<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Debian11 å®‰è£… Docker</title>
    <url>/2023/07/05/Debian11-%E5%AE%89%E8%A3%85-Docker/</url>
    <content><![CDATA[<h3 id="ä¸€ã€å®‰è£…Docker"><a href="#ä¸€ã€å®‰è£…Docker" class="headerlink" title="ä¸€ã€å®‰è£…Docker"></a>ä¸€ã€å®‰è£…<code>Docker</code></h3><h4 id="1-æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…"><a href="#1-æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…" class="headerlink" title="1.æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…"></a>1.æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ…</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h4 id="2-å®‰è£…æ‰€éœ€çš„ä¾èµ–åº“å’Œå·¥å…·ï¼š"><a href="#2-å®‰è£…æ‰€éœ€çš„ä¾èµ–åº“å’Œå·¥å…·ï¼š" class="headerlink" title="2.å®‰è£…æ‰€éœ€çš„ä¾èµ–åº“å’Œå·¥å…·ï¼š"></a>2.å®‰è£…æ‰€éœ€çš„ä¾èµ–åº“å’Œå·¥å…·ï¼š</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install apt-transport-https ca-certificates curl gnupg lsb-release</span><br></pre></td></tr></table></figure>

<h3 id="3-æ·»åŠ Dockerå®˜æ–¹GPTç§˜é’¥ï¼š"><a href="#3-æ·»åŠ Dockerå®˜æ–¹GPTç§˜é’¥ï¼š" class="headerlink" title="3.æ·»åŠ Dockerå®˜æ–¹GPTç§˜é’¥ï¼š"></a>3.æ·»åŠ <code>Docker</code>å®˜æ–¹<code>GPT</code>ç§˜é’¥ï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span><br></pre></td></tr></table></figure>

<h4 id="4-è®¾ç½®Dockerç¨³å®šç‰ˆå­˜å‚¨åº“"><a href="#4-è®¾ç½®Dockerç¨³å®šç‰ˆå­˜å‚¨åº“" class="headerlink" title="4.è®¾ç½®Dockerç¨³å®šç‰ˆå­˜å‚¨åº“"></a>4.è®¾ç½®<code>Docker</code>ç¨³å®šç‰ˆå­˜å‚¨åº“</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian <span class="subst">$(lsb_release -cs)</span> stable&quot;</span> | sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br></pre></td></tr></table></figure>

<h4 id="5-æ›´æ–°è½¯ä»¶åŒ…ç´¢å¼•ï¼š-è¿™ä¸€æ­¥å¯è¦å¯ä¸è¦ï¼Œå› ä¸ºå‰é¢å·²ç»æ‰§è¡Œäº†"><a href="#5-æ›´æ–°è½¯ä»¶åŒ…ç´¢å¼•ï¼š-è¿™ä¸€æ­¥å¯è¦å¯ä¸è¦ï¼Œå› ä¸ºå‰é¢å·²ç»æ‰§è¡Œäº†" class="headerlink" title="5.æ›´æ–°è½¯ä»¶åŒ…ç´¢å¼•ï¼š(è¿™ä¸€æ­¥å¯è¦å¯ä¸è¦ï¼Œå› ä¸ºå‰é¢å·²ç»æ‰§è¡Œäº†)"></a>5.æ›´æ–°è½¯ä»¶åŒ…ç´¢å¼•ï¼š(è¿™ä¸€æ­¥å¯è¦å¯ä¸è¦ï¼Œå› ä¸ºå‰é¢å·²ç»æ‰§è¡Œäº†)</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure>

<h4 id="6-å®‰è£…Dockerå¼•æ“ï¼š"><a href="#6-å®‰è£…Dockerå¼•æ“ï¼š" class="headerlink" title="6.å®‰è£…Dockerå¼•æ“ï¼š"></a>6.å®‰è£…Dockerå¼•æ“ï¼š</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>

<h4 id="7-æ·»åŠ å½“å‰ç”¨æˆ·åˆ°Dockerç»„ï¼š"><a href="#7-æ·»åŠ å½“å‰ç”¨æˆ·åˆ°Dockerç»„ï¼š" class="headerlink" title="7.æ·»åŠ å½“å‰ç”¨æˆ·åˆ°Dockerç»„ï¼š"></a>7.æ·»åŠ å½“å‰ç”¨æˆ·åˆ°<code>Docker</code>ç»„ï¼š</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo usermod -aG docker <span class="variable">$USER</span></span><br></pre></td></tr></table></figure>

<h6 id="å®‰è£…æˆåŠŸä»¥åæç¤ºï¼š"><a href="#å®‰è£…æˆåŠŸä»¥åæç¤ºï¼š" class="headerlink" title="å®‰è£…æˆåŠŸä»¥åæç¤ºï¼š"></a>å®‰è£…æˆåŠŸä»¥åæç¤ºï¼š</h6><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@Debian:~<span class="comment"># docker version #æŸ¥çœ‹ç‰ˆæœ¬</span></span><br><span class="line">Client: Docker Engine - Community</span><br><span class="line"> Version:           24.0.2</span><br><span class="line"> API version:       1.43</span><br><span class="line"> Go version:        go1.20.4</span><br><span class="line"> Git commit:        cb74dfc</span><br><span class="line"> Built:             Thu May 25 21:52:17 2023</span><br><span class="line"> OS/Arch:           linux/amd64</span><br><span class="line"> Context:           default</span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          24.0.2</span><br><span class="line">  API version:      1.43 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.20.4</span><br><span class="line">  Git commit:       659604f</span><br><span class="line">  Built:            Thu May 25 21:52:17 2023</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     <span class="literal">false</span></span><br><span class="line"> containerd:</span><br><span class="line">  Version:          1.6.21</span><br><span class="line">  GitCommit:        3dce8eb055cbb6872793272b4f20ed16117344f8</span><br><span class="line"> runc:</span><br><span class="line">  Version:          1.1.7</span><br><span class="line">  GitCommit:        v1.1.7-0-g860f061</span><br><span class="line"> docker-init:</span><br><span class="line">  Version:          0.19.0</span><br><span class="line">  GitCommit:        de40ad0</span><br></pre></td></tr></table></figure>

<h3 id="äºŒã€å®‰è£…Docker-Compose"><a href="#äºŒã€å®‰è£…Docker-Compose" class="headerlink" title="äºŒã€å®‰è£…Docker Compose"></a>äºŒã€å®‰è£…<code>Docker Compose</code></h3><p>ä¸‹è½½ <code>Docker Compose</code> äºŒè¿›åˆ¶æ–‡ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/latest/download/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ æ‰§è¡Œæƒé™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<p>éªŒè¯<code>Docker Compose</code>æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker-compose version</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Debian</category>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Debian - Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu UFW é˜²ç«å¢™</title>
    <url>/2023/07/01/Ubuntu-UFW-%E9%98%B2%E7%81%AB%E5%A2%99/</url>
    <content><![CDATA[<p><code>Ubuntu</code>é˜²ç«å¢™ï¼ˆ<code>Uncomplicated</code> <code>Firewall</code>ï¼Œç®€ç§°<code>ufw</code>ï¼‰æ˜¯ä¸€ä¸ªç”¨æˆ·å‹å¥½çš„å‰ç«¯å·¥å…·ï¼Œç”¨äºé…ç½®åº•å±‚çš„<code>iptables</code>é˜²ç«å¢™è§„åˆ™ã€‚å®ƒæ—¨åœ¨ç®€åŒ–é˜²ç«å¢™çš„é…ç½®è¿‡ç¨‹ï¼Œä½¿å…¶é€‚ç”¨äºä¸ç†Ÿæ‚‰<code>iptables</code>å‘½ä»¤çš„ç”¨æˆ·ã€‚</p>
<h3 id="ä¸€ã€å®‰è£…UFW"><a href="#ä¸€ã€å®‰è£…UFW" class="headerlink" title="ä¸€ã€å®‰è£…UFW"></a>ä¸€ã€å®‰è£…<code>UFW</code></h3><p><code>UFW</code> æ˜¯æ ‡å‡†<code> Ubuntu 20.04</code> å®‰è£…è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒåº”è¯¥å·²ç»åœ¨ä½ çš„ç³»ç»Ÿä¸Šå­˜åœ¨ã€‚å¦‚æœå› ä¸ºæŸäº›åŸå› ï¼Œå®ƒæ²¡æœ‰è¢«å®‰è£…ï¼Œä½ å¯ä»¥é€šè¿‡è¾“å…¥ä¸‹é¢çš„å‘½ä»¤å®‰è£…å®ƒï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install ufw</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h3 id="äºŒã€æ£€æŸ¥UFWçš„çŠ¶æ€"><a href="#äºŒã€æ£€æŸ¥UFWçš„çŠ¶æ€" class="headerlink" title="äºŒã€æ£€æŸ¥UFWçš„çŠ¶æ€"></a>äºŒã€æ£€æŸ¥<code>UFW</code>çš„çŠ¶æ€</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ufw status verbose</span><br></pre></td></tr></table></figure>

<h3 id="ä¸‰ã€é˜²ç«å¢™çš„åŸºæœ¬å‘½ä»¤"><a href="#ä¸‰ã€é˜²ç«å¢™çš„åŸºæœ¬å‘½ä»¤" class="headerlink" title="ä¸‰ã€é˜²ç«å¢™çš„åŸºæœ¬å‘½ä»¤"></a>ä¸‰ã€é˜²ç«å¢™çš„åŸºæœ¬å‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ufw <span class="built_in">enable</span> <span class="comment"># å¯ç”¨é˜²ç«å¢™</span></span><br><span class="line"></span><br><span class="line">sudo ufw <span class="built_in">disable</span> <span class="comment"># ç¦ç”¨é˜²ç«å¢™</span></span><br><span class="line"></span><br><span class="line">sudo ufw status <span class="comment"># æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">sudo ufw allow &lt;ç«¯å£å·&gt; <span class="comment"># å…è®¸ç‰¹å®šç«¯å£</span></span><br><span class="line"></span><br><span class="line">sudo ufw deny &lt;ç«¯å£å·&gt; <span class="comment"># ç¦æ­¢ç‰¹å®šç«¯å£</span></span><br><span class="line"></span><br><span class="line">sudo ufw allow from &lt;IPåœ°å€&gt; <span class="comment"># å…è®¸ç‰¹å®šIPåœ°å€è®¿é—®</span></span><br><span class="line"></span><br><span class="line">sudo ufw deny from &lt;IPåœ°å€&gt; <span class="comment"># ç¦æ­¢ç‰¹å®šIPåœ°å€è®¿é—®</span></span><br><span class="line"></span><br><span class="line">sudo ufw allow from &lt;IPåœ°å€&gt; to any port &lt;ç«¯å£å·&gt; <span class="comment"># å…è®¸ç‰¹å®šIPåœ°å€è®¿é—®ç‰¹å®šç«¯å£å· </span></span><br><span class="line"></span><br><span class="line">sudo ufw status numbered <span class="comment"># æŸ¥çœ‹è§„åˆ™ç¼–å·</span></span><br><span class="line"></span><br><span class="line">sudo ufw delete &lt;è§„åˆ™ç¼–å·&gt; <span class="comment"># åˆ é™¤è§„åˆ™</span></span><br></pre></td></tr></table></figure>

<h3 id="å››ã€æ ¡å›­ç½‘çš„æ¡ˆä¾‹"><a href="#å››ã€æ ¡å›­ç½‘çš„æ¡ˆä¾‹" class="headerlink" title="å››ã€æ ¡å›­ç½‘çš„æ¡ˆä¾‹"></a>å››ã€æ ¡å›­ç½‘çš„æ¡ˆä¾‹</h3><p>æ ¡å›­ç½‘è®¿é—®åœ¨å›½å¤–æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„ç½‘ç«™ï¼Œå¹¶ä½¿ç”¨<code>ufw</code>è¿›è¡Œé™åˆ¶ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š</p>
<ol>
<li><p>è·å–æ ¡å›­ç½‘çš„å…¬ç½‘<code>IP</code>åœ°å€èŒƒå›´ï¼šé¦–å…ˆï¼Œæ‚¨éœ€è¦è·å–æ ¡å›­ç½‘çš„å…¬ç½‘<code>IP</code>åœ°å€èŒƒå›´ã€‚æ‚¨å¯ä»¥è”ç³»æ‚¨çš„ç½‘ç»œç®¡ç†å‘˜æˆ–æŸ¥é˜…æ ¡å›­ç½‘ç›¸å…³çš„æ–‡æ¡£æˆ–èµ„æ–™ä»¥è·å–è¿™äº›ä¿¡æ¯ã€‚</p>
</li>
<li><p>æ·»åŠ å…è®¸è§„åˆ™ï¼šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼Œå°†æ ¡å›­ç½‘çš„å…¬ç½‘IPåœ°å€èŒƒå›´æ·»åŠ åˆ°å…è®¸è®¿é—®çš„è§„åˆ™ä¸­ã€‚å°† <code>&lt;æ ¡å›­ç½‘å…¬ç½‘IPèŒƒå›´&gt;</code> æ›¿æ¢ä¸ºæ‚¨å®é™…æ ¡å›­ç½‘çš„å…¬ç½‘IPåœ°å€èŒƒå›´ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ufw allow from &lt;æ ¡å›­ç½‘å…¬ç½‘IPèŒƒå›´&gt; to any</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ï¼Œå¦‚æœæ ¡å›­ç½‘çš„å…¬ç½‘IPåœ°å€èŒƒå›´æ˜¯ 203.0.113.0&#x2F;24ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ufw allow from 203.0.113.0/24 to any</span><br></pre></td></tr></table></figure>

<p>è¿™å°†å…è®¸æ¥è‡ªæ ¡å›­ç½‘å…¬ç½‘IPèŒƒå›´çš„æµé‡è®¿é—®ä»»ä½•ç«¯å£ã€‚</p>
</li>
<li><p>æ·»åŠ æ‹’ç»è§„åˆ™ï¼šä¸ºäº†ç¡®ä¿åªæœ‰æ ¡å›­ç½‘çš„å…¬ç½‘IPåœ°å€å¯ä»¥è®¿é—®æ‚¨çš„ç½‘ç«™ï¼Œæ‚¨å¯ä»¥æ·»åŠ ä¸€æ¡æ‹’ç»è§„åˆ™æ¥é˜»æ­¢å…¶ä»–IPåœ°å€çš„è®¿é—®ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ·»åŠ æ‹’ç»è§„åˆ™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ufw deny from any to any</span><br></pre></td></tr></table></figure>

<p>è¿™å°†æ‹’ç»æ¥è‡ªä»»ä½•å…¶ä»–IPåœ°å€çš„æµé‡è®¿é—®ä»»ä½•ç«¯å£ã€‚</p>
</li>
<li><p>ç¡®è®¤è§„åˆ™è®¾ç½®ï¼šæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¡®è®¤è§„åˆ™å·²æ­£ç¡®è®¾ç½®ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ufw status</span><br></pre></td></tr></table></figure>

<p>æ­¤å‘½ä»¤å°†æ˜¾ç¤ºå½“å‰çš„<code>ufw</code>è§„åˆ™åˆ—è¡¨ï¼ŒåŒ…æ‹¬å…è®¸å’Œæ‹’ç»çš„è§„åˆ™ã€‚</p>
</li>
<li><p>æµ‹è¯•è®¿é—®ï¼šåœ¨å®Œæˆé…ç½®åï¼Œæ‚¨å¯ä»¥å°è¯•ä½¿ç”¨æ ¡å›­ç½‘ä»¥å¤–çš„å…¬ç½‘<code>IP</code>åœ°å€è®¿é—®æ‚¨çš„ç½‘ç«™ï¼Œä»¥ç¡®ä¿å®ƒä»¬è¢«æ­£ç¡®åœ°æ‹’ç»è®¿é—®ã€‚åªæœ‰æ¥è‡ªæ ¡å›­ç½‘å…¬ç½‘IPèŒƒå›´çš„æµé‡æ‰åº”è¯¥èƒ½å¤Ÿè®¿é—®æ‚¨çš„ç½‘ç«™ã€‚</p>
</li>
</ol>
<p>è¯·æ³¨æ„ï¼Œç¡®ä¿åœ¨é…ç½®ä¹‹å‰å¤‡ä»½é‡è¦çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶åœ¨å®ŒæˆåéªŒè¯è§„åˆ™å·²æˆåŠŸè®¾ç½®ã€‚åŒæ—¶ï¼Œäº†è§£æ ¡å›­ç½‘çš„å…¬ç½‘<code>IP</code>åœ°å€èŒƒå›´éå¸¸é‡è¦ï¼Œä»¥ç¡®ä¿åªæœ‰å—é™åˆ¶çš„IPåœ°å€å¯ä»¥è®¿é—®æ‚¨çš„ç½‘ç«™ã€‚</p>
]]></content>
      <categories>
        <category>UFW</category>
        <category>Ubuntu UFW é˜²ç«å¢™</category>
      </categories>
      <tags>
        <tag>ufw - é˜²ç«å¢™</tag>
      </tags>
  </entry>
  <entry>
    <title>å¸¸è§ç½‘ç»œè®¾å¤‡å¯†ç </title>
    <url>/2023/06/20/%E5%B8%B8%E8%A7%81%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E5%AF%86%E7%A0%81/</url>
    <content><![CDATA[<h3 id="H3C"><a href="#H3C" class="headerlink" title="H3C"></a><code>H3C</code></h3><p>ï¼ˆåä¸‰ï¼‰è·¯ç”±å™¨äº¤æ¢æœºé»˜è®¤ç”¨æˆ·åå’Œå¯†ç </p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>admin</code></p>
<p>é»˜è®¤å¯†ç ï¼š<code>admin</code>æˆ–<code>adminer</code></p>
</blockquote>
<span id="more"></span>
<h3 id="HUAWEI"><a href="#HUAWEI" class="headerlink" title="HUAWEI"></a><code>HUAWEI</code></h3><p><code>V2R900</code>ä¹‹å‰ç‰ˆæœ¬</p>
<blockquote>
<p>æ— éœ€ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç </p>
</blockquote>
<p><code>V2R900</code>-<code>V2R10C00</code></p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>admin</code></p>
<p>é»˜è®¤å¯†ç ï¼š<code>admin@huawei.com</code></p>
</blockquote>
<h3 id="Cisco"><a href="#Cisco" class="headerlink" title="Cisco"></a><code>Cisco</code></h3><p>æ€ç§‘è·¯ç”±å™¨ï¼Œäº¤æ¢æœºå¤§å¤šæ•°é»˜è®¤ç”¨æˆ·åå’Œå¯†ç ï¼š</p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>admin</code>æˆ–<code>cisco</code></p>
<p>é»˜è®¤å¯†ç ï¼š<code>admin</code>æˆ–<code>cisco</code></p>
</blockquote>
<h3 id="Tp-Link"><a href="#Tp-Link" class="headerlink" title="Tp-Link"></a><code>Tp-Link</code></h3><p>ä¸­å¿ƒZTEè·¯ç”±å™¨äº¤æ¢æœºé»˜è®¤ç”¨æˆ·åå’Œå¯†ç </p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>admin</code></p>
<p>é»˜è®¤å¯†ç ï¼š<code>admin</code></p>
</blockquote>
<h3 id="Juniper"><a href="#Juniper" class="headerlink" title="Juniper"></a><code>Juniper</code></h3><ul>
<li><code>Juniper</code>æœ‰ä¸¤ç§é»˜è®¤ç”¨æˆ·åå’Œå¯†ç </li>
</ul>
<p><code>netscreen</code>è®¾å¤‡ï¼š</p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>netscreen</code></p>
<p>é»˜è®¤å¯†ç ï¼š<code>netscreen</code></p>
</blockquote>
<p><code>SRX</code>è®¾å¤‡ï¼š</p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>root</code></p>
<p>é»˜è®¤å¯†ç ï¼šæ— ï¼ˆç™»å½•ä»¥åè‡ªå·±å¯ä»¥è®¾ç½®ï¼‰</p>
</blockquote>
<h3 id="ZTE"><a href="#ZTE" class="headerlink" title="ZTE"></a><code>ZTE</code></h3><p>ä¸­å¿ƒ<code>ZTE</code>è·¯ç”±å™¨äº¤æ¢æœºé»˜è®¤ç”¨æˆ·åå’Œå¯†ç </p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>ZXDSL</code></p>
<p>é»˜è®¤å¯†ç ï¼š<code>ZXDSL</code></p>
</blockquote>
<h3 id="æ·±ä¿¡æœ"><a href="#æ·±ä¿¡æœ" class="headerlink" title="æ·±ä¿¡æœ"></a><code>æ·±ä¿¡æœ</code></h3><p>ä¸‹ä¸€ä»£é˜²ç«å¢™é»˜è®¤ç”¨æˆ·åå’Œå¯†ç :</p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>admin</code></p>
<p>é»˜è®¤å¯†ç ï¼š<code>admin</code></p>
</blockquote>
<p>å…¨ç½‘è¡Œä¸ºç®¡ç†ACé»˜è®¤ç”¨æˆ·åå’Œå¯†ç </p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>admin</code></p>
<p>é»˜è®¤å¯†ç ï¼š<code>switch</code></p>
</blockquote>
<h3 id="Alcatel"><a href="#Alcatel" class="headerlink" title="Alcatel"></a><code>Alcatel</code></h3><p><code>Alcatel</code>è·¯ç”±å™¨é»˜è®¤ç”¨æˆ·åå’Œå¯†ç ï¼š</p>
<blockquote>
<p>é»˜è®¤ç”¨æˆ·åï¼š<code>admin</code></p>
<p>é»˜è®¤å¯†ç ï¼š<code>switch</code></p>
</blockquote>
]]></content>
      <categories>
        <category>ç½‘ç»œè®¾å¤‡</category>
      </categories>
      <tags>
        <tag>äº¤æ¢æœº - å¸¸è§ç½‘ç»œè®¾å¤‡å¯†ç </tag>
      </tags>
  </entry>
  <entry>
    <title>äº¤æ¢æœºå·¡æ£€å‘½ä»¤</title>
    <url>/2023/06/17/%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%B7%A1%E6%A3%80%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h1 id="äº¤æ¢æœºå·¡æ£€å‘½ä»¤"><a href="#äº¤æ¢æœºå·¡æ£€å‘½ä»¤" class="headerlink" title="äº¤æ¢æœºå·¡æ£€å‘½ä»¤"></a>äº¤æ¢æœºå·¡æ£€å‘½ä»¤</h1><h3 id="ä¸€ã€æ€ç§‘äº¤æ¢æœº"><a href="#ä¸€ã€æ€ç§‘äº¤æ¢æœº" class="headerlink" title="ä¸€ã€æ€ç§‘äº¤æ¢æœº"></a>ä¸€ã€æ€ç§‘äº¤æ¢æœº</h3><span id="more"></span>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">show interface stats <span class="comment"># æŸ¥çœ‹äº¤æ¢æ‰€æœ‰æ¥å£å½“å‰æ¥å£æµé‡</span></span><br><span class="line">show running<span class="literal">-config</span> <span class="comment">#  æŸ¥çœ‹å½“å‰é…ç½®ä¿¡æ¯</span></span><br><span class="line">show version <span class="comment"># æŸ¥çœ‹ISOç‰ˆæœ¬ä¿¡æ¯åŠè®¾å¤‡æ­£å¸¸è¿è¡Œæ—¶é—´</span></span><br><span class="line">show clock <span class="comment"># æŸ¥çœ‹è®¾å¤‡æ—¶é’Ÿ</span></span><br><span class="line">show vtp status <span class="comment"># æŸ¥çœ‹äº¤æ¢æœºvtpé…ç½®æ¨¡å¼</span></span><br><span class="line">show vtp password <span class="comment"># æŸ¥çœ‹äº¤æ¢æœºvtpé…ç½®å£ä»¤</span></span><br><span class="line">show env all <span class="comment"># æ’å¡è®¾å¤‡æ¸©åº¦ï¼Œç”µæºå’Œé£æ‰‡è¿è½¬å‚æ•°åŠæ˜¯å¦æŠ¥è­¦</span></span><br><span class="line">show inventory <span class="comment"># è°ƒå–è®¾å¤‡å†…éƒ¨æ¿å¡å‡ºå‚æ¨¡å—å‹å·åŠåºåˆ—å·</span></span><br><span class="line">show spanning<span class="literal">-tree</span> root <span class="comment"># æŸ¥çœ‹äº¤æ¢æœºç”Ÿæˆæ ‘æ ¹ä½ç½®</span></span><br><span class="line">show interface summary <span class="comment"># æŸ¥çœ‹äº¤æ¢æ¥å£å½“å‰æ¥å£æµé‡</span></span><br><span class="line">show interface |ierrors|FastEthernet|GigabitEthernet <span class="comment"># æŸ¥çœ‹æ¥å£æ˜¯å¤Ÿå­˜åœ¨å¤§é‡inputæˆ–output errors åŒ…é”™è¯¯</span></span><br><span class="line">show processses cpu <span class="comment"># æŸ¥çœ‹è®¾å¤‡CPUè´Ÿè½½</span></span><br><span class="line">show access<span class="literal">-list</span> <span class="comment">#æŸ¥çœ‹è®¿é—®æ§åˆ¶åˆ—è¡¨é…ç½®åŠåŒ¹é…æ•°æ®åŒ…æ•°é‡</span></span><br><span class="line">show logging <span class="comment"># æŸ¥çœ‹æœ¬æœºå†…éƒ¨æ—¥å¿—è®°å½•æƒ…å†µ</span></span><br><span class="line">show ip route <span class="comment"># æŸ¥çœ‹è·¯ç”±è¡¨</span></span><br><span class="line">show firewall <span class="comment"># æ£€æŸ¥é˜²ç«å¢™çš„å·¥ä½œæ¨¡å¼</span></span><br><span class="line">show conn count <span class="comment"># æ£€æŸ¥é˜²ç«å¢™å¹¶å‘æ•°</span></span><br><span class="line">show xlate count <span class="comment"># æ£€æŸ¥é˜²ç«å¢™natå·¥ä½œçŠ¶æ€</span></span><br></pre></td></tr></table></figure>



<h3 id="äºŒã€åä¸º-x2F-H3Cäº¤æ¢æœº"><a href="#äºŒã€åä¸º-x2F-H3Cäº¤æ¢æœº" class="headerlink" title="äºŒã€åä¸º&#x2F;H3Cäº¤æ¢æœº"></a>äºŒã€åä¸º&#x2F;H3Cäº¤æ¢æœº</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">system-view <span class="comment"># è¿›å…¥ç³»ç»Ÿè§†å›¾</span></span><br><span class="line">user-interface vty 0 4 <span class="comment">#vtyå°±æ˜¯ç”¨telnet/sshè¿œç¨‹è¿›å…¥äº¤æ¢æœºçš„ç•Œé¢</span></span><br><span class="line">screen-length 0 <span class="comment"># æŒ‡å®šè¦åœ¨å±å¹•ä¸Šæ˜¾ç¤ºè¡Œæ•°ï¼Œ0é»˜è®¤æ˜¯æ²¡æœ‰åˆ†é¡µ</span></span><br></pre></td></tr></table></figure>

<h4 id="1-ç¡¬ä»¶çŠ¶æ€ï¼ŒISOç‰ˆæœ¬ä¿¡æ¯æ£€æŸ¥"><a href="#1-ç¡¬ä»¶çŠ¶æ€ï¼ŒISOç‰ˆæœ¬ä¿¡æ¯æ£€æŸ¥" class="headerlink" title="1. ç¡¬ä»¶çŠ¶æ€ï¼ŒISOç‰ˆæœ¬ä¿¡æ¯æ£€æŸ¥"></a>1. ç¡¬ä»¶çŠ¶æ€ï¼ŒISOç‰ˆæœ¬ä¿¡æ¯æ£€æŸ¥</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">display clock <span class="comment">#ç³»ç»Ÿæ—¶é—´</span></span><br><span class="line">display version <span class="comment">#æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œæœ€è¿‘iä¸€æ¬¡å¯åŠ¨çš„æ—¶é—´</span></span><br><span class="line">display environment <span class="comment">#è®¾å¤‡æ¸©åº¦</span></span><br><span class="line">display device <span class="comment">#å•æ¿è¿è¡ŒçŠ¶æ€</span></span><br><span class="line">display device manuinfor <span class="comment">#æŸ¥çœ‹è®¾å¤‡åºåˆ—å·</span></span><br><span class="line">display power <span class="comment">#æŸ¥çœ‹ç”µæºçŠ¶å†µ</span></span><br><span class="line">display fan <span class="comment">#æŸ¥çœ‹é£æ‰‡çŠ¶å†µ</span></span><br><span class="line">disply cpu-usage task <span class="comment">#æŸ¥çœ‹CPUåˆ©ç”¨ç‡</span></span><br><span class="line">dispaly memory <span class="comment">#æŸ¥çœ‹å†…å­˜å¤§å°å’Œå ç”¨ç‡</span></span><br><span class="line">dispaly logbuffer <span class="comment">#æ—¥å¿—ç¼“å†²åŒº</span></span><br><span class="line"><span class="built_in">dir</span> flash <span class="comment">#æŸ¥çœ‹flash</span></span><br><span class="line">dis boot-loader <span class="comment">#æ˜¾ç¤ºè½¯ä»¶æ˜ åƒæ–‡ä»¶</span></span><br><span class="line">display arp <span class="comment">#æ˜¾ç¤ºarpè¡¨ï¼ˆç›®çš„IPå’Œç›®çš„Macçš„æ˜ å°„å…³ç³»ï¼‰</span></span><br><span class="line">display mac-address <span class="comment">#æŸ¥çœ‹macåœ°å€è¡¨ï¼ˆäºŒå±‚è½¬å‘é€šè¿‡macåœ°å€è¡¨ï¼‰</span></span><br><span class="line">display ntp status <span class="comment">#ntpçŠ¶æ€ä¿¡æ¯</span></span><br><span class="line">reset counters interface <span class="comment">#æ¸…é™¤æ¥å£ç»Ÿè®¡ä¿¡æ¯ï¼Œæ–¹ä¾¿ä¸‹æ¬¡å·¡æ£€æŸ¥çœ‹æ¥å£é”™è¯¯åŒ…æ˜¯å¦å¢åŠ </span></span><br><span class="line">display elabel <span class="comment">#è·¯ç”±å™¨è®¾å¤‡å‘½ä»¤â€”æŸ¥çœ‹ç”µå­æ ‡ç­¾ä¿¡æ¯ï¼ˆåä¸ºï¼‰æ”¹ç”¨display device manuinfo</span></span><br><span class="line">display ndp <span class="comment">#è·¯ç”±å™¨è®¾å¤‡å‘½ä»¤â€”åä¸‰V5ç‰ˆæœ¬æ”¯æŒï¼Œç°åœ¨æ”¹ç”¨display lldp neighbor-information</span></span><br><span class="line">display diagnostic-information <span class="comment">#æ•…éšœä¿¡æ¯æ”¶é›†</span></span><br></pre></td></tr></table></figure>



<h4 id="2-ç³»ç»Ÿè¿è¡Œé…ç½®çŠ¶æ€æ£€æŸ¥"><a href="#2-ç³»ç»Ÿè¿è¡Œé…ç½®çŠ¶æ€æ£€æŸ¥" class="headerlink" title="2. ç³»ç»Ÿè¿è¡Œé…ç½®çŠ¶æ€æ£€æŸ¥"></a>2. ç³»ç»Ÿè¿è¡Œé…ç½®çŠ¶æ€æ£€æŸ¥</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">display interface <span class="comment">#æ¥å£æµé‡ã€é“¾è·¯çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">dis current-configuration inter <span class="comment">#åœ°å€åˆ†é…</span></span><br><span class="line"></span><br><span class="line">dis current-configuration |include ospf <span class="comment">#è·¯ç”±æ‰©æ•£</span></span><br><span class="line"></span><br><span class="line">display ip routing-table <span class="comment">#è·¯ç”±ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">display ip interface <span class="comment">#æ˜¾ç¤º vlan ç«¯å£ç»Ÿè®¡æ•°æ®</span></span><br><span class="line"></span><br><span class="line">display saved-configuration <span class="comment">#ä¿å­˜é…ç½®æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">display logbuffer <span class="comment">#æ—¥å¿—ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">display port trunk <span class="comment">#æŸ¥çœ‹å‚ä¸ trunk çš„ç«¯å£</span></span><br></pre></td></tr></table></figure>

<h4 id="3-STPä¿¡æ¯æ£€æŸ¥"><a href="#3-STPä¿¡æ¯æ£€æŸ¥" class="headerlink" title="3. STPä¿¡æ¯æ£€æŸ¥"></a>3. STPä¿¡æ¯æ£€æŸ¥</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">display stp root <span class="comment">#æŸ¥çœ‹ stp æ ¹æƒ…å†µ</span></span><br><span class="line"></span><br><span class="line">display stp brief <span class="comment">#æŸ¥çœ‹ stp ç®€å•ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">display stp abnormal-port <span class="comment">#æŸ¥çœ‹æ˜¯å¦æœ‰éæ­£å¸¸ç«¯å£</span></span><br><span class="line"></span><br><span class="line">display stp region-configuration <span class="comment">#ç”Ÿæˆæ ‘åŒºåŸŸé…ç½®</span></span><br><span class="line"></span><br><span class="line">display lldp neighbor-information <span class="comment">#æŸ¥çœ‹é“¾è·¯å±‚é‚»å±…å‘ç°åè®®ï¼ˆé‚»å±…ä¿¡æ¯ï¼‰</span></span><br><span class="line"></span><br><span class="line">display tcp status <span class="comment">#è·¯ç”±å™¨è®¾å¤‡å‘½ä»¤â€”tcpç»Ÿè®¡æ•°æ®</span></span><br><span class="line"></span><br><span class="line">display tcp statistics <span class="comment">#äº¤æ¢æœºè®¾å¤‡å‘½ä»¤â€”tcpç»Ÿè®¡æ•°æ®</span></span><br></pre></td></tr></table></figure>

<h4 id="4-vrrpå’Œç«¯å£èšåˆæ£€æŸ¥"><a href="#4-vrrpå’Œç«¯å£èšåˆæ£€æŸ¥" class="headerlink" title="4.vrrpå’Œç«¯å£èšåˆæ£€æŸ¥"></a>4.vrrpå’Œç«¯å£èšåˆæ£€æŸ¥</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">display vrrp <span class="comment">#æŸ¥çœ‹è™šæ‹Ÿè·¯ç”±å†—ä½™åè®®</span></span><br><span class="line"></span><br><span class="line">display vrrp statistics <span class="comment">#æŸ¥çœ‹ä¸»å¤‡ç”¨çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">display link-aggregation summary <span class="comment">#æŸ¥çœ‹é“¾è·¯èšåˆç»„çš„æƒ…å†µ</span></span><br></pre></td></tr></table></figure>































]]></content>
      <categories>
        <category>Switch</category>
        <category>äº¤æ¢æœº</category>
      </categories>
      <tags>
        <tag>Switch</tag>
        <tag>äº¤æ¢æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Mac(MacBookPro M1)MySQLæ— æ³•æ‰“å¼€è§£å†³æ–¹å¼</title>
    <url>/2023/06/07/Mac-MacBookPro-M1-MySQL%E6%97%A0%E6%B3%95%E6%89%93%E5%BC%80%E8%A7%A3%E5%86%B3%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<p>1.åœ¨macç³»ç»Ÿçš„æ´»åŠ¨ç›‘è§†å™¨é‡Œé¢æ‰¾åˆ°mysqldçš„è¿›ç¨‹é€‰æ‹©å°†å®ƒå…³é—­æ‰ï¼Œç„¶åæ‰“å¼€macä¸Šçš„å‘½ä»¤è¡Œå»æ‰§è¡Œå‘½ä»¤ã€‚</p>
<span id="more"></span>

<p>2.åœ¨å‘½ä»¤è¡Œä¹‹ä¸­æ‰§è¡Œå‘½ä»¤å»ç»™mysqlæ•°æ®åº“çš„å®‰è£…ç›®å½•èµ‹äºˆä¸€ä¸ªå¯ä»¥è¿›è¡Œè¯»å†™å’Œæ‰§è¡Œä»»æ„æ“ä½œçš„æƒé™ï¼Œåœ¨æœåŠ¡èƒ½å¤Ÿè¿è¡Œçš„æƒ…å†µä¸‹æ— æ³•å¯åŠ¨çš„åŸå› åŸºæœ¬ä¸Šéƒ½æ˜¯å› ä¸ºæƒé™å’Œé…ç½®æ–‡ä»¶çš„é—®é¢˜æ‰€å¯¼è‡´çš„ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">chown</span> -R mysql /usr/local/mysql/data</span><br></pre></td></tr></table></figure>



<p>3.å‘½ä»¤æ‰§è¡Œå®Œæ¯•ä¹‹åå†æ¬¡è¾“å…¥å‘½ä»¤å»å¯åŠ¨mysqlæ•°æ®åº“ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /usr/local/mysql/support-files/mysql.server start</span><br></pre></td></tr></table></figure>



<p>4.æ‰§è¡Œå®Œæ¯•æˆåŠŸä»¥åå‡ºç°ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Starting MySQL</span><br><span class="line">.Logging to <span class="string">&#x27;/usr/local/mysql/data/couturedeMacBook-Pro.local.err&#x27;</span>.</span><br><span class="line"> SUCCESS!</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>MySQL</category>
        <category>Mac</category>
      </categories>
      <tags>
        <tag>Mac</tag>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>å°çŸ¥è¯†</title>
    <url>/2023/05/29/%E5%B0%8F%E7%9F%A5%E8%AF%86/</url>
    <content><![CDATA[<h3 id="DTUå’ŒRTUæ˜¯ä»€ä¹ˆï¼š"><a href="#DTUå’ŒRTUæ˜¯ä»€ä¹ˆï¼š" class="headerlink" title="DTUå’ŒRTUæ˜¯ä»€ä¹ˆï¼š"></a>DTUå’ŒRTUæ˜¯ä»€ä¹ˆï¼š</h3><p>â€‹	DTUå’ŒRTUéƒ½æ˜¯æŒ‡ç”¨äºè¿œç¨‹ç›‘æ§å’Œæ§åˆ¶çš„è®¾å¤‡ï¼Œä½†å®ƒä»¬æœ‰ä¸åŒçš„å«ä¹‰ã€‚</p>
<span id="more"></span>

<p>DTUæ˜¯æ•°æ®ä¼ è¾“å•å…ƒï¼ˆData Transfer Unitï¼‰çš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§è¿œç¨‹æ•°æ®ä¼ è¾“è®¾å¤‡ã€‚å®ƒé€šå¸¸æ˜¯å®‰è£…åœ¨ç°åœºè®¾å¤‡ä¸Šçš„ä¸€ç§å°å‹æ™ºèƒ½ç»ˆç«¯ï¼Œå¯ä»¥é‡‡é›†ç°åœºè®¾å¤‡çš„æ•°æ®ï¼Œå¹¶é€šè¿‡æ— çº¿é€šä¿¡æˆ–æœ‰çº¿é€šä¿¡æ–¹å¼å°†æ•°æ®ä¼ è¾“åˆ°è¿œç¨‹æœåŠ¡å™¨æˆ–äº‘å¹³å°ã€‚DTUé€šå¸¸å…·æœ‰æ•°æ®é‡‡é›†ã€å¤„ç†ã€ä¼ è¾“å’Œå­˜å‚¨ç­‰å¤šç§åŠŸèƒ½ã€‚</p>
<p>RTUæ˜¯è¿œç¨‹ç»ˆç«¯å•å…ƒï¼ˆRemote Terminal Unitï¼‰çš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§ç”¨äºè¿œç¨‹ç›‘æ§å’Œæ§åˆ¶çš„è®¾å¤‡ã€‚å®ƒé€šå¸¸æ˜¯å®‰è£…åœ¨ç°åœºè®¾å¤‡ä¸Šçš„ä¸€ç§å°å‹æ™ºèƒ½ç»ˆç«¯ï¼Œå¯ä»¥é‡‡é›†ç°åœºè®¾å¤‡çš„æ•°æ®ï¼Œå¹¶é€šè¿‡æ— çº¿é€šä¿¡æˆ–æœ‰çº¿é€šä¿¡æ–¹å¼å°†æ•°æ®ä¼ è¾“åˆ°è¿œç¨‹ç›‘æ§ä¸­å¿ƒã€‚RTUé€šå¸¸å…·æœ‰æ•°æ®é‡‡é›†ã€å¤„ç†ã€æ§åˆ¶å’ŒæŠ¥è­¦ç­‰å¤šç§åŠŸèƒ½ã€‚</p>
<h3 id="RS232-x2F-RS485æ¥å£ï¼š"><a href="#RS232-x2F-RS485æ¥å£ï¼š" class="headerlink" title="RS232&#x2F;RS485æ¥å£ï¼š"></a>RS232&#x2F;RS485æ¥å£ï¼š</h3><p>â€‹	RS232å’ŒRS485éƒ½æ˜¯ä¸²è¡Œé€šä¿¡æ¥å£æ ‡å‡†ï¼Œå®ƒä»¬ç”¨äºåœ¨è®¡ç®—æœºå’Œå…¶ä»–è®¾å¤‡ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚</p>
<p>RS232æ˜¯ä¸€ç§ä¸²è¡Œé€šä¿¡æ ‡å‡†ï¼Œç”¨äºåœ¨è®¡ç®—æœºå’Œå…¶ä»–è®¾å¤‡ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚å®ƒå¸¸ç”¨äºè¿æ¥è°ƒåˆ¶è§£è°ƒå™¨ã€æ‰“å°æœºã€ä¼ çœŸæœºã€æ¡å½¢ç æ‰«æå™¨ç­‰è®¾å¤‡ã€‚RS232æ ‡å‡†è§„å®šäº†æ•°æ®ä¼ è¾“çš„ç”µæ°”ç‰¹æ€§ã€ä¿¡å·æ ¼å¼ã€æ•°æ®ä¼ è¾“é€Ÿç‡ç­‰å‚æ•°ã€‚</p>
<p>RS485ä¹Ÿæ˜¯ä¸€ç§ä¸²è¡Œé€šä¿¡æ ‡å‡†ï¼Œç”¨äºåœ¨è®¡ç®—æœºå’Œå…¶ä»–è®¾å¤‡ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚å®ƒé€šå¸¸ç”¨äºè¿æ¥å¤šä¸ªè®¾å¤‡ï¼Œå¦‚ä¼ æ„Ÿå™¨ã€æ§åˆ¶å™¨ã€PLCç­‰ã€‚RS485æ ‡å‡†è§„å®šäº†æ•°æ®ä¼ è¾“çš„ç”µæ°”ç‰¹æ€§ã€ä¿¡å·æ ¼å¼ã€æ•°æ®ä¼ è¾“é€Ÿç‡ç­‰å‚æ•°ï¼Œå¹¶æ”¯æŒå¤šç‚¹é€šä¿¡å’Œå·®åˆ†ä¿¡å·ä¼ è¾“ï¼Œå¯ä»¥å®ç°æ›´è¿œè·ç¦»çš„æ•°æ®ä¼ è¾“å’Œæ›´å¯é çš„æ•°æ®ä¼ è¾“ã€‚</p>
]]></content>
      <categories>
        <category>Agreement</category>
      </categories>
      <tags>
        <tag>Agreement</tag>
      </tags>
  </entry>
  <entry>
    <title>æ­å»ºChatGPTå…³é—­NGINXç¼“å­˜å®ç°å®˜æ–¹å›ç­”æ•ˆæœ</title>
    <url>/2023/05/08/%E6%90%AD%E5%BB%BAChatGPT%E5%85%B3%E9%97%ADNGINX%E7%BC%93%E5%AD%98%E5%AE%9E%E7%8E%B0%E5%AE%98%E6%96%B9%E5%9B%9E%E7%AD%94%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<p>ä¸‹é¢æ˜¯Nginxé…ç½®åå‘ä»£ç†æ–¹å¼ï¼Œå½“ç„¶ä¸ä»…ä»…è¿™ä¸€ç§æ–¹å¼</p>
<span id="more"></span>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line"></span><br><span class="line">listen 80;</span><br><span class="line"></span><br><span class="line">server_name xx.xx; <span class="comment"># åŸŸå</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">return</span> 301 https://$host<span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line"></span><br><span class="line">listen 443 ssl http2;</span><br><span class="line"></span><br><span class="line">server_name xx.cn; <span class="comment"># åŸŸå</span></span><br><span class="line"></span><br><span class="line">ssl_certificate /etc/nginx/certs/cert08.pem;</span><br><span class="line"></span><br><span class="line">ssl_certificate_key /etc/nginx/certs/key08.pem;</span><br><span class="line"></span><br><span class="line">location /&#123;</span><br><span class="line"></span><br><span class="line">  proxy_pass http://zxx.xx.xx:3000; <span class="comment"># æœåŠ¡å™¨çš„åœ°å€</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># è¿™é‡Œæ˜¯é‡ç‚¹ï¼Œåœ¨è¿™é‡Œæ˜¯å…³é—­ç¼“å­˜æ–¹å¼</span></span><br><span class="line">  proxy_buffering off; <span class="comment"># ç¦ç”¨ç¼“å­˜</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line"></span><br><span class="line">  proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line"></span><br><span class="line">  proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ChatGPT</category>
        <category>Nginx</category>
      </categories>
      <tags>
        <tag>ChatGPT - NGINX</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntuä½¿ç”¨sshè¿æ¥æœ‰è¾“å…¥å‘½ä»¤æœ‰æç¤º</title>
    <url>/2023/05/05/Ubuntu%E4%BD%BF%E7%94%A8ssh%E8%BF%9E%E6%8E%A5%E6%9C%89%E8%BE%93%E5%85%A5%E5%91%BD%E4%BB%A4%E6%9C%89%E6%8F%90%E7%A4%BA/</url>
    <content><![CDATA[<p>Ubuntuä½¿ç”¨é»˜è®¤çš„OpenSSHæœåŠ¡ä½œä¸ºSSHæœåŠ¡å™¨ï¼Œå½“æ‚¨ä½¿ç”¨SSHè¿æ¥åˆ°è¿œç¨‹è®¡ç®—æœºæ—¶ï¼Œå¦‚æœéœ€è¦æœ‰å‘½ä»¤æç¤ºï¼Œæ‚¨éœ€è¦å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>ç™»å½•åˆ°æ‚¨çš„è¿œç¨‹è®¡ç®—æœº<span id="more"></span>     </li>
<li>æ‰“å¼€æ‚¨çš„<code>SSH</code>é…ç½®æ–‡ä»¶</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°é…ç½®æ–‡ä»¶çš„æœ«å°¾ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PermitUserEnvironment <span class="built_in">yes</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p>ä¿å­˜å¹¶å…³é—­æ–‡ä»¶</p>
</li>
<li><p>é‡æ–°å¯åŠ¨<code>SSH</code>æœåŠ¡å™¨</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo service ssh restart</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>åˆ›å»ºä¸€ä¸ª<code>.bashrc</code>æ–‡ä»¶å¹¶æ·»åŠ ä¸€äº›å˜é‡</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nano ~/.bashrc</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>æ·»åŠ ä»¥ä¸‹è¡Œåˆ°æ–‡æœ¬ä¸­ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PS1=<span class="string">&quot;\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\W\[\033[00m\]\$ &quot;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¼šè®¾ç½®æ‚¨çš„æç¤ºç¬¦ã€‚</p>
<ol start="8">
<li><p>ä¿å­˜å¹¶å…³é—­æ–‡ä»¶</p>
</li>
<li><p>é‡æ–°åŠ è½½<code>bashrc</code>æ–‡ä»¶</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>è¿™èƒ½ç¡®ä¿è®©<code>.bashrc</code>çš„å˜æ›´ç”Ÿæ•ˆã€‚</p>
<p>ä»ç°åœ¨å¼€å§‹ï¼Œåœ¨ä½¿ç”¨<code>SSH</code>è¿æ¥åˆ°è¿œç¨‹è®¡ç®—æœºæ—¶ï¼Œæ‚¨åº”è¯¥ä¼šåœ¨è¾“å…¥å‘½ä»¤æ—¶è·å¾—æç¤ºã€‚</p>
]]></content>
      <categories>
        <category>Ubuntu</category>
        <category>SSH</category>
      </categories>
      <tags>
        <tag>Ubuntu - SSH</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntuå¸è½½Nginxå’Œæ›¿æ¢é…ç½®æ–‡ä»¶</title>
    <url>/2023/05/04/Ubuntu%E5%8D%B8%E8%BD%BDNginx%E5%92%8C%E6%9B%BF%E6%8D%A2%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<h3 id="1ã€å¸è½½Nginx"><a href="#1ã€å¸è½½Nginx" class="headerlink" title="1ã€å¸è½½Nginx"></a>1ã€å¸è½½Nginx</h3><ol>
<li>åœæ­¢ Nginx æœåŠ¡ï¼š</li>
</ol>
<span id="more"></span>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl stop nginx</span><br></pre></td></tr></table></figure>

<ol>
<li>åˆ é™¤ Nginxï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get remove nginx</span><br></pre></td></tr></table></figure>

<ol>
<li>åˆ é™¤ Nginx é…ç½®æ–‡ä»¶ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> -rf /etc/nginx/</span><br></pre></td></tr></table></figure>

<ol>
<li>åˆ é™¤ Nginx æ—¥å¿—æ–‡ä»¶ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> -rf /var/log/nginx/</span><br></pre></td></tr></table></figure>

<ol>
<li>æœ€åï¼Œåˆ é™¤ Nginx ç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo deluser --remove-home nginx</span><br><span class="line">sudo delgroup nginx</span><br></pre></td></tr></table></figure>

<p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œå°±æˆåŠŸå¸è½½ Nginxã€‚</p>
<h3 id="2ã€é…ç½®æ–‡ä»¶æ›¿æ¢ï¼ˆé‡ç½®é…ç½®æ–‡ä»¶ï¼‰"><a href="#2ã€é…ç½®æ–‡ä»¶æ›¿æ¢ï¼ˆé‡ç½®é…ç½®æ–‡ä»¶ï¼‰" class="headerlink" title="2ã€é…ç½®æ–‡ä»¶æ›¿æ¢ï¼ˆé‡ç½®é…ç½®æ–‡ä»¶ï¼‰"></a>2ã€é…ç½®æ–‡ä»¶æ›¿æ¢ï¼ˆé‡ç½®é…ç½®æ–‡ä»¶ï¼‰</h3><p>1.æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤åœæ­¢NGINXæœåŠ¡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl stop nginx</span><br></pre></td></tr></table></figure>

<p>2.å¤‡ä»½NGINXçš„å½“å‰é…ç½®æ–‡ä»¶ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak</span><br></pre></td></tr></table></figure>

<p>3.æ¢å¤é»˜è®¤çš„NGINXé…ç½®æ–‡ä»¶ï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">sudo cp <span class="regexp">/etc/</span>nginx<span class="regexp">/nginx.conf.default /</span>etc<span class="regexp">/nginx/</span>nginx.conf</span><br></pre></td></tr></table></figure>

<p>4.æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰é”™è¯¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo nginx -t</span><br></pre></td></tr></table></figure>

<p>5.å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œåˆ™é‡æ–°å¯åŠ¨NGINXæœåŠ¡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl start nginx</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œæ‚¨çš„NGINXæœåŠ¡åº”è¯¥å·²ç»é‡ç½®å¹¶é‡æ–°å¯åŠ¨ã€‚</p>
<h3 id="3ã€å®‰è£…Nginx"><a href="#3ã€å®‰è£…Nginx" class="headerlink" title="3ã€å®‰è£…Nginx"></a>3ã€å®‰è£…Nginx</h3><ol>
<li>æ‰“å¼€å‘½ä»¤ç»ˆç«¯ï¼Œæ›´æ–°è½¯ä»¶ä»“åº“ä¿¡æ¯ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install nginx</span><br></pre></td></tr></table></figure>

<ol>
<li>å®‰è£…å®Œæˆåï¼Œæ‚¨å¯ä»¥å¯åŠ¨NGINXå¹¶å°†å…¶æ·»åŠ åˆ°å¯åŠ¨é¡¹ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl start nginx` `sudo systemctl <span class="built_in">enable</span> nginx</span><br></pre></td></tr></table></figure>

<ol>
<li>æ£€æŸ¥NGINXæ˜¯å¦æ­£åœ¨è¿è¡Œï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl status nginx</span><br></pre></td></tr></table></figure>

<p>å¦‚æœçœ‹åˆ°â€œActive: active (running)â€çš„çŠ¶æ€ï¼Œåˆ™è¯´æ˜NGINXå·²æˆåŠŸå®‰è£…å¹¶æ­£åœ¨è¿è¡Œã€‚</p>
]]></content>
      <categories>
        <category>nginx</category>
        <category>è¿ç»´</category>
        <category>Ubuntu</category>
      </categories>
      <tags>
        <tag>Nginx - è¿ç»´</tag>
      </tags>
  </entry>
  <entry>
    <title>CLOUDFLAREå…³é—­ç¼“å­˜</title>
    <url>/2023/04/29/CLOUDFLARE%E5%85%B3%E9%97%AD%E7%BC%93%E5%AD%98/</url>
    <content><![CDATA[<p>â€‹	å…³äºCLOUDFLAREæ³¨å†Œæ‰˜ç®¡ä»€ä¹ˆæˆ‘å°±ä¸åœ¨è¿™é‡Œåšè¿‡å¤šçš„ä»‹ç»äº†ï¼ŒæŒ‰ç…§å®˜æ–¹æŒ‡å¼•ä¸€æ­¥æ­¥æ¥å°±è¡Œäº†ï¼Œç»™ä½ çš„åŸŸåæ‰˜ç®¡è¿›å»å³å¯ã€‚</p>
<p>ä¸‹é¢æ˜¯å…³é—­CLOUDFLAREç¼“å­˜ã€‚</p>
<span id="more"></span>


<p><strong>æ‰“å¼€åŸŸåç®¡ç†ç•Œé¢ï¼Œé€‰æ‹©ç•Œé¢è§„åˆ™ï¼Œç„¶ååˆ›å»ºé¡µé¢è§„åˆ™ï¼Œé¡µé¢éœ€è¦åˆ›å»ºä¸¤æ¬¡ã€‚</strong></p>
<p><img src="https://s2.loli.net/2023/04/29/ks1eIC9AWdpwlqz.png" alt="image-20230429213154288"></p>
<p><strong>URLå¡«å†™ä½ çš„åŸŸååœ°å€ï¼Œåˆ›å»ºé¡µé¢ç¬¬ä¸€æ¬¡</strong></p>
<p><strong>æ¨¡æ¿:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(ä½ çš„åŸŸå)/*</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2023/04/29/T3G9lrQFto8dahf.png" alt="image-20230429213705544"></p>
<p><strong>é‡å¤ä¸Šé¢çš„æ“ä½œå†æ¥ä¸€æ¬¡ã€‚</strong></p>
<p><strong>ç¬¬äºŒæ¬¡æ¨¡ç‰ˆï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*.(ä½ çš„åŸŸå)/*</span><br></pre></td></tr></table></figure>



<p><img src="https://s2.loli.net/2023/04/29/v2j5zm1eTPwbISE.png" alt="image-20230429214152718"></p>
<p><strong>é…ç½®å®Œæˆä»¥åçš„ç»“æœï¼š</strong></p>
<p><img src="https://s2.loli.net/2023/04/29/ZWnsuk7IrB1JTi6.png" alt="image-20230429214511773"></p>
]]></content>
      <categories>
        <category>Cloudflare</category>
        <category>Cloud</category>
      </categories>
      <tags>
        <tag>Cloudflare</tag>
        <tag>Cloud</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker ä¼˜åŒ–</title>
    <url>/2023/04/29/Docker-%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<blockquote>
<p>ç”±äº<code>Docker</code>éƒ¨ç½²é¡¹ç›®ä¹‹åè®¿é—®æœ‰äº›æ…¢ï¼Œè€ƒè™‘åˆ°æœåŠ¡å™¨çš„æ€§èƒ½æ¯”è¾ƒå¼±ï¼Œ <code>Docker</code>ä¼˜åŒ–æ–¹æ¡ˆè§£å†³</p>
</blockquote>
<span id="more"></span>


<p>Dockerçš„ç¼“å­˜ä¼šéšç€æ—¶é—´çš„æ¨ç§»ä¸æ–­å¢é•¿ï¼Œæ¸…ç†ç¼“å­˜å¯ä»¥å‡å°ç£ç›˜å ç”¨ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯æ¸…ç†Dockerç¼“å­˜çš„æ–¹æ³•ï¼š</p>
<ol>
<li>æ¸…ç†æ²¡æœ‰ä½¿ç”¨çš„é•œåƒå’Œå®¹å™¨ã€‚è¿™äº›æœªä½¿ç”¨çš„é•œåƒå’Œå®¹å™¨ä¼šå ç”¨ç³»ç»Ÿçš„ç©ºé—´ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ¸…ç†ï¼š</li>
</ol>
<ul>
<li>æ¸…ç†æœªè¿è¡Œçš„å®¹å™¨ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker container prune -f</span><br></pre></td></tr></table></figure>

<ul>
<li>æ¸…ç†æœªä½¿ç”¨çš„é•œåƒï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker image prune -a -f</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>æ¸…ç†æœªä½¿ç”¨çš„æ•°æ®å·ã€‚åœ¨ä½¿ç”¨æ•°æ®å·çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ¸…ç†æ²¡æœ‰å…³è”å®¹å™¨çš„æ•°æ®å·ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker volume prune -f</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>æ”¹å˜Dockerçš„é•œåƒå­˜å‚¨ä½ç½®ã€‚å¯ä»¥åœ¨Dockerå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨æ—¶è®¾ç½®<code>--data-root</code>å‚æ•°ï¼ŒæŒ‡å®šDockeré•œåƒå­˜å‚¨çš„ä½ç½®ï¼Œæˆ–è€…é€šè¿‡è½¯é“¾æ¥ç­‰æ–¹æ³•æ¥æ”¹å˜Dockeré•œåƒç›®å½•ã€‚</p>
</li>
<li><p>å®šæœŸæ¸…ç†Dockeré•œåƒç¼“å­˜ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æ¸…ç†Dockeré•œåƒç¼“å­˜ï¼š</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker system prune -a -f --volumes</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‘½ä»¤ä¼šæ¸…ç†Dockeré•œåƒã€å®¹å™¨ã€ç½‘ç»œå’Œæ•°æ®å·ç­‰ä¸å†ä½¿ç”¨çš„èµ„æºã€‚</p>
<p>æ¸…ç†Dockerç¼“å­˜æ˜¯ä¸€ä¸ªå¥å£®çš„ç®¡ç†å®è·µï¼Œå¯ä»¥å¸®åŠ©ç³»ç»Ÿä¿æŒæœ€ä½³æ€§èƒ½ï¼Œå‡å°‘ç£ç›˜å ç”¨</p>
]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows11è·³è¿‡å¼€æœºè”ç½‘</title>
    <url>/2023/04/25/Windows11%E8%B7%B3%E8%BF%87%E5%BC%80%E6%9C%BA%E8%81%94%E7%BD%91/</url>
    <content><![CDATA[<p>è¿™æ—¶å€™åœ¨æ¿€æ´»ç•Œé¢è°ƒå‡º<code>CMD</code>ç•Œé¢,è¾“å…¥å‘½ä»¤ï¼š</p>
<blockquote>
<p>è°ƒå‡ºCMDç•Œé¢çš„å¿«æ·é”®æ˜¯ï¼š<code>Shift+F10</code>æˆ–è€…æ˜¯<code>Fn+Shift+F10</code></p>
</blockquote>
<span id="more"></span>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">obbe\bypasssnro</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œä»¥åå›è½¦ï¼Œç­‰å¾…åŠ è½½å³å¯ï¼ï¼</p>
]]></content>
      <categories>
        <category>Windows 11 - è¿ç»´</category>
      </categories>
      <tags>
        <tag>Windows 11 - è¿ç»´</tag>
      </tags>
  </entry>
  <entry>
    <title>Mac è®¾ç½®å¼€æœºè‡ªåŠ¨ï¼ˆå…³é—­ï¼‰å¯åŠ¨MySQL</title>
    <url>/2023/04/25/Mac-%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%EF%BC%88%E5%85%B3%E9%97%AD%EF%BC%89%E5%90%AF%E5%8A%A8MySQL/</url>
    <content><![CDATA[<blockquote>
<p>æ³¨æ„ï¼šæœ¬æ¬¡è®¾å¤‡æ˜¯MacBookPro M1Proç‰ˆæœ¬</p>
</blockquote>
<p>æ‰“å¼€ç»ˆç«¯åº”ç”¨</p>
<p>å¦‚æœè¿‡å¯åŠ¨å…³é—­MySQLï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<span id="more"></span>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo launchctl <span class="built_in">disable</span> system/com.oracle.oss.mysql.mysqld</span><br></pre></td></tr></table></figure>

<p>ç³»ç»Ÿä¼šæç¤ºè¾“å…¥ç®¡ç†å‘˜å¯†ç ï¼Œè¾“å…¥å¯†ç åæŒ‰ä¸‹å›è½¦é”®ã€‚</p>
<p>æ‰§è¡Œå‘½ä»¤åï¼ŒMySQLå°†ä¼šåœæ­¢è¿è¡Œï¼Œä½ å¯ä»¥åœ¨ç»ˆç«¯ä¸­ç¡®è®¤MySQLå·²è¢«æˆåŠŸå…³é—­ã€‚</p>
<p>å¦‚æœæƒ³è¦å¯åŠ¨è‡ªåŠ¨å¼€æœºMySQLï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo launchctl <span class="built_in">enable</span> system/com.oracle.oss.mysql.mysqld</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å¯ä»¥å¯åŠ¨MySQLå¹¶å¼€å§‹è¿è¡Œ~</p>
]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>MySQL - Mac</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu SSHè¿æ¥MySQLæŠ¥é”™</title>
    <url>/2023/04/17/Ubuntu-SSH%E8%BF%9E%E6%8E%A5MySQL%E6%8A%A5%E9%94%99/</url>
    <content><![CDATA[<h3 id="æŠ¥é”™å†…å®¹ï¼š"><a href="#æŠ¥é”™å†…å®¹ï¼š" class="headerlink" title="æŠ¥é”™å†…å®¹ï¼š"></a>æŠ¥é”™å†…å®¹ï¼š</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[28000][1698] Access denied <span class="keyword">for</span> user <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;10.211.55.22&#x27;</span></span><br></pre></td></tr></table></figure>
<span id="more"></span>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/b1ec3ad37670b94ee13ae571d0dc9f7f.png" alt="v"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/e92246d9f5d9f15c20b70b597ccb6d2c.png" alt="e92246d9f5d9f15c20b70b597ccb6d2c"></p>
<h3 id="å¯¼è‡´é—®é¢˜å‡ºç°çš„åŸå› ï¼š"><a href="#å¯¼è‡´é—®é¢˜å‡ºç°çš„åŸå› ï¼š" class="headerlink" title="å¯¼è‡´é—®é¢˜å‡ºç°çš„åŸå› ï¼š"></a>å¯¼è‡´é—®é¢˜å‡ºç°çš„åŸå› ï¼š</h3><p>â€‹	åœ¨ MySQL 5.7.6 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œä¸ºäº†æé«˜å®‰å…¨æ€§ï¼ŒMySQL å°†é»˜è®¤ç¦æ­¢ <code>root</code> ç”¨æˆ·ä»è¿œç¨‹ä¸»æœºç™»å½•ã€‚å› æ­¤ï¼Œå¦‚æœä½ åœ¨å®‰è£… MySQL æ—¶é€‰æ‹©äº†é»˜è®¤é…ç½®ï¼Œåˆ™åœ¨è¿œç¨‹ä¸»æœºä¸Šä½¿ç”¨ <code>root</code> ç”¨æˆ·åå’Œå¯†ç è¿æ¥åˆ° MySQL æœåŠ¡å™¨æ—¶å°†ä¼šå¤±è´¥ã€‚</p>
<h3 id="è§£å†³æ–¹å¼ï¼š"><a href="#è§£å†³æ–¹å¼ï¼š" class="headerlink" title="è§£å†³æ–¹å¼ï¼š"></a>è§£å†³æ–¹å¼ï¼š</h3><p>â€‹	é¦–å…ˆä½ å¾—é˜²ç«å¢™è§„åˆ™è¦æ”¾é€šç«¯å£<code>3306</code>,å¦‚æœæ˜¯è™šæ‹Ÿæœºå†…ç½‘çš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç»™é˜²ç«å¢™å…³æ‰ã€‚</p>
<p>â€‹	ç„¶åå¯ä»¥ç›´æ¥æ–°æ·»åŠ ä¸€ä¸ªç”¨æˆ·ï¼Œç”¨æ¥ç®¡ç†MySQLã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE USER &#x27;username&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;password&#x27;; # username ä½ çš„ç”¨æˆ·å  password ä½ è¦è®¾ç½®çš„å¯†ç </span><br><span class="line"></span><br><span class="line">FLUSH PRIVILEGES; # åˆ·æ–°</span><br></pre></td></tr></table></figure>



<p>è¿™æ—¶å€™å†æ¬¡è¿æ¥å°±èƒ½è¿æ¥æˆåŠŸäº†~</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230417123523144.png" alt="image-20230417123523144"></p>
<p>Â </p>
]]></content>
      <categories>
        <category>Linux</category>
        <category>è¿ç»´</category>
        <category>Ubuntu</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>Macï¼ˆM1Proå®‰è£…Redisï¼‰</title>
    <url>/2023/04/13/Mac%EF%BC%88M1Pro%E5%AE%89%E8%A3%85Redis%EF%BC%89/</url>
    <content><![CDATA[<p>é‡‡ç”¨<code>homebrew</code>å®‰è£…Redisï¼Œå‰ææ˜¯Macå·²ç»å®‰è£…Redis</p>
<span id="more"></span>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~ brew install redis <span class="comment"># æ‰§è¡Œè¿™ä¸ªå‘½ä»¤æ¥å®‰è£…Redis</span></span><br><span class="line">Running `brew update --auto-update`...</span><br><span class="line">==&gt; Downloading https://formulae.brew.sh/api/formula.jws.json</span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################################## 100.0%</span></span><br><span class="line">==&gt; Fetching redis</span><br><span class="line">==&gt; Downloading https://mirrors.aliyun.com/homebrew/homebrew-bottles/redis-7.0.1</span><br><span class="line"><span class="comment">######################################################################## 100.0%</span></span><br><span class="line">==&gt; Pouring redis-7.0.10.arm64_monterey.bottle.tar.gz</span><br><span class="line">==&gt; Caveats</span><br><span class="line">To start redis now and restart at login:</span><br><span class="line">  brew services start redis</span><br><span class="line">==&gt; Summary</span><br><span class="line">ğŸº  /opt/homebrew/Cellar/redis/7.0.10: 14 files, 2.7MB</span><br><span class="line">==&gt; Running `brew cleanup redis`...</span><br><span class="line">Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.</span><br><span class="line">Hide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`).</span><br><span class="line">âœ  ~ brew services start redis</span><br><span class="line">==&gt; Downloading https://formulae.brew.sh/api/formula.jws.json</span><br><span class="line"><span class="comment">##O=#  #</span></span><br><span class="line">Warning: Calling formula.plist_path is deprecated! Use formula.launchd_service_path instead.</span><br><span class="line">Please report this issue to the homebrew/services tap (not Homebrew/brew or Homebrew/homebrew-core), or even better, submit a PR to fix it:</span><br><span class="line">  /opt/homebrew/Library/Taps/homebrew/homebrew-services/lib/service/formula_wrapper.rb:58</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  ~ redis-cli <span class="comment"># å¯åŠ¨redis</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name couture</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"><span class="string">&quot;couture&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; shutdown <span class="comment"># å…³é—­</span></span><br><span class="line">not connected&gt; quit  <span class="comment"># é€€å‡º</span></span><br></pre></td></tr></table></figure>



<p>åœ¨<code>homebrew</code>å®‰è£…çš„æ—¶å€™ä¹Ÿå‡ºç°ä¸€ä¸ªé—®é¢˜</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Warning: Calling formula.plist_path is deprecated! Use formula.launchd_service_path instead.</span><br><span class="line">Please report this issue to the homebrew/services tap (not Homebrew/brew or Homebrew/homebrew-core), or even better, submit a PR to fix it:</span><br><span class="line">  /opt/homebrew/Library/Taps/homebrew/homebrew-services/lib/service/formula_wrapper.rb:58</span><br></pre></td></tr></table></figure>

<p>éœ€è¦ä¿®å¤ä»€ä¹ˆä¸œè¥¿</p>
<p>ç„¶ååªéœ€è¦æ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  ~ <span class="built_in">unset</span> HOMEBREW_BOTTLE_DOMAIN</span><br></pre></td></tr></table></figure>

<p>é—®é¢˜è§£å†³~</p>
]]></content>
      <categories>
        <category>redis</category>
        <category>Mac</category>
        <category>Homebrew</category>
      </categories>
      <tags>
        <tag>redis</tag>
        <tag>Homebrew</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS 8 å­—ç¬¦é›†æŠ¥é”™è§£å†³æ–¹æ³•</title>
    <url>/2023/04/08/CentOS-8-%E5%AD%97%E7%AC%A6%E9%9B%86%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h5 id="é¦–å…ˆæ˜¯é”™è¯¯å¦‚ä¸‹ï¼š"><a href="#é¦–å…ˆæ˜¯é”™è¯¯å¦‚ä¸‹ï¼š" class="headerlink" title="é¦–å…ˆæ˜¯é”™è¯¯å¦‚ä¸‹ï¼š"></a>é¦–å…ˆæ˜¯é”™è¯¯å¦‚ä¸‹ï¼š</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@VM-4-3-centos ~]<span class="comment"># yum install -y yum-utils</span></span><br><span class="line">Failed to <span class="built_in">set</span> locale, defaulting to C.UTF-8     <span class="comment"># è¿™é‡Œæ˜¯å‡ºç°äº† UTF-8å­—ç¬¦é›†çš„é—®é¢˜</span></span><br><span class="line">Last metadata expiration check: 0:02:34 ago on Fri Apr  7 17:29:02 2023.</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<h5 id="è§£å†³æ–¹å¼ï¼š"><a href="#è§£å†³æ–¹å¼ï¼š" class="headerlink" title="è§£å†³æ–¹å¼ï¼š"></a>è§£å†³æ–¹å¼ï¼š</h5><p>æ‰§è¡Œä¸€ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export LC_ALL=en_US.UTF-8&quot;</span>  &gt;&gt;  /etc/profile</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export LC_CTYPE=en_US.UTF-8&quot;</span>  &gt;&gt;  /etc/profile</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<p>åœ¨å®‰è£…è½¯ä»¶ï¼Œä¸ä¼šæœ‰æŠ¥é”™æç¤ºï¼Œé—®é¢˜å¾—åˆ°äº†è§£å†³~</p>
]]></content>
      <categories>
        <category>è¿ç»´</category>
        <category>CentOS 8</category>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>CentOS 8</tag>
      </tags>
  </entry>
  <entry>
    <title>CentOS 8 å®‰è£…Docker</title>
    <url>/2023/04/08/CentOS-8-%E5%AE%89%E8%A3%85Docker/</url>
    <content><![CDATA[<h3 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h3><span id="more"></span>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@VM-4-3-centos ~]<span class="comment"># yum remove docker</span></span><br><span class="line">Failed to <span class="built_in">set</span> locale, defaulting to C.UTF-8</span><br><span class="line">No match <span class="keyword">for</span> argument: docker</span><br><span class="line">No packages marked <span class="keyword">for</span> removal.</span><br><span class="line">Dependencies resolved.</span><br><span class="line">Nothing to <span class="keyword">do</span>.</span><br><span class="line">Complete!</span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># yum remove docker *</span></span><br><span class="line">Failed to <span class="built_in">set</span> locale, defaulting to C.UTF-8</span><br><span class="line">No match <span class="keyword">for</span> argument: docker</span><br><span class="line">Error:</span><br><span class="line">Problem: The operation would result <span class="keyword">in</span> removing the following protected packages: dnf, kernel-core, setup, sudo, systemd, systemd-udev, yum</span><br><span class="line">(try to add <span class="string">&#x27;--skip-broken&#x27;</span> to skip uninstallable packages or <span class="string">&#x27;--nobest&#x27;</span> to use not only best candidate packages)</span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># yum install -y yum-utils</span></span><br><span class="line">Failed to <span class="built_in">set</span> locale, defaulting to C.UTF-8</span><br><span class="line">Last metadata expiration check: 0:02:34 ago on Fri Apr  7 17:29:02 2023.</span><br><span class="line">Dependencies resolved.</span><br><span class="line">================================================================================================</span><br><span class="line">Package                          Architecture   Version                Repository         Size</span><br><span class="line">================================================================================================</span><br><span class="line">Installing:</span><br><span class="line">yum-utils                        noarch         4.0.21-18.el8          baseos             75 k</span><br><span class="line">Upgrading:</span><br><span class="line">dnf                              noarch         4.7.0-15.el8           baseos            542 k</span><br><span class="line">dnf-data                         noarch         4.7.0-15.el8           baseos            156 k</span><br><span class="line">dnf-plugins-core                 noarch         4.0.21-18.el8          baseos             75 k</span><br><span class="line">libdnf                           x86_64         0.63.0-13.el8          baseos            704 k</span><br><span class="line">libsolv                          x86_64         0.7.20-4.el8           baseos            376 k</span><br><span class="line">python3-dnf                      noarch         4.7.0-15.el8           baseos            550 k</span><br><span class="line">python3-dnf-plugins-core         noarch         4.0.21-18.el8          baseos            258 k</span><br><span class="line">python3-hawkey                   x86_64         0.63.0-13.el8          baseos            117 k</span><br><span class="line">python3-libdnf                   x86_64         0.63.0-13.el8          baseos            779 k</span><br><span class="line">yum                              noarch         4.7.0-15.el8           baseos            208 k</span><br><span class="line">Installing dependencies:</span><br><span class="line">python3-systemd                  x86_64         234-8.el8              appstream          81 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">================================================================================================</span><br><span class="line">Install   2 Packages</span><br><span class="line">Upgrade  10 Packages</span><br><span class="line"></span><br><span class="line">Total download size: 3.8 M</span><br><span class="line">Downloading Packages:</span><br><span class="line">(1/12): python3-systemd-234-8.el8.x86_64.rpm                    2.9 MB/s |  81 kB     00:00</span><br><span class="line">(2/12): yum-utils-4.0.21-18.el8.noarch.rpm                      2.2 MB/s |  75 kB     00:00</span><br><span class="line">(3/12): dnf-plugins-core-4.0.21-18.el8.noarch.rpm               4.2 MB/s |  75 kB     00:00</span><br><span class="line">(4/12): dnf-4.7.0-15.el8.noarch.rpm                             8.0 MB/s | 542 kB     00:00</span><br><span class="line">(5/12): dnf-data-4.7.0-15.el8.noarch.rpm                        3.1 MB/s | 156 kB     00:00</span><br><span class="line">(6/12): libsolv-0.7.20-4.el8.x86_64.rpm                          10 MB/s | 376 kB     00:00</span><br><span class="line">(7/12): python3-dnf-plugins-core-4.0.21-18.el8.noarch.rpm       8.2 MB/s | 258 kB     00:00</span><br><span class="line">(8/12): libdnf-0.63.0-13.el8.x86_64.rpm                         6.5 MB/s | 704 kB     00:00</span><br><span class="line">(9/12): python3-hawkey-0.63.0-13.el8.x86_64.rpm                 3.2 MB/s | 117 kB     00:00</span><br><span class="line">(10/12): python3-dnf-4.7.0-15.el8.noarch.rpm                    4.7 MB/s | 550 kB     00:00</span><br><span class="line">(11/12): yum-4.7.0-15.el8.noarch.rpm                            5.4 MB/s | 208 kB     00:00</span><br><span class="line">(12/12): python3-libdnf-0.63.0-13.el8.x86_64.rpm                9.5 MB/s | 779 kB     00:00</span><br><span class="line">------------------------------------------------------------------------------------------------</span><br><span class="line">Total                                                            16 MB/s | 3.8 MB     00:00</span><br><span class="line">Running transaction check</span><br><span class="line">Transaction check succeeded.</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded.</span><br><span class="line">Running transaction</span><br><span class="line">Preparing        :                                                                        1/1</span><br><span class="line">Running scriptlet: libsolv-0.7.20-4.el8.x86_64                                            1/1</span><br><span class="line">Upgrading        : libsolv-0.7.20-4.el8.x86_64                                           1/22</span><br><span class="line">Upgrading        : libdnf-0.63.0-13.el8.x86_64                                           2/22</span><br><span class="line">Upgrading        : python3-libdnf-0.63.0-13.el8.x86_64                                   3/22</span><br><span class="line">Upgrading        : python3-hawkey-0.63.0-13.el8.x86_64                                   4/22</span><br><span class="line">Upgrading        : dnf-data-4.7.0-15.el8.noarch                                          5/22</span><br><span class="line">Upgrading        : python3-dnf-4.7.0-15.el8.noarch                                       6/22</span><br><span class="line">Upgrading        : dnf-4.7.0-15.el8.noarch                                               7/22</span><br><span class="line">Running scriptlet: dnf-4.7.0-15.el8.noarch                                               7/22</span><br><span class="line">Installing       : python3-systemd-234-8.el8.x86_64                                      8/22</span><br><span class="line">Upgrading        : python3-dnf-plugins-core-4.0.21-18.el8.noarch                         9/22</span><br><span class="line">Upgrading        : dnf-plugins-core-4.0.21-18.el8.noarch                                10/22</span><br><span class="line">Installing       : yum-utils-4.0.21-18.el8.noarch                                       11/22</span><br><span class="line">Upgrading        : yum-4.7.0-15.el8.noarch                                              12/22</span><br><span class="line">Cleanup          : yum-4.7.0-5.el8.noarch                                               13/22</span><br><span class="line">Running scriptlet: dnf-4.7.0-5.el8.noarch                                               14/22</span><br><span class="line">Cleanup          : dnf-4.7.0-5.el8.noarch                                               14/22</span><br><span class="line">Running scriptlet: dnf-4.7.0-5.el8.noarch                                               14/22</span><br><span class="line">Cleanup          : dnf-plugins-core-4.0.21-7.el8.noarch                                 15/22</span><br><span class="line">Cleanup          : python3-dnf-plugins-core-4.0.21-7.el8.noarch                         16/22</span><br><span class="line">Cleanup          : python3-dnf-4.7.0-5.el8.noarch                                       17/22</span><br><span class="line">Cleanup          : python3-hawkey-0.63.0-5.el8.x86_64                                   18/22</span><br><span class="line">Cleanup          : dnf-data-4.7.0-5.el8.noarch                                          19/22</span><br><span class="line">Cleanup          : python3-libdnf-0.63.0-5.el8.x86_64                                   20/22</span><br><span class="line">Cleanup          : libdnf-0.63.0-5.el8.x86_64                                           21/22</span><br><span class="line">Cleanup          : libsolv-0.7.20-1.el8.x86_64                                          22/22</span><br><span class="line">Running scriptlet: libsolv-0.7.20-1.el8.x86_64                                          22/22</span><br><span class="line">Verifying        : python3-systemd-234-8.el8.x86_64                                      1/22</span><br><span class="line">Verifying        : yum-utils-4.0.21-18.el8.noarch                                        2/22</span><br><span class="line">Verifying        : dnf-4.7.0-15.el8.noarch                                               3/22</span><br><span class="line">Verifying        : dnf-4.7.0-5.el8.noarch                                                4/22</span><br><span class="line">Verifying        : dnf-data-4.7.0-15.el8.noarch                                          5/22</span><br><span class="line">Verifying        : dnf-data-4.7.0-5.el8.noarch                                           6/22</span><br><span class="line">Verifying        : dnf-plugins-core-4.0.21-18.el8.noarch                                 7/22</span><br><span class="line">Verifying        : dnf-plugins-core-4.0.21-7.el8.noarch                                  8/22</span><br><span class="line">Verifying        : libdnf-0.63.0-13.el8.x86_64                                           9/22</span><br><span class="line">Verifying        : libdnf-0.63.0-5.el8.x86_64                                           10/22</span><br><span class="line">Verifying        : libsolv-0.7.20-4.el8.x86_64                                          11/22</span><br><span class="line">Verifying        : libsolv-0.7.20-1.el8.x86_64                                          12/22</span><br><span class="line">Verifying        : python3-dnf-4.7.0-15.el8.noarch                                      13/22</span><br><span class="line">Verifying        : python3-dnf-4.7.0-5.el8.noarch                                       14/22</span><br><span class="line">Verifying        : python3-dnf-plugins-core-4.0.21-18.el8.noarch                        15/22</span><br><span class="line">Verifying        : python3-dnf-plugins-core-4.0.21-7.el8.noarch                         16/22</span><br><span class="line">Verifying        : python3-hawkey-0.63.0-13.el8.x86_64                                  17/22</span><br><span class="line">Verifying        : python3-hawkey-0.63.0-5.el8.x86_64                                   18/22</span><br><span class="line">Verifying        : python3-libdnf-0.63.0-13.el8.x86_64                                  19/22</span><br><span class="line">Verifying        : python3-libdnf-0.63.0-5.el8.x86_64                                   20/22</span><br><span class="line">Verifying        : yum-4.7.0-15.el8.noarch                                              21/22</span><br><span class="line">Verifying        : yum-4.7.0-5.el8.noarch                                               22/22</span><br><span class="line"></span><br><span class="line">Upgraded:</span><br><span class="line">dnf-4.7.0-15.el8.noarch                             dnf-data-4.7.0-15.el8.noarch</span><br><span class="line">dnf-plugins-core-4.0.21-18.el8.noarch               libdnf-0.63.0-13.el8.x86_64</span><br><span class="line">libsolv-0.7.20-4.el8.x86_64                         python3-dnf-4.7.0-15.el8.noarch</span><br><span class="line">python3-dnf-plugins-core-4.0.21-18.el8.noarch       python3-hawkey-0.63.0-13.el8.x86_64</span><br><span class="line">python3-libdnf-0.63.0-13.el8.x86_64                 yum-4.7.0-15.el8.noarch</span><br><span class="line">Installed:</span><br><span class="line">python3-systemd-234-8.el8.x86_64                yum-utils-4.0.21-18.el8.noarch</span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line"></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># yum-config-manager \</span></span><br><span class="line">&gt; --add-repo \</span><br><span class="line">&gt; http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">Failed to <span class="built_in">set</span> locale, defaulting to C.UTF-8</span><br><span class="line">Adding repo from: http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># sudo yum install -y docker-ce docker-ce-cli containerd.io</span></span><br><span class="line">Failed to <span class="built_in">set</span> locale, defaulting to C.UTF-8</span><br><span class="line">Docker CE Stable - x86_64                                       153 kB/s |  40 kB     00:00</span><br><span class="line">Dependencies resolved.</span><br><span class="line">================================================================================================</span><br><span class="line">Package                 Arch   Version                                  Repository        Size</span><br><span class="line">================================================================================================</span><br><span class="line">Installing:</span><br><span class="line">containerd.io           x86_64 1.6.20-3.1.el8                           docker-ce-stable  34 M</span><br><span class="line">docker-ce               x86_64 3:23.0.3-1.el8                           docker-ce-stable  23 M</span><br><span class="line">docker-ce-cli           x86_64 1:23.0.3-1.el8                           docker-ce-stable 7.1 M</span><br><span class="line">Installing dependencies:</span><br><span class="line">checkpolicy             x86_64 2.9-1.el8                                baseos           348 k</span><br><span class="line">container-selinux       noarch 2:2.195.1-1.module_el8.8.0+1254+78119b6e appstream         63 k</span><br><span class="line">docker-ce-rootless-extras</span><br><span class="line">x86_64 23.0.3-1.el8                             docker-ce-stable 4.8 M</span><br><span class="line">fuse-common             x86_64 3.3.0-16.el8                             baseos            22 k</span><br><span class="line">fuse-overlayfs          x86_64 1.10-1.module_el8.8.0+1254+78119b6e      appstream         74 k</span><br><span class="line">fuse3                   x86_64 3.3.0-16.el8                             baseos            54 k</span><br><span class="line">fuse3-libs              x86_64 3.3.0-16.el8                             baseos            95 k</span><br><span class="line">libcgroup               x86_64 0.41-19.el8                              baseos            70 k</span><br><span class="line">libslirp                x86_64 4.4.0-1.module_el8.7.0+1216+b022c01d     appstream         70 k</span><br><span class="line">policycoreutils-python-utils</span><br><span class="line">noarch 2.9-17.el8                               baseos           252 k</span><br><span class="line">python3-audit           x86_64 3.0-0.17.20191104git1c2f876.el8          baseos            86 k</span><br><span class="line">python3-libsemanage     x86_64 2.9-6.el8                                baseos           127 k</span><br><span class="line">python3-policycoreutils noarch 2.9-17.el8                               baseos           2.2 M</span><br><span class="line">python3-setools         x86_64 4.3.0-3.el8                              baseos           624 k</span><br><span class="line">slirp4netns             x86_64 1.2.0-2.module_el8.7.0+1216+b022c01d     appstream         54 k</span><br><span class="line">Installing weak dependencies:</span><br><span class="line">docker-buildx-plugin    x86_64 0.10.4-1.el8                             docker-ce-stable  12 M</span><br><span class="line">docker-compose-plugin   x86_64 2.17.2-1.el8                             docker-ce-stable  12 M</span><br><span class="line">Enabling module streams:</span><br><span class="line">container-tools                rhel8</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">================================================================================================</span><br><span class="line">Install  20 Packages</span><br><span class="line"></span><br><span class="line">Total download size: 97 M</span><br><span class="line">Installed size: 367 M</span><br><span class="line">Downloading Packages:</span><br><span class="line">(1/20): container-selinux-2.195.1-1.module_el8.8.0+1254+78119b6 1.6 MB/s |  63 kB     00:00</span><br><span class="line">(2/20): fuse-overlayfs-1.10-1.module_el8.8.0+1254+78119b6e.x86_ 1.6 MB/s |  74 kB     00:00</span><br><span class="line">(3/20): libslirp-4.4.0-1.module_el8.7.0+1216+b022c01d.x86_64.rp 1.3 MB/s |  70 kB     00:00</span><br><span class="line">(4/20): slirp4netns-1.2.0-2.module_el8.7.0+1216+b022c01d.x86_64 2.6 MB/s |  54 kB     00:00</span><br><span class="line">(5/20): fuse-common-3.3.0-16.el8.x86_64.rpm                     1.6 MB/s |  22 kB     00:00</span><br><span class="line">(6/20): fuse3-3.3.0-16.el8.x86_64.rpm                           3.2 MB/s |  54 kB     00:00</span><br><span class="line">(7/20): fuse3-libs-3.3.0-16.el8.x86_64.rpm                      4.0 MB/s |  95 kB     00:00</span><br><span class="line">(8/20): libcgroup-0.41-19.el8.x86_64.rpm                        3.0 MB/s |  70 kB     00:00</span><br><span class="line">(9/20): checkpolicy-2.9-1.el8.x86_64.rpm                        4.3 MB/s | 348 kB     00:00</span><br><span class="line">(10/20): python3-audit-3.0-0.17.20191104git1c2f876.el8.x86_64.r 2.8 MB/s |  86 kB     00:00</span><br><span class="line">(11/20): policycoreutils-python-utils-2.9-17.el8.noarch.rpm     4.6 MB/s | 252 kB     00:00</span><br><span class="line">(12/20): python3-libsemanage-2.9-6.el8.x86_64.rpm               3.6 MB/s | 127 kB     00:00</span><br><span class="line">(13/20): python3-setools-4.3.0-3.el8.x86_64.rpm                 6.8 MB/s | 624 kB     00:00</span><br><span class="line">(14/20): python3-policycoreutils-2.9-17.el8.noarch.rpm          7.9 MB/s | 2.2 MB     00:00</span><br><span class="line">(15/20): docker-buildx-plugin-0.10.4-1.el8.x86_64.rpm           634 kB/s |  12 MB     00:19</span><br><span class="line">(16/20): docker-ce-cli-23.0.3-1.el8.x86_64.rpm                  623 kB/s | 7.1 MB     00:11</span><br><span class="line">(17/20): docker-ce-23.0.3-1.el8.x86_64.rpm                      661 kB/s |  23 MB     00:36</span><br><span class="line">(18/20): docker-ce-rootless-extras-23.0.3-1.el8.x86_64.rpm      676 kB/s | 4.8 MB     00:07</span><br><span class="line">(19/20): containerd.io-1.6.20-3.1.el8.x86_64.rpm                714 kB/s |  34 MB     00:48</span><br><span class="line">(20/20): docker-compose-plugin-2.17.2-1.el8.x86_64.rpm          761 kB/s |  12 MB     00:15</span><br><span class="line">------------------------------------------------------------------------------------------------</span><br><span class="line">Total                                                           1.9 MB/s |  97 MB     00:52</span><br><span class="line">Docker CE Stable - x86_64                                        18 kB/s | 1.6 kB     00:00</span><br><span class="line">Importing GPG key 0x621E9F35:</span><br><span class="line">Userid     : <span class="string">&quot;Docker Release (CE rpm) &lt;docker@docker.com&gt;&quot;</span></span><br><span class="line">Fingerprint: 060A 61C5 1B55 8A7F 742B 77AA C52F EB6B 621E 9F35</span><br><span class="line">From       : https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</span><br><span class="line">Key imported successfully</span><br><span class="line">Running transaction check</span><br><span class="line">Transaction check succeeded.</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded.</span><br><span class="line">Running transaction</span><br><span class="line">Preparing        :                                                                        1/1</span><br><span class="line">Installing       : docker-compose-plugin-2.17.2-1.el8.x86_64                             1/20</span><br><span class="line">Running scriptlet: docker-compose-plugin-2.17.2-1.el8.x86_64                             1/20</span><br><span class="line">Installing       : fuse3-libs-3.3.0-16.el8.x86_64                                        2/20</span><br><span class="line">Running scriptlet: fuse3-libs-3.3.0-16.el8.x86_64                                        2/20</span><br><span class="line">Installing       : docker-buildx-plugin-0.10.4-1.el8.x86_64                              3/20</span><br><span class="line">Running scriptlet: docker-buildx-plugin-0.10.4-1.el8.x86_64                              3/20</span><br><span class="line">Installing       : docker-ce-cli-1:23.0.3-1.el8.x86_64                                   4/20</span><br><span class="line">Running scriptlet: docker-ce-cli-1:23.0.3-1.el8.x86_64                                   4/20</span><br><span class="line">Installing       : python3-setools-4.3.0-3.el8.x86_64                                    5/20</span><br><span class="line">Installing       : python3-libsemanage-2.9-6.el8.x86_64                                  6/20</span><br><span class="line">Installing       : python3-audit-3.0-0.17.20191104git1c2f876.el8.x86_64                  7/20</span><br><span class="line">Running scriptlet: libcgroup-0.41-19.el8.x86_64                                          8/20</span><br><span class="line">Installing       : libcgroup-0.41-19.el8.x86_64                                          8/20</span><br><span class="line">Running scriptlet: libcgroup-0.41-19.el8.x86_64                                          8/20</span><br><span class="line">Installing       : fuse-common-3.3.0-16.el8.x86_64                                       9/20</span><br><span class="line">Installing       : fuse3-3.3.0-16.el8.x86_64                                            10/20</span><br><span class="line">Installing       : fuse-overlayfs-1.10-1.module_el8.8.0+1254+78119b6e.x86_64            11/20</span><br><span class="line">Running scriptlet: fuse-overlayfs-1.10-1.module_el8.8.0+1254+78119b6e.x86_64            11/20</span><br><span class="line">Installing       : checkpolicy-2.9-1.el8.x86_64                                         12/20</span><br><span class="line">Installing       : python3-policycoreutils-2.9-17.el8.noarch                            13/20</span><br><span class="line">Installing       : policycoreutils-python-utils-2.9-17.el8.noarch                       14/20</span><br><span class="line">Running scriptlet: container-selinux-2:2.195.1-1.module_el8.8.0+1254+78119b6e.noarch    15/20</span><br><span class="line">Installing       : container-selinux-2:2.195.1-1.module_el8.8.0+1254+78119b6e.noarch    15/20</span><br><span class="line">Running scriptlet: container-selinux-2:2.195.1-1.module_el8.8.0+1254+78119b6e.noarch    15/20</span><br><span class="line"></span><br><span class="line">Installing       : containerd.io-1.6.20-3.1.el8.x86_64                                  16/20</span><br><span class="line">Running scriptlet: containerd.io-1.6.20-3.1.el8.x86_64                                  16/20</span><br><span class="line">Installing       : libslirp-4.4.0-1.module_el8.7.0+1216+b022c01d.x86_64                 17/20</span><br><span class="line">Installing       : slirp4netns-1.2.0-2.module_el8.7.0+1216+b022c01d.x86_64              18/20</span><br><span class="line">Installing       : docker-ce-rootless-extras-23.0.3-1.el8.x86_64                        19/20</span><br><span class="line">Running scriptlet: docker-ce-rootless-extras-23.0.3-1.el8.x86_64                        19/20</span><br><span class="line">Installing       : docker-ce-3:23.0.3-1.el8.x86_64                                      20/20</span><br><span class="line">Running scriptlet: docker-ce-3:23.0.3-1.el8.x86_64                                      20/20</span><br><span class="line">Running scriptlet: container-selinux-2:2.195.1-1.module_el8.8.0+1254+78119b6e.noarch    20/20</span><br><span class="line">Running scriptlet: docker-ce-3:23.0.3-1.el8.x86_64                                      20/20</span><br><span class="line">Verifying        : container-selinux-2:2.195.1-1.module_el8.8.0+1254+78119b6e.noarch     1/20</span><br><span class="line">Verifying        : fuse-overlayfs-1.10-1.module_el8.8.0+1254+78119b6e.x86_64             2/20</span><br><span class="line">Verifying        : libslirp-4.4.0-1.module_el8.7.0+1216+b022c01d.x86_64                  3/20</span><br><span class="line">Verifying        : slirp4netns-1.2.0-2.module_el8.7.0+1216+b022c01d.x86_64               4/20</span><br><span class="line">Verifying        : checkpolicy-2.9-1.el8.x86_64                                          5/20</span><br><span class="line">Verifying        : fuse-common-3.3.0-16.el8.x86_64                                       6/20</span><br><span class="line">Verifying        : fuse3-3.3.0-16.el8.x86_64                                             7/20</span><br><span class="line">Verifying        : fuse3-libs-3.3.0-16.el8.x86_64                                        8/20</span><br><span class="line">Verifying        : libcgroup-0.41-19.el8.x86_64                                          9/20</span><br><span class="line">Verifying        : policycoreutils-python-utils-2.9-17.el8.noarch                       10/20</span><br><span class="line">Verifying        : python3-audit-3.0-0.17.20191104git1c2f876.el8.x86_64                 11/20</span><br><span class="line">Verifying        : python3-libsemanage-2.9-6.el8.x86_64                                 12/20</span><br><span class="line">Verifying        : python3-policycoreutils-2.9-17.el8.noarch                            13/20</span><br><span class="line">Verifying        : python3-setools-4.3.0-3.el8.x86_64                                   14/20</span><br><span class="line">Verifying        : containerd.io-1.6.20-3.1.el8.x86_64                                  15/20</span><br><span class="line">Verifying        : docker-buildx-plugin-0.10.4-1.el8.x86_64                             16/20</span><br><span class="line">Verifying        : docker-ce-3:23.0.3-1.el8.x86_64                                      17/20</span><br><span class="line">Verifying        : docker-ce-cli-1:23.0.3-1.el8.x86_64                                  18/20</span><br><span class="line">Verifying        : docker-ce-rootless-extras-23.0.3-1.el8.x86_64                        19/20</span><br><span class="line">Verifying        : docker-compose-plugin-2.17.2-1.el8.x86_64                            20/20</span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">checkpolicy-2.9-1.el8.x86_64</span><br><span class="line">container-selinux-2:2.195.1-1.module_el8.8.0+1254+78119b6e.noarch</span><br><span class="line">containerd.io-1.6.20-3.1.el8.x86_64</span><br><span class="line">docker-buildx-plugin-0.10.4-1.el8.x86_64</span><br><span class="line">docker-ce-3:23.0.3-1.el8.x86_64</span><br><span class="line">docker-ce-cli-1:23.0.3-1.el8.x86_64</span><br><span class="line">docker-ce-rootless-extras-23.0.3-1.el8.x86_64</span><br><span class="line">docker-compose-plugin-2.17.2-1.el8.x86_64</span><br><span class="line">fuse-common-3.3.0-16.el8.x86_64</span><br><span class="line">fuse-overlayfs-1.10-1.module_el8.8.0+1254+78119b6e.x86_64</span><br><span class="line">fuse3-3.3.0-16.el8.x86_64</span><br><span class="line">fuse3-libs-3.3.0-16.el8.x86_64</span><br><span class="line">libcgroup-0.41-19.el8.x86_64</span><br><span class="line">libslirp-4.4.0-1.module_el8.7.0+1216+b022c01d.x86_64</span><br><span class="line">policycoreutils-python-utils-2.9-17.el8.noarch</span><br><span class="line">python3-audit-3.0-0.17.20191104git1c2f876.el8.x86_64</span><br><span class="line">python3-libsemanage-2.9-6.el8.x86_64</span><br><span class="line">python3-policycoreutils-2.9-17.el8.noarch</span><br><span class="line">python3-setools-4.3.0-3.el8.x86_64</span><br><span class="line">slirp4netns-1.2.0-2.module_el8.7.0+1216+b022c01d.x86_64</span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment">#</span></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># systemctl enable docker --now</span></span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/docker.service â†’ /usr/lib/systemd/system/docker.service.</span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># echo &quot;export LC_ALL=en_US.UTF8&quot; &gt;&gt; /etc/profile</span></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># source /etc/profile</span></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY   TAG       IMAGE ID   CREATED   SIZE</span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># mkdir -p /etc/docker</span></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span></span><br><span class="line">&gt; &#123;</span><br><span class="line">&gt;   <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://82m9ar63.mirror.aliyuncs.com&quot;</span>],</span><br><span class="line">&gt;   <span class="string">&quot;exec-opts&quot;</span>: [<span class="string">&quot;native.cgroupdriver=systemd&quot;</span>],</span><br><span class="line">&gt;   <span class="string">&quot;log-driver&quot;</span>: <span class="string">&quot;json-file&quot;</span>,</span><br><span class="line">&gt;   <span class="string">&quot;log-opts&quot;</span>: &#123;</span><br><span class="line">&gt;     <span class="string">&quot;max-size&quot;</span>: <span class="string">&quot;100m&quot;</span></span><br><span class="line">&gt;   &#125;,</span><br><span class="line">&gt;   <span class="string">&quot;storage-driver&quot;</span>: <span class="string">&quot;overlay2&quot;</span></span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; EOF</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://82m9ar63.mirror.aliyuncs.com&quot;</span>],</span><br><span class="line"><span class="string">&quot;exec-opts&quot;</span>: [<span class="string">&quot;native.cgroupdriver=systemd&quot;</span>],</span><br><span class="line"><span class="string">&quot;log-driver&quot;</span>: <span class="string">&quot;json-file&quot;</span>,</span><br><span class="line"><span class="string">&quot;log-opts&quot;</span>: &#123;</span><br><span class="line"><span class="string">&quot;max-size&quot;</span>: <span class="string">&quot;100m&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">&quot;storage-driver&quot;</span>: <span class="string">&quot;overlay2&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># sudo systemctl daemon-reload</span></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># sudo systemctl restart docker</span></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment">#</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Docker</category>
        <category>DevOps</category>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Docker</tag>
        <tag>DevOps</tag>
      </tags>
  </entry>
  <entry>
    <title>é˜¿é‡Œäº‘Dockeré•œåƒåŠ é€Ÿ</title>
    <url>/2023/04/08/%E9%98%BF%E9%87%8C%E4%BA%91Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F/</url>
    <content><![CDATA[<h4 id="é˜¿é‡Œäº‘é•œåƒæº"><a href="#é˜¿é‡Œäº‘é•œåƒæº" class="headerlink" title="é˜¿é‡Œäº‘é•œåƒæº"></a>é˜¿é‡Œäº‘é•œåƒæº</h4><span id="more"></span>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@VM-4-3-centos ~]<span class="comment"># mkdir -p /etc/docker</span></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span></span><br><span class="line">&gt; &#123;</span><br><span class="line">&gt;   <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://82m9ar63.mirror.aliyuncs.com&quot;</span>],</span><br><span class="line">&gt;   <span class="string">&quot;exec-opts&quot;</span>: [<span class="string">&quot;native.cgroupdriver=systemd&quot;</span>],</span><br><span class="line">&gt;   <span class="string">&quot;log-driver&quot;</span>: <span class="string">&quot;json-file&quot;</span>,</span><br><span class="line">&gt;   <span class="string">&quot;log-opts&quot;</span>: &#123;</span><br><span class="line">&gt;     <span class="string">&quot;max-size&quot;</span>: <span class="string">&quot;100m&quot;</span></span><br><span class="line">&gt;   &#125;,</span><br><span class="line">&gt;   <span class="string">&quot;storage-driver&quot;</span>: <span class="string">&quot;overlay2&quot;</span></span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; EOF</span><br><span class="line">&lt;!--more--&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://82m9ar63.mirror.aliyuncs.com&quot;</span>],</span><br><span class="line">  <span class="string">&quot;exec-opts&quot;</span>: [<span class="string">&quot;native.cgroupdriver=systemd&quot;</span>],</span><br><span class="line">  <span class="string">&quot;log-driver&quot;</span>: <span class="string">&quot;json-file&quot;</span>,</span><br><span class="line">  <span class="string">&quot;log-opts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;max-size&quot;</span>: <span class="string">&quot;100m&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;storage-driver&quot;</span>: <span class="string">&quot;overlay2&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># sudo systemctl daemon-reload</span></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># sudo systemctl restart docker</span></span><br><span class="line">[root@VM-4-3-centos ~]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>docker</category>
        <category>è¿ç»´</category>
        <category>DevOps</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>è¿ç»´</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows10&amp;11å®˜æ–¹ç³»ç»Ÿç›˜åˆ¶ä½œæ•™ç¨‹</title>
    <url>/2023/04/03/Windows10-11%E5%AE%98%E6%96%B9%E7%B3%BB%E7%BB%9F%E7%9B%98%E5%88%B6%E4%BD%9C%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ¬¡åšç³»ç»Ÿç›˜ï¼Œé‡‡ç”¨å®˜æ–¹çš„æ–¹å¼åˆ¶ä½œï¼š</p>
<p>æ³¨æ„ï¼šUç›˜æœ€å°‘è¦<code>8G</code>åŠå…¶ä»¥ä¸Šçš„ç©ºUç›˜ï¼Œä¸ºäº†é¿å…å‡ºé”™ï¼Œåœ¨å¼€å±•ä¸€ä¸‹æ­¥éª¤ä¹‹å‰è¿˜æ˜¯å…ˆç»™Uç›˜æ•°æ®å¤‡ä»½å¥½ï¼Œç„¶åå¯¹Uç›˜è¿›è¡Œæ ¼å¼åŒ–</p>
</blockquote>
<span id="more"></span>
<h3 id="ç¬¬ä¸€æ­¥ï¼šå»å¾®è½¯é•œåƒå®˜æ–¹ä¸‹è½½ç½‘ç«™"><a href="#ç¬¬ä¸€æ­¥ï¼šå»å¾®è½¯é•œåƒå®˜æ–¹ä¸‹è½½ç½‘ç«™" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå»å¾®è½¯é•œåƒå®˜æ–¹ä¸‹è½½ç½‘ç«™"></a>ç¬¬ä¸€æ­¥ï¼šå»å¾®è½¯é•œåƒå®˜æ–¹ä¸‹è½½ç½‘ç«™</h3><h4 id="Window10é•œåƒ-https-www-microsoft-com-zh-cn-software-download-windows10"><a href="#Window10é•œåƒ-https-www-microsoft-com-zh-cn-software-download-windows10" class="headerlink" title="Window10é•œåƒ: https://www.microsoft.com/zh-cn/software-download/windows10/"></a><code>Window10</code>é•œåƒ: <a href="https://www.microsoft.com/zh-cn/software-download/windows10/">https://www.microsoft.com/zh-cn/software-download/windows10/</a></h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202304031022123.png" alt="image-20230403102222753"></p>
<h4 id="Window11é•œåƒ-https-www-microsoft-com-zh-cn-software-download-windows11"><a href="#Window11é•œåƒ-https-www-microsoft-com-zh-cn-software-download-windows11" class="headerlink" title="Window11é•œåƒ:https://www.microsoft.com/zh-cn/software-download/windows11/"></a><code>Window11é•œåƒ</code>:<a href="https://www.microsoft.com/zh-cn/software-download/windows11/">https://www.microsoft.com/zh-cn/software-download/windows11/</a></h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202304031022354.png" alt="image-20230403102242020"></p>
<h3 id="ç¬¬äºŒæ­¥ï¼šä»¥Windows10ä¸ºä¾‹ï¼Œå¼€å§‹åˆ¶ä½œç³»ç»Ÿç›˜ï¼Œä¸‹è½½åˆ¶ä½œå·¥å…·ï¼Œç‚¹å‡»ç«‹å³ä¸‹è½½å·¥å…·"><a href="#ç¬¬äºŒæ­¥ï¼šä»¥Windows10ä¸ºä¾‹ï¼Œå¼€å§‹åˆ¶ä½œç³»ç»Ÿç›˜ï¼Œä¸‹è½½åˆ¶ä½œå·¥å…·ï¼Œç‚¹å‡»ç«‹å³ä¸‹è½½å·¥å…·" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šä»¥Windows10ä¸ºä¾‹ï¼Œå¼€å§‹åˆ¶ä½œç³»ç»Ÿç›˜ï¼Œä¸‹è½½åˆ¶ä½œå·¥å…·ï¼Œç‚¹å‡»ç«‹å³ä¸‹è½½å·¥å…·"></a>ç¬¬äºŒæ­¥ï¼šä»¥<code>Windows10</code>ä¸ºä¾‹ï¼Œå¼€å§‹åˆ¶ä½œç³»ç»Ÿç›˜ï¼Œä¸‹è½½åˆ¶ä½œå·¥å…·ï¼Œç‚¹å‡»<code>ç«‹å³ä¸‹è½½å·¥å…·</code></h3><p>â€‹	<img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202304031025068.png" alt="image-20230403102511706"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202304031027631.png" alt="image-20230403102712343"></p>
<h3 id="ç¬¬ä¸‰æ­¥ï¼šä¸‹è½½å¥½ä»¥ååŒå‡»æ‰“å¼€è¿è¡Œï¼Œä¼šå‡ºç°ä¸‹å›¾ç•Œé¢"><a href="#ç¬¬ä¸‰æ­¥ï¼šä¸‹è½½å¥½ä»¥ååŒå‡»æ‰“å¼€è¿è¡Œï¼Œä¼šå‡ºç°ä¸‹å›¾ç•Œé¢" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šä¸‹è½½å¥½ä»¥ååŒå‡»æ‰“å¼€è¿è¡Œï¼Œä¼šå‡ºç°ä¸‹å›¾ç•Œé¢"></a>ç¬¬ä¸‰æ­¥ï¼šä¸‹è½½å¥½ä»¥ååŒå‡»æ‰“å¼€è¿è¡Œï¼Œä¼šå‡ºç°ä¸‹å›¾ç•Œé¢</h3><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202304031028052.png" alt="image-20230403102836981"></p>
<h4 id="ç¬¬å››æ­¥ï¼šé€‰æ‹©æ¥å—-gt-å†é€‰æ‹©ä¸ºå¦ä¸€å°ç”µè„‘åˆ›å»ºå®‰è£…ä»‹è´¨ï¼ˆUç›˜ã€DVDã€æˆ–ISOæ–‡ä»¶ï¼‰-gt-ä¸‹ä¸€æ­¥-gt-ä¸‹ä¸€æ­¥"><a href="#ç¬¬å››æ­¥ï¼šé€‰æ‹©æ¥å—-gt-å†é€‰æ‹©ä¸ºå¦ä¸€å°ç”µè„‘åˆ›å»ºå®‰è£…ä»‹è´¨ï¼ˆUç›˜ã€DVDã€æˆ–ISOæ–‡ä»¶ï¼‰-gt-ä¸‹ä¸€æ­¥-gt-ä¸‹ä¸€æ­¥" class="headerlink" title="ç¬¬å››æ­¥ï¼šé€‰æ‹©æ¥å—-&gt;å†é€‰æ‹©ä¸ºå¦ä¸€å°ç”µè„‘åˆ›å»ºå®‰è£…ä»‹è´¨ï¼ˆUç›˜ã€DVDã€æˆ–ISOæ–‡ä»¶ï¼‰-&gt;ä¸‹ä¸€æ­¥-&gt;ä¸‹ä¸€æ­¥"></a>ç¬¬å››æ­¥ï¼šé€‰æ‹©<code>æ¥å—</code>-&gt;å†é€‰æ‹©<code>ä¸ºå¦ä¸€å°ç”µè„‘åˆ›å»ºå®‰è£…ä»‹è´¨ï¼ˆUç›˜ã€DVDã€æˆ–ISOæ–‡ä»¶ï¼‰</code>-&gt;ä¸‹ä¸€æ­¥-&gt;ä¸‹ä¸€æ­¥</h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202304031029150.png" alt="image-20230403102942082"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202304031034181.png" alt="image-20230403103408109"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202304031034314.png" alt="image-20230403103447243"></p>
<h3 id="ç¬¬äº”æ­¥ï¼šé€‰æ‹©ä½ è¦å®‰è£…ç³»ç»Ÿçš„Uç›˜ï¼Œä¸‹ä¸€æ­¥ï¼Œç­‰å¾…Uç›˜å†™å…¥å®Œæˆ"><a href="#ç¬¬äº”æ­¥ï¼šé€‰æ‹©ä½ è¦å®‰è£…ç³»ç»Ÿçš„Uç›˜ï¼Œä¸‹ä¸€æ­¥ï¼Œç­‰å¾…Uç›˜å†™å…¥å®Œæˆ" class="headerlink" title="ç¬¬äº”æ­¥ï¼šé€‰æ‹©ä½ è¦å®‰è£…ç³»ç»Ÿçš„Uç›˜ï¼Œä¸‹ä¸€æ­¥ï¼Œç­‰å¾…Uç›˜å†™å…¥å®Œæˆ"></a>ç¬¬äº”æ­¥ï¼šé€‰æ‹©ä½ è¦å®‰è£…ç³»ç»Ÿçš„Uç›˜ï¼Œä¸‹ä¸€æ­¥ï¼Œç­‰å¾…Uç›˜å†™å…¥å®Œæˆ</h3><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202304031037842.png" alt="image-20230403103728772"></p>
<h3 id="ç¬¬å…­æ­¥ï¼šç­‰å¾…Uç›˜å†™å…¥ç™¾åˆ†ä¹‹ç™¾ï¼ŒæˆåŠŸä»¥åä¼šæœ‰æç¤ºï¼ŒUç›˜åˆ¶ä½œå®Œæˆ"><a href="#ç¬¬å…­æ­¥ï¼šç­‰å¾…Uç›˜å†™å…¥ç™¾åˆ†ä¹‹ç™¾ï¼ŒæˆåŠŸä»¥åä¼šæœ‰æç¤ºï¼ŒUç›˜åˆ¶ä½œå®Œæˆ" class="headerlink" title="ç¬¬å…­æ­¥ï¼šç­‰å¾…Uç›˜å†™å…¥ç™¾åˆ†ä¹‹ç™¾ï¼ŒæˆåŠŸä»¥åä¼šæœ‰æç¤ºï¼ŒUç›˜åˆ¶ä½œå®Œæˆ~"></a>ç¬¬å…­æ­¥ï¼šç­‰å¾…Uç›˜å†™å…¥ç™¾åˆ†ä¹‹ç™¾ï¼ŒæˆåŠŸä»¥åä¼šæœ‰æç¤ºï¼ŒUç›˜åˆ¶ä½œå®Œæˆ~</h3><blockquote>
<p>æ³¨æ„åœ¨Uç›˜å†™å…¥è¿‡ç¨‹ä¸­ï¼Œä¸è¦å¯¹Uç›˜è¿›è¡Œæ’æ‹”æˆ–è€…æ˜¯å¼¹å‡ºæ“ä½œï¼Œä¸ç„¶ä¼šå†™å…¥ä¸æˆåŠŸï¼Œä¸æˆåŠŸåˆ™éœ€è¦é‡æ–°æ“ä½œ</p>
<p>ä¸Šè¯‰è¿‡ç¨‹ä¸­æˆªå›¾çš„æ˜¯<code>Windows10</code>çš„åˆ¶ä½œè¿‡ç¨‹ï¼Œ<code>Windows11</code>ä¹Ÿæ˜¯ä¸€æ¨¡ä¸€æ ·ï¼Œæ²¡æœ‰å·®åˆ«</p>
</blockquote>
<p>ä»¥ä¸Šå°±æ˜¯<code>Windows10&amp;11</code>å®˜æ–¹ç³»ç»Ÿç›˜åˆ¶ä½œè¿‡ç¨‹ï¼Œå½“ç„¶ç³»ç»Ÿç›˜çš„åˆ¶ä½œä¸ä»…ä»…æ˜¯è¿™ä¸€ç§ï¼Œä½†æ˜¯è¿™ç§æ˜¯æœ€å‚»ç“œå¼çš„ï¼Œå¸Œæœ›å°ç™½ä¹Ÿéƒ½èƒ½çœ‹æ‡‚~</p>
]]></content>
      <categories>
        <category>Windows10</category>
        <category>ç³»ç»Ÿå®‰è£…</category>
      </categories>
      <tags>
        <tag>Windows 10</tag>
        <tag>Windows 11</tag>
      </tags>
  </entry>
  <entry>
    <title>Homebrewå®‰è£…æŠ¥é”™Error:Command failed with exit 128: git</title>
    <url>/2023/04/02/Homebrew%E5%AE%89%E8%A3%85%E6%8A%A5%E9%94%99Error-Command-failed-with-exit-128-git/</url>
    <content><![CDATA[<p>å®‰è£…å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">brew install telnet</span><br></pre></td></tr></table></figure>
<span id="more"></span>
<p>æ‰“å°æŠ¥é”™ä¿¡æ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">fatal: not in a git directory</span><br><span class="line"></span><br><span class="line">Error: Command failed with exit 128: git</span><br></pre></td></tr></table></figure>

<p>è§£å†³æ–¹å¼ï¼š</p>
<p>é¦–å…ˆæ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">unset HOMEBREW_BOTTLE_DOMAIN</span><br></pre></td></tr></table></figure>



<p>ç„¶åæ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git config --global --add safe.directory /opt/homebrew/Library/Taps/homebrew/homebrew-core</span><br><span class="line">git config --global --add safe.directory /opt/homebrew/Library/Taps/homebrew/homebrew-cask</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶æ‰§è¡Œè¿™ä¸ªä¸¤ä¸ªå‘½ä»¤æ˜¯ä¸åˆ†å‰åçš„ï¼Œéƒ½å¯ä»¥ï¼Œä½†æ˜¯éƒ½è¦æ‰§è¡Œï¼Œç„¶åå°±æ˜¯æˆåŠŸè§£å†³äº†æŠ¥é”™é—®é¢˜!</p>
]]></content>
      <categories>
        <category>macOS</category>
        <category>Homebrew</category>
      </categories>
      <tags>
        <tag>Mac</tag>
        <tag>homebrew</tag>
      </tags>
  </entry>
  <entry>
    <title>Windowsä¿®æ”¹å›ºå®šIPå’Œç½‘ç»œ</title>
    <url>/2023/04/01/Windows%E4%BF%AE%E6%94%B9%E5%9B%BA%E5%AE%9AIP%E5%92%8C%E7%BD%91%E7%BB%9C/</url>
    <content><![CDATA[<h2 id="ä¿®æ”¹å›ºå®šIP"><a href="#ä¿®æ”¹å›ºå®šIP" class="headerlink" title="ä¿®æ”¹å›ºå®šIP"></a>ä¿®æ”¹å›ºå®šIP</h2><p>â€‹	<strong>ä¿®æ”¹å’Œå›ºå®š<code>IP</code>ï¼Œå°±æ˜¯æŸ¥æ‰¾çš„IPçš„ç¬¬äºŒç§æ–¹å¼çš„åŸºç¡€ä¸Šè¿›è¡Œæ“ä½œ</strong></p>
<span id="more"></span>

<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401161930369.png" alt="image-20230401161930369"></p>
<p>â€‹	<strong>å¦‚ä¸Šå›¾çš„æ›´æ”¹é€‚é…å™¨ï¼Œè¿›è¡Œæ“ä½œï¼Œ<code>é€‰æ‹©ä»¥å¤ªç½‘</code>-&gt;<code>é¼ æ ‡å³é”®</code> -&gt;<code>ç‚¹å‡»å±æ€§</code></strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401162239432.png" alt="image-20230401162239432"></p>
<p>â€‹	<strong>åŒå‡»ä¸‹å›¾æ ‡æ³¨çš„<code>IPv4</code></strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401162323793-20230401163312323.png"></p>
<p>â€‹	<strong>åŒå‡»ä»¥åä¼šå‡ºç°ä¸‹é¢çš„è¿™ç§æƒ…å†µ</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401163413779.png" alt="image-20230401163413779"></p>
<p><strong>é€šå¸¸æƒ…å†µä¸‹éƒ½æ˜¯è‡ªåŠ¨è·å–<code>DHCP</code>ï¼ŒåŒå‡»ä»¥åä¹Ÿå°±æ˜¯ç©ºç™½çš„ï¼Œå¦‚æœä½ éœ€è¦å›ºå®šIPï¼Œéœ€è¦ç»™å¯¹åº”çš„<code>ip</code>ã€<code>å­ç½‘æ©ç </code>ã€<code>ç½‘å…³</code>å¡«å†™å³å¯ã€‚</strong></p>
<h2 id="é‡ç½®ç½‘ç»œ"><a href="#é‡ç½®ç½‘ç»œ" class="headerlink" title="é‡ç½®ç½‘ç»œ"></a>é‡ç½®ç½‘ç»œ</h2><blockquote>
<p>æ³¨ï¼šå†éå¿…è¦æƒ…å†µä¸‹æœ€å¥½ä¸è¦è¿›è¡Œç½‘ç»œé‡ç½®</p>
</blockquote>
<p><strong>æœç´¢<code>cmd</code>,ç„¶åå³é”®<code>ç®¡ç†å‘˜</code>è¿è¡Œ</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401164745531.png" alt="image-20230401164745531"></p>
<p><strong>æ‰“å¼€ä»¥åè¾“å…¥<code>netsh winsock reset</code>,ç„¶åè¿›è¡Œå›è½¦å³å¯ã€‚</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401165032282.png" alt="image-20230401165032282"></p>
<p><strong>å‡ºç°ä¸Šé¢è¿™ç§æƒ…å†µä¹Ÿå°±ä»£è¡¨ä½ çš„ç½‘ç»œé‡ç½®æˆåŠŸï¼Œè¿™æ—¶å€™ç”µè„‘éœ€è¦é‡å¯ï¼Œç„¶åå°†ç”µè„‘é‡å¯å³å¯ã€‚</strong></p>
]]></content>
      <categories>
        <category>IP</category>
        <category>Windows</category>
        <category>ç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>Windows</tag>
        <tag>IP</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>æŸ¥è¯¢Windows IP</title>
    <url>/2023/04/01/%E6%9F%A5%E8%AF%A2Windows-IP/</url>
    <content><![CDATA[<h2 id="æ–¹å¼ä¸€ï¼š"><a href="#æ–¹å¼ä¸€ï¼š" class="headerlink" title="æ–¹å¼ä¸€ï¼š"></a>æ–¹å¼ä¸€ï¼š</h2><h3 id="ä¸€ã€å¦‚ä½•çŸ¥é“æˆ‘ä»¬æœ¬æœºçš„IPåœ°å€"><a href="#ä¸€ã€å¦‚ä½•çŸ¥é“æˆ‘ä»¬æœ¬æœºçš„IPåœ°å€" class="headerlink" title="ä¸€ã€å¦‚ä½•çŸ¥é“æˆ‘ä»¬æœ¬æœºçš„IPåœ°å€"></a>ä¸€ã€å¦‚ä½•çŸ¥é“æˆ‘ä»¬æœ¬æœºçš„IPåœ°å€</h3><h4 id="ç¬¬ä¸€æ­¥ï¼šé¦–å…ˆç”µè„‘ä¸Šé¢çš„å¿«æ·é”®win-R"><a href="#ç¬¬ä¸€æ­¥ï¼šé¦–å…ˆç”µè„‘ä¸Šé¢çš„å¿«æ·é”®win-R" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šé¦–å…ˆç”µè„‘ä¸Šé¢çš„å¿«æ·é”®win + R"></a>ç¬¬ä¸€æ­¥ï¼š<strong>é¦–å…ˆç”µè„‘ä¸Šé¢çš„å¿«æ·é”®<code>win</code> + <code>R</code></strong></h4><span id="more"></span>

<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401155701051.png" alt="image-20230401155701051"></p>
<h4 id="ç¬¬äºŒæ­¥ï¼šç„¶ååœ¨æ‰“å¼€è¿™ä¸ªé€‰é¡¹ä¸­è¾“å…¥cmd-ç„¶åå›è½¦"><a href="#ç¬¬äºŒæ­¥ï¼šç„¶ååœ¨æ‰“å¼€è¿™ä¸ªé€‰é¡¹ä¸­è¾“å…¥cmd-ç„¶åå›è½¦" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šç„¶ååœ¨æ‰“å¼€è¿™ä¸ªé€‰é¡¹ä¸­è¾“å…¥cmd,ç„¶åå›è½¦"></a>ç¬¬äºŒæ­¥ï¼š<strong>ç„¶ååœ¨æ‰“å¼€è¿™ä¸ªé€‰é¡¹ä¸­è¾“å…¥<code>cmd</code>,ç„¶åå›è½¦</strong></h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401155900762.png" alt="image-20230401155900762"></p>
<h4 id="ç¬¬ä¸‰æ­¥ï¼šè¾“å…¥å‘½ä»¤ï¼šipconfig-ç„¶åè¿›è¡Œå›è½¦"><a href="#ç¬¬ä¸‰æ­¥ï¼šè¾“å…¥å‘½ä»¤ï¼šipconfig-ç„¶åè¿›è¡Œå›è½¦" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šè¾“å…¥å‘½ä»¤ï¼šipconfig,ç„¶åè¿›è¡Œå›è½¦"></a>ç¬¬ä¸‰æ­¥ï¼š<strong>è¾“å…¥å‘½ä»¤ï¼š<code>ipconfig</code>,ç„¶åè¿›è¡Œå›è½¦</strong></h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401160113210.png" alt="image-20230401160113210"></p>
<blockquote>
<p>æ³¨æ„è¿™æ—¶å€™æˆ‘æ ‡æ³¨å‡ºæ¥çš„IPv4çš„åœ°å€å°±æ˜¯ä¸€èˆ¬æ‰€éœ€è¦çš„åœ°å€</p>
</blockquote>
<h2 id="æ–¹å¼äºŒï¼š"><a href="#æ–¹å¼äºŒï¼š" class="headerlink" title="æ–¹å¼äºŒï¼š"></a>æ–¹å¼äºŒï¼š</h2><h4 id="ç¬¬ä¸€æ­¥ï¼šæœç´¢æ§åˆ¶é¢æ¿ï¼Œç„¶åè¿›è¡Œå›è½¦"><a href="#ç¬¬ä¸€æ­¥ï¼šæœç´¢æ§åˆ¶é¢æ¿ï¼Œç„¶åè¿›è¡Œå›è½¦" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šæœç´¢æ§åˆ¶é¢æ¿ï¼Œç„¶åè¿›è¡Œå›è½¦"></a>ç¬¬ä¸€æ­¥ï¼šæœç´¢æ§åˆ¶é¢æ¿ï¼Œç„¶åè¿›è¡Œå›è½¦</h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401160747545.png" alt="image-20230401160747545"></p>
<h4 id="ç¬¬äºŒæ­¥ï¼šé€‰æ‹©ç½‘ç»œå’ŒInternet"><a href="#ç¬¬äºŒæ­¥ï¼šé€‰æ‹©ç½‘ç»œå’ŒInternet" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šé€‰æ‹©ç½‘ç»œå’ŒInternet"></a>ç¬¬äºŒæ­¥ï¼šé€‰æ‹©<code>ç½‘ç»œå’ŒInternet</code></h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401160937333.png" alt="image-20230401160937333"></p>
<h4 id="ç¬¬ä¸‰æ­¥ï¼šç‚¹å‡»ç½‘ç»œå…±äº«ä¸­å¿ƒ"><a href="#ç¬¬ä¸‰æ­¥ï¼šç‚¹å‡»ç½‘ç»œå…±äº«ä¸­å¿ƒ" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šç‚¹å‡»ç½‘ç»œå…±äº«ä¸­å¿ƒ"></a>ç¬¬ä¸‰æ­¥ï¼šç‚¹å‡»ç½‘ç»œå…±äº«ä¸­å¿ƒ</h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401161048431.png" alt="image-20230401161048431"></p>
<p>â€‹	ç¬¬å››æ­¥ï¼šç‚¹å‡»<code>æ›´æ”¹é€‚é…å™¨</code>-&gt;<code>åŒå‡»ä»¥å¤ªç½‘</code>-&gt;ç‚¹å¼€<code>è¯¦ç»†ä¿¡æ¯</code>å°±å¯ä»¥çœ‹åˆ°IPåœ°å€</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/MacPicuture/image/image-20230401161421970.png" alt="image-20230401161421970"></p>
<blockquote>
<p>ä»¥ä¸Šå°±æ˜¯å¦‚ä½•æŸ¥çœ‹ç”µè„‘IPçš„æ–¹å¼ï¼Œå½“ç„¶æŸ¥çœ‹çš„IPçš„æ–¹å¼ä¸ä»…ä»…æ˜¯è¿™è¿™ä¸¤ç§ï¼Œä¹Ÿå¯ä»¥åœ¨è®¾ç½®ç½‘ç»œé‡Œé¢è¿›è¡Œç›´æ¥çš„æŸ¥çœ‹ï¼Œè¿˜æœ‰å…¶ä»–æ–¹å¼ç­‰ç­‰â€¦</p>
</blockquote>
]]></content>
      <categories>
        <category>è¿ç»´</category>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
        <tag>IP</tag>
      </tags>
  </entry>
  <entry>
    <title>Mac Consoleè¿æ¥äº¤æ¢æœº</title>
    <url>/2023/04/01/Mac-Console%E8%BF%9E%E6%8E%A5%E4%BA%A4%E6%8D%A2%E6%9C%BA/</url>
    <content><![CDATA[<h3 id="ä¸€ã€Macä½¿ç”¨consoleè¿æ¥äº¤æ¢æœº"><a href="#ä¸€ã€Macä½¿ç”¨consoleè¿æ¥äº¤æ¢æœº" class="headerlink" title="ä¸€ã€Macä½¿ç”¨consoleè¿æ¥äº¤æ¢æœº"></a>ä¸€ã€Macä½¿ç”¨consoleè¿æ¥äº¤æ¢æœº</h3><p>é¦–å…ˆä½¿ç”¨consoleçº¿å’ŒMacè¿æ¥ï¼Œè¿™æ—¶å€™éœ€è¦ç”¨åˆ°è½¬æ¢å™¨typeCè½¬USB-A</p>
<span id="more"></span>

<p>Macä¸Šé¢æŸ¥çœ‹æ˜¯å¦comå£çš„é©±åŠ¨å®‰è£…æˆåŠŸ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿™ä¸ªtty.usbserial-A9KXFHCDå°±æ˜¯æˆ‘ä»¬comå£çš„è®¾å¤‡</span></span><br><span class="line">$ <span class="built_in">ls</span> /dev/* |grep usb</span><br><span class="line">/dev/tty.usbserial-A9KXFHCD</span><br></pre></td></tr></table></figure>



<p>å®‰è£…minicomæ¥é€šè¿‡comè¿æ¥äº¤æ¢æœº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  ~ brew install minicom</span><br></pre></td></tr></table></figure>



<p>é…ç½®minicom</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥åˆ°é…ç½®</span></span><br><span class="line">$ minicom -s</span><br><span class="line">            +-----[configuration]------+</span><br><span class="line">            | Filenames and paths      |</span><br><span class="line">            | File transfer protocols  |</span><br><span class="line">            | Serial port setup        |			<span class="comment"># é€‰æ‹©æ­¤é¡¹å›è½¦</span></span><br><span class="line">            | Modem and dialing        |</span><br><span class="line">            | Screen and keyboard      |</span><br><span class="line">            | Save setup as dfl        |</span><br><span class="line">            | Save setup as..          |</span><br><span class="line">            | Exit                     |</span><br><span class="line">            | Exit from Minicom        |</span><br><span class="line">            +--------------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">+-----------------------------------------------------------------------+</span><br><span class="line">| A -    Serial Device      : /dev/tty.usbserial-A9KXFHCD               |	<span class="comment"># å°†æ­¤è®¾å¤‡åç§°æ”¹ä¸ºå‰é¢lsæŸ¥çœ‹åˆ°çš„è®¾å¤‡åç§°</span></span><br><span class="line">| B - Lockfile Location     : /opt/homebrew/Cellar/minicom/2.8/var      |</span><br><span class="line">| C -   Callin Program      :                                           |</span><br><span class="line">| D -  Callout Program      :                                           |</span><br><span class="line">| E -    Bps/Par/Bits       : 9600 8N1                                  |	<span class="comment"># å°†æ­¤é¡¹æ”¹ä¸º9600 8N1</span></span><br><span class="line">| F - Hardware Flow Control : No                                        |	<span class="comment"># å°†æ­¤é¡¹æ”¹ä¸ºNo</span></span><br><span class="line">| G - Software Flow Control : No                                        |</span><br><span class="line">| H -     RS485 Enable      : No                                        |</span><br><span class="line">| I -   RS485 Rts On Send   : No                                        |</span><br><span class="line">| J -  RS485 Rts After Send : No                                        |</span><br><span class="line">| K -  RS485 Rx During Tx   : No                                        |</span><br><span class="line">| L -  RS485 Terminate Bus  : No                                        |</span><br><span class="line">| M - RS485 Delay Rts Before: 0                                         |</span><br><span class="line">| N - RS485 Delay Rts After : 0                                         |</span><br><span class="line">|                                                                       |</span><br><span class="line">|    Change <span class="built_in">which</span> setting?                                              |</span><br><span class="line">+-----------------------------------------------------------------------+</span><br><span class="line"><span class="comment"># å›è½¦</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">+-----[configuration]------+</span><br><span class="line">| Filenames and paths      |</span><br><span class="line">| File transfer protocols  |</span><br><span class="line">| Serial port setup        |</span><br><span class="line">| Modem and dialing        |</span><br><span class="line">| Screen and keyboard      |</span><br><span class="line">| Save setup as dfl        |	<span class="comment"># é€‰æ‹©æ­¤é¡¹ä¿å­˜</span></span><br><span class="line">| Save setup as..          |</span><br><span class="line">| Exit                     |</span><br><span class="line">| Exit from Minicom        |</span><br><span class="line">+--------------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">+-----[configuration]------+</span><br><span class="line">| Filenames and paths      |</span><br><span class="line">| File transfer protocols  |</span><br><span class="line">| Serial port setup        |</span><br><span class="line">| Modem and dialing        |</span><br><span class="line">| Screen and keyboard      |</span><br><span class="line">| Save setup as dfl        |</span><br><span class="line">| Save setup as..          |</span><br><span class="line">| Exit                     |	<span class="comment"># é€‰æ‹©æ­¤é¡¹è¿›å…¥åˆ°ç»ˆç«¯</span></span><br><span class="line">| Exit from Minicom        |</span><br><span class="line">+--------------------------+</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥ç»ˆç«¯ä»¥åè¾“å…¥å¯†ç å³å¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ Login authentication</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Password:</span><br><span class="line">&lt;Quidway&gt;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒã€é…ç½®åä¸ºäº¤æ¢æœºwebè®¿é—®"><a href="#äºŒã€é…ç½®åä¸ºäº¤æ¢æœºwebè®¿é—®" class="headerlink" title="äºŒã€é…ç½®åä¸ºäº¤æ¢æœºwebè®¿é—®"></a>äºŒã€é…ç½®åä¸ºäº¤æ¢æœºwebè®¿é—®</h3><p>é…ç½®vlanifçš„ç®¡ç†iPï¼Œåœ¨è¿™é‡Œæˆ‘çš„æ‰€æœ‰ç®¡ç†iPéƒ½åœ¨vlan100çš„ç®¡ç†iP</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;Quidway&gt;system-view		(è¿›å…¥ç³»ç»Ÿè§†å›¾)</span><br><span class="line">[Quidway]int vlanif 100		ï¼ˆè¿›å…¥vlan100æ¥å£ï¼‰</span><br><span class="line">[Quidway-Vlanif100]ip add 192.168.99.200 24			ï¼ˆä¸ºvlan100é…ç½®ç®¡ç†ipï¼‰</span><br><span class="line">[Quidway-Vlanif100]q</span><br><span class="line">[Quidway]q</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹webç®¡ç†çš„æ–‡ä»¶åŒ…åœ°å€</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;Quidway&gt;sys    (è¿›å…¥ç³»ç»Ÿè§†å›¾)</span><br><span class="line">[Quidway]http server load web.7z   (åŠ è½½webåŒ…)</span><br><span class="line">[Quidway]http server <span class="built_in">enable</span>    (å¼€å¯httpæœåŠ¡)</span><br><span class="line">[Quidway]aaa    (è¿›å…¥aaaè§†å›¾)</span><br><span class="line">[Quidway-aaa]local-user admin password cipher Admin123  (é…ç½®ç®¡ç†è´¦å·ä¸å¯†ç )</span><br><span class="line">[Quidway-aaa]local-user admin privilege level 3   (é…ç½®ç®¡ç†è´¦å·çº§åˆ«)</span><br><span class="line">[Quidway-aaa]local-user admin service-type http   (é…ç½®æ¥å…¥ç±»å‹ä¸ºhttp)</span><br><span class="line">[Quidway-aaa]q   (é€€å‡º)</span><br><span class="line">[Quidway]q    (é€€å‡º)</span><br><span class="line">&lt;Quidway&gt;save    (ä¿å­˜)</span><br><span class="line">Y   (ç¡®è®¤)</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤å°±é…ç½®å®Œæˆäº†ï¼Œä½¿ç”¨æµè§ˆå™¨æ‰“å¼€é…ç½®çš„ç®¡ç†vlanipï¼Œå³å¯è®¿é—®åˆ°äº¤æ¢æœºçš„ç®¡ç†webé¡µé¢ã€‚</p>
<h3 id="ä¸‰ã€äº¤æ¢æœºå¸¸ç”¨vlané…ç½®ï¼Œ"><a href="#ä¸‰ã€äº¤æ¢æœºå¸¸ç”¨vlané…ç½®ï¼Œ" class="headerlink" title="ä¸‰ã€äº¤æ¢æœºå¸¸ç”¨vlané…ç½®ï¼Œ"></a>ä¸‰ã€äº¤æ¢æœºå¸¸ç”¨vlané…ç½®ï¼Œ</h3><p>vlané…ç½®ç›¸å…³</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹äº¤æ¢æœºvlané…ç½®ä¿¡æ¯</span></span><br><span class="line">[Quidway]display vlan</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºvlan100</span></span><br><span class="line">[Quidway]vlan 100</span><br><span class="line">[Quidway-vlan100]q</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†0/0/21ç«¯å£ä»åŸæœ‰vlanä¸­ç§»é™¤</span></span><br><span class="line">[Quidway]int GigabitEthernet 0/0/21</span><br><span class="line">[Quidway-GigabitEthernet0/0/21]undo port default vlan</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºç«¯å£ç»„ï¼Œä»¥åŠæ·»åŠ ç«¯å£ç»„</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç«¯å£ç»„ä¸­çš„æˆå‘˜</span></span><br><span class="line">[Quidway-port-group-200]display this</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç«¯å£ç»„</span></span><br><span class="line">[Quidway]port-group 100			<span class="comment"># åˆ›å»ºç«¯å£ç»„100ï¼Œ100ä¸ºç«¯å£ç»„åç§°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ç«¯å£æ·»åŠ åˆ°ç«¯å£ç»„,å°†g0/0/1-g0/0/15æ·»åŠ åˆ°ç«¯å£ç»„100</span></span><br><span class="line">[Quidway-port-group-100]group-member GigabitEthernet 0/0/1 to GigabitEthernet 0/0/15</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®ç«¯å£ç»„ä¸­çš„ç«¯å£è®¿é—®æ¨¡å¼</span></span><br><span class="line">[Quidway-port-group-100]port link-type access		<span class="comment"># (è¿™é‡Œè®¾ç½®ä¸ºaccessæ¨¡å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯trunkæ¨¡å¼çš„)ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ç«¯å£ç»„åŠ å…¥åˆ°vlan</span></span><br><span class="line">[Quidway-port-group-100]port default vlan 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†22å’Œ21ç«¯å£ä»ç«¯å£ç»„200ä¸­ç§»é™¤</span></span><br><span class="line">[Quidway]port-group 200</span><br><span class="line">[Quidway-port-group-200]undo  group-member GigabitEthernet 0/0/22 GigabitEthernet 0/0/21</span><br></pre></td></tr></table></figure>

<h3 id="å››ã€å¸¸ç”¨è·¯ç”±é…ç½®"><a href="#å››ã€å¸¸ç”¨è·¯ç”±é…ç½®" class="headerlink" title="å››ã€å¸¸ç”¨è·¯ç”±é…ç½®"></a>å››ã€å¸¸ç”¨è·¯ç”±é…ç½®</h3><p>å¸¸ç”¨é…ç½®å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">å¸¸ç”¨é…ç½®å‘½ä»¤ï¼š</span><br><span class="line">1.è¿›å…¥è§†å›¾æ¨¡å¼</span><br><span class="line">	&lt;Huawei&gt;sys</span><br><span class="line">2.è¿›å…¥æ¥å£</span><br><span class="line">	[Huawei]int g0/0/1				<span class="comment">#è¿›å…¥æŒ‡å®šæ¥å£</span></span><br><span class="line">	[Huawei]user-interface console 0			<span class="comment">#è¿›å…¥consoleå£</span></span><br><span class="line">	[Huawei-ui-console0]authentication-mode password	<span class="comment">#é…ç½®consoleå£å¯†ç éªŒè¯</span></span><br><span class="line">3.æŸ¥çœ‹æŒ‡å®šæ¥å£ä¿¡æ¯åŒ…æ‹¬ipåœ°å€</span><br><span class="line">	[Huawei-GigabitEthernet0/0/1]display ip interface g0/0/1</span><br><span class="line">4.ä¸ºæŒ‡å®šæ¥å£é…ç½®ipåœ°å€</span><br><span class="line">	[Huawei-GigabitEthernet0/0/1]ip add 192.168.1.111 24		<span class="comment">#é…ip</span></span><br><span class="line">	[Huawei-GigabitEthernet0/0/1]undo ip add 192.168.1.111 24	<span class="comment">#åˆ é™¤é…ç½®çš„ip</span></span><br><span class="line">5.æŸ¥çœ‹è·¯ç”±å™¨ipé…ç½®è¡¨</span><br><span class="line">	[Huawei]display current-configuration			<span class="comment">#æŸ¥çœ‹ip</span></span><br><span class="line">	[Huawei]display  ip routing-table			<span class="comment">#æŸ¥çœ‹è·¯ç”±è¡¨</span></span><br><span class="line">	[Huawei]display  nat  session  all			<span class="comment">#æŸ¥çœ‹natåœ°å€è½¬æ¢è¡¨</span></span><br></pre></td></tr></table></figure>



<p>naté…ç½®å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é™æ€natï¼šåœ¨å…¬ç½‘å…¥ç«™æ¥å£é…ç½®</span></span><br><span class="line">	[Huawei]interface  g0/0/0</span><br><span class="line">	[Huawei-GigabitEthernet0/0/0]nat server global 39.105.70.100 inside 192.168.1.254	<span class="comment">#å°†70.100é™æ€natåˆ°1.254</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ¨æ€patï¼š</span></span><br><span class="line">	[Huawei]acl number 2000				<span class="comment">#ä½¿ç”¨aclåŒ¹é…æ‰€æœ‰ipæµé‡</span></span><br><span class="line">	[Huawei-acl-basic-2000]rule  1 permit</span><br><span class="line">	[Huawei]interface  g0/0/0</span><br><span class="line">	[Huawei-GigabitEthernet0/0/0]nat outbound  2000	<span class="comment">#åœ¨å‡ºæ¥å£åº”ç”¨è¿™ä¸ªPATè§„åˆ™</span></span><br></pre></td></tr></table></figure>



<p>å¼€å¯telneté…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·¯ç”±å™¨å¼€å¯telneté…ç½®ï¼š</span></span><br><span class="line">user-interface maximum-vty 15</span><br><span class="line">user-interface vty 0 4</span><br><span class="line">authentication-mode aaa         		<span class="comment"># é…ç½®è®¤è¯æ¨¡å¼ä¸ºaaa</span></span><br><span class="line">q</span><br><span class="line">aaa                                			  <span class="comment"># è¿›å…¥aaaè§†å›¾</span></span><br><span class="line">local-user admin password cipher huawei    <span class="comment"># é…ç½®ç”¨æˆ·åä¸ºadminï¼Œå¯†ç ä¸ºhuawei</span></span><br><span class="line">local-user admin privilege level 3               <span class="comment"># è®¾ç½®ç”¨æˆ·æƒé™ä¸º3</span></span><br><span class="line">local-user admin service-type telnet  ssh     <span class="comment">#  å®šä¹‰ç”¨æˆ·æ¥å…¥ç±»å‹ä¸ºtelnet</span></span><br><span class="line">dis this                                   		  <span class="comment">#æŸ¥çœ‹é…ç½®</span></span><br></pre></td></tr></table></figure>

































]]></content>
      <categories>
        <category>Switch</category>
        <category>è¿ç»´</category>
      </categories>
      <tags>
        <tag>Mac</tag>
        <tag>Switch</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–°è£…çš„Windows10,11ç³»ç»Ÿå’ŒOfficeæ¿€æ´»æ•™ç¨‹</title>
    <url>/2023/03/29/%E6%96%B0%E8%A3%85%E7%9A%84Windows10-11-%E7%B3%BB%E7%BB%9F%E5%92%8COffice-2016%E6%BF%80%E6%B4%BB%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<h3 id="ç¬¬ä¸€æ­¥ï¼š"><a href="#ç¬¬ä¸€æ­¥ï¼š" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼š"></a>ç¬¬ä¸€æ­¥ï¼š</h3><p>é¦–å…ˆæˆ‘ä»¬è¦å‡†å¤‡å¥½æ¿€æ´»è½¯ä»¶ï¼Œ<code>HEU_KMS_Activator</code>è¿™ä¸ªè½¯ä»¶çš„ä¸‹è½½åœ°å€å¦‚ä¸‹ï¼š<a href="https://github.com/zbezj/HEU_KMS_Activator/releases/tag/26.1.0">https://github.com/zbezj/HEU_KMS_Activator/releases/tag/26.1.0</a></p>
<span id="more"></span>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071525532.png" alt="image-20221102093603191"><br>æ ‡å¿—çš„å‹ç¼©åŒ…å°±æ˜¯è¦ä¸‹è½½çš„è½¯ä»¶ï¼Œè§£å‹å³å¯ç”¨ï¼Œè§£å‹å¯†ç ä¹Ÿåœ¨å›¾ä¸­æœ‰å±•ç¤ºã€‚</p>
<h3 id="ç¬¬äºŒæ­¥ï¼š"><a href="#ç¬¬äºŒæ­¥ï¼š" class="headerlink" title="ç¬¬äºŒæ­¥ï¼š"></a>ç¬¬äºŒæ­¥ï¼š</h3><p>ä¸‹è½½å¹¶è§£å‹è¿™ä¸ªè½¯ä»¶ï¼š</p>
<p>åŒå‡»è¿è¡Œæ­¤è½¯ä»¶ï¼</p>
<h3 id="ç¬¬ä¸‰æ­¥ï¼š"><a href="#ç¬¬ä¸‰æ­¥ï¼š" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼š"></a>ç¬¬ä¸‰æ­¥ï¼š</h3><p>æ‰“å¼€è¿™ä¸ªè½¯ä»¶ï¼Œå¯¹ç”µè„‘ç³»ç»Ÿå’Œofficeè¿›è¡Œæ¿€æ´»å³å¯</p>
<p>è¿è¡Œä¸Šé¢çš„ <code>HEU_KMS_Activator_v26.0.0.exe</code>å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071525536.png" alt="image-20221102094027301"></p>
<p>ç„¶åå°±æ˜¯ç‚¹å‡»å¼€å§‹å°±è¡Œäº†ï¼Œè€å¿ƒç­‰å¾…è¿›åº¦æ¡èµ°å®Œï¼Œæ¿€æ´»å®Œæˆå³å¯ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071525986.png" alt="image-20221102094233468"></p>
<h3 id="æœ€åï¼š"><a href="#æœ€åï¼š" class="headerlink" title="æœ€åï¼š"></a>æœ€åï¼š</h3><p>ç­‰ç™¾åˆ†ä¹‹ç™¾çš„æ—¶å€™ä¼šæœ‰å¼¹çª—å‡ºæ¥ï¼Œå³æ¿€æ´»å®Œæ¯•ã€‚</p>
]]></content>
      <categories>
        <category>Windowsæ•™ç¨‹ è¿ç»´</category>
      </categories>
      <tags>
        <tag>Windows10&amp;Windows11</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºç½‘ç»œæ‰“å°æœºæ•™ç¨‹ï¼ˆäºŒï¼‰</title>
    <url>/2023/03/29/%E5%85%B3%E4%BA%8E%E7%BD%91%E7%BB%9C%E6%89%93%E5%8D%B0%E6%9C%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ¬¡æ•™ç¨‹ä¸»è¦æ˜¯é’ˆå¯¹äº<code>Windows11</code>æ‰“å°æœºè¿æ¥ï¼Œä»¥åŠæ‰«æä»ªçš„ç›¸å…³é—®é¢˜è§£ç­”</p>
</blockquote>
<p>åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç½‘ç»œæ‰“å°æœºå¸¦æ‰«æä»ªåŠŸèƒ½ï¼Œå¯¹äº<code>Windows7</code>å’Œ<code>Windows10</code>æ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œç›´æ¥å»å¯¹åº”çš„å®˜ç½‘å’Œå¯¹åº”çš„æ‰“å°æœºé©±åŠ¨ç½‘ç«™ç›´æ¥ä¸‹è½½å¯¹åº”çš„é©±åŠ¨å³å¯ï¼Œä½†æ˜¯<code>Windows11</code>æœ‰ç‚¹ä¸å¤ªä¸€æ ·ã€‚</p>
<span id="more"></span>
<p>é¦–å…ˆå°±æ˜¯<code>Windows11</code>æ€ä¹ˆæ·»åŠ æ‰“å°æœºï¼Œ<code>è®¾ç½®</code>-&gt;<code>è“ç‰™å’Œå…¶ä»–è®¾å¤‡</code>-&gt;<code>æ‰“å°æœºå’Œæ‰«æä»ª</code>-&gt;<code>æ·»åŠ è®¾å¤‡</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211250929234.png" alt="win1101"></p>
<p>å¦‚æœä½ æ˜¯å·²ç»è¿æ¥åˆ°äº†æ‰“å°æœºï¼Œè¿™æ—¶å€™å°±å¯ä»¥åˆ·æ–°æ£€æµ‹åˆ°äº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211250932931.png" alt="win1102"></p>
<p>å¦‚æœæ‰‹æ²¡æœ‰æ£€æµ‹åˆ°æ£€æŸ¥çº¿è·¯è¿æ¥çš„åŒæ—¶ï¼Œæ‰‹åŠ¨æ·»åŠ è®¾å¤‡ï¼Œæ‰‹åŠ¨æ·»åŠ è®¾å¤‡å¦‚æœä½ ä¸çŸ¥é“æµç¨‹ï¼Œå¯ä»¥å›çœ‹æˆ‘çš„æ•™ç¨‹ï¼ˆä¸€ï¼‰ï¼ŒæŒ‰ç…§æµç¨‹èµ°å®Œï¼Œæ£€æµ‹åˆ°é©±åŠ¨ä»¥åä¼šè‡ªåŠ¨å®‰è£…é©±åŠ¨ã€‚è‡ªæ­¤æ‰“å°æœºçš„é©±åŠ¨ç®—æ˜¯å®Œæˆäº†ã€‚</p>
<p>é‡ç‚¹æ˜¯æ‰«æä»ªï¼Œå¦‚æœæ‰“å°æœºå¸¦æ‰«æä»ªåŠŸèƒ½ï¼Œ<code>Windows10</code>æ“ä½œç³»ç»Ÿéœ€è¦ä½ å»å®˜ç½‘æˆ–è€…æ˜¯æ‰“å°æœºé©±åŠ¨ç½‘ä¸‹è½½é©±åŠ¨å®‰è£…ï¼Œ<code>Windows11</code>åˆ™æ˜¯è£…å®Œé©±åŠ¨ä»¥åï¼Œè‡ªåŠ¨æ‰«æï¼Œå¦‚æœæ£€æµ‹ä¸åˆ°æ‰«æä»ªï¼ŒåŸå› å¯èƒ½æ˜¯æ‰“å°æœºé©±åŠ¨é—®é¢˜ï¼Œè¿˜æœ‰å¯èƒ½å°±æ˜¯ç³»ç»Ÿé—®é¢˜ï¼Œå› ä¸ºè¿™ä¸ªä¸ç¡®å®šå› ç´ å¤ªå¤šï¼Œéœ€è¦é€ä¸€æ’æŸ¥ã€‚</p>
]]></content>
      <categories>
        <category>è¿ç»´</category>
        <category>æ‰“å°æœº</category>
      </categories>
      <tags>
        <tag>è¿ç»´</tag>
        <tag>æ‰“å°æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºç½‘ç»œæ‰“å°æœºæ•™ç¨‹ï¼ˆä¸€ï¼‰</title>
    <url>/2023/03/29/%E5%85%B3%E4%BA%8E%E7%BD%91%E7%BB%9C%E6%89%93%E5%8D%B0%E6%9C%BA%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<blockquote>
<p>æ³¨æ„ï¼šæœ¬æ•™ç¨‹åªé€‚åˆç½‘ç»œæ‰“å°æœºä¸”åŒä¸€å±€åŸŸç½‘æ‰“å°æœº</p>
</blockquote>
<h3 id="é¼ æ ‡å³é”®é€‰æ‹©ä¸ªæ€§åŒ–"><a href="#é¼ æ ‡å³é”®é€‰æ‹©ä¸ªæ€§åŒ–" class="headerlink" title="é¼ æ ‡å³é”®é€‰æ‹©ä¸ªæ€§åŒ–"></a>é¼ æ ‡å³é”®é€‰æ‹©<code>ä¸ªæ€§åŒ–</code></h3><span id="more"></span>
<h3 id="é¦–å…ˆé€‰æ‹©ä¸»é¡µï¼š"><a href="#é¦–å…ˆé€‰æ‹©ä¸»é¡µï¼š" class="headerlink" title="é¦–å…ˆé€‰æ‹©ä¸»é¡µï¼š"></a>é¦–å…ˆé€‰æ‹©<code>ä¸»é¡µ</code>ï¼š</h3><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211211929625.png" alt="image-20221121192919409"></p>
<h3 id="å…¶æ¬¡é€‰æ‹©è®¾å¤‡"><a href="#å…¶æ¬¡é€‰æ‹©è®¾å¤‡" class="headerlink" title="å…¶æ¬¡é€‰æ‹©è®¾å¤‡"></a>å…¶æ¬¡é€‰æ‹©<code>è®¾å¤‡</code></h3><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211211930726.png" alt="image-20221121193024629"></p>
<h3 id="å†é€‰æ‹©è®¾å¤‡ä¸æ‰“å°æœº"><a href="#å†é€‰æ‹©è®¾å¤‡ä¸æ‰“å°æœº" class="headerlink" title="å†é€‰æ‹©è®¾å¤‡ä¸æ‰“å°æœº"></a>å†é€‰æ‹©<code>è®¾å¤‡ä¸æ‰“å°æœº</code></h3><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211211933448.png" alt="image-20221121193302298"></p>
<h3 id="ç„¶åé€‰æ‹©æ·»åŠ æ‰“å°æœº"><a href="#ç„¶åé€‰æ‹©æ·»åŠ æ‰“å°æœº" class="headerlink" title="ç„¶åé€‰æ‹©æ·»åŠ æ‰“å°æœº"></a>ç„¶åé€‰æ‹©<code>æ·»åŠ æ‰“å°æœº</code></h3><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211211934010.png" alt="image-20221121193405923"></p>
<blockquote>
<p>æ³¨æ„é€‰æ‹©ä»¥åï¼Œè¿™æ—¶å€™ä¼šå‡ºç°è‡ªåŠ¨æœç´¢ç•Œé¢ï¼Œæœç´¢æ‰“å°æœºï¼Œå¦‚æœä½ æƒ³è¦è¿æ¥çš„æ‰“å°æœºæ²¡æœ‰åœ¨æœç´¢çš„åˆ—è¡¨ä¸­ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ‰‹åŠ¨æ·»åŠ ã€‚å¦‚æœæœ‰çš„è¯ï¼Œç›´æ¥é€‰ä¸­ä½ è¦è¿æ¥çš„æ‰“å°æœºä¸‹ä¸€æ­¥å³å¯ã€‚ç­‰å¾…é©±åŠ¨è‡ªåŠ¨å®‰è£…å®Œæˆå°±ç»“æŸäº†ã€‚</p>
<p>æœ‰çš„é©±åŠ¨window10ç³»ç»Ÿæ˜¯ä¸èƒ½è‡ªåŠ¨å®‰è£…é©±åŠ¨ï¼Œè¿™æ—¶å€™éœ€è¦æ‰‹åŠ¨ä¸‹è½½é©±åŠ¨ï¼Œåˆ°æ‰“å°æœºé©±åŠ¨ç½‘ç«™ä¸‹è½½é©±åŠ¨å°±è¡Œäº†ï¼Œç½‘å€ï¼š<a href="http://www.dyjqd.com/%EF%BC%8C%E8%87%AA%E8%A1%8C%E4%B8%8B%E8%BD%BD%E5%AF%B9%E5%BA%94%E7%9A%84%E6%89%93%E5%8D%B0%E6%9C%BA%E5%9E%8B%E5%8F%B7%E5%8D%B3%E5%8F%AF%EF%BC%8C%E8%A6%81%E6%B3%A8%E6%84%8F%E4%B8%8B%E8%BD%BD%E6%97%B6%E5%80%99%E9%80%89%E6%8B%A9%E5%AE%98%E7%BD%91%E4%B8%8B%E8%BD%BD%EF%BC%8C%E4%B8%8D%E8%A6%81%E4%B8%8B%E8%BD%BD%E9%94%99%E8%AF%AF%E3%80%82">http://www.dyjqd.com/ï¼Œè‡ªè¡Œä¸‹è½½å¯¹åº”çš„æ‰“å°æœºå‹å·å³å¯ï¼Œè¦æ³¨æ„ä¸‹è½½æ—¶å€™é€‰æ‹©å®˜ç½‘ä¸‹è½½ï¼Œä¸è¦ä¸‹è½½é”™è¯¯ã€‚</a></p>
</blockquote>
<h4 id="ä¸‹é¢æ˜¯ä»¥æƒ æ™®HP-LaserJet-M1005-MFPæ‰“å°æœºé©±åŠ¨ä¸ºä¾‹å­ï¼š"><a href="#ä¸‹é¢æ˜¯ä»¥æƒ æ™®HP-LaserJet-M1005-MFPæ‰“å°æœºé©±åŠ¨ä¸ºä¾‹å­ï¼š" class="headerlink" title="ä¸‹é¢æ˜¯ä»¥æƒ æ™®HP LaserJet M1005 MFPæ‰“å°æœºé©±åŠ¨ä¸ºä¾‹å­ï¼š"></a>ä¸‹é¢æ˜¯ä»¥<code>æƒ æ™®HP LaserJet M1005 MFP</code>æ‰“å°æœºé©±åŠ¨ä¸ºä¾‹å­ï¼š</h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211211940929.png" alt="image-20221121194013829"></p>
<p>ä¸‹è½½å®‰è£…å³å¯ã€‚</p>
<h4 id="å›åˆ°åˆšæ‰å¦‚æœä½ åœ¨æœç´¢æ¡†é‡Œé¢æ²¡æœ‰æ‰¾åˆ°ä½ çš„æ‰“å°æœºï¼Œè¿™æ—¶å€™åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ"><a href="#å›åˆ°åˆšæ‰å¦‚æœä½ åœ¨æœç´¢æ¡†é‡Œé¢æ²¡æœ‰æ‰¾åˆ°ä½ çš„æ‰“å°æœºï¼Œè¿™æ—¶å€™åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ" class="headerlink" title="å›åˆ°åˆšæ‰å¦‚æœä½ åœ¨æœç´¢æ¡†é‡Œé¢æ²¡æœ‰æ‰¾åˆ°ä½ çš„æ‰“å°æœºï¼Œè¿™æ—¶å€™åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ"></a>å›åˆ°åˆšæ‰å¦‚æœä½ åœ¨æœç´¢æ¡†é‡Œé¢æ²¡æœ‰æ‰¾åˆ°ä½ çš„æ‰“å°æœºï¼Œè¿™æ—¶å€™åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</h4><h4 id="æ‰‹åŠ¨æ·»åŠ IPï¼š"><a href="#æ‰‹åŠ¨æ·»åŠ IPï¼š" class="headerlink" title="æ‰‹åŠ¨æ·»åŠ IPï¼š"></a>æ‰‹åŠ¨æ·»åŠ IPï¼š</h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211211942117.png" alt="image-20221121194200062"></p>
<ul>
<li>é€‰æ‹©æˆ‘æ‰€éœ€è¦çš„æ‰“å°æœºæœªåˆ—å‡ºï¼Œç„¶åé€‰æ‹©<code>ä½¿ç”¨IPåœ°å€æˆ–ä¸»æœºåæ·»åŠ æ‰“å°æœº</code></li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211211942661.png" alt="image-20221121194254616"></p>
<ul>
<li>è¿™é‡Œé€‰æ‹©<code>è‡ªåŠ¨æ£€æµ‹</code>æˆ–<code>TCP/IP</code>éƒ½å¯ä»¥ï¼Œç„¶åè¾“å…¥ä½ æ‰“å°æœºçš„IPåœ°å€ï¼Œç„¶åä¸‹ä¸€æ­¥å³å¯ï¼ˆPS:ä¸‹å›¾ä¸­çš„IPåœ°å€åªæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæ ¹æ®è‡ªå·±æ‰“å°æœºçš„å®é™…æƒ…å†µè€Œå®šï¼‰</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211211946943.png" alt="image-20221121194633900"></p>
<ul>
<li>æœ€åä¸‹ä¸€æ­¥ï¼Œç„¶åå°±ç­‰ç€æœç´¢åˆ°æ‰“å°æœºï¼Œå®‰è£…é©±åŠ¨å³å¯ã€‚</li>
</ul>
<p>æœ€åæ³¨æ„ï¼Œè¿™ä¸ªæ•™ç¨‹åªé€‚åˆç½‘ç»œæ‰“å°æœºï¼Œå±€åŸŸç½‘çš„æƒ…å†µä¸‹ï¼Œæ ¡å›­ç½‘çš„å‰ææ˜¯IPç«¯å£æ²¡æœ‰é™åˆ¶ï¼Œåœ¨åŒä¸€ä¸ªè·¯ç”±å™¨ä¸‹æŒ‰ç†æ¥è¯´éƒ½å¯ä»¥ç”¨çš„ï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿåªæ˜¯é€‚åˆå°ç™½ï¼Œæˆ–è€…æ˜¯ä¸æ‡‚è®¡ç®—æœºçš„äººï¼Œå¦‚æœä½ åœ¨è¿æ¥æœ‰æ—¶å€™é‡åˆ°ä»€ä¹ˆé—®é¢˜å¯ä»¥è”ç³»æˆ‘<code>QQï¼š2842888712</code>ï¼Œå¦‚æœä½ æ˜¯ä¸€ä¸ªé«˜æ‰‹ï¼Œå¸Œæœ›ä½ å¯ä»¥æ‰¹è¯„æŒ‡æ­£ï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æ¥è¯´æœ‰äº›è®¸çš„å¸®åŠ©~</p>
]]></content>
      <categories>
        <category>è¿ç»´</category>
        <category>æ‰“å°æœº</category>
      </categories>
      <tags>
        <tag>è¿ç»´</tag>
        <tag>æ‰“å°æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx</title>
    <url>/2023/03/29/Nginx/</url>
    <content><![CDATA[<hr>
<p>[TOC]</p>
<h3 id="ä¸€ã€å¼•è¨€"><a href="#ä¸€ã€å¼•è¨€" class="headerlink" title="ä¸€ã€å¼•è¨€"></a>ä¸€ã€å¼•è¨€</h3><hr>
<h4 id="1-1-ä»£ç†é—®é¢˜"><a href="#1-1-ä»£ç†é—®é¢˜" class="headerlink" title="1.1 ä»£ç†é—®é¢˜"></a>1.1 ä»£ç†é—®é¢˜</h4><blockquote>
<p>å®¢æˆ·ç«¯åˆ°åº•è¦å°†è¯·æ±‚å‘é€ç»™å“ªå°æœåŠ¡å™¨ã€‚</p>
</blockquote>
<span id="more"></span>
<table>
<thead>
<tr>
<th align="center">å‘é€ç»™æœåŠ¡å™¨1è¿˜æ˜¯æœåŠ¡å™¨2</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071023267.png" alt="1589264952529"></td>
</tr>
</tbody></table>
<!--more-->
<h4 id="1-2-è´Ÿè½½å‡è¡¡é—®é¢˜"><a href="#1-2-è´Ÿè½½å‡è¡¡é—®é¢˜" class="headerlink" title="1.2 è´Ÿè½½å‡è¡¡é—®é¢˜"></a>1.2 è´Ÿè½½å‡è¡¡é—®é¢˜</h4><blockquote>
<p>å¦‚æœæ‰€æœ‰å®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½å‘é€ç»™äº†æœåŠ¡å™¨1ï¼Œé‚£ä¹ˆæœåŠ¡å™¨2å°†æ²¡æœ‰ä»»ä½•æ„ä¹‰</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">è´Ÿè½½å‡è¡¡é—®é¢˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071024949.png" alt="1589265005701"></td>
</tr>
</tbody></table>
<h4 id="1-3-èµ„æºä¼˜åŒ–"><a href="#1-3-èµ„æºä¼˜åŒ–" class="headerlink" title="1.3 èµ„æºä¼˜åŒ–"></a>1.3 èµ„æºä¼˜åŒ–</h4><blockquote>
<p>å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å¯èƒ½æ˜¯ç”³è¯·åŠ¨æ€èµ„æºçš„ï¼Œä¹Ÿæœ‰ç”³è¯·é™æ€èµ„æºï¼Œä½†æ˜¯éƒ½æ˜¯å»Tomcatä¸­è·å–çš„</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">é™æ€èµ„æºè®¿é—®</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071024993.png" alt="1589265063451"></td>
</tr>
</tbody></table>
<h4 id="1-4-Nginxå¤„ç†"><a href="#1-4-Nginxå¤„ç†" class="headerlink" title="1.4 Nginxå¤„ç†"></a>1.4 Nginxå¤„ç†</h4><table>
<thead>
<tr>
<th align="center">åœ¨æ­å»ºé›†ç¾¤åï¼Œä½¿ç”¨Nginx</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071024840.png" alt="1589265181473"></td>
</tr>
</tbody></table>
<h3 id="äºŒã€Nginxæ¦‚è¿°"><a href="#äºŒã€Nginxæ¦‚è¿°" class="headerlink" title="äºŒã€Nginxæ¦‚è¿°"></a>äºŒã€Nginxæ¦‚è¿°</h3><hr>
<blockquote>
<p>Nginxæ˜¯ç”±ä¿„ç½—æ–¯äººç ”å‘çš„ï¼Œåº”å¯¹Ramblerçš„ç½‘ç«™ï¼Œå¹¶ä¸”2004å¹´å‘å¸ƒçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ã€‚</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">Nginxä¹‹çˆ¶</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071024237.png" alt="1586502874584"></td>
</tr>
</tbody></table>
<blockquote>
<p>Nginxçš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>ç¨³å®šæ€§æå¼ºã€‚ 7*24å°æ—¶ä¸é—´æ–­è¿è¡Œã€‚</li>
<li>Nginxæä¾›äº†éå¸¸ä¸°å¯Œçš„é…ç½®å®ä¾‹ã€‚</li>
<li>å ç”¨å†…å­˜å°ï¼Œå¹¶å‘èƒ½åŠ›å¼ºã€‚</li>
</ul>
</blockquote>
<h3 id="ä¸‰ã€Nginxçš„å®‰è£…"><a href="#ä¸‰ã€Nginxçš„å®‰è£…" class="headerlink" title="ä¸‰ã€Nginxçš„å®‰è£…"></a>ä¸‰ã€Nginxçš„å®‰è£…</h3><hr>
<h4 id="3-1-å®‰è£…Nginx"><a href="#3-1-å®‰è£…Nginx" class="headerlink" title="3.1 å®‰è£…Nginx"></a>3.1 å®‰è£…Nginx</h4><blockquote>
<p>ä½¿ç”¨Docker-Composeå®‰è£…ï¼Œåˆ›å»ºdocker-compose.ymlå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.1&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">daocloud.io/library/nginx:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">80</span><span class="string">:80</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@192 ~]<span class="comment"># cd /opt</span></span><br><span class="line">[root@192 opt]<span class="comment"># mkdir docker_nginx</span></span><br><span class="line">[root@192 opt]<span class="comment"># cd docker_nginx/</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># vim docker-compose.yml</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># docker-compose up -d</span></span><br><span class="line">Creating network <span class="string">&quot;docker_nginx_default&quot;</span> with the default driver</span><br><span class="line">Pulling nginx (daocloud.io/library/nginx:latest)...</span><br><span class="line">latest: Pulling from library/nginx</span><br><span class="line">45b42c59be33: Pull complete</span><br><span class="line">d0d9e9ea897e: Pull complete</span><br><span class="line">66e650438339: Pull complete</span><br><span class="line">76a3dfe4406b: Pull complete</span><br><span class="line">410ff9d97480: Pull complete</span><br><span class="line">Digest: sha256:1a53eb723d17523512bd25c27299046cfa034cce309f4ed330c943a304513f59</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> daocloud.io/library/nginx:latest</span><br><span class="line">Creating nginx ... <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµè§ˆå™¨è®¿é—®å³å¯ï¼ˆ80ç«¯å£å¯ä»¥çœç•¥ä¸å†™ï¼Œäº‘æœåŠ¡å™¨è®°å¾—å»å¼€æ”¾80ç«¯å£ï¼‰</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071024665.png"></p>
<h4 id="3-2-Nginxçš„é…ç½®æ–‡ä»¶"><a href="#3-2-Nginxçš„é…ç½®æ–‡ä»¶" class="headerlink" title="3.2 Nginxçš„é…ç½®æ–‡ä»¶"></a>3.2 Nginxçš„é…ç½®æ–‡ä»¶</h4><blockquote>
<p>å…³äºNginxçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶nginx.conf</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@192 docker_nginx]<span class="comment"># docker ps</span></span><br><span class="line">CONTAINER ID   IMAGE                              COMMAND                  CREATED         STATUS         PORTS                               NAMES</span><br><span class="line">617da0b0dbbb   daocloud.io/library/nginx:latest   <span class="string">&quot;/docker-entrypoint.â€¦&quot;</span>   8 minutes ago   Up 8 minutes   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   nginx</span><br><span class="line">[root@192 docker_nginx]<span class="comment"># docker exec -it 617 bash</span></span><br><span class="line">root@617da0b0dbbb:/<span class="comment"># cd /etc/nginx</span></span><br><span class="line">root@617da0b0dbbb:/etc/nginx<span class="comment"># ls</span></span><br><span class="line">conf.d		koi-utf  mime.types  nginx.conf   uwsgi_params</span><br><span class="line">fastcgi_params	koi-win  modules     scgi_params  win-utf</span><br><span class="line">root@617da0b0dbbb:/etc/nginx<span class="comment"># cat nginx.conf </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŸ¥çœ‹nginx.conf é…ç½®æ–‡ä»¶</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">user  nginx;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">error_log  /var/log/nginx/error.log warn;</span><br><span class="line">pid        /var/run/nginx.pid;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è¯´æ˜</span></span><br><span class="line"><span class="comment"># ä»¥ä¸Šç»Ÿç§°ä¸ºå…¨å±€å—ï¼Œ </span></span><br><span class="line"><span class="comment"># worker_processesçš„æ•°å€¼è¶Šå¤§ï¼ŒNginxçš„å¹¶å‘èƒ½åŠ›å°±è¶Šå¼ºï¼ˆç”±è¿ç»´äººå‘˜ä¿®æ”¹ï¼‰</span></span><br><span class="line"><span class="comment"># error_log ä»£è¡¨Nginxçš„é”™è¯¯æ—¥å¿—å­˜æ”¾çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è¯´æ˜</span></span><br><span class="line"><span class="comment"># eventså—</span></span><br><span class="line"><span class="comment"># worker_connectionsçš„æ•°å€¼è¶Šå¤§ï¼ŒNginxçš„å¹¶å‘èƒ½åŠ›å°±è¶Šå¼ºï¼ˆç”±è¿ç»´äººå‘˜ä¿®æ”¹ï¼‰</span></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       /etc/nginx/mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    log_format  main  <span class="string">&#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    access_log  /var/log/nginx/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line"></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#gzip  on;</span></span><br><span class="line"></span><br><span class="line">    include /etc/nginx/conf.d/*.conf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è¯´æ˜</span></span><br><span class="line"><span class="comment"># httpå—</span></span><br><span class="line"><span class="comment"># includeä»£è¡¨å¼•å…¥ä¸€ä¸ªå¤–éƒ¨çš„æ–‡ä»¶ -&gt; /mime.typesä¸­æ”¾ç€å¤§é‡çš„åª’ä½“ç±»å‹</span></span><br><span class="line"><span class="comment"># include /etc/nginx/conf.d/*.conf; -&gt; å¼•å…¥äº†conf.dç›®å½•ä¸‹çš„ä»¥.confä¸ºç»“å°¾çš„é…ç½®æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>nginx.conf é…ç½®æ–‡ä»¶ä¸­å‘ç°ï¼Œæœ€åä¸€è¡Œå¼•å…¥äº†conf.dç›®å½•ä¸‹çš„*.confæ–‡ä»¶</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">root@617da0b0dbbb:/etc/nginx<span class="comment"># ls</span></span><br><span class="line">conf.d		koi-utf  mime.types  nginx.conf   uwsgi_params</span><br><span class="line">fastcgi_params	koi-win  modules     scgi_params  win-utf</span><br><span class="line">root@617da0b0dbbb:/etc/nginx<span class="comment"># cd conf.d/</span></span><br><span class="line">root@617da0b0dbbb:/etc/nginx/conf.d<span class="comment"># ls</span></span><br><span class="line">default.conf</span><br><span class="line">root@617da0b0dbbb:/etc/nginx/conf.d<span class="comment"># cat default.conf </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æŸ¥çœ‹default.conf é…ç½®æ–‡ä»¶</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å‚æ•°è¯´æ˜</span></span><br><span class="line"><span class="comment"># serverå—</span></span><br><span class="line"><span class="comment"># listenï¼š ä»£è¡¨Nginxç›‘å¬çš„ç«¯å£å·</span></span><br><span class="line"><span class="comment"># localhostï¼šä»£è¡¨Nginxæ¥æ”¶è¯·æ±‚çš„ip</span></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    listen  [::]:80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#charset koi8-r;</span></span><br><span class="line">    <span class="comment">#access_log  /var/log/nginx/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å‚æ•°è¯´æ˜</span></span><br><span class="line">    <span class="comment"># locationå—</span></span><br><span class="line">	<span class="comment"># rootï¼šå°†æ¥æ”¶åˆ°çš„è¯·æ±‚æ ¹æ®/usr/share/nginx/htmlå»æŸ¥æ‰¾é™æ€èµ„æº</span></span><br><span class="line">	<span class="comment"># indexï¼š é»˜è®¤å»ä¸Šè¿°çš„è·¯å¾„ä¸­æ‰¾åˆ°index.htmlæˆ–è€…index.htm</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    root           html;</span></span><br><span class="line">    <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">    <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">    <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">    <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">    <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">    <span class="comment">#    deny  all;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-3-é…ç½®æ•°æ®å·æ“ä½œNginx"><a href="#3-3-é…ç½®æ•°æ®å·æ“ä½œNginx" class="headerlink" title="3.3 é…ç½®æ•°æ®å·æ“ä½œNginx"></a>3.3 é…ç½®æ•°æ®å·æ“ä½œNginx</h4><blockquote>
<p>ä¸ºäº†æ–¹ä¾¿ä¿®æ”¹Nginxé…ç½®ï¼Œä¿®æ”¹docker-compose.ymlæ–‡ä»¶ï¼Œè®¾ç½® volumes ï¼Œé‡æ–°å¯åŠ¨</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.1&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">daocloud.io/library/nginx:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">80</span><span class="string">:80</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker_nginx/conf.d/:/etc/nginx/conf.d</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">root@617da0b0dbbb:/etc/nginx/conf.d<span class="comment"># exit </span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># vim docker-compose.yml </span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># docker-compose down</span></span><br><span class="line">Stopping nginx ... <span class="keyword">done</span></span><br><span class="line">Removing nginx ... <span class="keyword">done</span></span><br><span class="line">Removing network docker_nginx_default</span><br><span class="line">[root@192 docker_nginx]<span class="comment"># docker-compose up -d</span></span><br><span class="line">Creating network <span class="string">&quot;docker_nginx_default&quot;</span> with the default driver</span><br><span class="line">Creating nginx ... <span class="keyword">done</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># ls</span></span><br><span class="line">conf.d  docker-compose.yml</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ­¤æ—¶å†ä½¿ç”¨æµè§ˆå™¨è®¿é—®åˆ™æ— æ³•è®¿é—®nginx.htmlé¡µé¢äº†ï¼Œæ­¤æ—¶éœ€è¦åœ¨conf.dç›®å½•ä¸‹åˆ›å»ºdefault.confæ–‡ä»¶ï¼Œé…ç½®ä¸€ä¸ªserverï¼Œå†é‡æ–°å¯åŠ¨å³å¯</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    listen  [::]:80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@192 docker_nginx]<span class="comment"># cd conf.d/</span></span><br><span class="line">[root@192 conf.d]<span class="comment"># vim default.conf</span></span><br><span class="line">[root@192 conf.d]<span class="comment"># cd ..</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># docker-compose restart</span></span><br><span class="line">Restarting nginx ... <span class="keyword">done</span></span><br></pre></td></tr></table></figure>



<h3 id="å››ã€Nginxçš„åå‘ä»£ç†ã€é‡ç‚¹ã€‘"><a href="#å››ã€Nginxçš„åå‘ä»£ç†ã€é‡ç‚¹ã€‘" class="headerlink" title="å››ã€Nginxçš„åå‘ä»£ç†ã€é‡ç‚¹ã€‘"></a>å››ã€Nginxçš„åå‘ä»£ç†ã€<code>é‡ç‚¹</code>ã€‘</h3><hr>
<h4 id="4-1-æ­£å‘ä»£ç†å’Œåå‘ä»£ç†ä»‹ç»"><a href="#4-1-æ­£å‘ä»£ç†å’Œåå‘ä»£ç†ä»‹ç»" class="headerlink" title="4.1 æ­£å‘ä»£ç†å’Œåå‘ä»£ç†ä»‹ç»"></a>4.1 æ­£å‘ä»£ç†å’Œåå‘ä»£ç†ä»‹ç»</h4><blockquote>
<p>æ­£å‘ä»£ç†ï¼š</p>
<ul>
<li>æ­£å‘ä»£ç†æœåŠ¡æ˜¯ç”±å®¢æˆ·ç«¯è®¾ç«‹çš„ã€‚</li>
<li>å®¢æˆ·ç«¯äº†è§£ä»£ç†æœåŠ¡å™¨å’Œç›®æ ‡æœåŠ¡å™¨éƒ½æ˜¯è°ã€‚</li>
<li>å¸®åŠ©å’±ä»¬å®ç°çªç ´è®¿é—®æƒé™ï¼Œæé«˜è®¿é—®çš„é€Ÿåº¦ï¼Œå¯¹ç›®æ ‡æœåŠ¡å™¨éšè—å®¢æˆ·ç«¯çš„ipåœ°å€ã€‚</li>
</ul>
</blockquote>
<table>
<thead>
<tr>
<th align="center">æ­£å‘ä»£ç†</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071025691.png" alt="1586512751639"></td>
</tr>
</tbody></table>
<blockquote>
<p>åå‘ä»£ç†ï¼š</p>
<ul>
<li>åå‘ä»£ç†æœåŠ¡å™¨æ˜¯é…ç½®åœ¨æœåŠ¡ç«¯çš„ã€‚</li>
<li>å®¢æˆ·ç«¯æ˜¯ä¸çŸ¥é“è®¿é—®çš„åˆ°åº•æ˜¯å“ªä¸€å°æœåŠ¡å™¨ã€‚</li>
<li>è¾¾åˆ°è´Ÿè½½å‡è¡¡ï¼Œå¹¶ä¸”å¯ä»¥éšè—æœåŠ¡å™¨çœŸæ­£çš„ipåœ°å€ã€‚</li>
</ul>
</blockquote>
<p><img src="/Pictures/1586513061851.png" alt="1586513061851"></p>
<h4 id="4-2-åŸºäºNginxå®ç°åå‘ä»£ç†"><a href="#4-2-åŸºäºNginxå®ç°åå‘ä»£ç†" class="headerlink" title="4.2 åŸºäºNginxå®ç°åå‘ä»£ç†"></a>4.2 åŸºäºNginxå®ç°åå‘ä»£ç†</h4><blockquote>
<p>åˆ›å»ºä¸‰ä¸ªTomcatï¼Œé€šè¿‡æ•°æ®å·æ˜ å°„ï¼Œåœ¨æ˜ å°„ç›®å½•ä¸‹åˆ›å»ºROOTç›®å½•ï¼Œåœ¨å¯¹åº”çš„ROOTç›®å½•ä¸‹å†åˆ›å»ºindex.htmlï¼ˆéœ€è¦åˆ›å»ºä¸‰ä¸ªROOTç›®å½•å’Œä¸‰ä¸ªindex.htmlï¼Œindex.htmlå†…å®¹ä¸è¦ç›¸åŒï¼Œç”¨äºæµ‹è¯•ï¼‰</p>
</blockquote>
<blockquote>
<p>docker-compose.ymlå†…å®¹å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">version: <span class="string">&#x27;3.1&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  tomcat1:</span><br><span class="line">    restart: always</span><br><span class="line">    image: daocloud.io/library/tomcat:8.5.15-jre8</span><br><span class="line">    container_name: tomcat8081</span><br><span class="line">    ports:</span><br><span class="line">      - 8081:8080</span><br><span class="line">    environment:</span><br><span class="line">      TZ: Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - /opt/docker_tomcats/tomcat_webapps8081:/usr/local/tomcat/webapps</span><br><span class="line">  tomcat2:</span><br><span class="line">    restart: always</span><br><span class="line">    image: daocloud.io/library/tomcat:8.5.15-jre8</span><br><span class="line">    container_name: tomcat8082</span><br><span class="line">    ports:</span><br><span class="line">      - 8082:8080</span><br><span class="line">    environment:</span><br><span class="line">      TZ: Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - /opt/docker_tomcats/tomcat_webapps8082:/usr/local/tomcat/webapps</span><br><span class="line">  tomcat3:</span><br><span class="line">    restart: always</span><br><span class="line">    image: daocloud.io/library/tomcat:8.5.15-jre8</span><br><span class="line">    container_name: tomcat8083</span><br><span class="line">    ports:</span><br><span class="line">      - 8083:8080</span><br><span class="line">    environment:</span><br><span class="line">      TZ: Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - /opt/docker_tomcats/tomcat_webapps8083:/usr/local/tomcat/webapps</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@192 opt]<span class="comment"># mkdir docker_tomcats</span></span><br><span class="line">[root@192 opt]<span class="comment"># cd docker_tomcats/</span></span><br><span class="line">[root@192 docker_tomcats]<span class="comment"># vim docker-compose.yml </span></span><br><span class="line">[root@192 docker_tomcats]<span class="comment"># docker-compose up -d</span></span><br><span class="line">Creating network <span class="string">&quot;docker_tomcats_default&quot;</span> with the default driver</span><br><span class="line">Creating tomcat8082 ... <span class="keyword">done</span></span><br><span class="line">Creating tomcat8081 ... <span class="keyword">done</span></span><br><span class="line">Creating tomcat8083 ... <span class="keyword">done</span></span><br><span class="line">[root@192 docker_tomcats]<span class="comment"># ls</span></span><br><span class="line">docker-compose.yml  tomcat_webapps8081  tomcat_webapps8082  tomcat_webapps8083</span><br><span class="line">[root@192 docker_tomcats]<span class="comment"># cd tomcat_webapps8081</span></span><br><span class="line">[root@192 tomcat_webapps8081]<span class="comment"># mkdir ROOT</span></span><br><span class="line">[root@192 tomcat_webapps8081]<span class="comment"># cd ROOT</span></span><br><span class="line">[root@192 ROOT]<span class="comment"># vim index.html</span></span><br><span class="line">[root@192 ROOT]<span class="comment"># cd ..</span></span><br><span class="line">[root@192 tomcat_webapps8081]<span class="comment"># cd ..</span></span><br><span class="line">[root@192 docker_tomcats]<span class="comment"># cd tomcat_webapps8082</span></span><br><span class="line">[root@192 tomcat_webapps8082]<span class="comment"># mkdir ROOT</span></span><br><span class="line">[root@192 tomcat_webapps8082]<span class="comment"># cd ROOT</span></span><br><span class="line">[root@192 ROOT]<span class="comment"># vim index.html</span></span><br><span class="line">[root@192 ROOT]<span class="comment"># cd ..</span></span><br><span class="line">[root@192 tomcat_webapps8082]<span class="comment"># cd ..</span></span><br><span class="line">[root@192 docker_tomcats]<span class="comment"># cd tomcat_webapps8083</span></span><br><span class="line">[root@192 tomcat_webapps8083]<span class="comment"># mkdir ROOT</span></span><br><span class="line">[root@192 tomcat_webapps8083]<span class="comment"># cd ROOT</span></span><br><span class="line">[root@192 ROOT]<span class="comment"># vim index.html</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç„¶åä¿®æ”¹nginxçš„default.confé…ç½®æ–‡ä»¶ï¼Œä½¿å…¶é€šè¿‡Nginxè®¿é—®åˆ°tomcatæœåŠ¡å™¨ã€‚</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    listen  [::]:80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åŸºäºåå‘ä»£ç†è®¿é—®åˆ°TomcatæœåŠ¡å™¨</span></span><br><span class="line">    location / &#123;</span><br><span class="line">      proxy_pass http://192.168.25.132:8081/;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@192 opt]<span class="comment"># cd docker_nginx/</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># ls</span></span><br><span class="line">conf.d  docker-compose.yml</span><br><span class="line">[root@192 docker_nginx]<span class="comment"># cd conf.d/</span></span><br><span class="line">[root@192 conf.d]<span class="comment"># ls</span></span><br><span class="line">default.conf</span><br><span class="line">[root@192 conf.d]<span class="comment"># vim default.conf </span></span><br><span class="line">[root@192 conf.d]<span class="comment"># cd ..</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># docker-compose restart</span></span><br><span class="line">Restarting nginx ... <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å†æ¬¡è®¿é—®æ—¶ï¼Œnginxä¸»é¡µç›´æ¥æ˜¾ç¤ºåˆ°å¯¹åº”tomcatçš„é¡µé¢äº†</p>
</blockquote>
<h4 id="4-3-å…³äºNginxçš„locationè·¯å¾„æ˜ å°„"><a href="#4-3-å…³äºNginxçš„locationè·¯å¾„æ˜ å°„" class="headerlink" title="4.3 å…³äºNginxçš„locationè·¯å¾„æ˜ å°„"></a>4.3 å…³äºNginxçš„locationè·¯å¾„æ˜ å°„</h4><blockquote>
<p>ä¼˜å…ˆçº§å…³ç³»å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"># <span class="number">1.</span> ç›´æ¥åŒ¹é…</span><br><span class="line">location = / <span class="punctuation">&#123;</span></span><br><span class="line">  # ç²¾å‡†åŒ¹é…ï¼Œä¸»æœºååé¢ä¸èƒ½å¸¦ä»»ä½•çš„å­—ç¬¦ä¸²</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"># <span class="number">2.</span> é€šç”¨åŒ¹é…</span><br><span class="line">location /xxx <span class="punctuation">&#123;</span></span><br><span class="line">  # åŒ¹é…æ‰€æœ‰ä»¥/xxxå¼€å¤´çš„è·¯å¾„</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"># <span class="number">3.</span> æ­£åˆ™åŒ¹é…</span><br><span class="line">location ~ /xxx <span class="punctuation">&#123;</span></span><br><span class="line">  # åŒ¹é…æ‰€æœ‰ä»¥/xxxå¼€å¤´çš„è·¯å¾„</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"># <span class="number">4.</span> åŒ¹é…å¼€å¤´è·¯å¾„</span><br><span class="line">location ^~ /images/ <span class="punctuation">&#123;</span></span><br><span class="line">  # åŒ¹é…æ‰€æœ‰ä»¥/imageså¼€å¤´çš„è·¯å¾„</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"># <span class="number">5.</span> åŒ¹é…åç¼€</span><br><span class="line">location ~* \.(gif|jpg|png)$ <span class="punctuation">&#123;</span></span><br><span class="line">  # åŒ¹é…ä»¥gifæˆ–è€…jpgæˆ–è€…pngä¸ºç»“å°¾çš„è·¯å¾„</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"># <span class="number">6.</span> å…¨éƒ¨é€šé…</span><br><span class="line">location / <span class="punctuation">&#123;</span></span><br><span class="line">  # åŒ¹é…å…¨éƒ¨è·¯å¾„  </span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="äº”ã€Nginxè´Ÿè½½å‡è¡¡ã€é‡ç‚¹ã€‘"><a href="#äº”ã€Nginxè´Ÿè½½å‡è¡¡ã€é‡ç‚¹ã€‘" class="headerlink" title="äº”ã€Nginxè´Ÿè½½å‡è¡¡ã€é‡ç‚¹ã€‘"></a>äº”ã€Nginxè´Ÿè½½å‡è¡¡ã€<code>é‡ç‚¹</code>ã€‘</h3><hr>
<blockquote>
<p>Nginxä¸ºæˆ‘ä»¬é»˜è®¤æä¾›äº†ä¸‰ç§è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ï¼š</p>
<p>â€‹	è½®è¯¢ï¼šå°†å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚ï¼Œå¹³å‡çš„åˆ†é…ç»™æ¯ä¸€å°æœåŠ¡å™¨ã€‚</p>
<p>â€‹	æƒé‡ï¼šä¼šå°†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œæ ¹æ®æœåŠ¡å™¨çš„æƒé‡å€¼ä¸åŒï¼Œåˆ†é…ä¸åŒçš„æ•°é‡ã€‚</p>
<p>â€‹	ip_hashï¼šåŸºäºå½“å‰å‘èµ·è¯·æ±‚çš„å®¢æˆ·ç«¯çš„ipåœ°å€ï¼Œå¦‚æœipåœ°å€ä¸å˜ï¼Œå§‹ç»ˆä¼šå°†è¯·æ±‚å‘é€åˆ°å½“å‰çš„æœåŠ¡å™¨ä¸Šã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071025043.png"></p>
<h4 id="5-1-è½®è¯¢"><a href="#5-1-è½®è¯¢" class="headerlink" title="5.1 è½®è¯¢"></a>5.1 è½®è¯¢</h4><blockquote>
<p>æƒ³å®ç°Nginxè½®è¯¢è´Ÿè½½å‡è¡¡æœºåˆ¶éœ€è¦ä¿®æ”¹default.confé…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹ï¼š</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">upstream åå­— <span class="punctuation">&#123;</span></span><br><span class="line">  server ip<span class="punctuation">:</span>port;</span><br><span class="line">  server ip<span class="punctuation">:</span>port;</span><br><span class="line">  ...</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">server <span class="punctuation">&#123;</span></span><br><span class="line">  listen <span class="number">80</span>;</span><br><span class="line">  listen  <span class="punctuation">[</span><span class="punctuation">:</span><span class="punctuation">:</span><span class="punctuation">]</span><span class="punctuation">:</span><span class="number">80</span>;</span><br><span class="line">  server_name localhost;</span><br><span class="line">  </span><br><span class="line">  location / <span class="punctuation">&#123;</span></span><br><span class="line">    proxy_pass http<span class="punctuation">:</span><span class="comment">//upstreamçš„åå­—/;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¾‹å¦‚ï¼šï¼ˆæ³¨æ„ï¼šupstreamçš„åå­—ä¸è¦ä½¿ç”¨ä¸‹åˆ’çº¿ï¼‰</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">upstream my-server &#123;</span><br><span class="line">  server <span class="number">47.100</span><span class="number">.241</span><span class="number">.89</span>:<span class="number">8081</span>;</span><br><span class="line">  server <span class="number">47.100</span><span class="number">.241</span><span class="number">.89</span>:<span class="number">8082</span>;</span><br><span class="line">  server <span class="number">47.100</span><span class="number">.241</span><span class="number">.89</span>:<span class="number">8083</span>;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">  listen <span class="number">80</span>;</span><br><span class="line">  listen  [::]:<span class="number">80</span>;</span><br><span class="line">  server_name localhost;</span><br><span class="line">  </span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass http:<span class="comment">//my-server/;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@192 opt]<span class="comment"># cd docker_nginx/</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># ls</span></span><br><span class="line">conf.d  docker-compose.yml</span><br><span class="line">[root@192 docker_nginx]<span class="comment"># cd conf.d/</span></span><br><span class="line">[root@192 conf.d]<span class="comment"># ls</span></span><br><span class="line">default.conf</span><br><span class="line">[root@192 conf.d]<span class="comment"># vim default.conf </span></span><br><span class="line">[root@192 conf.d]<span class="comment"># cd ..</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># docker-compose restart</span></span><br><span class="line">Restarting nginx ... <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨ï¼šè‹¥è½®è¯¢æ— æ³•å®ç°ï¼ŒæŠŠnginx.confæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­çš„ keepalive_timeout  65 æ”¹ä¸º keepalive_timeout  0 å³å¯ï¼</p>
</blockquote>
<h4 id="5-2-æƒé‡"><a href="#5-2-æƒé‡" class="headerlink" title="5.2 æƒé‡"></a>5.2 æƒé‡</h4><blockquote>
<p>å®ç°æƒé‡çš„æ–¹å¼</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">upstream åå­— <span class="punctuation">&#123;</span></span><br><span class="line">  server ip<span class="punctuation">:</span>port weight=æƒé‡æ¯”ä¾‹;</span><br><span class="line">  server ip<span class="punctuation">:</span>port weight=æƒé‡æ¯”ä¾‹;</span><br><span class="line">  ...</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">server <span class="punctuation">&#123;</span></span><br><span class="line">  listen <span class="number">80</span>;</span><br><span class="line">  server_name localhost;</span><br><span class="line">  </span><br><span class="line">  location / <span class="punctuation">&#123;</span></span><br><span class="line">    proxy_pass http<span class="punctuation">:</span><span class="comment">//upstreamçš„åå­—/;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¾‹å¦‚ï¼š</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">upstream my-server &#123;</span><br><span class="line">  server 47.100.241.89:8081 weight=10;</span><br><span class="line">  server 47.100.241.89:8082 weight=5;</span><br><span class="line">  server 47.100.241.89:80 weight=1;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  listen  [::]:80;</span><br><span class="line">  server_name localhost;</span><br><span class="line">  </span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass http://my-server/;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@192 docker_nginx]<span class="comment"># cd conf.d/</span></span><br><span class="line">[root@192 conf.d]<span class="comment"># ls</span></span><br><span class="line">default.conf</span><br><span class="line">[root@192 conf.d]<span class="comment"># vim default.conf </span></span><br><span class="line">[root@192 conf.d]<span class="comment"># cd ..</span></span><br><span class="line">[root@192 docker_nginx]<span class="comment"># docker-compose restart</span></span><br><span class="line">Restarting nginx ... <span class="keyword">done</span></span><br></pre></td></tr></table></figure>



<h4 id="5-3-ip-hash"><a href="#5-3-ip-hash" class="headerlink" title="5.3 ip_hash"></a>5.3 ip_hash</h4><blockquote>
<p>ip_hashå®ç°ï¼Œåªéœ€è¦æ·»åŠ ä¸€ä¸ª  ip_hash é…ç½®å³å¯ï¼Œåœ¨æš‚æ—¶ä¸ä½¿ç”¨çš„æœåŠ¡å™¨åé¢æ·»åŠ downå³å¯</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">upstream åå­— &#123;</span><br><span class="line">  ip_hash; <span class="comment"># é…ç½®ip_hash</span></span><br><span class="line">  server ip:port down;</span><br><span class="line">  server ip:port;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name localhost;</span><br><span class="line">  </span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass http://upstreamçš„åå­—/;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¾‹å¦‚ï¼š</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">upstream my-server &#123;</span><br><span class="line">  ip_hash;</span><br><span class="line">  server 192.168.25.140:8081;</span><br><span class="line">  server 192.168.25.140:8082 down;</span><br><span class="line">  server 192.168.25.140:8083 down;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  listen  [::]:80;</span><br><span class="line">  server_name localhost;</span><br><span class="line"></span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass http://my-server/;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="å…­ã€NginxåŠ¨é™åˆ†ç¦»ã€é‡ç‚¹ã€‘"><a href="#å…­ã€NginxåŠ¨é™åˆ†ç¦»ã€é‡ç‚¹ã€‘" class="headerlink" title="å…­ã€NginxåŠ¨é™åˆ†ç¦»ã€é‡ç‚¹ã€‘"></a>å…­ã€NginxåŠ¨é™åˆ†ç¦»ã€<code>é‡ç‚¹</code>ã€‘</h3><hr>
<blockquote>
<p>Nginxçš„å¹¶å‘èƒ½åŠ›å…¬å¼ï¼š</p>
<p>worker_processes * worker_connections &#x2F; 4 | 2 &#x3D; Nginxæœ€ç»ˆçš„å¹¶å‘èƒ½åŠ›</p>
<p>åŠ¨æ€èµ„æºéœ€è¦&#x2F;4ï¼Œé™æ€èµ„æºéœ€è¦&#x2F;2.</p>
<p>Nginxé€šè¿‡åŠ¨é™åˆ†ç¦»ï¼Œæ¥æå‡Nginxçš„å¹¶å‘èƒ½åŠ›ï¼Œæ›´å¿«çš„ç»™ç”¨æˆ·å“åº”ã€‚</p>
</blockquote>
<h4 id="6-1-åŠ¨æ€èµ„æºä»£ç†"><a href="#6-1-åŠ¨æ€èµ„æºä»£ç†" class="headerlink" title="6.1 åŠ¨æ€èµ„æºä»£ç†"></a>6.1 åŠ¨æ€èµ„æºä»£ç†</h4><blockquote>
<p>ä½¿ç”¨proxy_passåŠ¨æ€ä»£ç†</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½®å¦‚ä¸‹</span></span><br><span class="line">location / &#123;</span><br><span class="line">  proxy_pass è·¯å¾„;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="6-2-é™æ€èµ„æºä»£ç†"><a href="#6-2-é™æ€èµ„æºä»£ç†" class="headerlink" title="6.2 é™æ€èµ„æºä»£ç†"></a>6.2 é™æ€èµ„æºä»£ç†</h4><blockquote>
<p>ä½¿ç”¨rooté™æ€ä»£ç†</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½®å¦‚ä¸‹</span></span><br><span class="line">location / &#123;</span><br><span class="line">  root é™æ€èµ„æºè·¯å¾„;</span><br><span class="line">  index é»˜è®¤è®¿é—®è·¯å¾„ä¸‹çš„ä»€ä¹ˆèµ„æº;</span><br><span class="line">  autoindex on; <span class="comment"># ä»£è¡¨å±•ç¤ºé™æ€èµ„æºå…¨çš„å…¨éƒ¨å†…å®¹ï¼Œä»¥åˆ—è¡¨çš„å½¢å¼å±•å¼€ã€‚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…ˆä¿®æ”¹dockerï¼Œæ·»åŠ ä¸€ä¸ªæ•°æ®å·ï¼Œæ˜ å°„åˆ°NginxæœåŠ¡å™¨çš„ä¸€ä¸ªç›®å½•</span></span><br><span class="line"><span class="comment"># æ·»åŠ äº†index.htmlå’Œ1.jpgé™æ€èµ„æº</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@localhost docker_nginx]<span class="comment"># ls</span></span><br><span class="line">conf.d  docker-compose.yml</span><br><span class="line">[root@localhost docker_nginx]<span class="comment"># vim docker-compose.yml </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¿®æ”¹docker-compose.ymlä¸ºå¦‚ä¸‹å†…å®¹ï¼š</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">version: <span class="string">&#x27;3.1&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  nginx:</span><br><span class="line">    restart: always</span><br><span class="line">    image: daocloud.io/library/nginx:latest</span><br><span class="line">    container_name: nginx</span><br><span class="line">    ports:</span><br><span class="line">      - 80:80</span><br><span class="line">    volumes:</span><br><span class="line">      - /opt/docker_nginx/conf.d/:/etc/nginx/conf.d</span><br><span class="line">      - /opt/docker_nginx/img/:/data/img</span><br><span class="line">      - /opt/docker_nginx/html/:/data/html</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é‡å¯å†æŸ¥çœ‹ï¼Œç›®å½•å·²ç»åˆ›å»º</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@localhost docker_nginx]<span class="comment"># docker-compose down</span></span><br><span class="line">Stopping nginx ... <span class="keyword">done</span></span><br><span class="line">Removing nginx ... <span class="keyword">done</span></span><br><span class="line">Removing network docker_nginx_default</span><br><span class="line">[root@localhost docker_nginx]<span class="comment"># docker-compose up -d</span></span><br><span class="line">Creating network <span class="string">&quot;docker_nginx_default&quot;</span> with the default driver</span><br><span class="line">Creating nginx ... <span class="keyword">done</span></span><br><span class="line">[root@localhost docker_nginx]<span class="comment"># ls</span></span><br><span class="line">conf.d  docker-compose.yml  html  img</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ†åˆ«åœ¨ html ä»¥åŠ img ç›®å½•ä¸­æ‹·è´å¯¹åº”çš„ html é¡µé¢å’Œå›¾ç‰‡å³å¯ï¼Œç„¶åä¿®æ”¹ Nginx çš„ default.conf é…ç½®æ–‡ä»¶</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  listen  [::]:80;</span><br><span class="line">  server_name localhost;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># ä»£ç†åˆ°htmlçš„é™æ€èµ„æº</span></span><br><span class="line">  location /html &#123;</span><br><span class="line">    root /data;   <span class="comment">#ç”±äºlocationåé¢å†™çš„æ˜¯/htmlï¼Œæ‰€ä»¥rootåçš„è·¯å¾„å°±ä¸ç”¨å†™æˆ/data/htmlï¼Œ/htmlä¼šé»˜è®¤æ”¾åœ¨/dataåé¢</span></span><br><span class="line">    index student.html;<span class="comment">#é»˜è®¤è®¿é—®student.html</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># ä»£ç†åˆ°imgçš„é™æ€èµ„æº</span></span><br><span class="line">  location /img &#123;</span><br><span class="line">    root /data;</span><br><span class="line">    autoindex on;<span class="comment">#ä»¥åˆ—è¡¨çš„å½¢å¼å±•å¼€</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@localhost docker_nginx]<span class="comment"># cd conf.d/</span></span><br><span class="line">[root@localhost conf.d]<span class="comment"># vim default.conf </span></span><br><span class="line">[root@localhost conf.d]<span class="comment"># cd ..</span></span><br><span class="line">[root@localhost docker_nginx]<span class="comment"># docker-compose restart</span></span><br><span class="line">Restarting nginx ... <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµè§ˆå™¨åˆ†åˆ«è®¿é—®ä»¥ä¸‹åœ°å€è¿›è¡Œæµ‹è¯•ï¼š</p>
<p>â€‹		<a href="http://39.98.132.196/html/">http://39.98.132.196/html/</a> ï¼ˆæŸ¥çœ‹ä¹‹å‰æ‹·è´çš„student.htmlé¡µé¢ï¼‰</p>
<p>â€‹		<a href="http://39.98.132.196/img/2.jpg">http://39.98.132.196/img/2.jpg</a> ï¼ˆæ³¨ï¼š2.jpgæ˜¯æ‹·è´çš„å›¾ç‰‡åç§°ï¼‰</p>
<p>â€‹		<a href="http://39.98.132.196/img/">http://39.98.132.196/img/</a> ï¼ˆæ³¨ï¼šå¯ä»¥çœ‹åˆ°å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼‰</p>
</blockquote>
<h3 id="ä¸ƒã€Nginxé›†ç¾¤"><a href="#ä¸ƒã€Nginxé›†ç¾¤" class="headerlink" title="ä¸ƒã€Nginxé›†ç¾¤"></a>ä¸ƒã€Nginxé›†ç¾¤</h3><hr>
<blockquote>
<p>å•ç‚¹æ•…éšœï¼Œé¿å…nginxçš„å®•æœºï¼Œå¯¼è‡´æ•´ä¸ªç¨‹åºçš„å´©æºƒ</p>
<p>å‡†å¤‡å¤šå°Nginxã€‚</p>
<p>å‡†å¤‡keepalivedï¼Œç›‘å¬nginxçš„å¥åº·æƒ…å†µã€‚</p>
<p>å‡†å¤‡haproxyï¼Œæä¾›ä¸€ä¸ªè™šæ‹Ÿçš„è·¯å¾„ï¼Œç»Ÿä¸€çš„å»æ¥æ”¶ç”¨æˆ·å¾—è¯·æ±‚ã€‚</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">Nginxé›†ç¾¤</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071025764.png" alt="1588755548570"></td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>åç«¯å­¦ä¹ </category>
        <category>java</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºWindowsä¸€äº›å¸¸ç”¨Command</title>
    <url>/2023/03/29/%E5%85%B3%E4%BA%8EWindows%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8Command/</url>
    <content><![CDATA[<h3 id="å…³æœºã€é‡å¯ã€æ³¨é”€ã€ä¼‘çœ ã€å®šæ—¶"><a href="#å…³æœºã€é‡å¯ã€æ³¨é”€ã€ä¼‘çœ ã€å®šæ—¶" class="headerlink" title="å…³æœºã€é‡å¯ã€æ³¨é”€ã€ä¼‘çœ ã€å®šæ—¶"></a>å…³æœºã€é‡å¯ã€æ³¨é”€ã€ä¼‘çœ ã€å®šæ—¶</h3><ul>
<li>å…³æœºï¼š<code>shutdown /s</code></li>
<li>é‡å¯ï¼š<code>shutdown /r</code></li>
<li>æ³¨é”€ï¼š<code>shutdown /l</code></li>
<li>ä¼‘çœ ï¼š<code>shutdown /h /f</code></li>
<li>å–æ¶ˆå…³æœºï¼š<code>shutdown /a</code></li>
<li>å®šæ—¶å…³æœºï¼š<code>shutdown /s /t 3600</code>ï¼ˆ3600 ç§’åå…³æœºï¼‰<span id="more"></span></li>
</ul>
<h3 id="ç›®å½•æ“ä½œ"><a href="#ç›®å½•æ“ä½œ" class="headerlink" title="ç›®å½•æ“ä½œ"></a>ç›®å½•æ“ä½œ</h3><p><strong>åˆ‡æ¢ç›®å½•ï¼Œè¿›å…¥æŒ‡å®šæ–‡ä»¶å¤¹ï¼š</strong></p>
<ul>
<li>åˆ‡æ¢ç£ç›˜ï¼š<code>d:</code>ï¼ˆè¿›å…¥ d ç›˜ï¼‰</li>
<li>åˆ‡æ¢ç£ç›˜å’Œç›®å½•ï¼š<code>cd /d d:/test</code>ï¼ˆè¿›å…¥ <code>d</code> ç›˜ <code>test</code> æ–‡ä»¶å¤¹ï¼‰</li>
<li>è¿›å…¥æ–‡ä»¶å¤¹ï¼š<code>cd \test1\test2</code>ï¼ˆè¿›å…¥ <code>test2</code> æ–‡ä»¶å¤¹ï¼‰</li>
<li>è¿”å›æ ¹ç›®å½•ï¼š<code>cd \</code></li>
<li>å›åˆ°ä¸Šçº§ç›®å½•ï¼š<code>cd ..</code></li>
<li>æ–°å»ºæ–‡ä»¶å¤¹ï¼š<code>md test</code></li>
</ul>
<p><strong>æ˜¾ç¤ºç›®å½•å†…å®¹ï¼š</strong></p>
<ul>
<li>æ˜¾ç¤ºç›®å½•ä¸­æ–‡ä»¶åˆ—è¡¨ï¼š<code>dir</code></li>
<li>æ˜¾ç¤ºç›®å½•ç»“æ„ï¼š<code>tree d:\test</code>ï¼ˆd ç›˜ test ç›®å½•ï¼‰</li>
<li>æ˜¾ç¤ºå½“å‰ç›®å½•ä½ç½®ï¼š<code>cd</code></li>
<li>æ˜¾ç¤ºæŒ‡å®šç£ç›˜çš„å½“å‰ç›®å½•ä½ç½®ï¼š<code>cd d:</code></li>
</ul>
<h3 id="ç½‘ç»œæ“ä½œ"><a href="#ç½‘ç»œæ“ä½œ" class="headerlink" title="ç½‘ç»œæ“ä½œ"></a><strong>ç½‘ç»œæ“ä½œ</strong></h3><ul>
<li>å»¶è¿Ÿå’Œä¸¢åŒ…ç‡ï¼š<code>ping ip/åŸŸå</code></li>
<li>Ping æµ‹è¯• 5 æ¬¡ï¼š<code>ping ip/åŸŸå -n 5</code></li>
<li>æ¸…é™¤æœ¬åœ° DNS ç¼“å­˜ï¼š<code>ipconfig /flushdns</code></li>
<li>è·¯ç”±è¿½è¸ªï¼š<code>tracert ip/åŸŸå</code></li>
</ul>
<h3 id="è¿›ç¨‹-x2F-æœåŠ¡æ“ä½œ"><a href="#è¿›ç¨‹-x2F-æœåŠ¡æ“ä½œ" class="headerlink" title="è¿›ç¨‹&#x2F;æœåŠ¡æ“ä½œ"></a><strong>è¿›ç¨‹&#x2F;æœåŠ¡æ“ä½œ</strong></h3><p><strong>è¿›ç¨‹ç®¡ç†ï¼š</strong></p>
<ul>
<li>æ˜¾ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼š<code>tasklist</code></li>
<li>è¿è¡Œç¨‹åºæˆ–å‘½ä»¤ï¼š<code>start ç¨‹åºå</code></li>
<li>ç»“æŸè¿›ç¨‹ï¼ŒæŒ‰åç§°ï¼š<code>taskkill /im notepad.exe</code>ï¼ˆå…³é—­è®°äº‹æœ¬ï¼‰</li>
<li>ç»“æŸè¿›ç¨‹ï¼ŒæŒ‰ PIDï¼š<code>taskkill /pid 1234</code>ï¼ˆå…³é—­ PID ä¸º 1234 çš„è¿›ç¨‹ï¼‰</li>
</ul>
<p><strong>æœåŠ¡ç®¡ç†ï¼š</strong></p>
<ul>
<li>æ˜¾ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„æœåŠ¡ï¼š<code>net start</code></li>
<li>å¯åŠ¨æŒ‡å®šæœåŠ¡ï¼š<code>net start æœåŠ¡å</code></li>
<li>åœæ­¢æŒ‡å®šæœåŠ¡ï¼š<code>net stop æœåŠ¡å</code></li>
</ul>
<h3 id="ä¿å­˜ä¸º-bat-å¯æ‰§è¡Œæ–‡ä»¶"><a href="#ä¿å­˜ä¸º-bat-å¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="ä¿å­˜ä¸º .bat å¯æ‰§è¡Œæ–‡ä»¶"></a>ä¿å­˜ä¸º .bat å¯æ‰§è¡Œæ–‡ä»¶</h3><p>æˆ‘ä»¬å¯ä»¥å°†å¸¸ç”¨çš„å‘½ä»¤è¾“å…¥è®°äº‹æœ¬ä¸­ï¼Œå¹¶ä¿å­˜ä¸ºåç¼€ä¸º <code>.bat</code> çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
<p>ä»¥ååªè¦åŒå‡»è¯¥æ–‡ä»¶å³å¯æ‰§è¡ŒæŒ‡å®šå‘½ä»¤ï¼›å°†æ–‡ä»¶æ”¾å…¥ç³»ç»Ÿã€å¯åŠ¨ã€‘ç›®å½•ä¸­ï¼Œå¯ä»¥å®ç°å¼€æœºè‡ªåŠ¨è¿è¡Œã€‚</p>
<h3 id="ä½¿ç”¨çš„æ¡ˆä¾‹"><a href="#ä½¿ç”¨çš„æ¡ˆä¾‹" class="headerlink" title="ä½¿ç”¨çš„æ¡ˆä¾‹"></a>ä½¿ç”¨çš„æ¡ˆä¾‹</h3><p><strong>ä½¿ç”¨ç¤ºä¾‹ 1ï¼š</strong></p>
<p>åœ¨èµ„æºç®¡ç†å™¨å¡æ­»æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>taskkill</code> å‘½ä»¤é‡å¯ã€‚å°†ä¸‹é¢å‘½ä»¤ä¿å­˜ä¸º <code>ReExplorer.bat</code>ï¼Œåœ¨éœ€è¦æ—¶åŒå‡»å³å¯å¼ºåˆ¶é‡å¯èµ„æºç®¡ç†å™¨ã€‚æˆ–ç›´æ¥æ‰“å¼€ CMD è¿è¡Œå‘½ä»¤ä¹Ÿå¯ä»¥ã€‚</p>
<p>text</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">01taskkill /f /im explorer.exe &amp; start explorer.exe</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ç¤ºä¾‹ 2ï¼š</strong></p>
<p>è¿…é›·ä¼šåœ¨åå°è‡ªåŠ¨è¿è¡Œ <code>ThunderPlatform.exe</code> è¿›ç¨‹å’Œ <code>XLServicePlatform</code> æœåŠ¡ï¼Œå¦‚æœå½“å‰æ²¡æœ‰ä½¿ç”¨è¿…é›·çš„è¯æ˜¾ç„¶æ²¡å¿…è¦ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å°†å¦‚ä¸‹ä»£ç ä¿å­˜ä¸º <code>killxl.bat</code>ï¼Œå¹¶æ”¾å…¥ã€å¯åŠ¨ã€‘ç›®å½•ï¼Œå¼€æœºåä¼šè‡ªåŠ¨è¿è¡Œè¯¥è„šæœ¬ï¼Œæ¸…é™¤è¿™ä¸¤ä¸ªè¿›ç¨‹ã€‚</p>
<p>text</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">0102net stop XLServicePlatform</span><br><span class="line">taskkill /F /im ThunderPlatform.exe</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows Command</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºRiderå¼•å…¥nugetæ— æ³•åŠ è½½åŒ…ä¾èµ–è§£æ–¹å¼</title>
    <url>/2022/11/22/%E5%85%B3%E4%BA%8ERider%E5%BC%95%E5%85%A5nuget%E6%97%A0%E6%B3%95%E5%8A%A0%E8%BD%BD%E5%8C%85%E4%BE%9D%E8%B5%96%E8%A7%A3%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<blockquote>
<p>è¿™ä¸ªé—®é¢˜å·²ç»æ˜¯å›°æ‰°æˆ‘ä¸‰å¤©äº†ï¼Œå› ä¸º<code>C#</code>ä½¿ç”¨<code>ride</code>rå¼€å‘çš„äººç›¸å¯¹è¾ƒå°‘ï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘è‡ªèº«é‡åˆ°è¿™ä¸ªé—®é¢˜æ¯”è¾ƒç‰¹æ®Šï¼Œç»ˆäºæ‰¾åˆ°äº†<code>nuget</code>æ— æ³•å¼•å…¥åŒ…çš„è§£å†³æ–¹æ¡ˆ</p>
</blockquote>
<span id="more"></span>
<p>é¦–å…ˆçœ‹å›¾ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211220823203.png" alt="image-20221122082335814"></p>
<p>æˆ‘åœ¨<code>Nuget</code>ä¸‹é¢æŸ¥æ‰¾<code>Nunit</code>æµ‹è¯•åŒ…ä¸‹é¢éƒ½æ²¡æœ‰åŠ è½½å‡ºæ¥ï¼Œå…¶ä»–çš„åŒ…ä¹Ÿæ˜¯åŠ è½½ä¸å‡ºæ¥ï¼Œä¸‹é¢ä¸€ç›´æ˜¾ç¤ºçš„åŒ…é‡ç½®ï¼Œä½†æ˜¯æˆ‘æ˜¯é»˜è®¤ä¸‹è½½ä¸‹æ¥çš„ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ä¿®æ”¹ï¼Œç„¶åæˆ‘å°±ç‚¹å¼€äº†<code>nuget.config</code>è¿™ä¸ªé…ç½®æ–‡ä»¶</p>
<p>å›¾ä¸­ä¹Ÿæœ‰ï¼Œæˆ‘åœ¨ç½‘ä¸Šä¹Ÿæ²¡æœ‰æ‰¾åˆ°ç›¸å…³çš„é…ç½®è¯´æ˜ï¼Œå½“æ—¶ä¹Ÿæ²¡æœ‰æƒ³åˆ°å»å¾®è½¯å®˜ç½‘å»çœ‹ï¼Œå› ä¸ºå®˜ç½‘è®²çš„åŸºæœ¬éƒ½æ˜¯å…³äºVSçš„é…ç½®ã€‚</p>
<p>åœ¨é»˜è®¤é…ç½®ä¸­ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211220828462.png" alt="image-20221122082848339"></p>
<p>sourceä¸­é»˜è®¤çš„feedsè¿æ¥éƒ½æ˜¯ç©ºçš„ï¼Œé—®é¢˜å°±æ˜¯å‡ºåœ¨æˆ‘ä¸Šé¢æ ‡æ³¨å‡ºæ¥çš„åŒ…çš„ä¸‹è½½åœ°å€ã€‚</p>
<p>ç»™ä¸‹é¢ä»å¾®è½¯å®˜æ–¹æ‰¾åˆ°çš„é…ç½®åœ°å€ï¼Œå¤åˆ¶åˆ°<code>nuget.config</code>é…ç½®æ–‡ä»¶ä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- defaultPushSource key works like the &#x27;defaultPushSource&#x27; key of NuGet.Config files. --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- This can be used by administrators to prevent accidental publishing of packages to nuget.org. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">add</span> <span class="attr">key</span>=<span class="string">&quot;defaultPushSource&quot;</span> <span class="attr">value</span>=<span class="string">&quot;https://contoso.com/packages/&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">config</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Default Package Sources; works like the &#x27;packageSources&#x27; section of NuGet.Config files. --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- This collection cannot be deleted or modified but can be disabled/enabled by users. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packageSources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">add</span> <span class="attr">key</span>=<span class="string">&quot;Contoso Package Source&quot;</span> <span class="attr">value</span>=<span class="string">&quot;https://contoso.com/packages/&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">add</span> <span class="attr">key</span>=<span class="string">&quot;nuget.org&quot;</span> <span class="attr">value</span>=<span class="string">&quot;https://api.nuget.org/v3/index.json&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">packageSources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Default Package Sources that are disabled by default. --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Works like the &#x27;disabledPackageSources&#x27; section of NuGet.Config files. --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Sources cannot be modified or deleted either but can be enabled/disabled by users. --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">disabledPackageSources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">add</span> <span class="attr">key</span>=<span class="string">&quot;nuget.org&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">disabledPackageSources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¦ç»™è¿™äº›enableéƒ½å‹¾é€‰ä¸Š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211220833403.png" alt="image-20221122083314091"></p>
<p>ç„¶åå³è¾¹çš„åˆ·æ–°æŒ‰é’®ç‚¹ä¸€ä¸‹ï¼Œæˆ–è€…å»åˆ°è®¾ç½®é‡Œé¢æ‰¾åˆ°</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211220834175.png" alt="image-20221122083437031"></p>
<p>è¿™æ—¶å€™ä»£è¡¨å·²ç»æ·»åŠ æˆåŠŸã€‚</p>
<p>å›åˆ°<code>nuget</code>ä»¥å,<code>packages</code>æœç´¢æ¡†è¿™æ—¶å€™å·²ç»åŠ è½½å‡ºæ¥åŒ…äº†ï¼Œä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211220836706.png" alt="image-20221122083626412"></p>
<p>è¿™æ—¶å€™è¯´æ˜å·²ç»æˆåŠŸï¼ï¼ï¼</p>
<blockquote>
<p>æœ¬æ¬¡ç‰ˆæœ¬æ˜¯<code>.net6,riderç‰ˆæœ¬æ˜¯2021.3.4</code>ï¼Œæœ€æ–°ç‰ˆ2022ç‰ˆæœ¬åº”è¯¥ä¹Ÿæ˜¯å¯ä»¥è¿™æ ·ä¿®æ”¹ï¼Œå¦‚æœèƒ½ç›´æ¥åŠ è½½å‡ºæ¥å°±æ›´å¥½ï¼Œæ— æ³•åŠ è½½å¯ä»¥å°è¯•ä¿®æ”¹~</p>
</blockquote>
]]></content>
      <categories>
        <category>C#</category>
        <category>åç«¯å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title>æœåŠ¡å™¨ï¼ˆä¸€ï¼‰</title>
    <url>/2022/10/07/%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<h3 id="1-æœåŠ¡å™¨çš„æ¦‚è¿°"><a href="#1-æœåŠ¡å™¨çš„æ¦‚è¿°" class="headerlink" title="1.æœåŠ¡å™¨çš„æ¦‚è¿°"></a>1.æœåŠ¡å™¨çš„æ¦‚è¿°</h3><h4 id="1-ä»€ä¹ˆæ˜¯æœåŠ¡å™¨"><a href="#1-ä»€ä¹ˆæ˜¯æœåŠ¡å™¨" class="headerlink" title="1.ä»€ä¹ˆæ˜¯æœåŠ¡å™¨"></a>1.ä»€ä¹ˆæ˜¯æœåŠ¡å™¨</h4><blockquote>
<p>æœåŠ¡å™¨æ˜¯è®¡ç®—æœºçš„ä¸€ç§ï¼Œå®ƒæ¯”æ™®é€šè®¡ç®—æœºè¿è¡Œæ›´å¿«ã€è´Ÿè½½æ›´é«˜ã€ä»·æ ¼æ›´è´µã€‚æœåŠ¡å™¨åœ¨ç½‘ç»œä¸­ä¸ºå…¶å®ƒå®¢æˆ·æœºï¼ˆå¦‚PCæœºã€æ™ºèƒ½æ‰‹æœºã€ATMç­‰ç»ˆç«¯ç”šè‡³æ˜¯ç«è½¦ç³»ç»Ÿç­‰å¤§å‹è®¾å¤‡ï¼‰æä¾›è®¡ç®—æˆ–è€…åº”ç”¨æœåŠ¡ã€‚æœåŠ¡å™¨å…·æœ‰é«˜é€Ÿçš„CPUè¿ç®—èƒ½åŠ›ã€é•¿æ—¶é—´çš„å¯é è¿è¡Œã€å¼ºå¤§çš„V&#x2F;Oå¤–éƒ¨æ•°æ®ååèƒ½åŠ›ä»¥åŠæ›´å¥½çš„æ‰©å±•æ€§ã€‚æ ¹æ®æœåŠ¡å™¨æ‰€æä¾›çš„æœåŠ¡ï¼Œä¸€èˆ¬æ¥è¯´æœåŠ¡å™¨éƒ½å…·å¤‡æ‰¿æ‹…å“åº”æœåŠ¡è¯·æ±‚ã€æ‰¿æ‹…æœåŠ¡ã€ä¿éšœæœåŠ¡çš„èƒ½åŠ›ã€‚æœåŠ¡å™¨ä½œä¸ºç”µå­è®¾å¤‡ï¼Œå…¶å†…éƒ¨çš„ç»“æ„ååˆ†çš„å¤æ‚ï¼Œä½†ä¸æ™®é€šçš„è®¡ç®—æœºå†…éƒ¨ç»“æ„ç›¸å·®ä¸å¤§ï¼Œå¦‚ï¼šcpuã€ç¡¬ç›˜ã€å†…å­˜ï¼Œç³»ç»Ÿã€ç³»ç»Ÿæ€»çº¿ç­‰ã€‚</p>
</blockquote>
<span id="more"></span>
<h3 id="2-æœåŠ¡å™¨çš„ä½œç”¨"><a href="#2-æœåŠ¡å™¨çš„ä½œç”¨" class="headerlink" title="2.æœåŠ¡å™¨çš„ä½œç”¨"></a>2.æœåŠ¡å™¨çš„ä½œç”¨</h3><blockquote>
<p>é€šä¿—çš„è¯´ï¼ŒæœåŠ¡å™¨ä¸»è¦æ˜¯ç”¨æ¥å“åº”ç»ˆç«¯çš„æœåŠ¡è¯·æ±‚ï¼šå¹¶è¿›è¡Œå¤„ç†ï¼Œæˆ‘ä»¬åœ¨ä¸Šç½‘çš„æ—¶å€™æ˜¯ä¸å¯èƒ½ç›´æ¥å°†ç½‘å®¢æ¥äººäº’è”ç½‘çš„ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é€šè¿‡æœåŠ¡å™¨ç±³è¿æ¥ç½‘ç»œï¼ŒçœŸæœ‰æœåŠ¡å™¨å“åº”ä½ çš„è”ç½‘è¯·æ±‚ï¼Œå¹¶ä¸”è¿›è¡Œå¤„ç†ä»¥åæ‰å¯ä»¥è”ç½‘ï¼šå­˜å‚¨çš„åŠŸèƒ½ï¼ŒæœåŠ¡å™¨çš„å­˜å‚¨ç©ºé—´ä¸€èˆ¬æ¯”è¾ƒå……è¶³ï¼Œå¯ä»¥å­˜å‚¨éå¸¸å¤šçš„ä¿¡æ¯ã€‚</p>
</blockquote>
<h3 id="3-æœåŠ¡å™¨çš„åˆ†ç±»"><a href="#3-æœåŠ¡å™¨çš„åˆ†ç±»" class="headerlink" title="3.æœåŠ¡å™¨çš„åˆ†ç±»"></a>3.æœåŠ¡å™¨çš„åˆ†ç±»</h3><h5 id="3-1-æŒ‰ç‰©ç†å½¢æ€ï¼š"><a href="#3-1-æŒ‰ç‰©ç†å½¢æ€ï¼š" class="headerlink" title="3.1 æŒ‰ç‰©ç†å½¢æ€ï¼š"></a>3.1 <strong>æŒ‰ç‰©ç†å½¢æ€ï¼š</strong></h5><p><strong>æœåŠ¡å™¨ï¼š</strong>æœåŠ¡å™¨å¯ä»¥ç†è§£ä¸ºæ”¾åœ¨è¿œç¨‹æœºæˆ¿çš„ç‹¬ç«‹è®¡ç®—æœºï¼Œå’Œæˆ‘ä»¬æ‰€ç”¨çš„å°å¼æœºï¼ˆæ²¡æœ‰æ˜¾ç¤ºå™¨ã€é”®å¾®ã€é¼ æ ‡ï¼‰é™¤äº†å¤–è§‚å’Œé…ç½®å¤–ï¼ŒåŠŸèƒ½ä¸Šæ²¡æœ‰å·®å¼‚ï¼Œä½ å¯ä»¥é€šè¿‡è¿œç¨‹æ§åˆ¶è‡ªå·±å®‰è£…ç³»ç»ŸåŠå…¶ä»–è½¯ä»¶ï¼ŒåŒæ—¶å¯ä»¥è§£æå’Œç»‘å®šåŸåï¼Œå¹¶é€šè¿‡åŸåæˆ–<code>IP</code>è®¿é—®æœåŠ¡å™¨ä¸Šçš„ç½‘ç«™ã€‚</p>
<p><strong>ECSæœåŠ¡å™¨ï¼š</strong>äº‘æœåŠ¡å™¨<code>(Elastic Compute Service)</code>ï¼Œé€šå¸¸ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦é€‰å®šä¸»æœºå®¹é‡ã€<code>CPU</code>èƒ½åŠ›ã€å†…å­˜å¤§å°ã€å¸¦å®½åŠè´­ä¹°æ—¶å¸¸ç­‰ï¼Œå› æ­¤ä¹Ÿç§°ä¹‹ä¸ºå¼¹æ€§è®¡ç®—æœåŠ¡å™¨ï¼Œ<code>ECS</code>åœ¨ä½¿ç”¨ä¸Šå’Œç‹¬ç«‹çš„æœåŠ¡å™¨æ²¡æœ‰åŒºåˆ«ï¼Œä¸”å¯ä»¥è®©ä¼ä¸šèŠ‚çœè‡ªè¡Œè´­ä¹°å’Œç»´æŠ¤æœåŠ¡å™¨ç¡¬ä»¶çš„æˆæœ¬ï¼Œ<code>ECS</code>å·²è¢«ä¸­å°ä¼ä¸šå¹¿æ³›ä½¿ç”¨ã€‚</p>
<p><strong>VPSæœåŠ¡å™¨ï¼š</strong>è™šæ‹Ÿä¸“ç”¨æœåŠ¡å™¨<code>(Virtual Private Server)</code>ï¼Œå³å°†ä¸€å°ç‹¬ç«‹æœåŠ¡å™¨è¿è¿‡è™šæ‹ŸæŠ€æœ¯åˆ†å‰²ä¸ºè‹¥å¹²ä¸ªè™•æ‹ŸæœåŠ¡å™¨ï¼Œæ¯ä¸ª<code>VPS</code>å¯ä»¥ç‹¬ç«‹å®‰è£…ç³»ç»Ÿï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„<code>IP</code>ï¼Œå®ç°ä¸åŒ<code>VPS</code>é—´ç£ç›˜ç©ºé—®ã€å†…å­˜ã€<code>CPU</code>èµ„æºã€è¿›ç¨‹å’Œç³»ç»Ÿé…ç½®çš„éš”å•†ï¼Œä¸ºç”¨æˆ·å’Œåº”ç”¨ç¨‹åºæ¨¡æ‹Ÿå‡ºâ€œç‹¬å â€ä½¿ç”¨è®¡ç®—èµ„æºçš„ä½“éªŒã€‚<code>VPS</code>å¯ä»¥åƒç‹¬ç«‹æœåŠ¡å™¨ä¸€æ ·ï¼Œé‡è£…æ“ä½œç³»ç»Ÿï¼Œå®‰è£ç¨‹åºï¼Œå•ç‹¬é‡å¯æœåŠ¡å™¨ï¼Œå½¢å¼ä¸Šå’Œ<code>ECS</code>æ²¡æœ‰åŒºåˆ¥ï¼Œä½†æ€»ä½“æ€§èƒ½å’Œä»˜è´¹çµæ´»æ€§ä¸å¦‚<code>ECS</code></p>
<p><strong>è™šæ‹Ÿä¸»æœºï¼š</strong>å³å°†ä¸€å°å·±å®‰è£…æ¨£ä½œç³»ç»Ÿå’Œå®‰å…¨é˜²èŒƒçš„æœåŠ¡å™¨é€šè¿‡æŠ€æœ¯æ‰‹æ®µåˆ†åˆ¶ä¸ºè‹¥åƒä¸ªç‹¬ç«‹çš„ç©ºé—´ï¼Œåˆ†é…ç»™ç”¨æˆ·ç‹¬ç«‹ä½¿ç”¨ï¼Œç”¨æˆ·åªéœ€è¦ä¸Šä¼ ç½‘ç«™ç¨‹åºï¼Œè§£æå’Œç»‘å®šåŸŸåå³å¯ä½¿ç”¨ã€‚è™šæ‹Ÿä¸»æœºä¸åŒäºæœåŠ¡å™¨ï¼Œç”¨æˆ·æ— æ³•å®‰è£…æ“ä½œç³»ç»Ÿå’Œæ“ä½œè½¯ä»¶ï¼Œåªèƒ½è¿è¡Œç½‘ç«™è„šæœ¬è¯­è¨€ã€<code>html</code>æ–‡ä»¶ã€å›¾ç‰‡åŠå…¶ä»–é™æ€æ–‡ä»¶ç­‰ã€‚è™šæ‹Ÿä¸»æœºç›¸å½“äºç€å¹²ä¸ªç”¨æˆ·ä¸€èµ·ç§Ÿç”¨ä¸€å°æœåŠ¡å™¨ï¼Œä»·æ ¼å®æƒ ï¼Œç®€å•æ˜“ç”¨ï¼Œå› æ­¤å¤§å¤šæ•°ä¼ä¸šç½‘ç«™é€‰æ‹©äº†è™šæ‹Ÿä¸»æœºï¼Œè€Œè‡ªåŠ©å»ºç«™åŠäº‘å»ºç«™ä½¿ç”¨çš„ä¹Ÿæ˜¯è™šæ‹Ÿä¸»æœºã€‚</p>
<h5 id="3-2-æŒ‰ç‰©ç†ä½ç½®ï¼š"><a href="#3-2-æŒ‰ç‰©ç†ä½ç½®ï¼š" class="headerlink" title="3.2 æŒ‰ç‰©ç†ä½ç½®ï¼š"></a>3.2 æŒ‰ç‰©ç†ä½ç½®ï¼š</h5><p><strong>å›½å†…ä¸»æœº</strong><br><strong>å›½å¤–ä¸»æœºï¼ˆç¾å›½ã€å¾·å›½ç­‰åœ°åŒºçš„ä¸»æœºï¼‰</strong><br>1ã€å¤‡æ¡ˆæ–¹è€Œï¼šå›½å†…ä¸»æœºå¿…é¡»å¤‡æ¡ˆå› å¤–ä¸»æœºä¸éœ€è¦æäº¤å¤‡æ¡ˆèµ„æ–™çš„ã€‚<br>2ã€è®¿é—®é€Ÿåº¦ï¼šå›½å†…ä¸»æœºå›½å†…è®¿é—®å¿«ï¼Œæµ·å¤–ä¸»æœºæµ·å¤–è®¿é—®å¿«ã€‚<br>3ã€çº¿è·¯ï¼šå›½å†…ä¸»æœºæœ‰çº¿è·¯é™åˆ¶ï¼Œæµ·å¤–ä¸»æœºæ²¡æœ‰ï¼Œå› å†…ä¸»æœºçº¿è·¯ä»¥è”é€šå’Œç”µä¿¡ä¸ºä¸»ï¼Œç›¸åŒçš„çº¿è·¯è®¿é—®ä¸å­˜åœ¨é€Ÿåº¦é™åˆ¶ï¼Œä½†ç›¸äº’è®¿é—®å°±æœ‰ç‚¹é—®é¢˜äº†</p>
<h3 id="4-æœåŠ¡å™¨çš„å…³é”®å‚æ•°æŒ‡æ ‡"><a href="#4-æœåŠ¡å™¨çš„å…³é”®å‚æ•°æŒ‡æ ‡" class="headerlink" title="4.æœåŠ¡å™¨çš„å…³é”®å‚æ•°æŒ‡æ ‡"></a>4.æœåŠ¡å™¨çš„å…³é”®å‚æ•°æŒ‡æ ‡</h3><h5 id="4-1-æ“ä½œç³»ç»Ÿï¼š"><a href="#4-1-æ“ä½œç³»ç»Ÿï¼š" class="headerlink" title="4.1 æ“ä½œç³»ç»Ÿï¼š"></a>4.1 æ“ä½œç³»ç»Ÿï¼š</h5><p><strong>Windows Serverï¼š</strong><br>é‡è¦ç‰ˆæœ¬<code>Windows NT Server 4.0</code>ã€ <code>Windows 2000 Server</code>ã€ <code>Windows Server 2003</code>ã€ <code>Windows Server 2003 R2</code>ã€<code>Windows Server 2008</code> ã€ <code>Windows Server 2008 R2 </code>ã€ <code>Windows Server 2012</code>ã€‚<code> Windows</code>æœåŠ¡å™¨æ“ä½œç³»ç»Ÿæ´¾åº”ç”¨ï¼Œç»“<br>åˆ<code>.NET</code>å¼€å‘ç¯å¢ƒï¼Œä¸ºå¾®è½¯ä¼ä¸šç”¨æˆ·æä¾›äº†è‰¯å¥½çš„åº”ç”¨æ¡†æ¶ã€‚<br><strong>Netwareï¼š</strong><br>åœ¨ä¸€äº›ç‰¹å®šè¡Œä¸šå’Œäº‹ä¸šå•ä½ä¸­ï¼ŒNetWareä¼˜ç§€çš„æ‰¹å¤„ç†åŠŸèƒ½å’Œå®‰å…¨ã€ç¨³å®šçš„ç³»ç»Ÿæ€§èƒ½ä¹Ÿæœ‰å¾ˆå¤§çš„ç”Ÿå­˜ç©ºé—´ã€‚NetWareå¸¸<br>ç”¨çš„ç‰ˆæœ¬æœ‰<code>Novell</code>çš„<code>3.11</code>ã€ <code>3.12</code>ã€ <code>4.10</code>ã€<code>5.0</code>ç­‰ä¸­è‹±æ–‡ç‰ˆã€‚<br><strong>Unixï¼š</strong><br><code>Unix</code>æœåŠ¡å™¨æ“ä½œç³»ç»Ÿç”±<code>AT&amp;T</code>å…¬å¸å’Œ<code>SCO</code>å…¬å¸å…±åŒæ¨å‡ºï¼Œä¸»è¦æ”¯æŒå¤§å‹çš„æ–‡ä»¶ç³»ç»ŸæœåŠ¡ã€æ•°æ®æœåŠ¡ç­‰åº”ç”¨ã€‚å¸‚é¢ä¸Šæµä¼ çš„<br>ä¸»è¦æœ‰<code>SCO SVR</code>ã€<code> BSD Unix</code>ã€ <code>SUN Solaris</code>ã€ <code>IBM-AIX</code>ã€ <code>HP-U</code>ã€ <code>FreeBSDX</code>ã€‚<br><strong>Linuxï¼š</strong><br><code>Linux</code>æ“ä½œç³»ç»Ÿè™½ç„¶ä¸<code>UNIX</code>æ“ä½œç³»ç»Ÿç±»ä¼¼ï¼Œä½†æ˜¯å®ƒä¸æ˜¯<code>UNIX</code>æ“ä½œç³»ç»Ÿçš„å˜ç§ã€‚<code>Torvald</code>ä»å¼€å§‹ç¼–å†™å†…æ ¸ä»£ç æ—¶å°±ä»¿æ•ˆ<code>UNIX</code>ï¼Œ<br>å‡ ä¹æ‰€æœ‰<code>UNIX</code>çš„å·¥å…·ä¸å¤–å£³éƒ½å¯ä»¥è¿è¡Œåœ¨<code>LINUX</code>ä¸Šã€‚(linuxç³»ç»Ÿç›¸æ¯”windowsæ›´å®‰å…¨ï¼Œè¿è¡Œæ•ˆç‡æ›´é«˜ï¼‰</p>
<h5 id="4-2-æ”¯æŒè„šæœ¬ï¼š"><a href="#4-2-æ”¯æŒè„šæœ¬ï¼š" class="headerlink" title="4.2 æ”¯æŒè„šæœ¬ï¼š"></a>4.2 æ”¯æŒè„šæœ¬ï¼š</h5><p>å³æ˜¯å¦ç½‘ç«™ç¨‹åºå¸¸è§çš„å¼€å‘è¯­è¨€ï¼Œä¸»è¦æœ‰<code>asp</code>åŠ<code>.net</code>ã€<code> php</code>ã€<code> jsp</code>, -èˆ¬éœ€è¦æ ¹æ®ç½‘ç«™ç¨‹åºæ‰€ä½¿ç”¨çš„å¼€å‘è¯­è¨€é€‰æ‹©ï¼Œæ”¯æŒçš„å¼€å‘è¯­è¨€è¶Šå°‘ä¸»æœºè¶Šå®‰å…¨å’Œé«˜æ•ˆ</p>
<h5 id="4-3-ç©ºé—´å®¹é‡ï¼š"><a href="#4-3-ç©ºé—´å®¹é‡ï¼š" class="headerlink" title="4.3 ç©ºé—´å®¹é‡ï¼š"></a><strong>4.3 ç©ºé—´å®¹é‡ï¼š</strong></h5><p>å­˜æ”¾æ–‡ä»¶çš„ç©ºé—´å¤§å°ï¼Œä¼ä¸šç½‘ç«™ä¸€èˆ¬å¯ä»¥æ ¹æ®å›¾ç‰‡å’Œè§†é¢‘æ–‡ä»¶å¤§å°æ¥é€‰æ‹©ï¼Œä»¥åŠä¸»æœºä½¿ç”¨çš„å¹´é™ï¼Œä¸€èˆ¬1-5Gå°±å¤Ÿç”¨äº†</p>
<h5 id="4-4ä¸»æœºå¸¦å®½ï¼š"><a href="#4-4ä¸»æœºå¸¦å®½ï¼š" class="headerlink" title="4.4ä¸»æœºå¸¦å®½ï¼š"></a><strong>4.4ä¸»æœºå¸¦å®½ï¼š</strong></h5><p>ä¸»æœºæ”¯æŒçš„æœ€å¤§ä¸‹è¡Œè®¿é—®é€Ÿåº¦ï¼Œå³ç›´æ¥å½±å“ç½‘ç«™è®¿é—®é€Ÿåº¦ï¼Œä½†è™šæ‹Ÿä¸»æœºå¹¶ä¸æ˜¯å¸¦å®½è¶Šå¤§è®¿é—®å°±ä¼šè¶Šå¿«ï¼Œè¿˜éœ€è¦è€ƒè™‘åŒä¸€å°æœåŠ¡å™¨ä¸Šæœ‰å¤šå°‘ä¸ªç½‘ç«™å’Œå…¶ä»–ç½‘ç«™æ˜¯å¦ä¼šæ¶ˆè€—å¸¦å®½èµ„æºã€‚</p>
<h5 id="4-5-è®¿é—®æµé‡ï¼š"><a href="#4-5-è®¿é—®æµé‡ï¼š" class="headerlink" title="4.5 è®¿é—®æµé‡ï¼š"></a>4.5 è®¿é—®æµé‡ï¼š</h5><p>å½“ä¸€å°æœåŠ¡å™¨åˆ†å‰²çš„è™šæ‹Ÿä¸»æœºè¶…è¿‡ä¸€å®šæ•°é‡ï¼ˆå¦‚100ï¼Œå¾ˆå¤šä¸»æœºå•†ä¸€å°æœåŠ¡å™¨æ”¾ç½®äº†æ•°ç™¾ä¸ªè™šæ‹Ÿä¸»æœºï¼‰æ—¶ï¼Œä¸ºäº†é™åˆ¶å› æŸä¸ªè™šæ‹Ÿä¸»æœºçš„ç½‘ç«™å¤§é‡æ¶ˆè€—è®¿é—®å¸¦å®½ï¼ˆæµé‡ï¼‰èµ„æºï¼Œä¸»æœºæä¾›å•†ä¸å¾—ä¸åœ¨æˆæœ¬å’Œå¤§å¤šæ•°ç”¨æˆ·çš„è®¿é—®é€Ÿåº¦ä¸­æ‰¾ä¸€ä¸ªå¹³è¡¡ç‚¹ï¼Œæ‰€ä»¥å°±ä½¿ç”¨äº†é™åˆ¶è®¿é—®æµé‡è¿™ä¸ªæŒ‡æ ‡ã€‚è€Œå¯¹äºç”¨æˆ·æ¥è¯´ï¼Œå½“ç„¶æ˜¯ä¸é™åˆ¶æµé‡æ‰æ²¡æœ‰åé¡¾ä¹‹å¿§ã€‚</p>
<h5 id="4-6-å¹¶å‘é‡ï¼š"><a href="#4-6-å¹¶å‘é‡ï¼š" class="headerlink" title="4.6 å¹¶å‘é‡ï¼š"></a>4.6 å¹¶å‘é‡ï¼š</h5><p>å³åŒä¸€æ—¶åˆ»è¯·æ±‚è®¿é—®ç½‘ç«™çš„ç”¨æˆ·æ•°é‡ï¼Œè™šæ‹Ÿä¸»æœºæä¾›å•†ä¸ºå°½å¯èƒ½ä¿éšœæ¯ä¸ªè™šæ‹Ÿä¸»æœºç”¨æˆ·çš„ç½‘ç«™ç¨³å®šå’Œå…¬å¹³æ€§ï¼Œä¸å¾—å·±è®¾ç½®äº†å¹¶å‘é‡å‚æ•°ï¼Œä»è€Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¡®ä¿ä¸€å°æœåŠ¡å™¨ä¸Šçš„å…¶ä»–è™šæ‹Ÿä¸»æœºèƒ½ç¨³å®šçš„è®¿é—®ã€‚å¯¹äºå°å‹ç½‘ç«™æ¥è¯´ï¼ŒåŒä¸€æ—¶åˆ»åœ¨çº¿å¹¶åŠ¨æ€è¯·æ±‚çš„ç”¨æˆ·æ•°é‡å¹¶ä¸ä¼šå¤ªå¤§ï¼Œå› æ­¤ä¸€èˆ¬çš„ç”¨æˆ·æ„Ÿè§‰ä¸å‡ºæ¥è‡ªå·±çš„ç½‘ç«™è®¿é—®å—é™ã€‚</p>
<h5 id="4-7-CPUå’Œå†…å­˜ï¼š"><a href="#4-7-CPUå’Œå†…å­˜ï¼š" class="headerlink" title="4.7 CPUå’Œå†…å­˜ï¼š"></a>4.7 CPUå’Œå†…å­˜ï¼š</h5><p>å’Œæ™®é€šç”µè„‘ä¸€æ ·ï¼Œä»£è¡¨æœåŠ¡å™¨çš„è¿è¡Œè®¡ç®—èƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯å¯¹ç½‘ç«™ç¨‹åºçš„å“åº”é€Ÿåº¦å’Œæ•ˆç‡ï¼Œå¦‚æœåœ¨ä¸è€ƒè™‘æˆæœ¬çš„æƒ…å†µä¸‹ï¼Œå½“ç„¶æ˜¯CPUå¤šæ ¸ã€å†…å­˜è¶Šå¤§æ€§èƒ½è¶Šé«˜ï¼Œä½†ä¼ä¸šç½‘ç«™çš„æ•°æ®é‡æ˜¯æœ‰é™çš„ï¼Œä¸€èˆ¬åŒæ ¸ã€4Gå°±å¯ä»¥æ»¡è¶³åŸºæœ¬ä½¿ç”¨ã€‚</p>
<h5 id="4-8-æœåŠ¡å™¨ipç±»å‹ï¼šç‹¬ç«‹ipå’Œå…±äº«ipï¼š"><a href="#4-8-æœåŠ¡å™¨ipç±»å‹ï¼šç‹¬ç«‹ipå’Œå…±äº«ipï¼š" class="headerlink" title="4.8 æœåŠ¡å™¨ipç±»å‹ï¼šç‹¬ç«‹ipå’Œå…±äº«ipï¼š"></a>4.8 æœåŠ¡å™¨ipç±»å‹ï¼šç‹¬ç«‹ipå’Œå…±äº«ipï¼š</h5><p>é¦–å…ˆï¼Œä¸¤è€…çš„æ¦‚å¿µä¸ä¸€æ ·ï¼Œç‹¬ç«‹<code>IP</code>æ˜¯æŒ‡ä¸€ä¸ªæœåŠ¡å™¨æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„<code>IP</code>åœ°å€ï¼Œå…±äº«<code>IP</code>æ˜¯æŒ‡å¤šä¸ªæœåŠ¡å™¨å…±ç”¨ä¸€ä¸ªå…¬ç½‘IPåœ°å€ï¼Œ<br>ç¾¤è‹±æŠŠä¸¤è€…çš„ä¼˜ç¼ºç‚¹ç®€å•æ¦‚è¿°å¦‚ä¸‹å‡ ç‚¹ï¼š<br>1.ä»·æ ¼æ–¹é¢ï¼šå…±äº«<code>IP</code>è¦æ¯”ç‹¬ç«‹<code>IP</code>ä¾¿å®œ.<br>2.é£é™©é—®é¢˜ï¼šå…±äº«<code>IP</code>æ˜“å—åˆ°å¤–æ¥ç½‘ç»œæ”»å‡»ï¼Œä¸”å…¶ä¸­ä¸€ä¸ªç½‘ç«™å‡ºç°é—®é¢˜å°±ä¼šæ³¢åŠå…¶ä»–ç«™ç‚¹ï¼Œè€Œç‹¬ç«‹<code>IP</code>å°±ä¸ä¼šå—åˆ°è¿™ç§è¿å¸¦çš„<br>æ³¢åŠé—®é¢˜.<br>3.æ”¶æ°¸å½±å“ï¼šç‹¬ç«‹<code>IP</code>æ›´æœ‰åˆ©äºè¢«æœç´ å¼•æ“æ”¶å½•ï¼Œæƒé‡æ›´é«˜.<br>4.åŸåç»‘å®šåŒºåˆ«ï¼šç‹¬ç«‹<code>IP</code>å¯ä»¥å®ç°æ³›åŸŸåç»‘å®šï¼Œè€Œå…±äº«<code>IP</code>æ— æ³•å®ç°æ³›åŸŸåç»‘å®š.<br>5.èƒ½é¦™ç›´æ¥ä½¿ç”¨<code>IP</code>è®¿é—®ï¼šç‹¬ç«‹IPå¯ä»¥ç›´æ¥ä½¿ç”¨<code>IP</code>è®¿é—®ï¼Œå…±äº«<code>IP</code>ä¸èƒ½ï¼Œè‹¥è®¿é—®å°±ä¼šæ”¶åˆ°æŠ¥é”™çš„æç¤ºã€‚</p>
<h5 id="4-9-æ‰©å±•æ€§èƒ½ï¼š"><a href="#4-9-æ‰©å±•æ€§èƒ½ï¼š" class="headerlink" title="4.9 æ‰©å±•æ€§èƒ½ï¼š"></a>4.9 æ‰©å±•æ€§èƒ½ï¼š</h5><p>æ”¯æŒè¯­è¨€ï¼Œæ˜¯å¦æ”¯æŒä¼ªé™æ€ã€å­—ä½“</p>
<h3 id="5-ç®¡ç†æœåŠ¡å™¨"><a href="#5-ç®¡ç†æœåŠ¡å™¨" class="headerlink" title="5. ç®¡ç†æœåŠ¡å™¨"></a>5. ç®¡ç†æœåŠ¡å™¨</h3><h5 id="5-1-FTPæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#5-1-FTPæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5.1 FTPæ˜¯ä»€ä¹ˆï¼Ÿ"></a>5.1 <strong>FTPæ˜¯ä»€ä¹ˆï¼Ÿ</strong></h5><blockquote>
<p><code>FTP</code> <code>(File Transfer Protocol</code>ï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯ <code>TCPAP</code> åè®®ç»„ä¸­çš„åè®®ä¹‹ä¸€ã€‚<code>FTP</code>åè®®åŒ…æ‹¬ä¸¤ä¸ªç»„æˆéƒ¨åˆ†ï¼Œå…¶ä¸€ä¸º<br><code>FTP</code>æœåŠ¡å™¨ï¼Œå…¶äºŒä¸º<code>FTP</code>å®¢æˆ·ç«¯ã€‚<br>ä½œç”¨:<br>å¯¹äºå®¢æˆ·ç«¯ï¼šæ˜¯ä¸ºäº†å®¢æˆ·ç«¯é“¾æ¥ä¸»æœºæ¥ç®¡ç†è‡ªå·±çš„ä¸»æœºæ–‡ä»¶<br>å¯¹äºä¸»æœºå•†ï¼šå¯ä»¥ç”¨<code>FTP</code>å¯ä»¥ç”¨æ¥å®ç°é™åˆ¶ä¸åŒè™šæ‹Ÿä¸»æœºåˆ†é…ç»™ç”¨æˆ·å¯¹æœåŠ¡å™¨çš„ç®¡ç†æƒé™</p>
</blockquote>
<h5 id="5-2-FTPé“¾æ¥æ¨¡å¼ï¼š"><a href="#5-2-FTPé“¾æ¥æ¨¡å¼ï¼š" class="headerlink" title="5.2 FTPé“¾æ¥æ¨¡å¼ï¼š"></a>5.2 FTPé“¾æ¥æ¨¡å¼ï¼š</h5><p>ä¸»åŠ¨æ¨¡å¼ï¼ˆ<code>port</code>æ¨¡å¼ï¼‰<br>å®¢æˆ·ç«¯å‘é€æ§åˆ¶é“¾æ¥åˆ°æœåŠ¡å™¨çš„<code>FTP</code>å¢™å£ï¼Œä¸€èˆ¬æ˜¯é»˜è®¤è®¾ç½®ä¸º<code>21</code>ï¼Œç„¶åæœåŠ¡å™¨çš„æ•°æ®ç«¯å£ä¸»åŠ¨å»è¿æ¥ç”¨æˆ·çš„å®¢æˆ·è ²<code>n+1</code>çš„æ•°æ®ç«¯å£<br>è¢«åŠ¨æ¨¡å¼ï¼ˆ <code>passive</code>æ¨¡å¼ï¼‰<br>å®¢æˆ·ç«¯å‘é€æ§åˆ¶é“¾æ¥åˆ°æœåŠ¡å™¨çš„<code>FTP</code>ç«¯å£ï¼Œä¸€èˆ¬æ˜¯é»˜è®¤è®¾ç½®ä¸º<code>21</code>ï¼Œå®¢æœèº…çš„æ•°æ®ç«¯å£<code>n+1</code>ç«¯å£ï¼Œä¸»åŠ¨é“¾æ¥çš„æœåŠ¡å™¨çš„æ•°æ®<code>20</code>ç«¯å£</p>
]]></content>
      <categories>
        <category>Linux</category>
        <category>è¿ç»´</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>C# windows ç¯å¢ƒæ­å»º</title>
    <url>/2022/10/02/C-windows-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    <content><![CDATA[<blockquote>
<p>æ³¨ï¼šæœ¬æ¬¡å­¦ä¹ å¼€å‘ä½¿ç”¨çš„è½¯ä»¶<code>jetbrians Rider</code></p>
</blockquote>
<h3 id="C-è¯­è¨€ï¼Œå…¶å®ä¹Ÿå«åš-netè¯­è¨€ï¼Œæ‰€æœ‰æˆ‘ä»¬å‡†å¤‡å¿…è¦çš„å¼€å‘ç¯å¢ƒï¼Œä¸‹è½½é“¾æ¥-https-dotnet-microsoft-com-zh-cn-download"><a href="#C-è¯­è¨€ï¼Œå…¶å®ä¹Ÿå«åš-netè¯­è¨€ï¼Œæ‰€æœ‰æˆ‘ä»¬å‡†å¤‡å¿…è¦çš„å¼€å‘ç¯å¢ƒï¼Œä¸‹è½½é“¾æ¥-https-dotnet-microsoft-com-zh-cn-download" class="headerlink" title="C# è¯­è¨€ï¼Œå…¶å®ä¹Ÿå«åš.netè¯­è¨€ï¼Œæ‰€æœ‰æˆ‘ä»¬å‡†å¤‡å¿…è¦çš„å¼€å‘ç¯å¢ƒï¼Œä¸‹è½½é“¾æ¥: https://dotnet.microsoft.com/zh-cn/download"></a>C# è¯­è¨€ï¼Œå…¶å®ä¹Ÿå«åš.netè¯­è¨€ï¼Œæ‰€æœ‰æˆ‘ä»¬å‡†å¤‡å¿…è¦çš„å¼€å‘ç¯å¢ƒï¼Œä¸‹è½½é“¾æ¥: <a href="https://dotnet.microsoft.com/zh-cn/download">https://dotnet.microsoft.com/zh-cn/download</a></h3><span id="more"></span>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211120647988.png" alt="image-20221112064702881"></p>
<h3 id="ä¸Šé¢ä¸¤è€…è½¯ä»¶éƒ½å¯ä»¥ï¼Œæ›´æ¨èé•¿æœŸç‰ˆæœ¬ï¼Œå…¼å®¹æ€§æ¯”è¾ƒå¥½ã€‚"><a href="#ä¸Šé¢ä¸¤è€…è½¯ä»¶éƒ½å¯ä»¥ï¼Œæ›´æ¨èé•¿æœŸç‰ˆæœ¬ï¼Œå…¼å®¹æ€§æ¯”è¾ƒå¥½ã€‚" class="headerlink" title="ä¸Šé¢ä¸¤è€…è½¯ä»¶éƒ½å¯ä»¥ï¼Œæ›´æ¨èé•¿æœŸç‰ˆæœ¬ï¼Œå…¼å®¹æ€§æ¯”è¾ƒå¥½ã€‚"></a>ä¸Šé¢ä¸¤è€…è½¯ä»¶éƒ½å¯ä»¥ï¼Œæ›´æ¨èé•¿æœŸç‰ˆæœ¬ï¼Œå…¼å®¹æ€§æ¯”è¾ƒå¥½ã€‚</h3><h3 id="ä¸‹è½½å®Œæˆä»¥ååŒå‡»å®‰è£…å³å¯ï¼š"><a href="#ä¸‹è½½å®Œæˆä»¥ååŒå‡»å®‰è£…å³å¯ï¼š" class="headerlink" title="ä¸‹è½½å®Œæˆä»¥ååŒå‡»å®‰è£…å³å¯ï¼š"></a>ä¸‹è½½å®Œæˆä»¥ååŒå‡»å®‰è£…å³å¯ï¼š</h3><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211120649963.png" alt="image-20221112064939901"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211120648869.png" alt="image-20221112064846821"></p>
<h3 id="å½“è¿›åº¦æ¡èµ°å®Œæ—¶ï¼Œä»£è¡¨å·²ç»å®‰è£…æˆåŠŸã€‚"><a href="#å½“è¿›åº¦æ¡èµ°å®Œæ—¶ï¼Œä»£è¡¨å·²ç»å®‰è£…æˆåŠŸã€‚" class="headerlink" title="å½“è¿›åº¦æ¡èµ°å®Œæ—¶ï¼Œä»£è¡¨å·²ç»å®‰è£…æˆåŠŸã€‚"></a>å½“è¿›åº¦æ¡èµ°å®Œæ—¶ï¼Œä»£è¡¨å·²ç»å®‰è£…æˆåŠŸã€‚</h3><p>å®‰è£…æˆåŠŸ</p>
<h3 id="éªŒè¯è‡ªå·±æœ‰æ²¡æœ‰å®‰è£…æˆåŠŸï¼Œåœ¨cmdä¸­ï¼Œè¾“å…¥å‘½ä»¤"><a href="#éªŒè¯è‡ªå·±æœ‰æ²¡æœ‰å®‰è£…æˆåŠŸï¼Œåœ¨cmdä¸­ï¼Œè¾“å…¥å‘½ä»¤" class="headerlink" title="éªŒè¯è‡ªå·±æœ‰æ²¡æœ‰å®‰è£…æˆåŠŸï¼Œåœ¨cmdä¸­ï¼Œè¾“å…¥å‘½ä»¤"></a>éªŒè¯è‡ªå·±æœ‰æ²¡æœ‰å®‰è£…æˆåŠŸï¼Œåœ¨<code>cmd</code>ä¸­ï¼Œè¾“å…¥å‘½ä»¤</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dotnet --list-sdks</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211120809434.png" alt="image-20221112080948275"></p>
<h3 id="å‡ºç°è¿™ä¸ªå³ä»£è¡¨å®‰è£…æˆåŠŸï¼Œç¯å¢ƒæ­å»ºå®Œæˆã€‚"><a href="#å‡ºç°è¿™ä¸ªå³ä»£è¡¨å®‰è£…æˆåŠŸï¼Œç¯å¢ƒæ­å»ºå®Œæˆã€‚" class="headerlink" title="å‡ºç°è¿™ä¸ªå³ä»£è¡¨å®‰è£…æˆåŠŸï¼Œç¯å¢ƒæ­å»ºå®Œæˆã€‚"></a>å‡ºç°è¿™ä¸ªå³ä»£è¡¨å®‰è£…æˆåŠŸï¼Œç¯å¢ƒæ­å»ºå®Œæˆã€‚</h3><p><strong>ç„¶åå®‰è£… <code>Jerbetbrians Rider</code></strong></p>
<p><strong>å®˜ç½‘ä¸‹è½½ï¼š</strong><a href="https://www.jetbrains.com/rider/">https://www.jetbrains.com/rider/</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211120814198.png" alt="image-20221112081423053"></p>
<p><strong>ä¸‹è½½ä»¥ååŒå‡»ï¼š</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211131101754.png" alt="image-20221113110130585"></p>
<p><strong>å½“å‡ºç°è¿™ä¸ªç•Œé¢çš„æ—¶å€™ï¼Œå³è½¯ä»¶ä»£è¡¨å®‰è£…æˆåŠŸï¼</strong></p>
<p><strong>ç„¶åå°±æ˜¯æ–°å»ºé¡¹ç›®</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211131104971.png" alt="image-20221113110407910"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211131104951.png" alt="image-20221113110443839"></p>
<p><strong>è¿è¡Œï¼š</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211131106148.png" alt="image-20221113110613050"></p>
<p><strong>è¿è¡Œç»“æœ<code>Hello, Worldï¼</code></strong></p>
<p><strong>ç¯å¢ƒæ­å»ºç»“æŸ</strong></p>
]]></content>
      <categories>
        <category>C#</category>
      </categories>
      <tags>
        <tag>åç«¯</tag>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis</title>
    <url>/2022/07/05/Redis/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238373.jfif" alt="1586740065742"></p>
<span id="more"></span>


<p>[TOC]</p>
<h3 id="ä¸€ã€å¼•è¨€"><a href="#ä¸€ã€å¼•è¨€" class="headerlink" title="ä¸€ã€å¼•è¨€"></a>ä¸€ã€å¼•è¨€</h3><hr>
<h4 id="1-1-æ•°æ®åº“å‹åŠ›è¿‡å¤§"><a href="#1-1-æ•°æ®åº“å‹åŠ›è¿‡å¤§" class="headerlink" title="1.1 æ•°æ®åº“å‹åŠ›è¿‡å¤§"></a>1.1 æ•°æ®åº“å‹åŠ›è¿‡å¤§</h4><blockquote>
<p>ç”±äºç”¨æˆ·é‡å¢å¤§ï¼Œè¯·æ±‚æ•°é‡ä¹Ÿéšä¹‹å¢å¤§ï¼Œæ•°æ®å‹åŠ›è¿‡å¤§</p>
</blockquote>
<h4 id="1-2-æ•°æ®ä¸åŒæ­¥"><a href="#1-2-æ•°æ®ä¸åŒæ­¥" class="headerlink" title="1.2 æ•°æ®ä¸åŒæ­¥"></a>1.2 æ•°æ®ä¸åŒæ­¥</h4><blockquote>
<p>å¤šå°æœåŠ¡å™¨ä¹‹é—´ï¼Œæ•°æ®ä¸åŒæ­¥</p>
</blockquote>
<h4 id="1-3-ä¼ ç»Ÿé”å¤±æ•ˆ"><a href="#1-3-ä¼ ç»Ÿé”å¤±æ•ˆ" class="headerlink" title="1.3 ä¼ ç»Ÿé”å¤±æ•ˆ"></a>1.3 ä¼ ç»Ÿé”å¤±æ•ˆ</h4><blockquote>
<p>å¤šå°æœåŠ¡å™¨ä¹‹é—´çš„é”ï¼Œå·²ç»ä¸å­˜åœ¨äº’æ–¥æ€§äº†ã€‚</p>
</blockquote>
<h3 id="äºŒã€Redisä»‹ç»"><a href="#äºŒã€Redisä»‹ç»" class="headerlink" title="äºŒã€Redisä»‹ç»"></a>äºŒã€Redisä»‹ç»</h3><hr>
<h4 id="2-1-å…³äºå…³ç³»å‹æ•°æ®åº“å’ŒNOSQLæ•°æ®åº“ï¼ˆé”®å€¼å¯¹å­˜å‚¨ï¼‰"><a href="#2-1-å…³äºå…³ç³»å‹æ•°æ®åº“å’ŒNOSQLæ•°æ®åº“ï¼ˆé”®å€¼å¯¹å­˜å‚¨ï¼‰" class="headerlink" title="2.1 å…³äºå…³ç³»å‹æ•°æ®åº“å’ŒNOSQLæ•°æ®åº“ï¼ˆé”®å€¼å¯¹å­˜å‚¨ï¼‰"></a>2.1 å…³äºå…³ç³»å‹æ•°æ®åº“å’ŒNOSQLæ•°æ®åº“ï¼ˆé”®å€¼å¯¹å­˜å‚¨ï¼‰</h4><blockquote>
<p>å…³ç³»å‹æ•°æ®åº“æ˜¯åŸºäºå…³ç³»è¡¨çš„æ•°æ®åº“ï¼Œæœ€ç»ˆä¼šå°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šï¼Œè€Œnosqlæ•°æ®åº“æ˜¯åŸºäºç‰¹æ®Šçš„ç»“æ„ï¼Œå¹¶å°†æ•°æ®å­˜å‚¨åˆ°å†…å­˜çš„æ•°æ®åº“ã€‚ä»æ€§èƒ½ä¸Šè€Œè¨€ï¼Œnosqlæ•°æ®åº“è¦ä¼˜äºå…³ç³»å‹æ•°æ®åº“ï¼Œä»å®‰å…¨æ€§ä¸Šè€Œè¨€å…³ç³»å‹æ•°æ®åº“è¦ä¼˜äºnosqlæ•°æ®åº“ï¼Œæ‰€ä»¥åœ¨å®é™…å¼€å‘ä¸­ä¸€ä¸ªé¡¹ç›®ä¸­nosqlå’Œå…³ç³»å‹æ•°æ®åº“ä¼šä¸€èµ·ä½¿ç”¨ï¼Œè¾¾åˆ°æ€§èƒ½å’Œå®‰å…¨æ€§çš„åŒä¿è¯ã€‚</p>
<p>NOSQLäº§å“: redisï¼Œmongodbï¼Œmemcachedâ€¦</p>
</blockquote>
<blockquote>
<ul>
<li>Rediså°±æ˜¯ä¸€æ¬¾NoSQL</li>
<li>NoSQL -&gt; éå…³ç³»å‹æ•°æ®åº“ -&gt; Not Only SQLã€‚</li>
<li>Key-Valueï¼šRedis â€¦</li>
<li>æ–‡æ¡£å‹ï¼šElasticSearchï¼ŒSolrï¼ŒMongodb â€¦</li>
<li>é¢å‘åˆ—ï¼šHbaseï¼ŒCassandra â€¦</li>
<li>å›¾å½¢åŒ–ï¼šNeo4j â€¦</li>
<li>é™¤äº†å…³ç³»å‹æ•°æ®åº“éƒ½æ˜¯éå…³ç³»å‹æ•°æ®åº“</li>
<li>NoSQLåªæ˜¯ä¸€ç§æ¦‚å¿µï¼Œæ³›æŒ‡éå…³ç³»å‹æ•°æ®åº“ï¼Œå’Œå…³ç³»å‹æ•°æ®åº“åšä¸€ä¸ªåŒºåˆ†</li>
</ul>
</blockquote>
<!--more-->
<h4 id="2-2-Redisä»‹ç»"><a href="#2-2-Redisä»‹ç»" class="headerlink" title="2.2 Redisä»‹ç»"></a>2.2 Redisä»‹ç»</h4><blockquote>
<ul>
<li><p>æœ‰ä¸€ä½æ„å¤§åˆ©äººï¼Œåœ¨å¼€å‘ä¸€æ¬¾LLOOGGçš„ç»Ÿè®¡é¡µé¢ï¼Œå› ä¸ºMySQLçš„æ€§èƒ½ä¸å¥½ï¼Œè‡ªå·±ç ”å‘äº†ä¸€æ¬¾éå…³ç³»å‹æ•°æ®åº“ï¼Œå¹¶å‘½åä¸ºRedisã€‚Salvatoreã€‚</p>
</li>
<li><p>Redisï¼ˆRemote Dictionary Serverï¼‰å³è¿œç¨‹å­—å…¸æœåŠ¡ï¼ŒRedisæ˜¯ç”±Cè¯­è¨€å»ç¼–å†™ï¼ŒRedisæ˜¯ä¸€æ¬¾åŸºäºKey-Valueçš„NoSQLï¼Œè€Œä¸”Redisæ˜¯åŸºäºå†…å­˜å­˜å‚¨æ•°æ®çš„ï¼ŒRedisè¿˜æä¾›äº†å¤šç§æŒä¹…åŒ–æœºåˆ¶ï¼Œæ€§èƒ½å¯ä»¥è¾¾åˆ°110000&#x2F;sè¯»å–æ•°æ®ä»¥åŠ81000&#x2F;så†™å…¥æ•°æ®ï¼ŒRedisè¿˜æä¾›äº†ä¸»ä»ï¼Œå“¨å…µä»¥åŠé›†ç¾¤çš„æ­å»ºæ–¹å¼ï¼Œå¯ä»¥æ›´æ–¹ä¾¿çš„æ¨ªå‘æ‰©å±•ä»¥åŠå‚ç›´æ‰©å±•ã€‚</p>
</li>
</ul>
</blockquote>
<table>
<thead>
<tr>
<th align="center">Redisä¹‹çˆ¶</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238413.png" alt="1586747559955"></td>
</tr>
</tbody></table>
<h3 id="ä¸‰ã€Rediså®‰è£…"><a href="#ä¸‰ã€Rediså®‰è£…" class="headerlink" title="ä¸‰ã€Rediså®‰è£…"></a>ä¸‰ã€Rediså®‰è£…</h3><hr>
<h4 id="3-1-å®‰è£…Redis"><a href="#3-1-å®‰è£…Redis" class="headerlink" title="3.1 å®‰è£…Redis"></a>3.1 å®‰è£…Redis</h4><blockquote>
<p>å®˜ç½‘ï¼š<a href="https://redis.io/">https://redis.io</a></p>
<p>ä¸‹è½½ï¼š<a href="http://download.redis.io/releases">http://download.redis.io/releases</a></p>
<p>ä¸­æ–‡ç½‘ï¼š<a href="https://www.redis.net.cn/">https://www.redis.net.cn/</a></p>
</blockquote>
<blockquote>
<p>å®˜ç½‘æä¾›å®‰è£…æ–¹å¼å¦‚ä¸‹ï¼šï¼ˆå®‰è£…redisç¼–è¯‘çš„cç¯å¢ƒï¼Œæ­¤æ­¥éª¤æ²¡æœ‰ç¼–è¯‘ï¼‰</p>
<p>Installation</p>
<p>Download, extract and compile Redis with:</p>
<p>$ wget &lt;<a href="http://download.redis.io/releases/redis-5.0.5.tar.gz">http://download.redis.io/releases/redis-5.0.5.tar.gz</a> &gt;</p>
<p>$ tar xzf redis-5.0.5.tar.gz $ cd redis-5.0.5</p>
<p>$ make</p>
<p>The binaries that are now compiled are available in the src directory. Run Redis with:</p>
<p>$ src&#x2F;redis-server</p>
<p>You can interact with Redis using the built-in client:</p>
<p>$ src&#x2F;redis-cli</p>
<p>redis&gt; set foo bar</p>
<p>OK</p>
<p>redis&gt; get foo</p>
<p>â€œbarâ€</p>
</blockquote>
<h4 id="3-3-å®‰è£…æ­¥éª¤"><a href="#3-3-å®‰è£…æ­¥éª¤" class="headerlink" title="3.3 å®‰è£…æ­¥éª¤"></a>3.3 å®‰è£…æ­¥éª¤</h4><blockquote>
<p>1.æŠŠä¸‹è½½å¥½çš„redis-6.2.6.tar.gzå®‰è£…åŒ…æ‹·è´åˆ°å½“å‰è™šæ‹Ÿæœºrootç›®å½•ä¸‹ï¼Œè§£å‹åˆ°&#x2F;usr&#x2F;localä¸‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]# tar -zxvf redis-6.2.6.tar.gz -C /usr/local</span><br></pre></td></tr></table></figure>



<p>2.ç¼–è¯‘çš„cç¯å¢ƒï¼Œæ³¨ï¼šå®‰è£…æ—¶å¦‚æœæ˜¾ç¤ºyumæ­£åœ¨è¿è¡Œï¼Œéœ€è¦å…ˆå°†yumè¿›ç¨‹killåå†æ‰§è¡Œè¯¥å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]# yum install gcc-c++</span><br></pre></td></tr></table></figure>



<p>3.è¿›å…¥redis-6.2.6ç›®å½• ä½¿ç”¨makeå‘½ä»¤ç¼–è¯‘redisï¼ˆè‹¥æŠ¥é”™ï¼Œå…ˆmake distcleanï¼Œå†makeï¼‰</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost redis-6.2.6]# make</span><br></pre></td></tr></table></figure>



<p>4.ä½¿ç”¨make PREFIX&#x3D;&#x2F;usr&#x2F;local&#x2F;redis-6.2.6 installå‘½ä»¤å®‰è£…ï¼ˆå®‰è£…åä¼šå‡ºç°binç›®å½•ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost redis-6.2.6]# make PREFIX=/usr/local/redis-6.2.6 install</span><br></pre></td></tr></table></figure>



<p>5.å¯åŠ¨redisæœåŠ¡ç«¯ï¼ˆå‰å°å¯åŠ¨ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost redis-6.2.6]# cd bin</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-server </span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238861.png"></p>
<p>å¯åŠ¨åçœ‹åˆ°å¦‚ä¸Šæ¬¢è¿é¡µé¢ï¼Œä½†æ­¤çª—å£ä¸èƒ½å…³é—­ï¼Œçª—å£å…³é—­å°±è®¤ä¸ºredisä¹Ÿå…³é—­äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨åå°å¯åŠ¨ï¼Œç„¶åå†å¯åŠ¨å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥ï¼Œæ‰€ä»¥é¦–å…ˆCtrl+Cé€€å‡ºã€‚</p>
<p>è§£å†³ï¼šå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶é…ç½®redisçš„åå°å¯åŠ¨ï¼ˆå³æœåŠ¡å™¨å¯åŠ¨äº†ä½†ä¸ä¼šåˆ›å»ºæ§åˆ¶å°çª—å£ï¼‰</p>
<p>æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p>1.åˆ‡æ¢åˆ°redis-6.2.6ç›®å½•ä¸‹ï¼ŒæŠŠå½“å‰ç›®å½•ä¸‹çš„redis.confæ–‡ä»¶æ‹·è´åˆ°binç›®å½•ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# cd ../</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost redis-6.2.6]# cp redis.conf bin/redis.conf</span><br></pre></td></tr></table></figure>



<p>2.åˆ‡æ¢åˆ°binç›®å½•ä¸‹ï¼Œä¿®æ”¹redis.confæ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost redis-6.2.6]# cd bin</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# vim redis.conf </span><br></pre></td></tr></table></figure>



<p>3.å°†redis.confæ–‡ä»¶ä¸­çš„daemonizeçš„å€¼ä»noä¿®æ”¹æˆyesè¡¨ç¤ºåå°å¯åŠ¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238640.png"></p>
<p>4.å¯åŠ¨redisæœåŠ¡ç«¯ï¼ˆåå°å¯åŠ¨ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-server redis.conf</span><br></pre></td></tr></table></figure>



<p>5.æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# ps -ef | grep redis</span><br></pre></td></tr></table></figure>



<p>6.å¯åŠ¨å®¢æˆ·ç«¯</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-cli</span><br></pre></td></tr></table></figure>



<p>7.å­˜å–æ•°æ®è¿›è¡Œæµ‹è¯•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set name jack</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line">&quot;jack&quot;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="3-4-Redisçš„é…ç½®æ–‡ä»¶"><a href="#3-4-Redisçš„é…ç½®æ–‡ä»¶" class="headerlink" title="3.4 Redisçš„é…ç½®æ–‡ä»¶"></a>3.4 Redisçš„é…ç½®æ–‡ä»¶</h4><table>
<thead>
<tr>
<th>é…ç½®é¡¹åç§°</th>
<th>é…ç½®é¡¹å€¼èŒƒå›´</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>daemonize</td>
<td>yesã€no</td>
<td>yesè¡¨ç¤ºå¯ç”¨å®ˆæŠ¤è¿›ç¨‹ï¼Œé»˜è®¤æ˜¯noå³ä¸ä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œã€‚å…¶ä¸­Windowsç³»ç»Ÿä¸‹ä¸æ”¯æŒå¯ç”¨å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œ</td>
</tr>
<tr>
<td>port</td>
<td></td>
<td>æŒ‡å®š Redis ç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º 6379</td>
</tr>
<tr>
<td>bind</td>
<td></td>
<td>ç»‘å®šçš„ä¸»æœºåœ°å€,å¦‚æœéœ€è¦è®¾ç½®è¿œç¨‹è®¿é—®åˆ™ç›´æ¥å°†è¿™ä¸ªå±æ€§å¤‡æ³¨ä¸‹æˆ–è€…æ”¹ä¸ºbind * å³å¯,è¿™ä¸ªå±æ€§å’Œä¸‹é¢çš„protected-modeæ§åˆ¶äº†æ˜¯å¦å¯ä»¥è¿œç¨‹è®¿é—® ã€‚</td>
</tr>
<tr>
<td>protected-mode</td>
<td>yes ã€no</td>
<td>é»˜è®¤æ˜¯yesï¼Œå³å¼€å¯ã€‚è®¾ç½®å¤–éƒ¨ç½‘ç»œè¿æ¥redisæœåŠ¡ï¼Œè®¾ç½®æ–¹å¼å¦‚ä¸‹ï¼š1ã€å…³é—­protected-modeæ¨¡å¼ï¼Œæ­¤æ—¶å¤–éƒ¨ç½‘ç»œå¯ä»¥ç›´æ¥è®¿é—®2ã€å¼€å¯protected-modeä¿æŠ¤æ¨¡å¼ï¼Œéœ€é…ç½®bind ipæˆ–è€…è®¾ç½®è®¿é—®å¯†ç </td>
</tr>
<tr>
<td>timeout</td>
<td>300</td>
<td>å½“å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åå…³é—­è¿æ¥ï¼Œå¦‚æœæŒ‡å®šä¸º 0ï¼Œè¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½</td>
</tr>
<tr>
<td>loglevel</td>
<td>debugã€verboseã€noticeã€warning</td>
<td>æ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤ä¸º notice</td>
</tr>
<tr>
<td>databases</td>
<td>16</td>
<td>è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤çš„æ•°æ®åº“æ˜¯0ã€‚æ•´ä¸ªé€šè¿‡å®¢æˆ·ç«¯å·¥å…·å¯ä»¥çœ‹å¾—åˆ°</td>
</tr>
<tr>
<td>rdbcompression</td>
<td>yesã€no</td>
<td>æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸º yesï¼ŒRedis é‡‡ç”¨ LZF å‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœ CPU æ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§ã€‚</td>
</tr>
<tr>
<td>dbfilename</td>
<td>dump.rdb</td>
<td>æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸º dump.rdb</td>
</tr>
<tr>
<td>dir</td>
<td></td>
<td>æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•</td>
</tr>
<tr>
<td>requirepass</td>
<td></td>
<td>è®¾ç½® Redis è¿æ¥å¯†ç ï¼Œå¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥ Redis æ—¶éœ€è¦é€šè¿‡ AUTH <password> å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­</td>
</tr>
<tr>
<td>maxclients</td>
<td>0</td>
<td>è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ï¼ŒRedis å¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥æ•°ä¸º Redis è¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°ï¼Œå¦‚æœè®¾ç½® maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ã€‚å½“å®¢æˆ·ç«¯è¿æ¥æ•°åˆ°è¾¾é™åˆ¶æ—¶ï¼ŒRedis ä¼šå…³é—­æ–°çš„è¿æ¥å¹¶å‘å®¢æˆ·ç«¯è¿”å› max number of clients reached é”™è¯¯ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td>maxmemory</td>
<td>XXX <bytes></td>
<td>æŒ‡å®š Redis æœ€å¤§å†…å­˜é™åˆ¶ï¼ŒRedis åœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åï¼ŒRedis ä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„ Keyï¼Œå½“æ­¤æ–¹æ³•å¤„ç† åï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œå°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚Redis æ–°çš„ vm æœºåˆ¶ï¼Œä¼šæŠŠ Key å­˜æ”¾å†…å­˜ï¼ŒValue ä¼šå­˜æ”¾åœ¨ swap åŒºã€‚é…ç½®é¡¹å€¼èŒƒå›´åˆ—é‡ŒXXXä¸ºæ•°å€¼ã€‚</td>
</tr>
</tbody></table>
<h3 id="å››ã€redis-benchmarkå®˜æ–¹è‡ªå¸¦çš„æ€§èƒ½æµ‹è¯•å·¥å…·"><a href="#å››ã€redis-benchmarkå®˜æ–¹è‡ªå¸¦çš„æ€§èƒ½æµ‹è¯•å·¥å…·" class="headerlink" title="å››ã€redis-benchmarkå®˜æ–¹è‡ªå¸¦çš„æ€§èƒ½æµ‹è¯•å·¥å…·"></a>å››ã€redis-benchmarkå®˜æ–¹è‡ªå¸¦çš„æ€§èƒ½æµ‹è¯•å·¥å…·</h3><hr>
<h4 id="4-1-åœ¨å®‰è£…çš„redisä¸­å¯ä»¥çœ‹åˆ°redis-benchmark"><a href="#4-1-åœ¨å®‰è£…çš„redisä¸­å¯ä»¥çœ‹åˆ°redis-benchmark" class="headerlink" title="4.1 åœ¨å®‰è£…çš„redisä¸­å¯ä»¥çœ‹åˆ°redis-benchmark"></a>4.1 åœ¨å®‰è£…çš„redisä¸­å¯ä»¥çœ‹åˆ°redis-benchmark</h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238733.png"></p>
<h4 id="4-2-å…³äºredis-benchmark-çš„ä¸€äº›å‚æ•°"><a href="#4-2-å…³äºredis-benchmark-çš„ä¸€äº›å‚æ•°" class="headerlink" title="4.2 å…³äºredis-benchmark çš„ä¸€äº›å‚æ•°"></a>4.2 å…³äºredis-benchmark çš„ä¸€äº›å‚æ•°</h4><p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238626.png"></p>
<blockquote>
<p>æµ‹è¯•ï¼š100ä¸ªå¹¶å‘ï¼Œåä¸‡ä¸ªè¯·æ±‚ï¼Œå•æœºæµ‹è¯•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-benchmark -h 127.0.0.1 -p 6379 -c 100 -n 100000</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238323.png"></p>
<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; SET &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;                                                     	<br>100000 requests completed in 0.94 seconds   	è¡¨ç¤ºå¯¹åä¸‡ä¸ªè¯·æ±‚è¿›è¡Œå†™å…¥æµ‹è¯•<br>100 parallel clients 		100ä¸ªå¹¶å‘å®¢æˆ·ç«¯<br>3 bytes payload		æ¯æ¬¡å†™å…¥3ä¸ªå­—èŠ‚<br>keep alive: 1		åªæœ‰ä¸€å°æœåŠ¡å™¨å¤„ç†è¯·æ±‚<br>host configuration â€œsaveâ€: 3600 1 300 100 60 10000		RDBæŒä¹…åŒ–æ–¹å¼é»˜è®¤å¼€å¯çš„è§„åˆ™<br>host configuration â€œappendonlyâ€: no		AOFæŒä¹…åŒ–æ–¹å¼æœªå¼€å¯<br>multi-thread: no		å¤šçº¿ç¨‹æœªå¼€å¯</p>
<p>99.998% &lt;&#x3D; 12.559 milliseconds (cumulative count 99999)<br>99.999% &lt;&#x3D; 12.567 milliseconds (cumulative count 100000)<br>100.000% &lt;&#x3D; 12.567 milliseconds (cumulative count 100000)  è¯·æ±‚åœ¨å¤šå°‘æ¯«ç§’å¤„ç†å®Œæˆ</p>
<p>throughput summary: 106837.61 requests per second	æ¯ç§’å¤„ç†è¯·æ±‚æ•°</p>
</blockquote>
<blockquote>
<p>å¦ä¸€ç§å†™æ³•ï¼š</p>
<p>åªæµ‹è¯• set å’Œ get å‘½ä»¤åé€€å‡º</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-benchmark -h 127.0.0.1 -p 6379 -t set,get -n 10000 -q</span><br></pre></td></tr></table></figure>



<h3 id="äº”ã€Redisçš„æ•°æ®ç±»å‹ã€é‡ç‚¹ã€‘"><a href="#äº”ã€Redisçš„æ•°æ®ç±»å‹ã€é‡ç‚¹ã€‘" class="headerlink" title="äº”ã€Redisçš„æ•°æ®ç±»å‹ã€é‡ç‚¹ã€‘"></a>äº”ã€Redisçš„æ•°æ®ç±»å‹ã€é‡ç‚¹ã€‘</h3><hr>
<blockquote>
<p>å¸¸ç”¨çš„5ç§æ•°æ®ç»“æ„ï¼š</p>
<ul>
<li>key-stringï¼šä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªå€¼ã€‚</li>
<li>key-hashï¼šä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªMapã€‚</li>
<li>key-listï¼šä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªåˆ—è¡¨ã€‚</li>
<li>key-setï¼šä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªé›†åˆã€‚</li>
<li>key-zsetï¼šä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªæœ‰åºçš„é›†åˆã€‚</li>
</ul>
<p>å¦å¤–ä¸‰ç§æ•°æ®ç»“æ„ï¼š</p>
<ul>
<li>HyperLogLogï¼šè®¡ç®—è¿‘ä¼¼å€¼çš„ã€‚</li>
<li>GEOï¼šåœ°ç†ä½ç½®ã€‚</li>
<li>BITï¼šä¸€èˆ¬å­˜å‚¨çš„ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­˜å‚¨çš„æ˜¯ä¸€ä¸ªbyte[]ã€‚</li>
</ul>
<p>redisæ˜¯ä¸€ç§é«˜çº§çš„key-valueçš„å­˜å‚¨ç³»ç»Ÿï¼Œå…¶ä¸­çš„keyæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå°½å¯èƒ½æ»¡è¶³å¦‚ä¸‹å‡ ç‚¹ï¼š</p>
<p>1.keyä¸è¦å¤ªé•¿ï¼Œæœ€å¥½ä¸è¦æ“ä½œ1024ä¸ªå­—èŠ‚ï¼Œè¿™ä¸ä»…ä¼šæ¶ˆè€—å†…å­˜è¿˜ä¼šé™ä½æŸ¥æ‰¾æ•ˆç‡</p>
<p>2.keyä¸è¦å¤ªçŸ­ï¼Œå¦‚æœå¤ªçŸ­ä¼šé™ä½keyçš„å¯è¯»æ€§</p>
<p>3.åœ¨é¡¹ç›®ä¸­ï¼Œkeyæœ€å¥½æœ‰ä¸€ä¸ªç»Ÿä¸€çš„å‘½åè§„èŒƒï¼ˆæ ¹æ®ä¼ä¸šçš„éœ€æ±‚ï¼‰</p>
<p>valueæœ€å¸¸ç”¨çš„äº”ç§æ•°æ®ç±»å‹ï¼š</p>
<p>1.å­—ç¬¦ä¸²(String)ï¼šæœ€å¸¸ç”¨çš„ï¼Œä¸€èˆ¬ç”¨äºå­˜å‚¨ä¸€ä¸ªå€¼</p>
<p>2.åˆ—è¡¨(List)ï¼šä½¿ç”¨listç»“æ„å®ç°æ ˆå’Œé˜Ÿåˆ—ç»“æ„</p>
<p>3.é›†åˆ(Set) ï¼šäº¤é›†ï¼Œå·®é›†å’Œå¹¶é›†çš„æ“ä½œ</p>
<p>4.æœ‰åºé›†åˆ(sorted set) ï¼šæ’è¡Œæ¦œï¼Œç§¯åˆ†å­˜å‚¨ç­‰æ“ä½œ</p>
<p>5.å“ˆå¸Œ(Hash)ï¼šå­˜å‚¨ä¸€ä¸ªå¯¹è±¡æ•°æ®çš„</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238255.png"></p>
<h4 id="5-1-å­—ç¬¦ä¸²-String"><a href="#5-1-å­—ç¬¦ä¸²-String" class="headerlink" title="5.1 å­—ç¬¦ä¸²(String)"></a>5.1 å­—ç¬¦ä¸²(String)</h4><blockquote>
<p>set key valueï¼šè®¾å®škeyæŒæœ‰æŒ‡å®šçš„å­—ç¬¦ä¸²valueï¼Œå¦‚æœè¯¥keyå­˜åœ¨åˆ™è¿›è¡Œè¦†ç›–æ“ä½œï¼Œæ€»æ˜¯è¿”å›â€OKâ€</p>
<p>get keyï¼šè·å–keyçš„valueã€‚å¦‚æœä¸è¯¥keyå…³è”çš„valueä¸æ˜¯Stringç±»å‹ï¼Œrediså°†è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œå› ä¸ºgetå‘½ä»¤åªèƒ½ç”¨äºè·å–String valueï¼Œå¦‚æœè¯¥keyä¸å­˜åœ¨ï¼Œè¿”å›null</p>
<p>setex key seconds valueï¼šè®¾ç½®keyä»¥åŠå¯¹åº”çš„valueï¼Œè¿˜å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´</p>
<p>setnx key valueï¼šå½“keyä¸å­˜åœ¨æ—¶ï¼Œè®¾ç½®å¯¹åº”çš„valueï¼Œå½“keyå­˜åœ¨æ—¶ï¼Œä¸åšä»»ä½•æ“ä½œ</p>
<p>incr keyï¼šå°†æŒ‡å®šçš„keyçš„valueåŸå­æ€§çš„é€’å¢1.å¦‚æœè¯¥keyä¸å­˜åœ¨ï¼Œå…¶åˆå§‹å€¼ä¸º0ï¼Œåœ¨incrä¹‹åå…¶å€¼ä¸º1ã€‚å¦‚æœvalueçš„å€¼ä¸èƒ½è½¬æˆæ•´å‹ï¼Œå¦‚helloï¼Œè¯¥æ“ä½œå°†æ‰§è¡Œå¤±è´¥å¹¶è¿”å›ç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>decr keyï¼šå°†æŒ‡å®šçš„keyçš„valueåŸå­æ€§çš„é€’å‡1.å¦‚æœè¯¥keyä¸å­˜åœ¨ï¼Œå…¶åˆå§‹å€¼ä¸º0ï¼Œåœ¨incrä¹‹åå…¶å€¼ä¸º-1ã€‚å¦‚æœvalueçš„å€¼ä¸èƒ½è½¬æˆæ•´å‹ï¼Œå¦‚helloï¼Œè¯¥æ“ä½œå°†æ‰§è¡Œå¤±è´¥å¹¶è¿”å›ç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>incrby key incrementï¼šå°†æŒ‡å®šçš„keyçš„valueåŸå­æ€§å¢åŠ incrementï¼Œå¦‚æœè¯¥keyä¸å­˜åœ¨ï¼Œå™¨åˆå§‹å€¼ä¸º0ï¼Œåœ¨incrbyä¹‹åï¼Œè¯¥å€¼ä¸ºincrementã€‚å¦‚æœè¯¥å€¼ä¸èƒ½è½¬æˆæ•´å‹ï¼Œå¦‚helloåˆ™å¤±è´¥å¹¶è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>decrby key decrementï¼šå°†æŒ‡å®šçš„keyçš„valueåŸå­æ€§å‡å°‘decrementï¼Œå¦‚æœè¯¥keyä¸å­˜åœ¨ï¼Œå™¨åˆå§‹å€¼ä¸º0ï¼Œåœ¨decrbyä¹‹åï¼Œè¯¥å€¼ä¸ºdecrementã€‚å¦‚æœè¯¥å€¼ä¸èƒ½è½¬æˆæ•´å‹ï¼Œå¦‚helloåˆ™å¤±è´¥å¹¶è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
</blockquote>
<blockquote>
<p>1.ç®€å•çš„ç¼“å­˜å­˜å‚¨ï¼ˆæœ€å¸¸ç”¨ï¼‰</p>
<p>2.æ¶ˆæ¯çš„å¤±æ•ˆæ€§ï¼ˆè¿‡æœŸæ—¶é—´çš„è®¾ç½®ï¼‰</p>
<p>3.åˆ†å¸ƒå¼é”çš„å®ç°ï¼ˆredissonï¼‰</p>
</blockquote>
<h4 id="5-2-åˆ—è¡¨-List"><a href="#5-2-åˆ—è¡¨-List" class="headerlink" title="5.2 åˆ—è¡¨(List)"></a>5.2 åˆ—è¡¨(List)</h4><blockquote>
<p>lpush key value1 value2â€¦ï¼šåœ¨æŒ‡å®šçš„keyæ‰€å…³è”çš„listçš„å¤´éƒ¨æ’å…¥æ‰€æœ‰çš„valuesï¼Œå¦‚æœè¯¥keyä¸å­˜åœ¨ï¼Œè¯¥å‘½ä»¤åœ¨æ’å…¥çš„ä¹‹å‰åˆ›å»ºä¸€ä¸ªä¸è¯¥keyå…³è”çš„ç©ºé“¾è¡¨ï¼Œä¹‹åå†å‘è¯¥é“¾è¡¨çš„å¤´éƒ¨æ’å…¥æ•°æ®ã€‚æ’å…¥æˆåŠŸï¼Œè¿”å›å…ƒç´ çš„ä¸ªæ•°ã€‚</p>
<p>rpush key value1 value2â€¦ï¼šåœ¨è¯¥listçš„å°¾éƒ¨æ·»åŠ å…ƒç´ ã€‚</p>
<p>lrange key start endï¼šè·å–é“¾è¡¨ä¸­ä»startåˆ°endçš„å…ƒç´ çš„å€¼ï¼Œstartã€endå¯ä¸ºè´Ÿæ•°ï¼Œè‹¥ä¸º-1åˆ™è¡¨ç¤ºé“¾è¡¨å°¾éƒ¨çš„å…ƒç´ ï¼Œ-2åˆ™è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªï¼Œä¾æ¬¡ç±»æ¨â€¦.</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238502.png"></p>
<p>lpop keyï¼šè¿”å›å¹¶å¼¹å‡ºæŒ‡å®šçš„keyå…³è”çš„é“¾è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå³å¤´éƒ¨å…ƒç´ ã€‚</p>
<p>rpop keyï¼šä»å°¾éƒ¨å¼¹å‡ºå…ƒç´ ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071238251.png"></p>
<p>llen keyï¼šè¿”å›æŒ‡å®šçš„keyå…³è”çš„é“¾è¡¨ä¸­çš„å…ƒç´ çš„æ•°é‡ã€‚</p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
</blockquote>
<blockquote>
<p>æ¶ˆæ¯æµçš„åœºæ™¯ï¼š</p>
<p>1.ç”¨æˆ·çš„idä½œä¸ºkeyï¼Œå‘é€çš„æ¶ˆæ¯ä½œä¸ºvalueï¼Œä¾‹å¦‚ï¼šæœ‹å‹åœˆå‘å¸ƒï¼Œå¾®åšå‘å¸ƒï¼Œå…¬ä¼—å·å‘å¸ƒâ€¦</p>
</blockquote>
<h4 id="5-3-é›†åˆ-Setï¼Œä¸å…è®¸å‡ºç°é‡å¤çš„å…ƒç´ "><a href="#5-3-é›†åˆ-Setï¼Œä¸å…è®¸å‡ºç°é‡å¤çš„å…ƒç´ " class="headerlink" title="5.3 é›†åˆ(Setï¼Œä¸å…è®¸å‡ºç°é‡å¤çš„å…ƒç´ )"></a>5.3 é›†åˆ(Setï¼Œä¸å…è®¸å‡ºç°é‡å¤çš„å…ƒç´ )</h4><blockquote>
<p>sadd key value1  value2â€¦ï¼šå‘setä¸­æ·»åŠ æ•°æ®ï¼Œå¦‚æœè¯¥keyçš„å€¼å·²æœ‰åˆ™ä¸ä¼šé‡å¤æ·»åŠ ã€‚</p>
<p>smembers keyï¼šè·å–setä¸­æ‰€æœ‰çš„æˆå‘˜ã€‚</p>
<p>scard keyï¼šè·å–setä¸­æˆå‘˜çš„æ•°é‡ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239420.png"></p>
<p>sismember key memberï¼šåˆ¤æ–­å‚æ•°ä¸­æŒ‡å®šçš„æˆå‘˜æ˜¯å¦åœ¨è¯¥setä¸­ï¼Œ1è¡¨ç¤ºå­˜åœ¨ï¼Œ0è¡¨ç¤ºä¸å­˜åœ¨æˆ–è€…è¯¥keyæœ¬èº«å°±ä¸å­˜åœ¨ã€‚</p>
<p>srem key member1  member2â€¦ ï¼šåˆ é™¤setä¸­æŒ‡å®šçš„æˆå‘˜ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239230.png"></p>
<p>srandmember keyï¼šéšæœºè¿”å›setä¸­çš„ä¸€ä¸ªæˆå‘˜ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239870.png"></p>
<p>spop keyï¼šéšæœºè¿”å›setä¸­çš„ä¸€ä¸ªæˆå‘˜å¹¶ä»setä¸­ç§»é™¤ã€‚</p>
<p>sdiff key1 key2ï¼šè¿”å›key1ä¸key2ä¸­ç›¸å·®çš„æˆå‘˜ï¼Œè€Œä¸”ä¸keyçš„é¡ºåºæœ‰å…³ï¼Œå³è¿”å›å·®é›†ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239621.png"></p>
<p>sdiffstore destination key1 key2ï¼šå°†key1ã€key2ç›¸å·®çš„æˆå‘˜å­˜å‚¨åœ¨destinationä¸Šã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239477.png"></p>
<p>sinter key[key1,key2â€¦]ï¼šè¿”å›äº¤é›†ã€‚</p>
<p>sinterstore destination key1 key2ï¼šå°†è¿”å›çš„äº¤é›†å­˜å‚¨åœ¨destinationä¸Šã€‚</p>
<p><img src="E:/notes/Day75-Redis/1.%E8%AF%BE%E4%BB%B6/34.redis/01.%E8%AF%BE%E4%BB%B6/Pictures/18.png"></p>
<p>sunion key1 key2ï¼šè¿”å›å¹¶é›†ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239623.png"></p>
<p>sunionstore destination key1 key2ï¼šå°†è¿”å›çš„å¹¶é›†å­˜å‚¨åœ¨destinationä¸Š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239546.png"></p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
</blockquote>
<blockquote>
<p>å…¬å¸å¹´ä¼šï¼ŒéšæœºæŠ½å¥–å°ç¨‹åº</p>
<p>1.æŠŠæ‰€æœ‰ç”¨æˆ·ç»Ÿä¸€å­˜å…¥seté›†åˆä¸­</p>
<p>2.æŸ¥çœ‹æ‰€æœ‰æŠ½å¥–äººæ•°</p>
<p>3.éšæœºæŠ½å–æŒ‡å®šå¾—å¥–äººæ•°å¹¶ä»seté›†åˆä¸­åˆ é™¤</p>
<p>å®ç°ï¼š</p>
<p>1.sadd  choujiang  userid1,userid2,userid3â€¦</p>
<p>2.smembers  choujiang</p>
<p>3.spop  choujiang  [count]</p>
</blockquote>
<blockquote>
<p>å¾®ä¿¡ç‚¹èµï¼Œå¾®åšæ”¶è—</p>
<p>1.ç‚¹èµï¼Œåˆ›å»ºé›†åˆå¹¶åŠ å…¥å¯¹åº”ç”¨æˆ·</p>
<p>2.å–æ¶ˆç‚¹èµï¼Œä»é›†åˆä¸­åˆ é™¤å¯¹åº”ç”¨æˆ·</p>
<p>3.æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç‚¹è¿‡èµ</p>
<p>4.è·å–ç‚¹èµç”¨æˆ·åˆ—è¡¨</p>
<p>5.è·å–ç‚¹èµç”¨æˆ·æ•°é‡</p>
<p>å®ç°ï¼š</p>
<p>1.sadd  dianzan userid1,userid2,userid3â€¦</p>
<p>2.srem dianzan userid1</p>
<p>3.sismember dianzan userid1</p>
<p>4.smembers dianzan</p>
<p>5.scard dianzan</p>
</blockquote>
<blockquote>
<p>å¯èƒ½è®¤è¯†çš„äººæ¨è</p>
<p>1.ä¸¤ä¸ªé›†åˆå–äº¤é›†</p>
<p>å®ç°ï¼š</p>
<p>1.sinter user1list,user2listâ€¦</p>
<p>2.sinterstore list user1list,user2listâ€¦</p>
</blockquote>
<h4 id="5-4-æœ‰åºé›†åˆ-sorted-set"><a href="#5-4-æœ‰åºé›†åˆ-sorted-set" class="headerlink" title="5.4 æœ‰åºé›†åˆ(sorted set)"></a>5.4 æœ‰åºé›†åˆ(sorted set)</h4><blockquote>
<p>zadd key score member score2 member2 â€¦ ï¼šå°†æ‰€æœ‰æˆå‘˜ä»¥åŠè¯¥æˆå‘˜çš„åˆ†æ•°å­˜æ”¾åˆ°sorted-setä¸­ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239166.png"></p>
<p>zcard keyï¼šè·å–é›†åˆä¸­çš„æˆå‘˜æ•°é‡ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239334.png"></p>
<p>zcount key min maxï¼šè·å–åˆ†æ•°åœ¨[min,max]ä¹‹é—´çš„æˆå‘˜ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239837.png"></p>
<p>zincrby key increment memberï¼šè®¾ç½®æŒ‡å®šæˆå‘˜çš„å¢åŠ çš„åˆ†æ•°ã€‚</p>
<p>zrangebyscore key min max [withscores] [limit offset count]ï¼šè¿”å›åˆ†æ•°åœ¨[min,max]çš„æˆå‘˜å¹¶æŒ‰ç…§åˆ†æ•°ä»ä½åˆ°é«˜æ’åºã€‚[withscores]ï¼šæ˜¾ç¤ºåˆ†æ•°ï¼›[limit offset count]ï¼šoffsetï¼Œè¡¨æ˜ä»è„šæ ‡ä¸ºoffsetçš„å…ƒç´ å¼€å§‹å¹¶è¿”å›countä¸ªæˆå‘˜ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239543.png"></p>
<p>zrevrangebyscore key min max [withscores] [limit offset count]ï¼šä¸Šé¢ç±»ä¼¼ï¼ˆscoreéœ€ä»å¤§åˆ°å°ï¼‰ï¼Œä»é«˜åˆ°åº•æ’åº</p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
</blockquote>
<blockquote>
<p>æ’è¡Œæ¦œå®ç°</p>
<p>1.å¯¹æ’­æ”¾çš„è§†é¢‘ï¼Œåˆ†æ•°è‡ªå¢1</p>
<p>2.å±•ç¤ºæ’è¡Œæ¦œå‰åçš„è§†é¢‘</p>
<p>å®ç°ï¼š</p>
<p>1.zincrby  videos  1  video1id</p>
<p>2.zrevrangebyscore videos  100 0  withscores limit 0 10 ï¼ˆzrevrangebyscoreä»å¤§åˆ°å°æ’åºï¼‰</p>
</blockquote>
<h4 id="5-5-å“ˆå¸Œ-Hash"><a href="#5-5-å“ˆå¸Œ-Hash" class="headerlink" title="5.5 å“ˆå¸Œ(Hash)"></a>5.5 å“ˆå¸Œ(Hash)</h4><blockquote>
<p>hset key field valueï¼šä¸ºæŒ‡å®šçš„keyè®¾å®šfield&#x2F;valueå¯¹ï¼ˆé”®å€¼å¯¹ï¼‰ã€‚</p>
<p>hget key fieldï¼šè¿”å›æŒ‡å®šçš„keyä¸­çš„fieldçš„å€¼ã€‚</p>
<p>hgetall keyï¼šè·å–keyä¸­çš„æ‰€æœ‰filed-vauleã€‚</p>
<p>hlen keyï¼šè·å–keyæ‰€åŒ…å«çš„fieldçš„æ•°é‡ã€‚</p>
<p>hincrby key field incrementï¼šè®¾ç½®keyä¸­filedçš„å€¼å¢åŠ increment</p>
<p>hdel key field [field â€¦]ï¼šåˆ é™¤keyä¸­çš„å±æ€§</p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
</blockquote>
<blockquote>
<p>è´­ç‰©è½¦åœºæ™¯ï¼š</p>
<p>1.ç”¨æˆ·çš„idä½œä¸ºkey</p>
<p>2.å•†å“çš„idä½œä¸ºfieldï¼ˆå±æ€§ï¼‰</p>
<p>3.å•†å“çš„æ•°é‡ä½œä¸ºvalueï¼ˆå±æ€§å€¼ï¼‰</p>
<p>è´­ç‰©è½¦æ“ä½œï¼š</p>
<p>1.ç”¨æˆ·æ·»åŠ è´­ç‰©è½¦ï¼šhset cart:1001  20001   1    ï¼ˆidä¸º1001çš„ç”¨æˆ·æ·»åŠ äº†ä¸€ä¸ªidä¸º20001çš„å•†å“ï¼Œæ•°é‡ä¸º1ä¸ªï¼‰</p>
<p>2.å¢åŠ å¯¹åº”å•†å“æ•°é‡ï¼šhincrby cart:1001  20001  1</p>
<p>3.æŸ¥è¯¢å•†å“æ€»æ•°ï¼šhlen cart:1001</p>
<p>4.åˆ é™¤è¯¥ç”¨æˆ·çš„æŸä¸ªå•†å“ï¼šhdel cart:1001  20001</p>
<p>5.æŸ¥è¯¢è¯¥ç”¨æˆ·è´­ç‰©è½¦ä¿¡æ¯ï¼šhgetall cart:1001</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071239965.png"></p>
<h4 id="5-6-é€šç”¨æ“ä½œ"><a href="#5-6-é€šç”¨æ“ä½œ" class="headerlink" title="5.6 é€šç”¨æ“ä½œ"></a>5.6 é€šç”¨æ“ä½œ</h4><blockquote>
<p>keys pattenï¼šè·å–æ‰€æœ‰ä¸pattenåŒ¹é…çš„keyï¼Œ*è¡¨ç¤ºä»»æ„å­—ç¬¦ï¼Œ?è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚</p>
<p>del key1 key2â€¦.ï¼šåˆ é™¤æŒ‡å®šçš„keyã€‚</p>
<p>exists keyï¼šåˆ¤æ–­è¯¥keyæ˜¯å¦å­˜åœ¨ï¼Œ1è¡¨ç¤ºå­˜åœ¨ï¼Œ0è¡¨ç¤ºä¸å­˜åœ¨ã€‚</p>
<p>expire key secondï¼šä¸ºå½“å‰keyè®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚</p>
<p>ttl keyï¼šæŸ¥çœ‹å½“å‰keyå‰©ä½™è¿‡æœŸæ—¶é—´ã€‚</p>
<p>flushall:   åˆ é™¤æ‰€æœ‰keyï¼ˆæ…ç”¨ï¼‰</p>
<p>flushdb:  åˆ é™¤æ‰€æœ‰keyï¼ˆæ…ç”¨ï¼‰</p>
</blockquote>
<h3 id="å…­ã€Jedisçš„ä½¿ç”¨ã€é‡ç‚¹ã€‘"><a href="#å…­ã€Jedisçš„ä½¿ç”¨ã€é‡ç‚¹ã€‘" class="headerlink" title="å…­ã€Jedisçš„ä½¿ç”¨ã€é‡ç‚¹ã€‘"></a>å…­ã€Jedisçš„ä½¿ç”¨ã€é‡ç‚¹ã€‘</h3><hr>
<blockquote>
<p>1.ä¿®æ”¹&#x2F;usr&#x2F;local&#x2F;redis-5.0.4&#x2F;binç›®å½•ä¸‹çš„redis.confé…ç½®æ–‡ä»¶ï¼Œç„¶åå¯åŠ¨redisæœåŠ¡ç«¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240709.png"></p>
<p>ä¿®æ”¹redis.confæ–‡ä»¶ä¸­çš„bindä¸ºï¼š0.0.0.0ï¼Œç„¶åæŠŠä¿æŠ¤æ¨¡å¼å…³æ‰</p>
</blockquote>
<blockquote>
<p>å¦‚éœ€è®¾ç½®å¯†ç ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p>
<p>æ–¹å¼ä¸€ï¼šé€šè¿‡ä¿®æ”¹ redis.conf æ–‡ä»¶ï¼Œè®¾ç½®Redisçš„å¯†ç æ ¡éªŒ</p>
<p>requirepass å¯†ç </p>
<p>æ–¹å¼äºŒï¼šåœ¨ä¸ä¿®æ”¹ redis.conf æ–‡ä»¶çš„å‰æä¸‹ï¼Œåœ¨ç¬¬ä¸€æ¬¡é“¾æ¥Redisæ—¶ï¼Œè¾“å…¥å‘½ä»¤ï¼šConfig set requirepass å¯†ç </p>
<p>åç»­è¿æ¥rediså®¢æˆ·ç«¯çš„æ—¶å€™ï¼Œéœ€è¦å…ˆ AUTH åšä¸€ä¸‹æ ¡éªŒ</p>
<p>127.0.0.1:6379&gt; auth å¯†ç </p>
</blockquote>
<blockquote>
<p>2.åˆ›å»ºMavenå·¥ç¨‹ï¼Œå¯¼å…¥ä¾èµ–</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- jediså®¢æˆ·ç«¯ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>3.ç¼–å†™å®ä½“ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qf.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>4.ç¼–å†™æµ‹è¯•ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qf.jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson2.JSON;</span><br><span class="line"><span class="keyword">import</span> com.qf.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPool;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//è·å–å®¢æˆ·ç«¯å¯¹è±¡</span></span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;192.168.126.129&quot;</span>,<span class="number">6379</span>);</span><br><span class="line">        <span class="comment">//å¦‚æœæœ‰å¯†ç ï¼Œå¿…é¡»è®¾ç½®</span></span><br><span class="line">        <span class="comment">//jedis.auth(&quot;root&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//å­˜å‚¨Stringç±»å‹æ•°æ®</span></span><br><span class="line">        jedis.set(<span class="string">&quot;content&quot;</span>,<span class="string">&quot;java2203&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–Stringå€¼</span></span><br><span class="line">        System.out.println(jedis.get(<span class="string">&quot;content&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å­˜å¯¹è±¡</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(<span class="number">1</span>);</span><br><span class="line">        user.setName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">userJson</span> <span class="operator">=</span> JSON.toJSONString(user);</span><br><span class="line">        jedis.set(<span class="string">&quot;user&quot;</span>,userJson);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–å¯¹è±¡</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonStringUser</span> <span class="operator">=</span> jedis.get(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        System.out.println(jsonStringUser);</span><br><span class="line">        <span class="type">User</span> <span class="variable">db_user</span> <span class="operator">=</span> JSON.parseObject(jsonStringUser, User.class);</span><br><span class="line">        System.out.println(db_user);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­</span></span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//é€šè¿‡æ± æ‹¿jediså¯¹è±¡</span></span><br><span class="line">        <span class="comment">//é…ç½®ä¸€äº›å‚æ•°</span></span><br><span class="line">        <span class="type">JedisPoolConfig</span> <span class="variable">jedisPoolConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPoolConfig</span>();</span><br><span class="line">        <span class="comment">//é…ç½®å‚æ•°</span></span><br><span class="line">        jedisPoolConfig.setMaxTotal(<span class="number">200</span>);<span class="comment">//æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">        jedisPoolConfig.setMaxIdle(<span class="number">20</span>);<span class="comment">//æœ€å¤§ç©ºé—²</span></span><br><span class="line">        jedisPoolConfig.setMinIdle(<span class="number">1</span>);<span class="comment">//æœ€å°ç©ºé—²</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºJedisPoolå¯¹è±¡</span></span><br><span class="line">        <span class="type">JedisPool</span> <span class="variable">jedisPool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPool</span>(jedisPoolConfig,<span class="string">&quot;192.168.126.129&quot;</span>,<span class="number">6379</span>);</span><br><span class="line">        <span class="comment">//è·å–jediså¯¹è±¡</span></span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> jedisPool.getResource();</span><br><span class="line">        <span class="comment">//å¦‚æœæœ‰å¯†ç ï¼Œå¿…é¡»è®¾ç½®</span></span><br><span class="line">        <span class="comment">//jedis.auth(&quot;root&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ“ä½œListé›†åˆ</span></span><br><span class="line">        jedis.lpush(<span class="string">&quot;sina001&quot;</span>,<span class="string">&quot;ä»Šå¤©ä¸­åˆåƒä»€ä¹ˆï¼Ÿ&quot;</span>,<span class="string">&quot;ä»Šå¤©æ™šä¸Šå–ä»€ä¹ˆ&quot;</span>);</span><br><span class="line">        System.out.println(jedis.lrange(<span class="string">&quot;sina001&quot;</span>,<span class="number">0</span>,-<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ“ä½œSeté›†åˆ</span></span><br><span class="line">        jedis.sadd(<span class="string">&quot;userList&quot;</span>,<span class="string">&quot;jack&quot;</span>,<span class="string">&quot;rose&quot;</span>,<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        System.out.println(jedis.smembers(<span class="string">&quot;userList&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æœ‰åºSetä»¥åŠHash</span></span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­</span></span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="ä¸ƒã€Redisä¸­çš„äº‹åŠ¡ã€äº†è§£ã€‘"><a href="#ä¸ƒã€Redisä¸­çš„äº‹åŠ¡ã€äº†è§£ã€‘" class="headerlink" title="ä¸ƒã€Redisä¸­çš„äº‹åŠ¡ã€äº†è§£ã€‘"></a>ä¸ƒã€Redisä¸­çš„äº‹åŠ¡ã€äº†è§£ã€‘</h3><hr>
<blockquote>
<p>Redisä¸­çš„äº‹åŠ¡å’ŒMySQLä¸­çš„äº‹åŠ¡æœ‰æœ¬è´¨çš„åŒºåˆ«ï¼ŒRedisä¸­çš„äº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼Œäº‹åŠ¡ä¸­æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ï¼ŒæŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œäº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘æ¥çš„å‘½ä»¤æ‰€æ‰“æ–­ï¼Œå› ä¸ºRedisæœåŠ¡ç«¯æ˜¯ä¸ªå•çº¿ç¨‹çš„æ¶æ„ï¼Œä¸åŒçš„Clientè™½ç„¶çœ‹ä¼¼å¯ä»¥åŒæ—¶ä¿æŒè¿æ¥ï¼Œä½†å‘å‡ºå»çš„å‘½ä»¤æ˜¯åºåˆ—åŒ–æ‰§è¡Œçš„ï¼Œè¿™åœ¨é€šå¸¸çš„æ•°æ®åº“ç†è®ºä¸‹æ˜¯æœ€é«˜çº§åˆ«çš„éš”ç¦»ã€‚</p>
<p>Redisä¸­çš„äº‹åŠ¡çš„ä½œç”¨å°±æ˜¯ä¸²è”å¤šä¸ªå‘½ä»¤ï¼Œé˜²æ­¢åˆ«çš„å‘½ä»¤æ’é˜Ÿã€‚</p>
<p>å¸¸ç”¨å‘½ä»¤ï¼šmultiã€execã€discardã€watchã€unwatch</p>
<p>å½“è¾“å…¥multiå‘½ä»¤æ—¶ï¼Œä¹‹åè¾“å…¥çš„å‘½ä»¤éƒ½ä¼šè¢«æ”¾åœ¨é˜Ÿåˆ—ä¸­ï¼Œä½†ä¸ä¼šæ‰§è¡Œï¼Œç›´åˆ°è¾“å…¥execåï¼ŒRedisä¼šå°†é˜Ÿåˆ—ä¸­çš„å‘½ä»¤ä¾æ¬¡æ‰§è¡Œï¼Œdiscardç”¨æ¥æ’¤é”€Execä¹‹å‰è¢«æš‚å­˜çš„å‘½ä»¤ï¼Œå¹¶ä¸æ˜¯å›æ»šã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240256.png"></p>
</blockquote>
<blockquote>
<p>watch&#x2F;unwatch</p>
<p>åœ¨æ‰§è¡Œmultiä¹‹å‰ï¼Œå…ˆæ‰§è¡Œwatch key1 [key2â€¦] ï¼Œwatchæä¾›çš„ä¹è§‚é”åŠŸèƒ½ï¼ˆåˆå§‹æ—¶ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œexecä¹‹åä¼šæ›´æ–°å½“å‰ç‰ˆæœ¬å·ï¼‰ï¼Œåœ¨ä½ execçš„é‚£ä¸€åˆ»ï¼Œå¦‚æœè¢«watchçš„é”®å‘ç”Ÿè¿‡æ”¹åŠ¨ï¼Œåˆ™multiåˆ°execä¹‹é—´çš„æŒ‡ä»¤å…¨éƒ¨ä¸æ‰§è¡Œã€‚</p>
<p>watchè¡¨ç¤ºç›‘æ§ï¼Œç›¸å½“äºåŠ é”ï¼Œä½†åœ¨æ‰§è¡Œå®Œexecæ—¶å°±ä¼šè§£é”ã€‚</p>
<p>unwatchå–æ¶ˆæ‰€æœ‰é”ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240336.png"></p>
</blockquote>
<blockquote>
<p>Redisä¸­çš„äº‹åŠ¡çš„ç‰¹æ€§æ€»ç»“</p>
<p>1.å•ç‹¬çš„éš”ç¦»æ“ä½œ</p>
<p>â€‹	äº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ï¼Œç„¶åæŒ‰é¡ºåºæ‰§è¡Œï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€çš„å‘½ä»¤æ‰“æ–­ã€‚</p>
<p>2.æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ</p>
<p>â€‹	é˜Ÿåˆ—ä¸­çš„å‘½ä»¤æ²¡æœ‰è¢«æäº¤ä¹‹å‰éƒ½ä¸ä¼šæ‰§è¡Œã€‚</p>
<p>3.ä¸èƒ½ä¿è¯åŸå­æ€§</p>
<p>â€‹	RedisåŒä¸€ä¸ªäº‹åŠ¡ä¸­å¦‚æœæœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œä¸ä¼šå›æ»š</p>
</blockquote>
<h3 id="å…«ã€Redisæ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒã€äº†è§£ã€‘"><a href="#å…«ã€Redisæ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒã€äº†è§£ã€‘" class="headerlink" title="å…«ã€Redisæ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒã€äº†è§£ã€‘"></a>å…«ã€Redisæ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒã€äº†è§£ã€‘</h3><hr>
<blockquote>
<p>subscribe channel   è®¢é˜…é¢‘é“      ä¾‹å¦‚ï¼šsubscribe cctv5</p>
<p>publish channel content  åœ¨æŒ‡å®šé¢‘é“ä¸­å‘å¸ƒå†…å®¹  ä¾‹å¦‚ï¼špublish cctv5 basketball</p>
<p>åŒæ—¶æ‰“å¼€ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼Œä¸€ä¸ªè®¢é˜…é¢‘é“ï¼Œä¸€ä¸ªåœ¨é¢‘é“ä¸­å‘å¸ƒå†…å®¹ï¼Œè®¢é˜…é¢‘é“çš„å®¢æˆ·ç«¯ä¼šæ¥æ”¶åˆ°æ¶ˆæ¯ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240777.png"></p>
</blockquote>
<h3 id="ä¹ã€Rediså›¾å½¢åŒ–ç¨‹åºç•Œé¢ã€äº†è§£ã€‘"><a href="#ä¹ã€Rediså›¾å½¢åŒ–ç¨‹åºç•Œé¢ã€äº†è§£ã€‘" class="headerlink" title="ä¹ã€Rediså›¾å½¢åŒ–ç¨‹åºç•Œé¢ã€äº†è§£ã€‘"></a>ä¹ã€Rediså›¾å½¢åŒ–ç¨‹åºç•Œé¢ã€äº†è§£ã€‘</h3><hr>
<blockquote>
<p> Redisä¸­é»˜è®¤æœ‰16ä¸ªåº“ï¼Œå¯ä»¥åœ¨ä¸åŒçš„åº“ä¸­å­˜å‚¨æ•°æ®ï¼Œé»˜è®¤ä½¿ç”¨0å·åº“å­˜å‚¨æ•°æ®ï¼Œä½¿ç”¨select 0-15å¯ä»¥é€‰æ‹©ä¸åŒçš„åº“ã€‚</p>
<p> <img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240008.png"></p>
</blockquote>
<blockquote>
<p>å®‰è£…ä¹‹å‰ï¼Œéœ€è¦ä¿®æ”¹redis.confæ–‡ä»¶ä¸­çš„bindä¸ºï¼š0.0.0.0ï¼ˆä¹‹å‰å·²ç»ä¿®æ”¹è¿‡äº†ï¼‰</p>
</blockquote>
<blockquote>
<p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/lework/RedisDesktopManager-Windows">https://github.com/lework/RedisDesktopManager-Windows</a></p>
</blockquote>
<blockquote>
<p>å®‰è£…ä¹‹åï¼Œè¾“å…¥IPåœ°å€ç™»å½•å³å¯çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240715.png"></p>
</blockquote>
<h3 id="åã€Redisä¸­çš„æŒä¹…åŒ–ã€é‡ç‚¹ã€‘"><a href="#åã€Redisä¸­çš„æŒä¹…åŒ–ã€é‡ç‚¹ã€‘" class="headerlink" title="åã€Redisä¸­çš„æŒä¹…åŒ–ã€é‡ç‚¹ã€‘"></a>åã€Redisä¸­çš„æŒä¹…åŒ–ã€é‡ç‚¹ã€‘</h3><hr>
<blockquote>
<p>Redisæœ‰ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼šRDBå’ŒAOFã€‚</p>
</blockquote>
<h4 id="1-RDBï¼ˆRedis-DataBaseï¼‰"><a href="#1-RDBï¼ˆRedis-DataBaseï¼‰" class="headerlink" title="1.RDBï¼ˆRedis DataBaseï¼‰"></a>1.RDBï¼ˆRedis DataBaseï¼‰</h4><blockquote>
<p>å°†å†…å­˜ä¸­çš„æ•°æ®ä»¥å¿«ç…§çš„æ–¹å¼å†™å…¥ç£ç›˜ä¸­ï¼Œåœ¨redis.confæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹é…ç½®ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240254.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240309.png"></p>
<p>save 900 1</p>
<p>save 300 10</p>
<p>save 60 10000</p>
<p>é…ç½®å«ä¹‰ï¼š</p>
<p>900ç§’å†…ï¼Œå¦‚æœè¶…è¿‡1ä¸ªkeyè¢«ä¿®æ”¹ï¼Œåˆ™å‘èµ·å¿«ç…§ä¿å­˜</p>
<p>300ç§’å†…ï¼Œå¦‚æœè¶…è¿‡10ä¸ªkeyè¢«ä¿®æ”¹ï¼Œåˆ™å‘èµ·å¿«ç…§ä¿å­˜</p>
<p>60ç§’å†…ï¼Œå¦‚æœ1ä¸‡ä¸ªkeyè¢«ä¿®æ”¹ï¼Œåˆ™å‘èµ·å¿«ç…§ä¿å­˜</p>
<p>RDBæ–¹å¼å­˜å‚¨çš„æ•°æ®ä¼šåœ¨</p>
<p>dump.rdbæ–‡ä»¶ä¸­ï¼ˆåœ¨å“ªä¸ªç›®å½•å¯åŠ¨redisæœåŠ¡ç«¯ï¼Œè¯¥æ–‡ä»¶å°±ä¼šåœ¨å¯¹åº”ç›®å½•ä¸‹ç”Ÿæˆï¼‰ï¼Œè¯¥æ–‡ä»¶ä¸èƒ½æŸ¥çœ‹ï¼Œå¦‚éœ€å¤‡ä»½ï¼Œå¯¹Redisæ“ä½œå®Œæˆä¹‹åï¼Œåªéœ€æ‹·è´è¯¥æ–‡ä»¶å³å¯ï¼ˆRedisæœåŠ¡ç«¯å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åŠ è½½è¯¥æ–‡ä»¶ï¼‰</p>
</blockquote>
<h4 id="2-AOFï¼ˆAppend-Of-Fileï¼‰"><a href="#2-AOFï¼ˆAppend-Of-Fileï¼‰" class="headerlink" title="2.AOFï¼ˆAppend Of Fileï¼‰"></a>2.AOFï¼ˆAppend Of Fileï¼‰</h4><blockquote>
<p>AOFé»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯ï¼ŒåŒæ ·æ˜¯åœ¨redis.confæ–‡ä»¶ä¸­å¼€å¯ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240657.png"></p>
<p>é…ç½®æ–‡ä»¶ä¸­çš„appendonlyä¿®æ”¹ä¸ºyesï¼Œå¼€å¯AOFæŒä¹…åŒ–ã€‚å¼€å¯åï¼Œå¯åŠ¨redisæœåŠ¡ç«¯ï¼Œå‘ç°å¤šäº†ä¸€ä¸ªappendonly.aofæ–‡ä»¶ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240766.png"></p>
<p>ä¹‹åä»»ä½•çš„æ“ä½œéƒ½ä¼šä¿å­˜åœ¨appendonly.aofæ–‡ä»¶ä¸­ï¼Œå¯ä»¥è¿›è¡ŒæŸ¥çœ‹ï¼ŒRediså¯åŠ¨æ—¶ä¼šå°†appendonly.aofæ–‡ä»¶ä¸­çš„å†…å®¹æ‰§è¡Œä¸€éã€‚</p>
<p>å¦‚æœAOFå’ŒRDBåŒæ—¶å¼€å¯ï¼Œç³»ç»Ÿä¼šé»˜è®¤è¯»å–AOFçš„æ•°æ®ã€‚</p>
</blockquote>
<h4 id="3-æ€»ç»“"><a href="#3-æ€»ç»“" class="headerlink" title="3.æ€»ç»“"></a>3.æ€»ç»“</h4><blockquote>
<p><strong>RDBä¼˜ç‚¹ä¸ç¼ºç‚¹</strong></p>
<p>ä¼˜ç‚¹</p>
<p>å¦‚æœè¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼ŒRDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ¢å¤é€Ÿåº¦è¦å¿«ã€‚</p>
<p>RDBæ˜¯ä¸€ä¸ªéå¸¸ç´§å‡‘(compact)çš„æ–‡ä»¶,å®ƒä¿å­˜äº†æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®é›†ï¼Œéå¸¸é€‚åˆç”¨ä½œå¤‡ä»½ï¼ŒåŒæ—¶ä¹Ÿéå¸¸é€‚åˆç”¨ä½œç¾éš¾æ€§æ¢å¤ï¼Œå®ƒåªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹ç´§å‡‘ï¼Œé€šè¿‡å¤‡ä»½åŸæ–‡ä»¶åˆ°æœ¬æœºå¤–çš„å…¶ä»–ä¸»æœºä¸Šï¼Œä¸€æ—¦æœ¬æœºå‘ç”Ÿå®•æœºï¼Œå°±èƒ½å°†å¤‡ä»½æ–‡ä»¶å¤åˆ¶åˆ°rediså®‰è£…ç›®å½•ä¸‹ï¼Œé€šè¿‡å¯ç”¨æœåŠ¡å°±èƒ½å®Œæˆæ•°æ®çš„æ¢å¤ã€‚</p>
<p>ç¼ºç‚¹</p>
<p>RDBè¿™ç§æŒä¹…åŒ–æ–¹å¼ä¸å¤ªé€‚åº”å¯¹æ•°æ®å®Œæ•´æ€§è¦æ±‚ä¸¥æ ¼çš„æƒ…å†µï¼Œå› ä¸ºï¼Œå°½ç®¡æˆ‘ä»¬å¯ä»¥ç”¨è¿‡ä¿®æ”¹å¿«ç…§å®ç°æŒä¹…åŒ–çš„é¢‘ç‡ï¼Œä½†æ˜¯è¦æŒä¹…åŒ–çš„æ•°æ®æ˜¯ä¸€æ®µæ—¶é—´å†…çš„æ•´ä¸ªæ•°æ®é›†çš„çŠ¶æ€ï¼Œå¦‚æœåœ¨è¿˜æ²¡æœ‰è§¦å‘å¿«ç…§æ—¶ï¼Œæœ¬æœºå°±å®•æœºäº†ï¼Œé‚£ä¹ˆå¯¹æ•°æ®åº“æ‰€åšçš„å†™æ“ä½œå°±éšä¹‹è€Œæ¶ˆå¤±äº†å¹¶æ²¡æœ‰æŒä¹…åŒ–æœ¬åœ°dump.rdbæ–‡ä»¶ä¸­ã€‚</p>
<p><strong>AOFä¼˜ç‚¹ä¸ç¼ºç‚¹</strong></p>
<p>ä¼˜ç‚¹</p>
<p>AOFæœ‰ç€å¤šç§æŒä¹…åŒ–ç­–ç•¥ï¼š</p>
<p>appendfsync always:æ¯ä¿®æ”¹åŒæ­¥ï¼Œæ¯ä¸€æ¬¡å‘ç”Ÿæ•°æ®å˜æ›´éƒ½ä¼šæŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šï¼Œæ€§èƒ½è¾ƒå·®ï¼Œä½†æ•°æ®å®Œæ•´æ€§è¾ƒå¥½ã€‚</p>
<p>appendfsync everysec: æ¯ç§’åŒæ­¥ï¼Œæ¯ç§’å†…è®°å½•æ“ä½œï¼Œå¼‚æ­¥æ“ä½œï¼Œå¦‚æœä¸€ç§’å†…å®•æœºï¼Œæœ‰æ•°æ®ä¸¢å¤±ã€‚</p>
<p>appendfsync no:ä¸åŒæ­¥ã€‚</p>
<p>AOFæ–‡ä»¶æ˜¯ä¸€ä¸ªåªè¿›è¡Œè¿½åŠ æ“ä½œçš„æ—¥å¿—æ–‡ä»¶ï¼Œå¯¹æ–‡ä»¶å†™å…¥ä¸éœ€è¦è¿›è¡Œseekï¼Œå³ä½¿åœ¨è¿½åŠ çš„è¿‡ç¨‹ä¸­ï¼Œå†™å…¥äº†ä¸å®Œæ•´çš„å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼šç£ç›˜å·²æ»¡ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨redis-check-aofå·¥å…·å¯ä»¥ä¿®å¤è¿™ç§é—®é¢˜</p>
<p>Rediså¯ä»¥åœ¨AOFæ–‡ä»¶å˜å¾—è¿‡å¤§æ—¶ï¼Œä¼šè‡ªåŠ¨åœ°åœ¨åå°å¯¹AOFè¿›è¡Œé‡å†™ï¼šé‡å†™åçš„æ–°çš„AOFæ–‡ä»¶åŒ…å«äº†æ¢å¤å½“å‰æ•°æ®é›†æ‰€éœ€çš„æœ€å°å‘½ä»¤é›†åˆã€‚æ•´ä¸ªé‡å†™æ“ä½œæ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œå› ä¸ºRedisåœ¨åˆ›å»ºAOFæ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œä¼šç»§ç»­å°†å‘½ä»¤è¿½åŠ åˆ°ç°æœ‰çš„AOFæ–‡ä»¶ä¸­ï¼Œå³ä½¿åœ¨é‡å†™çš„è¿‡ç¨‹ä¸­å‘ç”Ÿå®•æœºï¼Œç°æœ‰çš„AOFæ–‡ä»¶ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚ä¸€æ—¦æ–°AOFæ–‡ä»¶åˆ›å»ºå®Œæ¯•ï¼ŒRediså°±ä¼šä»æ—§çš„AOFæ–‡ä»¶åˆ‡æ¢åˆ°æ–°çš„AOFæ–‡ä»¶ï¼Œå¹¶å¯¹æ–°çš„AOFæ–‡ä»¶è¿›è¡Œè¿½åŠ æ“ä½œã€‚</p>
<p>ç¼ºç‚¹</p>
<p>å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼ŒAOFæ–‡ä»¶è¦æ¯”RDBæ–‡ä»¶å¤§ã€‚</p>
<p>æ ¹æ®æ‰€ä½¿ç”¨çš„æŒä¹…åŒ–ç­–ç•¥æ¥è¯´ï¼ŒAOFçš„é€Ÿåº¦è¦æ…¢äºRDBã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ç§’åŒæ­¥ç­–ç•¥æ•ˆæœè¾ƒå¥½ã€‚ä¸ä½¿ç”¨åŒæ­¥ç­–ç•¥çš„æƒ…å†µä¸‹ï¼ŒAOFä¸RDBé€Ÿåº¦ä¸€æ ·å¿«ã€‚</p>
</blockquote>
<h3 id="åä¸€ã€Redisçš„ä¸»ä»å¤åˆ¶-ã€é‡ç‚¹ã€‘"><a href="#åä¸€ã€Redisçš„ä¸»ä»å¤åˆ¶-ã€é‡ç‚¹ã€‘" class="headerlink" title="åä¸€ã€Redisçš„ä¸»ä»å¤åˆ¶ ã€é‡ç‚¹ã€‘"></a>åä¸€ã€Redisçš„ä¸»ä»å¤åˆ¶ ã€é‡ç‚¹ã€‘</h3><hr>
<blockquote>
<p>ä¸»ä»å¤åˆ¶æ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶å®ƒçš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave)ï¼›æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼Œä¸”ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªä»èŠ‚ç‚¹ï¼ˆæˆ–æ²¡æœ‰ä»èŠ‚ç‚¹ï¼‰ï¼Œä½†ä¸€ä¸ªä»èŠ‚ç‚¹åªèƒ½æœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071240740.png"></p>
<blockquote>
<p>ä¸»ä»å¤åˆ¶çš„ä½œç”¨ï¼š</p>
<p>1.æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</p>
<p>2.æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼Œä½†å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™.</p>
<p>3.è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯»Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</p>
<p>4.é«˜å¯ç”¨åŸºçŸ³ï¼šé™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯Redisé«˜å¯ç”¨çš„åŸºç¡€.</p>
</blockquote>
<blockquote>
<p><strong>é…ç½®æ­¥éª¤ï¼š</strong></p>
<p>1.æŸ¥çœ‹å½“å‰åº“çš„ä¿¡æ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241232.png"></p>
<p>2.å…³é—­å½“å‰è¿è¡Œçš„redisï¼Œæ‰“å¼€å››ä¸ªé“¾æ¥ï¼Œè¿›è¡Œæµ‹è¯•ï¼Œæ‹·è´ä¸‰ä¸ªredis.confæ–‡ä»¶ï¼ˆæ”¹æˆ6379ï¼Œ6380ï¼Œ6381ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241363.png"></p>
<p>3.åˆ†åˆ«ä¿®æ”¹è¿™ä¸‰ä¸ªæ–‡ä»¶ä¿¡æ¯ï¼Œéœ€è¦ä¿®æ”¹ï¼šç«¯å£ï¼Œpidåå­—ï¼Œlogæ–‡ä»¶åå­—ï¼Œdump.rdbåå­—</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241463.png"></p>
<p>port 6379</p>
<p>pidfile &#x2F;var&#x2F;run&#x2F;redis_6379.pid</p>
<p>logfile â€œ6379.logâ€</p>
<p>dbfilename dump6379.rdb</p>
<p>port 6380</p>
<p>pidfile &#x2F;var&#x2F;run&#x2F;redis_63780pid</p>
<p>logfile â€œ6380.logâ€</p>
<p>dbfilename dump6380.rdb</p>
<p>port 6381</p>
<p>pidfile &#x2F;var&#x2F;run&#x2F;redis_6381.pid</p>
<p>logfile â€œ6381.logâ€</p>
<p>dbfilename dump6381.rdb</p>
<p>4.åˆ†åˆ«åœ¨ä¸‰ä¸ªé“¾æ¥ä¸­å¯åŠ¨6379ï¼Œ6380ï¼Œ6381ä¸‰å°redis-serverï¼Œåœ¨ç¬¬å››ä¸ªé“¾æ¥ä¸­æŸ¥çœ‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241739.png"></p>
<p>æŸ¥çœ‹çŠ¶æ€</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241022.png"></p>
<p>5.é…ç½®ä¸€ä¸»äºŒä»</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°Rediséƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦é…ç½®ä»æœºå³å¯ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨6379ä¸ºä¸»æœºï¼Œ6380å’Œ6381ä¸ºä»æœº.</p>
<p>åœ¨å¯¹åº”6380çš„é“¾æ¥ä¸­è¿›è¡Œé…ç½®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-cli -p 6380</span><br><span class="line"></span><br><span class="line">127.0.0.1:6380&gt; slaveof 127.0.0.1 6379</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241702.png"></p>
<p>6380ä»æœºé…ç½®æˆåŠŸä¹‹åï¼Œå¯ä»¥å»ä¸»æœºä¸­æŸ¥çœ‹å¯¹åº”ä¿¡æ¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241494.png"></p>
<p>6381ä»æœºé…ç½®æ–¹å¼å’Œ6380ä¸€æ ·ï¼Œé…ç½®æˆåŠŸä¹‹åå¯ä»¥å†å»çœ‹ä¸€ä¸‹ä¸»æœº</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241741.png"></p>
<p>6.ç”±äºè¿™é‡Œä½¿ç”¨çš„æ˜¯å‘½ä»¤è¿›è¡Œé…ç½®ï¼Œæ‰€ä»¥æ˜¯æš‚æ—¶çš„ï¼Œä¸€èˆ¬å…¬å¸é…ç½®ä¼šåœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œå±äºæ°¸ä¹…æ€§é…ç½®ï¼Œç›¸å½“äºä¸€æ‰“å¼€å½“å‰æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨å°±æ˜¯ä»æœºï¼Œä¸€èˆ¬ä¸»æœºå¯ä»¥å†™ï¼Œä»æœºä¸èƒ½å†™åªèƒ½è¯»ï¼Œä¸»æœºä¸­çš„æ‰€æœ‰ä¿¡æ¯å’Œæ•°æ®éƒ½ä¼šè¢«ä»æœºä¿å­˜ï¼</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241875.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241162.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241729.png"></p>
<p>å³ä½¿ä¸»æœºæ–­å¼€é“¾æ¥ï¼ˆ127.0.0.1:6379&gt;shutdownï¼‰ï¼Œä»æœºä»ç„¶å¯ä»¥è¿æ¥åˆ°ä¸»æœºï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯å‘½ä»¤è¡Œé…ç½®çš„ä»æœºï¼Œä»æœºä¸€æ—¦æ–­å¼€é“¾æ¥åï¼Œå°±ä¼šå˜å›ä¸»æœºäº†ï¼Œå¦‚æœå†æ¬¡å˜å›ä»æœºï¼Œä»æ—§å¯ä»¥è·å–ä¸»æœºä¸­çš„å€¼.</p>
<p>å¦‚æœä¸»æœºæ–­å¼€é“¾æ¥ï¼Œä»æœºå¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼š127.0.0.1:6380&gt;slaveof no one ä½¿è‡ªå·±æˆä¸ºä¸»æœº</p>
<p>7.ä¸»ä»å¤åˆ¶åŸç†</p>
<p>Slaveå¯åŠ¨æˆåŠŸè¿æ¥åˆ°masteråä¼šå‘é€ä¸€ä¸ªsyncåŒæ­¥å‘½ä»¤ï¼ŒMasteræ¥åˆ°å‘½ä»¤åï¼Œä¼šå¯åŠ¨åå°çš„å­˜ç›˜è¿›ç¨‹ï¼ŒåŒæ—¶æ”¶é›†æ‰€æœ‰æ¥æ”¶åˆ°çš„ç”¨äºä¿®æ”¹æ•°æ®é›†å‘½ä»¤ï¼Œåœ¨åå°è¿›ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œmasterå°†ä¼ é€æ•´ä¸ªæ•°æ®æ–‡ä»¶åˆ°salveï¼Œå¹¶å®Œæˆä¸€æ¬¡å®Œæ•´çš„åŒæ­¥.</p>
<p>å…¨é‡å¤åˆ¶ï¼šsalveæœåŠ¡åœ¨æ¥æ”¶åˆ°æ•°æ®åº“æ–‡ä»¶æ•°æ®åï¼Œå°†å…¶å­˜ç›˜å¹¶åŠ è½½åˆ°å†…å­˜ä¸­.</p>
<p>å¢é‡å¤åˆ¶ï¼šmasterç»§ç»­å°†æ–°çš„æ‰€æœ‰æ”¶é›†åˆ°çš„ä¿®æ”¹å‘½ä»¤ä¾æ¬¡ä¼ é€’ç»™salveï¼Œå®ŒæˆåŒæ­¥.</p>
</blockquote>
<blockquote>
<p>å¦‚æœæ˜¯é…ç½®æ–‡ä»¶é…ç½®ï¼Œå¯ç›´æ¥åœ¨å¯¹åº”çš„redis.confæ–‡ä»¶ä¸­æ·»åŠ ï¼š slaveof 127.0.0.1 6379 ï¼ˆå’Œå‘½ä»¤ä¸€æ ·ï¼‰</p>
</blockquote>
<h3 id="åäºŒã€Redisçš„å“¨å…µæ¨¡å¼ã€é‡ç‚¹ã€‘"><a href="#åäºŒã€Redisçš„å“¨å…µæ¨¡å¼ã€é‡ç‚¹ã€‘" class="headerlink" title="åäºŒã€Redisçš„å“¨å…µæ¨¡å¼ã€é‡ç‚¹ã€‘"></a>åäºŒã€Redisçš„å“¨å…µæ¨¡å¼ã€é‡ç‚¹ã€‘</h3><hr>
<blockquote>
<p>å½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œå¹¶ä¸”æˆ‘ä»¬å¹¶æ²¡æœ‰åŠæ—¶å‘ç°ï¼Œè¿™æ—¶å€™å°±å¯èƒ½ä¼šå‡ºç°æ•°æ®ä¸¢å¤±æˆ–ç¨‹åºæ— æ³•è¿è¡Œã€‚æ­¤æ—¶ï¼Œredisçš„å“¨å…µæ¨¡å¼å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œå¯ä»¥ç”¨å®ƒæ¥åšredisçš„é«˜å¯ç”¨.</p>
<p>æ¯ä¸ªå“¨å…µéƒ½æ˜¯ç›‘æ§ä¸»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹å®•æœºï¼Œå“¨å…µä¸ä¼šå®•æœºï¼</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241034.png"></p>
<blockquote>
<p>åŠŸèƒ½ä½œç”¨ï¼š</p>
<p>1.ç›‘æ§(monitoring)ï¼šSentinel ä¼šä¸æ–­åœ°æ£€æŸ¥ä½ çš„ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</p>
<p>2.æé†’(Notifation)ï¼šå½“è¢«ç›‘æ§çš„æŸä¸ª Redis æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œ Sentinel å¯ä»¥é€šè¿‡ API å‘ç®¡ç†å‘˜æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚</p>
<p>3.è‡ªåŠ¨æ•…éšœè½¬ç§»(Automatic failover)ï¼šå½“ä¸€ä¸ªä¸»æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œ Sentinel ä¼šå¼€å§‹ä¸€æ¬¡è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œï¼Œ å®ƒä¼šå°†å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä¸­ä¸€ä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œ å¹¶è®©å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä»–ä»æœåŠ¡å™¨æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»æœåŠ¡å™¨ï¼› å½“å®¢æˆ·ç«¯è¯•å›¾è¿æ¥å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œ é›†ç¾¤ä¹Ÿä¼šå‘å®¢æˆ·ç«¯è¿”å›æ–°ä¸»æœåŠ¡å™¨çš„åœ°å€ï¼Œ ä½¿å¾—é›†ç¾¤å¯ä»¥ä½¿ç”¨æ–°ä¸»æœåŠ¡å™¨ä»£æ›¿å¤±æ•ˆæœåŠ¡å™¨ã€‚</p>
</blockquote>
<blockquote>
<p><strong>é…ç½®æ­¥éª¤ï¼š</strong></p>
<p>1.åˆ›å»ºå“¨å…µé…ç½®æ–‡ä»¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# vim sentinel.conf</span><br></pre></td></tr></table></figure>

<p>sentinel.confæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼šï¼ˆæ ¼å¼ï¼šsentinel monitor è¢«ç›‘æ§åç§° host port 1ï¼‰</p>
<p>sentinel monitor myredis 127.0.0.1 6379 1</p>
<p>æ³¨æ„ï¼šéœ€è¦ä¿®æ”¹redis.confæ–‡ä»¶ä¸­çš„bindä¸ºï¼š0.0.0.0ï¼ˆä¹‹å‰å·²ç»ä¿®æ”¹è¿‡äº†ï¼‰ï¼Œå¦‚æœæ˜¯ä¸‰å°é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œæ¯ä¸ªæœåŠ¡å™¨éƒ½è¦è®¾ç½®sentinel.confæ–‡ä»¶å¹¶å¯åŠ¨å“¨å…µï¼Œ127.0.0.1æ”¹æˆä¸»æœºçš„IPåœ°å€ï¼Œï¼ˆä»æœºä¹Ÿæ˜¯ç›‘æ§ä¸»æœºIPï¼Œç›¸å½“äºä¸‰å°æœåŠ¡å™¨çš„sentinel.confçš„å†…å®¹éƒ½æ˜¯ä¸€æ ·çš„ï¼šsentinel monitor myredis ä¸»æœºIPåœ°å€ 6379 1ï¼‰ï¼Œåé¢çš„æ•°å­—1è¡¨ç¤ºæœ‰1ä¸ªsentinelè®¤ä¸ºä¸€ä¸ªmasterå¤±æ•ˆæ—¶ï¼Œmasterå°±ç®—çœŸæ­£å¤±æ•ˆï¼Œslaveä¼šä»¥æŠ•ç¥¨çš„æ–¹å¼é€‰ä¸¾æˆä¸ºä¸»æœºï¼Œä¸€èˆ¬è®¾ç½®çš„å€¼ä¸ºä»æœºæ•°é‡ä¸€åŠä»¥ä¸Šï¼Œæ¯”å¦‚è¯´ï¼šä¸‰ä¸ªä»æœºå°±è®¾ç½®ä¸ºï¼š2</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241771.png"></p>
<p>2.å¯åŠ¨å“¨å…µ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@localhost bin]# ./redis-sentinel sentinel.conf</span><br></pre></td></tr></table></figure>

<p><img src="/Pictures%5C59.png"></p>
<p>3.å¦‚æœMasterèŠ‚ç‚¹æ–­å¼€äº†ï¼ˆä¸»æœºå®•æœºäº†ï¼‰ï¼Œè¿‡ä¸€ä¼šï¼Œä¼šå‘é€å“¨å…µæ—¥å¿—ï¼Œå¹¶è‡ªåŠ¨é€šè¿‡ç®—æ³•åœ¨å…¶ä»–ä¸¤ä¸ªä»æœºä¸­é€‰æ‹©ä¸€ä¸ªæˆä¸ºä¸»æœº.</p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071241535.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071242550.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071242883.png"></p>
<p>å¦‚æœä¹‹å‰çš„ä¸»æœº6379åˆé‡æ–°å¯åŠ¨äº†ï¼Œè¿‡ä¸€ä¼šï¼Œå“¨å…µæ£€æµ‹åˆ°äº†ä¹‹åï¼Œä¼šæŠŠ6379è®¾ç½®ä¸ºä»æœºï¼</p>
<p>å“¨å…µæ¨¡å¼çš„ä¼˜ç¼ºç‚¹</p>
<p>ä¼˜ç‚¹</p>
<p>1.å“¨å…µé›†ç¾¤æ¨¡å¼æ˜¯åŸºäºä¸»ä»æ¨¡å¼çš„ï¼Œæ‰€æœ‰ä¸»ä»çš„ä¼˜ç‚¹ï¼Œå“¨å…µæ¨¡å¼åŒæ ·å…·æœ‰ã€‚</p>
<p>2.ä¸»ä»å¯ä»¥åˆ‡æ¢ï¼Œæ•…éšœå¯ä»¥è½¬ç§»ï¼Œç³»ç»Ÿå¯ç”¨æ€§æ›´å¥½ã€‚</p>
<p>3.å“¨å…µæ¨¡å¼æ˜¯ä¸»ä»æ¨¡å¼çš„å‡çº§ï¼Œç³»ç»Ÿæ›´å¥å£®ï¼Œå¯ç”¨æ€§æ›´é«˜ã€‚</p>
<p>ç¼ºç‚¹</p>
<p>1.Redisè¾ƒéš¾æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œåœ¨é›†ç¾¤å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶åœ¨çº¿æ‰©å®¹ä¼šå˜å¾—å¾ˆå¤æ‚ã€‚</p>
<p>2.å®ç°å“¨å…µæ¨¡å¼çš„é…ç½®ä¹Ÿä¸ç®€å•ï¼Œç”šè‡³å¯ä»¥è¯´æœ‰äº›ç¹ç</p>
</blockquote>
<h3 id="åä¸‰ã€Redisç¼“å­˜ç©¿é€ï¼Œå‡»ç©¿ï¼Œé›ªå´©ï¼Œå€¾æ–œ"><a href="#åä¸‰ã€Redisç¼“å­˜ç©¿é€ï¼Œå‡»ç©¿ï¼Œé›ªå´©ï¼Œå€¾æ–œ" class="headerlink" title="åä¸‰ã€Redisç¼“å­˜ç©¿é€ï¼Œå‡»ç©¿ï¼Œé›ªå´©ï¼Œå€¾æ–œ"></a>åä¸‰ã€Redisç¼“å­˜ç©¿é€ï¼Œå‡»ç©¿ï¼Œé›ªå´©ï¼Œå€¾æ–œ</h3><hr>
<h4 id="1-1-ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰"><a href="#1-1-ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰" class="headerlink" title="1.1 ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰"></a>1.1 ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰</h4><blockquote>
<p>æ¦‚å¿µï¼šå½“ç”¨æˆ·å»æŸ¥è¯¢æ•°æ®çš„æ—¶å€™ï¼Œå‘ç°rediså†…å­˜æ•°æ®åº“ä¸­æ²¡æœ‰ï¼Œäºæ˜¯å‘æŒä¹…å±‚æ•°æ®åº“æŸ¥è¯¢ï¼Œå‘ç°ä¹Ÿæ²¡æœ‰ï¼Œäºæ˜¯æŸ¥è¯¢å¤±è´¥ï¼Œå½“ç”¨æˆ·è¿‡å¤šæ—¶ï¼Œç¼“å­˜éƒ½æ²¡æœ‰æŸ¥åˆ°ï¼Œäºæ˜¯éƒ½å»æŸ¥æŒä¹…å±‚æ•°æ®åº“ï¼Œè¿™ä¼šç»™æŒä¹…å±‚æ•°æ®åº“é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œæ­¤æ—¶ç›¸å½“äºå‡ºç°äº†ç¼“å­˜ç©¿é€ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071242308.png"></p>
<blockquote>
<p> è§£å†³æ–¹æ¡ˆï¼š</p>
<p> 1.å¸ƒéš†è¿‡æ»¤å™¨ï¼šæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥hashå½¢å¼å­˜å‚¨ï¼Œåœ¨æ§åˆ¶å±‚å…ˆè¿›è¡Œæ ¡éªŒï¼Œä¸ç¬¦åˆåˆ™ä¸¢å¼ƒï¼Œä»è€Œé¿å…äº†å¯¹åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„å‹åŠ›ï¼Œä½†æ˜¯ï¼Œå¸ƒéš†è¿‡æ»¤å™¨æœ‰è¯¯å·®ï¼Œè¯´myql æœ‰è¯¥id ï¼Œä¸ä¸€å®šæœ‰ï¼Œè¯´myql æ²¡æœ‰è¯¥idï¼Œä¸€å®šæ²¡æœ‰ ï¼</p>
<p> <img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071242234.png"></p>
<p> 2.ç¼“å­˜ç©ºå¯¹è±¡ï¼šå½“å­˜å‚¨å±‚æŸ¥ä¸åˆ°æ—¶ï¼Œå³ä½¿è¿”å›çš„ç©ºå¯¹è±¡ä¹Ÿå°†å…¶ç¼“å­˜èµ·æ¥ï¼ŒåŒæ—¶è®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¹‹åå†è®¿é—®è¿™ä¸ªæ•°æ®å°†ä¼šä»ç¼“å­˜ä¸­è·å–ï¼Œä¿æŠ¤åç«¯æ•°æ®.</p>
<p> <img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071242723.png"></p>
<p> ä½†ä¼šæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<p> 1.å¦‚æœç©ºå€¼è¢«ç¼“å­˜èµ·æ¥ï¼Œå°±æ„å‘³ç€éœ€è¦æ›´å¤šçš„ç©ºé—´å­˜å‚¨æ›´å¤šçš„é”®ï¼Œä¼šæœ‰å¾ˆå¤šç©ºå€¼çš„é”®.</p>
<p> 2.å³ä½¿å¯¹ç©ºå€¼è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£ä¸ä¸€è‡´ï¼Œè¿™å¯¹äºéœ€è¦ä¿æŒä¸€è‡´æ€§çš„ä¸šåŠ¡ä¼šæœ‰å½±å“.</p>
</blockquote>
<h4 id="1-2-ç¼“å­˜å‡»ç©¿ï¼ˆè®¿é—®é‡å¤§ï¼Œç¼“å­˜è¿‡æœŸï¼‰"><a href="#1-2-ç¼“å­˜å‡»ç©¿ï¼ˆè®¿é—®é‡å¤§ï¼Œç¼“å­˜è¿‡æœŸï¼‰" class="headerlink" title="1.2 ç¼“å­˜å‡»ç©¿ï¼ˆè®¿é—®é‡å¤§ï¼Œç¼“å­˜è¿‡æœŸï¼‰"></a>1.2 ç¼“å­˜å‡»ç©¿ï¼ˆè®¿é—®é‡å¤§ï¼Œç¼“å­˜è¿‡æœŸï¼‰</h4><blockquote>
<p>æŒ‡å¯¹æŸä¸€ä¸ªkeyçš„é¢‘ç¹è®¿é—®ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ä¼šç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ä¸ªå±éšœä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ï¼Œä¾‹å¦‚å¾®åšç”±äºæŸä¸ªçƒ­æœå¯¼è‡´å®•æœº.</p>
<p>â€‹</p>
<p>å…¶å®å°±æ˜¯ï¼šå½“æŸä¸ªkeyåœ¨è¿‡æœŸçš„ç¬é—´ï¼Œæœ‰å¤§é‡çš„è¯·æ±‚å¹¶å‘è®¿é—®ï¼Œè¿™ç±»æ•°æ®ä¸€æ®µæ˜¯çƒ­ç‚¹æ•°æ®ï¼Œç”±äºç¼“å­˜è¿‡æœŸï¼Œä¼šåŒæ—¶è®¿é—®æ•°æ®åº“æ¥æŸ¥è¯¢æœ€æ–°æ•°æ®ï¼Œå¹¶å›å†™ç¼“å­˜ï¼Œå¯¼è‡´æ•°æ®åº“ç¬é—´å‹åŠ›è¿‡å¤§ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071242941.png"></p>
<blockquote>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>1.è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸï¼šä»ç¼“å­˜å±‚é¢ä¸Šæ¥è¯´ï¼Œä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå°±ä¸ä¼šå‡ºç°çƒ­ç‚¹keyè¿‡æœŸåäº§ç”Ÿçš„é—®é¢˜.</p>
<p>2.æ·»åŠ äº’æ–¥é”ï¼šä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œä¿è¯å¯¹æ¯ä¸ªkeyåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å»æŸ¥è¯¢åç«¯æœåŠ¡ï¼Œå…¶ä»–çº¿ç¨‹æ²¡æœ‰è·å¾—åˆ†å¸ƒå¼é”çš„æƒé™ï¼Œå› æ­¤åªéœ€è¦ç­‰å¾…å³å¯ï¼Œè¿™ç§æ–¹å¼å°†é«˜å¹¶å‘çš„å‹åŠ›è½¬ç§»åˆ°äº†åˆ†å¸ƒå¼é”ä¸Šï¼Œå¯¹åˆ†å¸ƒå¼é”ä¹Ÿæ˜¯ä¸€ç§æå¤§çš„è€ƒéªŒ.</p>
</blockquote>
<h4 id="1-3-ç¼“å­˜é›ªå´©"><a href="#1-3-ç¼“å­˜é›ªå´©" class="headerlink" title="1.3 ç¼“å­˜é›ªå´©"></a>1.3 ç¼“å­˜é›ªå´©</h4><blockquote>
<p>æŒ‡åœ¨æŸä¸€ä¸ªæ—¶é—´æ®µï¼Œç¼“å­˜é›†ä¸­è¿‡æœŸå¤±æ•ˆæˆ–Rediså®•æœºå¯¼è‡´çš„ï¼Œä¾‹å¦‚åŒåä¸€æŠ¢è´­çƒ­é—¨å•†å“ï¼Œè¿™äº›å•†å“éƒ½ä¼šæ”¾åœ¨ç¼“å­˜ä¸­ï¼Œå‡è®¾ç¼“å­˜æ—¶é—´ä¸ºä¸€ä¸ªå°æ—¶ï¼Œä¸€ä¸ªå°æ—¶ä¹‹åï¼Œè¿™äº›å•†å“çš„ç¼“å­˜éƒ½è¿‡æœŸäº†ï¼Œè®¿é—®å‹åŠ›ç¬é—´éƒ½æ¥åˆ°äº†æ•°æ®åº“ä¸Šï¼Œæ­¤æ—¶æ•°æ®åº“ä¼šäº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›æ³¢å³°ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šåˆ°è¾¾å­˜å‚¨å±‚ï¼Œå­˜å‚¨å±‚çš„è°ƒç”¨é‡æš´å¢ï¼Œé€ æˆå­˜å‚¨å±‚æŒ‚æ‰çš„æƒ…å†µ.</p>
</blockquote>
<p><img src="/Pictures%5C67.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071242355.png"></p>
<blockquote>
<p>å…¶å®æ¯”è¾ƒè‡´å‘½çš„ç¼“å­˜é›ªå´©ï¼Œæ˜¯ç¼“å­˜æœåŠ¡å™¨æŸä¸ªèŠ‚ç‚¹å®•æœºæˆ–æ–­ç½‘ï¼Œå› ä¸ºè‡ªç„¶å½¢æˆçš„ç¼“å­˜é›ªå´©ï¼Œä¸€å®šæ˜¯åœ¨æŸä¸ªæ—¶é—´æ®µé›†ä¸­åˆ›å»ºç¼“å­˜ï¼Œæ­¤æ—¶çš„æ•°æ®åº“è¿˜æ˜¯å¯ä»¥é¡¶ä½å‹åŠ›çš„ï¼Œè€Œç¼“å­˜æœåŠ¡èŠ‚ç‚¹çš„å®•æœºï¼Œå¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆçš„å‹åŠ›æ˜¯ä¸å¯é¢„çŸ¥çš„ï¼Œæœ‰å¯èƒ½ç¬é—´å°±æŠŠæœåŠ¡å™¨å‹å®.</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>1.é…ç½®Redisçš„é«˜å¯ç”¨ï¼šå…¶å®å°±æ˜¯æ­å»ºé›†ç¾¤ç¯å¢ƒï¼Œæœ‰æ›´å¤šçš„å¤‡ç”¨æœº.</p>
<p>2.é™æµé™çº§ï¼šåœ¨ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡åŠ é”æˆ–è€…é˜Ÿåˆ—æ¥æ§åˆ¶è¯»æœåŠ¡å™¨ä»¥åŠå†™ç¼“å­˜çš„çº¿ç¨‹æ•°é‡ï¼Œæ¯”å¦‚å¯¹æŸä¸ªkeyåªå…è®¸ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®å’Œå†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾….</p>
<p>3.æ•°æ®é¢„çƒ­ï¼šåœ¨é¡¹ç›®æ­£å¼éƒ¨ç½²ä¹‹å‰ï¼ŒæŠŠå¯èƒ½ç”¨çš„æ•°æ®é¢„å…ˆè®¿é—®ä¸€è¾¹ï¼Œè¿™æ ·å¯ä»¥æŠŠä¸€äº›æ•°æ®åŠ è½½åˆ°ç¼“å­˜ä¸­ï¼Œåœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®ä¹‹å‰æ‰‹åŠ¨è§¦å‘åŠ è½½ç¼“å­˜ä¸­ä¸åŒçš„keyï¼Œè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œè®©ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´å°½é‡å‡è¡¡.</p>
</blockquote>
<h4 id="1-4-ç¼“å­˜å€¾æ–œ"><a href="#1-4-ç¼“å­˜å€¾æ–œ" class="headerlink" title="1.4 ç¼“å­˜å€¾æ–œ"></a>1.4 ç¼“å­˜å€¾æ–œ</h4><blockquote>
<p>æŒ‡æŸä¸€å°redisæœåŠ¡å™¨å‹åŠ›è¿‡å¤§è€Œå¯¼è‡´è¯¥æœåŠ¡å™¨å®•æœº.</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071242384.png"></p>
<h3 id="åå››ã€Redisé›†ç¾¤æ­å»º"><a href="#åå››ã€Redisé›†ç¾¤æ­å»º" class="headerlink" title="åå››ã€Redisé›†ç¾¤æ­å»º"></a>åå››ã€Redisé›†ç¾¤æ­å»º</h3><hr>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071242006.png"></p>
<h3 id="åäº”ã€Rediså…¶ä»–å¸¸è§é—®é¢˜"><a href="#åäº”ã€Rediså…¶ä»–å¸¸è§é—®é¢˜" class="headerlink" title="åäº”ã€Rediså…¶ä»–å¸¸è§é—®é¢˜"></a>åäº”ã€Rediså…¶ä»–å¸¸è§é—®é¢˜</h3><hr>
<h4 id="1-keyçš„ç”Ÿå­˜æ—¶é—´åˆ°äº†ï¼ŒRedisä¼šç«‹å³åˆ é™¤å—ï¼Ÿ"><a href="#1-keyçš„ç”Ÿå­˜æ—¶é—´åˆ°äº†ï¼ŒRedisä¼šç«‹å³åˆ é™¤å—ï¼Ÿ" class="headerlink" title="1.keyçš„ç”Ÿå­˜æ—¶é—´åˆ°äº†ï¼ŒRedisä¼šç«‹å³åˆ é™¤å—ï¼Ÿ"></a>1.keyçš„ç”Ÿå­˜æ—¶é—´åˆ°äº†ï¼ŒRedisä¼šç«‹å³åˆ é™¤å—ï¼Ÿ</h4><blockquote>
<p><strong>ä¸ä¼šç«‹å³åˆ é™¤</strong></p>
<p>1.1å®šæœŸåˆ é™¤ï¼šRedisæ¯éš”ä¸€æ®µæ—¶é—´å°±å»ä¼šå»æŸ¥çœ‹Redisè®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyï¼Œä¼šå†100msçš„é—´éš”ä¸­é»˜è®¤æŸ¥çœ‹3ä¸ªkeyã€‚</p>
<p>1.2æƒ°æ€§åˆ é™¤ï¼šå¦‚æœå½“ä½ å»æŸ¥è¯¢ä¸€ä¸ªå·²ç»è¿‡äº†ç”Ÿå­˜æ—¶é—´çš„keyæ—¶ï¼ŒRedisä¼šå…ˆæŸ¥çœ‹å½“å‰keyçš„ç”Ÿå­˜æ—¶é—´ï¼Œæ˜¯å¦å·²ç»åˆ°äº†ï¼Œç›´æ¥åˆ é™¤å½“å‰keyï¼Œå¹¶ä¸”ç»™ç”¨æˆ·è¿”å›ä¸€ä¸ªç©ºå€¼ã€‚</p>
</blockquote>
<h4 id="2-Redisçš„æ·˜æ±°æœºåˆ¶"><a href="#2-Redisçš„æ·˜æ±°æœºåˆ¶" class="headerlink" title="2.Redisçš„æ·˜æ±°æœºåˆ¶"></a>2.Redisçš„æ·˜æ±°æœºåˆ¶</h4><blockquote>
<p>åœ¨Rediså†…å­˜å·²ç»æ»¡çš„æ—¶å€™ï¼Œæ·»åŠ äº†ä¸€ä¸ªæ–°çš„æ•°æ®ï¼Œæ‰§è¡Œæ·˜æ±°æœºåˆ¶ã€‚(redis.confä¸­é…ç½®)</p>
<p>2.1  volatile-lruï¼šåœ¨å†…å­˜ä¸è¶³æ—¶ï¼ŒRedisä¼šåœ¨è®¾ç½®è¿‡äº†ç”Ÿå­˜æ—¶é—´çš„keyä¸­å¹²æ‰ä¸€ä¸ªæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚</p>
<p>2.2  allkeys-lruï¼šåœ¨å†…å­˜ä¸è¶³æ—¶ï¼ŒRedisä¼šåœ¨å…¨éƒ¨çš„keyä¸­å¹²æ‰ä¸€ä¸ªæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚</p>
<p>2.3  volatile-lfuï¼šåœ¨å†…å­˜ä¸è¶³æ—¶ï¼ŒRedisä¼šåœ¨è®¾ç½®è¿‡äº†ç”Ÿå­˜æ—¶é—´çš„keyä¸­å¹²æ‰ä¸€ä¸ªæœ€è¿‘æœ€å°‘é¢‘æ¬¡ä½¿ç”¨çš„keyã€‚</p>
<p>2.4  allkeys-lfuï¼šåœ¨å†…å­˜ä¸è¶³æ—¶ï¼ŒRedisä¼šåœ¨å…¨éƒ¨çš„keyä¸­å¹²æ‰ä¸€ä¸ªæœ€è¿‘æœ€å°‘é¢‘æ¬¡ä½¿ç”¨çš„keyã€‚</p>
<p>2.5  volatile-randomï¼šåœ¨å†…å­˜ä¸è¶³æ—¶ï¼ŒRedisä¼šåœ¨è®¾ç½®è¿‡äº†ç”Ÿå­˜æ—¶é—´çš„keyä¸­éšæœºå¹²æ‰ä¸€ä¸ªã€‚</p>
<p>2.6  allkeys-randomï¼šåœ¨å†…å­˜ä¸è¶³æ—¶ï¼ŒRedisä¼šåœ¨å…¨éƒ¨çš„keyä¸­éšæœºå¹²æ‰ä¸€ä¸ªã€‚</p>
<p>2.7  volatile-ttlï¼šåœ¨å†…å­˜ä¸è¶³æ—¶ï¼ŒRedisä¼šåœ¨è®¾ç½®è¿‡äº†ç”Ÿå­˜æ—¶é—´çš„keyä¸­å¹²æ‰ä¸€ä¸ªå‰©ä½™ç”Ÿå­˜æ—¶é—´æœ€å°‘çš„keyã€‚</p>
<p>2.8  noevictionï¼šï¼ˆé»˜è®¤ï¼‰åœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œç›´æ¥æŠ¥é”™ã€‚</p>
<p>æ–¹æ¡ˆï¼šæŒ‡å®šæ·˜æ±°æœºåˆ¶çš„æ–¹å¼ï¼šmaxmemory-policyå…·ä½“ç­–ç•¥ï¼Œè®¾ç½®Redisçš„æœ€å¤§å†…å­˜ï¼šmaxmemory å­—èŠ‚å¤§å°</p>
</blockquote>
]]></content>
      <categories>
        <category>åç«¯å­¦ä¹ </category>
        <category>redis</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>RabbitMQ</title>
    <url>/2022/06/30/RabbitMQ/</url>
    <content><![CDATA[<p>[TOC]</p>
<h3 id="ä¸€ã€å¼•è¨€"><a href="#ä¸€ã€å¼•è¨€" class="headerlink" title="ä¸€ã€å¼•è¨€"></a>ä¸€ã€å¼•è¨€</h3><blockquote>
<p>æ¨¡å—ä¹‹é—´çš„è€¦åˆåº¦è¿‡é«˜ï¼Œä¸€æ—¦ä¸€ä¸ªæ¨¡å—å®•æœºåï¼Œå…¨éƒ¨åŠŸèƒ½éƒ½ä¸èƒ½ç”¨äº†ï¼Œå¹¶ä¸”åŒæ­¥é€šè®¯çš„æˆæœ¬è¿‡é«˜ï¼Œç”¨æˆ·ä½“éªŒå·®ã€‚</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">RabbitMQå¼•è¨€</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071256754.png" alt="1587650344256"></td>
</tr>
</tbody></table>
<span id="more"></span>
<h3 id="äºŒã€RabbitMQä»‹ç»"><a href="#äºŒã€RabbitMQä»‹ç»" class="headerlink" title="äºŒã€RabbitMQä»‹ç»"></a>äºŒã€RabbitMQä»‹ç»</h3><hr>
<blockquote>
<p>å¸‚é¢ä¸Šæ¯”è¾ƒç«çˆ†çš„å‡ æ¬¾MQï¼š</p>
<p>ActiveMQï¼ŒRocketMQï¼ŒKafkaï¼ŒRabbitMQã€‚</p>
<ul>
<li><p>è¯­è¨€çš„æ”¯æŒï¼šActiveMQï¼ŒRocketMQåªæ”¯æŒJavaè¯­è¨€ï¼ŒKafkaå¯ä»¥æ”¯æŒå¤šé—¨è¯­è¨€ï¼ŒRabbitMQæ”¯æŒå¤šç§è¯­è¨€ã€‚</p>
</li>
<li><p>æ•ˆç‡æ–¹é¢ï¼šActiveMQï¼ŒRocketMQï¼ŒKafkaæ•ˆç‡éƒ½æ˜¯æ¯«ç§’çº§åˆ«ï¼ŒRabbitMQæ˜¯å¾®ç§’çº§åˆ«çš„ã€‚</p>
</li>
<li><p>æ¶ˆæ¯ä¸¢å¤±ï¼Œæ¶ˆæ¯é‡å¤é—®é¢˜ï¼š RabbitMQé’ˆå¯¹æ¶ˆæ¯çš„æŒä¹…åŒ–ï¼Œå’Œé‡å¤é—®é¢˜éƒ½æœ‰æ¯”è¾ƒæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆã€‚</p>
</li>
<li><p>å­¦ä¹ æˆæœ¬ï¼šRabbitMQéå¸¸ç®€å•ã€‚</p>
</li>
</ul>
<p>RabbitMQæ˜¯ç”±Rabbitå…¬å¸å»ç ”å‘å’Œç»´æŠ¤çš„ï¼Œæœ€ç»ˆæ˜¯åœ¨Pivotalï¼Œç”±Erlangè¯­è¨€å¼€å‘ï¼ˆå¹¶å‘çš„ç¼–ç¨‹è¯­è¨€ï¼‰</p>
<p>RabbitMQä¸¥æ ¼çš„éµå¾ªAMQPåè®®ï¼Œé«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œå¸®åŠ©æˆ‘ä»¬åœ¨è¿›ç¨‹ä¹‹é—´ä¼ é€’å¼‚æ­¥æ¶ˆæ¯ã€‚</p>
</blockquote>
<blockquote>
<p>â€‹	RabbitMQæ˜¯ç”¨Erlangå®ç°çš„ä¸€ä¸ªé«˜å¹¶å‘é«˜å¯é AMQPæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨ã€‚æ”¯æŒæ¶ˆæ¯çš„æŒä¹…åŒ–ã€äº‹åŠ¡ã€æ‹¥å¡æ§åˆ¶ã€è´Ÿè½½å‡è¡¡ç­‰ç‰¹æ€§ï¼Œä½¿å¾—RabbitMQæ‹¥æœ‰æ›´åŠ å¹¿æ³›çš„åº”ç”¨åœºæ™¯ã€‚RabbitMQè·ŸErlangå’ŒAMQPæœ‰å…³ã€‚ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹Erlangå’ŒAMQPã€‚</p>
<p>â€‹	 Erlangæ˜¯ä¸€é—¨åŠ¨æ€ç±»å‹çš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒä¹Ÿæ˜¯ä¸€é—¨è§£é‡Šå‹è¯­è¨€ï¼Œç”±Erlangè™šæ‹Ÿæœºè§£é‡Šæ‰§è¡Œã€‚ä»è¯­è¨€æ¨¡å‹ä¸Šè¯´ï¼ŒErlangæ˜¯åŸºäºActoræ¨¡å‹çš„å®ç°ã€‚åœ¨Actoræ¨¡å‹é‡Œé¢ï¼Œä¸‡ç‰©çš†Actorï¼Œæ¯ä¸ªActoréƒ½å°è£…ç€å†…éƒ¨çŠ¶æ€ï¼ŒActorç›¸äº’ä¹‹é—´åªèƒ½é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿™ä¸€ç§æ–¹å¼æ¥è¿›è¡Œé€šä¿¡ã€‚å¯¹åº”åˆ°Erlangé‡Œï¼Œæ¯ä¸ªActorå¯¹åº”ç€ä¸€ä¸ªErlangè¿›ç¨‹ï¼Œè¿›ç¨‹ä¹‹é—´é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œé€šä¿¡ã€‚ç›¸æ¯”å…±äº«å†…å­˜ï¼Œè¿›ç¨‹é—´é€šè¿‡æ¶ˆæ¯ä¼ é€’æ¥é€šä¿¡å¸¦æ¥çš„ç›´æ¥å¥½å¤„å°±æ˜¯æ¶ˆé™¤äº†ç›´æ¥çš„é”å¼€é”€(ä¸è€ƒè™‘Erlangè™šæ‹Ÿæœºåº•å±‚å®ç°ä¸­çš„é”åº”ç”¨)ã€‚</p>
<p>â€‹	AMQP(Advanced Message Queue Protocol)å®šä¹‰äº†ä¸€ç§æ¶ˆæ¯ç³»ç»Ÿè§„èŒƒã€‚è¿™ä¸ªè§„èŒƒæè¿°äº†åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼çš„ç³»ç»Ÿä¸­å„ä¸ªå­ç³»ç»Ÿå¦‚ä½•é€šè¿‡æ¶ˆæ¯äº¤äº’ã€‚è€ŒRabbitMQåˆ™æ˜¯AMQPçš„ä¸€ç§åŸºäºerlangçš„å®ç°ã€‚AMQPå°†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å„ä¸ªå­ç³»ç»Ÿéš”ç¦»å¼€æ¥ï¼Œå­ç³»ç»Ÿä¹‹é—´ä¸å†æœ‰ä¾èµ–ã€‚å­ç³»ç»Ÿä»…ä¾èµ–äºæ¶ˆæ¯ã€‚å­ç³»ç»Ÿä¸å…³å¿ƒæ¶ˆæ¯çš„å‘é€è€…ï¼Œä¹Ÿä¸å…³å¿ƒæ¶ˆæ¯çš„æ¥å—è€…ã€‚</p>
</blockquote>
<blockquote>
<p>ä¼˜ç‚¹</p>
<p>1ã€è§£è€¦ï¼šé™ä½ç³»ç»Ÿæ¨¡å—çš„è€¦åˆåº¦</p>
<p>2ã€æé«˜ç³»ç»Ÿå“åº”æ—¶é—´</p>
<p>3ã€å¼‚æ­¥æ¶ˆæ¯</p>
<p>4ã€è¿‡è½½ä¿æŠ¤ï¼Œæµé‡å‰Šå³°</p>
</blockquote>
<blockquote>
<p>1.åº”ç”¨è§£è€¦</p>
<p>åœºæ™¯ï¼šåŒ11è´­ç‰©ï¼Œç”¨æˆ·ä¸‹å•åï¼Œè®¢å•ç³»ç»Ÿéœ€è¦é€šçŸ¥åº“å­˜ç³»ç»Ÿï¼Œä¼ ç»Ÿçš„åšæ³•å°±æ˜¯è®¢å•ç³»ç»Ÿè°ƒç”¨åº“å­˜ç³»ç»Ÿçš„æ¥å£.</p>
<p>è¿™ç§åšæ³•æœ‰ä¸€ä¸ªç¼ºç‚¹:</p>
<ul>
<li>å½“åº“å­˜ç³»ç»Ÿå‡ºç°æ•…éšœæ—¶ï¼Œè®¢å•å°±ä¼šå¤±è´¥.</li>
<li>è®¢å•ç³»ç»Ÿå’Œåº“å­˜ç³»ç»Ÿé«˜è€¦åˆ.</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071256494.png" alt="1617864607294"></p>
<blockquote>
<p>å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—</p>
<ul>
<li><p>è®¢å•ç³»ç»Ÿ: ç”¨æˆ·ä¸‹å•åï¼Œè®¢å•ç³»ç»Ÿå®ŒæˆæŒä¹…åŒ–å¤„ç†ï¼Œå°†æ¶ˆæ¯å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—,è¿”å›ç”¨æˆ·è®¢å•ä¸‹å•æˆåŠŸã€‚</p>
</li>
<li><p>åº“å­˜ç³»ç»Ÿ: è®¢é˜…ä¸‹å•çš„æ¶ˆæ¯,è·å–ä¸‹å•æ¶ˆæ¯ï¼Œè¿›è¡Œåº“æ“ä½œã€‚ å°±ç®—åº“å­˜ç³»ç»Ÿå‡ºç°æ•…éšœï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿèƒ½ä¿è¯æ¶ˆæ¯çš„å¯é æŠ•é€’ï¼Œä¸ä¼šå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±</p>
</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071256472.png" alt="1617864757691"></p>
<blockquote>
<p>2.å¼‚æ­¥å¤„ç†<br>åœºæ™¯è¯´æ˜ï¼šç”¨æˆ·æ³¨å†Œåï¼Œéœ€è¦å‘æ³¨å†Œé‚®ä»¶å’Œæ³¨å†ŒçŸ­ä¿¡ï¼Œä¼ ç»Ÿçš„åšæ³•æœ‰ä¸¤ç§  1. ä¸²è¡Œçš„æ–¹å¼   2. å¹¶è¡Œçš„æ–¹å¼</p>
<p>ä¸²è¡Œæ–¹å¼: å°†æ³¨å†Œä¿¡æ¯å†™å…¥æ•°æ®åº“å,å‘é€æ³¨å†Œé‚®ä»¶ï¼Œå†å‘é€æ³¨å†ŒçŸ­ä¿¡ï¼Œä»¥ä¸Šä¸‰ä¸ªä»»åŠ¡å…¨éƒ¨å®Œæˆåæ‰è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ è¿™æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œé‚®ä»¶ï¼ŒçŸ­ä¿¡å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªé€šçŸ¥,è€Œè¿™ç§åšæ³•è®©å®¢æˆ·ç«¯ç­‰å¾…æ²¡æœ‰å¿…è¦ç­‰å¾…çš„ä¸œè¥¿.</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071256803.png" alt="1617865002916"></p>
<blockquote>
<p>å¹¶è¡Œæ–¹å¼:å°†æ³¨å†Œä¿¡æ¯å†™å…¥æ•°æ®åº“å,å‘é€é‚®ä»¶çš„åŒæ—¶,å‘é€çŸ­ä¿¡,ä»¥ä¸Šä¸‰ä¸ªä»»åŠ¡å®Œæˆå,è¿”å›ç»™å®¢æˆ·ç«¯,å¹¶è¡Œçš„æ–¹å¼èƒ½æé«˜å¤„ç†çš„æ—¶é—´</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257793.png" alt="1617865040355"></p>
<blockquote>
<p>å‡è®¾ä¸‰ä¸ªä¸šåŠ¡èŠ‚ç‚¹åˆ†åˆ«ä½¿ç”¨50msï¼Œä¸²è¡Œæ–¹å¼ä½¿ç”¨æ—¶é—´150ms,å¹¶è¡Œä½¿ç”¨æ—¶é—´100msã€‚è™½ç„¶å¹¶æ€§å·²ç»æé«˜çš„å¤„ç†æ—¶é—´ï¼Œä½†æ˜¯ï¼Œå‰é¢è¯´è¿‡,é‚®ä»¶å’ŒçŸ­ä¿¡å¯¹æˆ‘æ­£å¸¸çš„ä½¿ç”¨ç½‘ç«™æ²¡æœ‰ä»»ä½•å½±å“ï¼Œå®¢æˆ·ç«¯æ²¡æœ‰å¿…è¦ç­‰ç€å…¶å‘é€å®Œæˆæ‰æ˜¾ç¤ºæ³¨å†ŒæˆåŠŸ,è‹±çˆ±æ˜¯å†™å…¥æ•°æ®åº“åå°±è¿”å›.</p>
</blockquote>
<blockquote>
<p>æ¶ˆæ¯é˜Ÿåˆ—</p>
<p>å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—åï¼ŒæŠŠå‘é€é‚®ä»¶ï¼ŒçŸ­ä¿¡ä¸æ˜¯å¿…é¡»çš„ä¸šåŠ¡é€»è¾‘å¼‚æ­¥å¤„ç†ï¼Œå¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—åï¼Œç”¨æˆ·çš„å“åº”æ—¶é—´å°±ç­‰äºå†™å…¥æ•°æ®åº“çš„æ—¶é—´+å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—çš„æ—¶é—´(å¯ä»¥å¿½ç•¥ä¸è®¡)ï¼Œå¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—åå¤„ç†åï¼Œå“åº”æ—¶é—´æ˜¯ä¸²è¡Œçš„3å€ï¼Œæ˜¯å¹¶è¡Œçš„2å€</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257549.png" alt="1617865161427"></p>
<blockquote>
<p>3.æµé‡å‰Šå³°</p>
<p>æµé‡å‰Šå³°ä¸€èˆ¬åœ¨ç§’æ€æ´»åŠ¨ä¸­åº”ç”¨å¹¿æ³›</p>
<p>åœºæ™¯:ç§’æ€æ´»åŠ¨ï¼Œä¸€èˆ¬ä¼šå› ä¸ºæµé‡è¿‡å¤§ï¼Œå¯¼è‡´åº”ç”¨æŒ‚æ‰ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬åœ¨åº”ç”¨å‰ç«¯åŠ å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p>
<p>ä½œç”¨:<br>1.å¯ä»¥æ§åˆ¶æ´»åŠ¨äººæ•°ï¼Œè¶…è¿‡æ­¤ä¸€å®šé˜€å€¼çš„è®¢å•ç›´æ¥ä¸¢å¼ƒ</p>
<p>2.å¯ä»¥ç¼“è§£çŸ­æ—¶é—´çš„é«˜æµé‡å‹å®åº”ç”¨(åº”ç”¨ç¨‹åºæŒ‰è‡ªå·±çš„æœ€å¤§å¤„ç†èƒ½åŠ›è·å–è®¢å•)</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257803.png" alt="1617865250142"></p>
<blockquote>
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨é˜Ÿåˆ—çš„æœºåˆ¶æ¥å¤„ç†ï¼Œå¦‚åŒæˆ‘ä»¬åœ¨è¶…å¸‚ç»“ç®—ä¸€æ ·ï¼Œå¹¶ä¸ä¼šä¸€çªèœ‚ä¸€æ ·æ¶Œå…¥æ”¶é“¶å°ï¼Œè€Œæ˜¯æ’é˜Ÿç»“ç®—ï¼Œä¸€ä¸ªæ¥ç€ä¸€ä¸ªçš„å¤„ç†ï¼Œä¸èƒ½æ’é˜Ÿï¼Œå› ä¸ºåŒæ—¶ç»“ç®—å°±åªèƒ½è¾¾åˆ°è¿™ä¹ˆå¤šã€‚</p>
</blockquote>
<h3 id="ä¸‰ã€RabbitMQå®‰è£…"><a href="#ä¸‰ã€RabbitMQå®‰è£…" class="headerlink" title="ä¸‰ã€RabbitMQå®‰è£…"></a>ä¸‰ã€RabbitMQå®‰è£…</h3><hr>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.1&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">daocloud.io/library/rabbitmq:management</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">rabbitmq</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5672</span><span class="string">:5672</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">15672</span><span class="string">:15672</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./data:/var/lib/rabbitmq</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@192 ~]<span class="comment"># cd /opt</span></span><br><span class="line">[root@192 opt]<span class="comment"># mkdir docker_rabbitmq</span></span><br><span class="line">[root@192 opt]<span class="comment"># cd docker_rabbitmq/</span></span><br><span class="line">[root@192 docker_rabbitmq]<span class="comment"># vim docker-compose.yml</span></span><br><span class="line">[root@192 docker_rabbitmq]<span class="comment"># docker-compose up -d</span></span><br><span class="line">Creating network <span class="string">&quot;docker_rabbitmq_default&quot;</span> with the default driver</span><br><span class="line">Pulling rabbitmq (daocloud.io/library/rabbitmq:management)...</span><br><span class="line">management: Pulling from library/rabbitmq</span><br><span class="line">01bf7da0a88c: Pull complete</span><br><span class="line">f3b4a5f15c7a: Pull complete</span><br><span class="line">57ffbe87baa1: Pull complete</span><br><span class="line">5ef3ef76b1b5: Pull complete</span><br><span class="line">82a3ce07c0eb: Pull complete</span><br><span class="line">1da219d9bd70: Pull complete</span><br><span class="line">446554ac749d: Pull complete</span><br><span class="line">8e4c09e200e7: Pull complete</span><br><span class="line">7a8620611ebf: Pull complete</span><br><span class="line">c70a2924b273: Pull complete</span><br><span class="line">3b0b9e36b4e9: Pull complete</span><br><span class="line">7619a9a42512: Pull complete</span><br><span class="line">965a8e1f1b1c: Pull complete</span><br><span class="line">Digest: sha256:4cc2267788b21e0f34523b4f2d9b32ee1c2867bf2de75d572158d6115349658c</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> daocloud.io/library/rabbitmq:management</span><br><span class="line">Creating rabbitmq ... <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµè§ˆå™¨è®¿é—®ï¼š<a href="http://ip:15672/">http://ip:15672</a>  ï¼ˆæ³¨ï¼šipæŒ‡å½“å‰äº‘æœåŠ¡å™¨çš„åœ°å€ï¼Œäº‘æœåŠ¡å™¨è®°å¾—å¼€æ”¾ 15672 å’Œ 5672 ç«¯å£ï¼‰</p>
<p>ç”¨æˆ·åå’Œå¯†ç é»˜è®¤éƒ½æ˜¯ï¼šguest</p>
</blockquote>
<h3 id="å››ã€RabbitMQæ¶æ„ã€é‡ç‚¹ã€‘"><a href="#å››ã€RabbitMQæ¶æ„ã€é‡ç‚¹ã€‘" class="headerlink" title="å››ã€RabbitMQæ¶æ„ã€é‡ç‚¹ã€‘"></a>å››ã€RabbitMQæ¶æ„ã€<code>é‡ç‚¹</code>ã€‘</h3><hr>
<h4 id="4-1-å®˜æ–¹çš„ç®€å•æ¶æ„å›¾"><a href="#4-1-å®˜æ–¹çš„ç®€å•æ¶æ„å›¾" class="headerlink" title="4.1 å®˜æ–¹çš„ç®€å•æ¶æ„å›¾"></a>4.1 å®˜æ–¹çš„ç®€å•æ¶æ„å›¾</h4><blockquote>
<ul>
<li><p>Publisher - ç”Ÿäº§è€…ï¼šå‘å¸ƒæ¶ˆæ¯åˆ°RabbitMQä¸­çš„Exchange</p>
</li>
<li><p>Consumer - æ¶ˆè´¹è€…ï¼šç›‘å¬RabbitMQä¸­çš„Queueä¸­çš„æ¶ˆæ¯</p>
</li>
<li><p>Exchange - äº¤æ¢æœºï¼šå’Œç”Ÿäº§è€…å»ºç«‹è¿æ¥å¹¶æ¥æ”¶ç”Ÿäº§è€…çš„æ¶ˆæ¯</p>
</li>
<li><p>Queue - é˜Ÿåˆ—ï¼šExchangeä¼šå°†æ¶ˆæ¯åˆ†å‘åˆ°æŒ‡å®šçš„Queueï¼ŒQueueå’Œæ¶ˆè´¹è€…è¿›è¡Œäº¤äº’</p>
</li>
<li><p>Routes - è·¯ç”±ï¼šäº¤æ¢æœºä»¥ä»€ä¹ˆæ ·çš„ç­–ç•¥å°†æ¶ˆæ¯å‘å¸ƒåˆ°Queue</p>
</li>
</ul>
</blockquote>
<table>
<thead>
<tr>
<th align="center">ç®€å•æ¶æ„å›¾</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257617.png" alt="1587703812776"></td>
</tr>
</tbody></table>
<h4 id="4-2-RabbitMQçš„å®Œæ•´æ¶æ„å›¾"><a href="#4-2-RabbitMQçš„å®Œæ•´æ¶æ„å›¾" class="headerlink" title="4.2 RabbitMQçš„å®Œæ•´æ¶æ„å›¾"></a>4.2 RabbitMQçš„å®Œæ•´æ¶æ„å›¾</h4><blockquote>
<p>å®Œæ•´æ¶æ„å›¾</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">å®Œæ•´æ¶æ„å›¾</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257828.png" alt="1587705504342"></td>
</tr>
</tbody></table>
<h4 id="4-3-RabbitMQ-é€šè®¯æ–¹å¼"><a href="#4-3-RabbitMQ-é€šè®¯æ–¹å¼" class="headerlink" title="4.3 RabbitMQ é€šè®¯æ–¹å¼"></a>4.3 RabbitMQ é€šè®¯æ–¹å¼</h4><blockquote>
<p><a href="https://www.rabbitmq.com/getstarted.html">https://www.rabbitmq.com/getstarted.html</a></p>
</blockquote>
<h4 id="4-4-Hello-Worldæ¡ˆä¾‹æ¼”ç¤º"><a href="#4-4-Hello-Worldæ¡ˆä¾‹æ¼”ç¤º" class="headerlink" title="4.4 Hello-Worldæ¡ˆä¾‹æ¼”ç¤º"></a>4.4 Hello-Worldæ¡ˆä¾‹æ¼”ç¤º</h4><blockquote>
<ol>
<li>å¯¼å…¥ä¾èµ–</li>
</ol>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.rabbitmq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>amqp-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.15.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="2">
<li>åˆ›å»ºç”Ÿäº§è€… Publisher</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.rabbitmq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿäº§è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Publisher</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Publisher...&quot;</span>);</span><br><span class="line">        <span class="comment">//é…ç½®è¿æ¥å‚æ•°</span></span><br><span class="line">        <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">        factory.setHost(<span class="string">&quot;192.168.25.132&quot;</span>);</span><br><span class="line">        factory.setPort(<span class="number">5672</span>);</span><br><span class="line">        factory.setUsername(<span class="string">&quot;guest&quot;</span>);</span><br><span class="line">        factory.setPassword(<span class="string">&quot;guest&quot;</span>);</span><br><span class="line">        <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">        <span class="comment">//è·å–Channel</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">        <span class="comment">//é…ç½®é˜Ÿåˆ—å‚æ•°</span></span><br><span class="line">        <span class="comment">//å‚æ•°1ï¼šqueue - æŒ‡å®šé˜Ÿåˆ—çš„åç§°</span></span><br><span class="line">        <span class="comment">//å‚æ•°2ï¼šdurable - å½“å‰é˜Ÿåˆ—æ˜¯å¦éœ€è¦æŒä¹…åŒ–,å€¼ä¸ºtrueæ—¶è¡¨ç¤ºæŒä¹…åŒ–ï¼Œrabbitmqå®•æœºæˆ–é‡å¯åï¼Œé˜Ÿåˆ—ä¾ç„¶åœ¨</span></span><br><span class="line">        <span class="comment">//å‚æ•°3ï¼šexclusive - å½“å‰é˜Ÿåˆ—æ˜¯å¦ä¸ºæ’ä»–é˜Ÿåˆ—ï¼Œå€¼ä¸ºtrueæ—¶è¡¨ç¤ºä¸å½“å‰è¿æ¥ï¼ˆconnectionï¼‰ç»‘å®šï¼Œè¿æ¥å…³é—­ï¼Œé˜Ÿåˆ—æ¶ˆå¤±</span></span><br><span class="line">        <span class="comment">//å‚æ•°4ï¼šautoDelete - å½“å‰é˜Ÿåˆ—æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œå€¼ä¸ºtrueæ—¶è¡¨ç¤ºé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä¸€æ—¦è¢«æ¶ˆè´¹ï¼Œè¯¥é˜Ÿåˆ—ä¼šæ¶ˆå¤±</span></span><br><span class="line">        <span class="comment">//å‚æ•°5ï¼šarguments - æŒ‡å®šå½“å‰é˜Ÿåˆ—çš„ç›¸å…³å‚æ•°</span></span><br><span class="line">        channel.queueDeclare(<span class="string">&quot;helloworldQueue&quot;</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">false</span>,<span class="literal">null</span>);</span><br><span class="line">        <span class="comment">//å‘å¸ƒæ¶ˆæ¯åˆ°exchangeï¼ŒåŒæ—¶æŒ‡å®šè·¯ç”±çš„è§„åˆ™</span></span><br><span class="line">        <span class="comment">// å‚æ•°1ï¼šæŒ‡å®šexchangeï¼Œç›®å‰æµ‹è¯•æ²¡æœ‰åˆ›å»ºäº¤æ¢æœºï¼Œä½¿ç”¨&quot;&quot;</span></span><br><span class="line">        <span class="comment">// å‚æ•°2ï¼šæŒ‡å®šè·¯ç”±çš„è§„åˆ™ï¼Œæˆ–è€…ä½¿ç”¨å…·ä½“çš„é˜Ÿåˆ—åç§°</span></span><br><span class="line">        <span class="comment">// å‚æ•°3ï¼šæŒ‡å®šä¼ é€’çš„æ¶ˆæ¯æ‰€æºå¸¦çš„propertiesï¼Œç›®å‰æµ‹è¯•ä¸éœ€è¦ï¼Œä½¿ç”¨null</span></span><br><span class="line">        <span class="comment">// å‚æ•°4ï¼šæŒ‡å®šå‘å¸ƒçš„å…·ä½“æ¶ˆæ¯ï¼Œbyte[]ç±»å‹ï¼Œç›®å‰æµ‹è¯•éœ€è¦ï¼Œä¼ é€’æ•°æ®è¿›è¡Œç±»å‹è½¬æ¢</span></span><br><span class="line">        channel.basicPublish(<span class="string">&quot;&quot;</span>,<span class="string">&quot;helloworldQueue&quot;</span>,<span class="literal">null</span>,<span class="string">&quot;helloworld&quot;</span>.getBytes());</span><br><span class="line">        <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">        channel.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="3">
<li>åˆ›å»ºæ¶ˆè´¹è€… Consumer</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.rabbitmq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Consumer...&quot;</span>);</span><br><span class="line">        <span class="comment">//é…ç½®è¿æ¥å‚æ•°</span></span><br><span class="line">        <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">        factory.setHost(<span class="string">&quot;192.168.25.132&quot;</span>);</span><br><span class="line">        factory.setPort(<span class="number">5672</span>);</span><br><span class="line">        factory.setUsername(<span class="string">&quot;guest&quot;</span>);</span><br><span class="line">        factory.setPassword(<span class="string">&quot;guest&quot;</span>);</span><br><span class="line">        <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">        <span class="comment">//è·å–Channel</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">        <span class="comment">//ç›‘å¬é˜Ÿåˆ—</span></span><br><span class="line">        <span class="type">DefaultConsumer</span> <span class="variable">defaultConsumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ¥è‡ªç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼š&quot;</span>+<span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line">        <span class="comment">//å‚æ•°1ï¼šqueue - æŒ‡å®šæ¶ˆè´¹å“ªä¸ªé˜Ÿåˆ—</span></span><br><span class="line">        <span class="comment">//å‚æ•°2ï¼šautoAck - æŒ‡å®šæ˜¯å¦è‡ªåŠ¨ACK ï¼ˆtrueè¡¨ç¤ºæ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šç«‹å³å‘ŠçŸ¥RabbitMQï¼Œfalseè¡¨ç¤ºä¸å‘ŠçŸ¥ï¼‰</span></span><br><span class="line">        <span class="comment">//å‚æ•°3ï¼šconsumer - æŒ‡å®šæ¶ˆè´¹å›è°ƒ</span></span><br><span class="line">        channel.basicConsume(<span class="string">&quot;helloworldQueue&quot;</span>,<span class="literal">true</span>,defaultConsumer);</span><br><span class="line">        <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">        channel.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ†åˆ«å¯åŠ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…è¿›è¡Œæµ‹è¯•ï¼ˆç”Ÿäº§ä¸€æ¬¡æ‰èƒ½æ¶ˆè´¹ä¸€æ¬¡ï¼‰</p>
</blockquote>
<h4 id="4-5-åŸºæœ¬åŸç†"><a href="#4-5-åŸºæœ¬åŸç†" class="headerlink" title="4.5 åŸºæœ¬åŸç†"></a>4.5 åŸºæœ¬åŸç†</h4><blockquote>
<p>RabbitMQæ˜¯æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸€ç§å®ç°ï¼Œé‚£ä¹ˆä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—åˆ°åº•éœ€è¦ä»€ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯é˜Ÿåˆ—ï¼Œå³Queueï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æ‰€æœ‰åè¯éƒ½æ˜¯å›´ç»•è¿™ä¸ª<strong>Queue</strong>æ¥æ‹“å±•çš„ã€‚</p>
<p>â€‹	å°±RabbimtMQè€Œè¨€ï¼ŒQueueæ˜¯å…¶ä¸­çš„ä¸€ä¸ªé€»è¾‘ä¸Šçš„å®ç°ï¼Œæˆ‘ä»¬éœ€è¦è¿æ¥åˆ°RabbitMQæ¥æ“ä½œé˜Ÿåˆ—è¿›è€Œå®ç°ä¸šåŠ¡åŠŸèƒ½ï¼Œæ‰€ä»¥å°±ä¼šæœ‰<strong>Connection</strong>ï¼Œæˆ‘ä»¬å‘ä¸€æ¡æ¶ˆæ¯è¿æ¥ä¸€æ¬¡ï¼Œè¿™æ ·å¾ˆæ˜¾ç„¶æ˜¯æµªè´¹èµ„æºçš„ï¼Œå»ºç«‹è¿æ¥çš„è¿‡ç¨‹ä¹Ÿå¾ˆè€—æ—¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¼šåšä¸€ä¸ªä¸œè¥¿è®©ä»–æ¥ç®¡ç†è¿æ¥ï¼Œå½“æˆ‘ç”¨çš„æ—¶å€™ï¼Œç›´æ¥ä»é‡Œè¾¹æ‹¿å‡ºæ¥å·²ç»å»ºç«‹å¥½çš„è¿æ¥å‘ä¿¡æ¯ï¼Œé‚£ä¹ˆ<strong>ConnectionFactory</strong>åº”è¿è€Œç”Ÿã€‚</p>
<p>â€‹	æ¥ä¸‹æ¥ï¼Œå½“ç¨‹åºå¼€å‘æ—¶ï¼Œå¯èƒ½ä¸æ­¢ç”¨åˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¯èƒ½æœ‰è®¢å•çš„é˜Ÿåˆ—ã€æ¶ˆæ¯çš„é˜Ÿåˆ—ã€ä»»åŠ¡çš„é˜Ÿåˆ—ç­‰ç­‰ï¼Œé‚£ä¹ˆå°±éœ€è¦ç»™ä¸åŒçš„queueå‘ä¿¡æ¯ï¼Œé‚£ä¹ˆå’Œæ¯ä¸€ä¸ªé˜Ÿåˆ—è¿æ¥çš„è¿™ä¸ªæ¦‚å¿µï¼Œå°±å«<strong>Channel</strong>ã€‚</p>
<p>â€‹	å†å¾€ä¸‹æ¥ï¼Œå½“æˆ‘ä»¬å¼€å‘çš„æ—¶å€™è¿˜æœ‰æ—¶å€™ä¼šç”¨åˆ°è¿™æ ·ä¸€ç§åŠŸèƒ½ï¼Œå°±æ˜¯å½“æˆ‘å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œéœ€è¦è®©å‡ ä¸ªqueueéƒ½æ”¶åˆ°ï¼Œé‚£ä¹ˆæ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Œéš¾é“æˆ‘è¦ç»™æ¯ä¸€ä¸ªqueueå‘é€ä¸€æ¬¡æ¶ˆæ¯ï¼Ÿé‚£å²‚ä¸æ˜¯æµªè´¹å¸¦å®½åˆæµªè´¹èµ„æºï¼Œæˆ‘ä»¬èƒ½æƒ³åˆ°ä»€ä¹ˆåŠæ³•å‘¢ï¼Œå½“ç„¶æ˜¯æˆ‘ä»¬å‘é€ç»™RabbitMQæœåŠ¡å™¨ä¸€æ¬¡ï¼Œç„¶åè®©RabbitMQæœåŠ¡å™¨è‡ªå·±è§£æéœ€è¦ç»™å“ªä¸ªQueueå‘ï¼Œé‚£ä¹ˆ<strong>Exchange</strong>å°±æ˜¯å¹²è¿™ä»¶äº‹çš„<br>ä½†æ˜¯æˆ‘ä»¬ç»™Exchangeå‘æ¶ˆæ¯ï¼Œä»–æ€ä¹ˆçŸ¥é“ç»™å“ªä¸ªQueueå‘å‘¢ï¼Ÿè¿™é‡Œå°±ç”¨åˆ°äº†<strong>RoutingKeyå’ŒBindingKey</strong><br>BindingKeyæ˜¯Exchangeå’ŒQueueç»‘å®šçš„è§„åˆ™æè¿°ï¼Œè¿™ä¸ªæè¿°ç”¨æ¥è§£æå½“Exchangeæ¥æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼ŒExchangeæ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¼šå¸¦æœ‰RoutingKeyè¿™ä¸ªå­—æ®µï¼ŒExchangeå°±æ˜¯æ ¹æ®è¿™ä¸ªRoutingKeyå’Œå½“å‰Exchangeæ‰€æœ‰ç»‘å®šçš„BindingKeyåšåŒ¹é…ï¼Œå¦‚æœæ»¡è¶³è¦æ±‚ï¼Œå°±å¾€BindingKeyæ‰€ç»‘å®šçš„Queueå‘é€æ¶ˆæ¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±è§£å†³äº†æˆ‘ä»¬å‘RabbitMQå‘é€ä¸€æ¬¡æ¶ˆæ¯ï¼Œå¯ä»¥åˆ†å‘åˆ°ä¸åŒçš„Queueçš„è¿‡ç¨‹</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æŠŠæ‰€æœ‰çš„åè¯è´¯é€šå’¯ï¼Œæ¥ä¸‹æ¥åšä¸ªæ¦‚è¦æè¿°ï¼š</p>
<ul>
<li>Broker:æä¾›ä¸€ç§ä¼ è¾“æœåŠ¡,å®ƒçš„è§’è‰²å°±æ˜¯ç»´æŠ¤ä¸€æ¡ä»ç”Ÿäº§è€…åˆ°æ¶ˆè´¹è€…çš„è·¯çº¿ï¼Œä¿è¯æ•°æ®èƒ½æŒ‰ç…§æŒ‡å®šçš„æ–¹å¼è¿›è¡Œä¼ è¾“</li>
<li>ConnectionFactoryï¼šä¸RabbitMQæœåŠ¡å™¨è¿æ¥çš„ç®¡ç†å™¨</li>
<li>Connectionï¼šä¸RabbitMQæœåŠ¡å™¨çš„TCPè¿æ¥</li>
<li>Channelï¼šä¸Exchangeçš„è¿æ¥ï¼Œä¸€ä¸ªConnectionå¯ä»¥åŒ…å«å¤šä¸ªChannelã€‚ä¹‹æ‰€ä»¥éœ€è¦Channelï¼Œæ˜¯å› ä¸ºTCPè¿æ¥çš„å»ºç«‹å’Œé‡Šæ”¾éƒ½æ˜¯ååˆ†æ˜‚è´µçš„ï¼Œä¸ºäº†å¤šè·¯å¤ç”¨ã€‚RabbitMQå»ºè®®å®¢æˆ·ç«¯çº¿ç¨‹ä¹‹é—´ä¸è¦å…±ç”¨Channelï¼Œä½†æ˜¯å»ºè®®å°½é‡å…±ç”¨Connectionã€‚</li>
<li>Queue:æ¶ˆæ¯çš„è½½ä½“,æ¯ä¸ªæ¶ˆæ¯éƒ½ä¼šè¢«æŠ•åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚</li>
<li>Exchangeï¼šæ¥å—æ¶ˆæ¯ç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®æ¶ˆæ¯çš„RoutingKeyå’Œ Exchangeç»‘å®šçš„BindingKeyï¼Œä»¥åŠBindingè§„åˆ™å°†æ¶ˆæ¯è·¯ç”±ç»™æœåŠ¡å™¨ä¸­çš„é˜Ÿåˆ—ã€‚ExchangeTypeå†³å®šäº†Exchangeè·¯ç”±æ¶ˆæ¯çš„è¡Œä¸ºï¼Œä¾‹å¦‚ï¼Œåœ¨RabbitMQä¸­ï¼ŒExchangeTypeæœ‰directã€Fanoutå’ŒTopicä¸‰ç§ï¼Œä¸åŒç±»å‹çš„Exchangeè·¯ç”±çš„è¡Œä¸ºæ˜¯ä¸ä¸€æ ·çš„ã€‚</li>
<li>Message Queueï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨äºå­˜å‚¨è¿˜æœªè¢«æ¶ˆè´¹è€…æ¶ˆè´¹çš„æ¶ˆæ¯ã€‚</li>
<li>Message: ç”±Headerå’ŒBodyç»„æˆï¼ŒHeaderæ˜¯ç”±ç”Ÿäº§è€…æ·»åŠ çš„å„ç§å±æ€§çš„é›†åˆï¼ŒåŒ…æ‹¬Messageæ˜¯å¦è¢«æŒä¹…åŒ–ã€ç”±å“ªä¸ªMessage Queueæ¥å—ã€ä¼˜å…ˆçº§æ˜¯å¤šå°‘ç­‰ã€‚è€ŒBodyæ˜¯çœŸæ­£éœ€è¦ä¼ è¾“çš„APPæ•°æ®ã€‚</li>
<li>RoutingKeyï¼šç”±Producerå‘é€Messageæ—¶æŒ‡å®šï¼ŒæŒ‡å®šå½“å‰æ¶ˆæ¯è¢«è°æ¥å—</li>
<li>BindingKeyï¼šç”±Consumeråœ¨Binding Exchangeä¸Message Queueæ—¶æŒ‡å®šï¼ŒæŒ‡å®šå½“å‰Exchangeä¸‹ï¼Œä»€ä¹ˆæ ·çš„RoutingKeyä¼šè¢«ä¸‹æ´¾åˆ°å½“å‰ç»‘å®šçš„Queueä¸­</li>
<li>Binding:è”ç³»äº†Exchangeä¸Message Queueã€‚Exchangeåœ¨ä¸å¤šä¸ªMessage Queueå‘ç”ŸBindingåä¼šç”Ÿæˆä¸€å¼ è·¯ç”±è¡¨ï¼Œè·¯ç”±è¡¨ä¸­å­˜å‚¨ç€Message Queueæ‰€éœ€æ¶ˆæ¯çš„é™åˆ¶æ¡ä»¶å³Binding Keyã€‚å½“Exchangeæ”¶åˆ°Messageæ—¶ä¼šè§£æå…¶Headerå¾—åˆ°Routing Keyï¼ŒExchangeæ ¹æ®Routing Keyä¸<strong>Exchange Type</strong>å°†Messageè·¯ç”±åˆ°Message Queueã€‚Binding Keyç”±Consumeråœ¨Binding Exchangeä¸Message Queueæ—¶æŒ‡å®šï¼Œè€ŒRouting Keyç”±Producerå‘é€Messageæ—¶æŒ‡å®šï¼Œä¸¤è€…çš„åŒ¹é…æ–¹å¼ç”±Exchange Typeå†³å®šã€‚</li>
<li>Server: æ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼Œå®ç°AMQPæ¶ˆæ¯é˜Ÿåˆ—å’Œè·¯ç”±åŠŸèƒ½çš„è¿›ç¨‹ã€‚</li>
<li>Virtual Host:å…¶å®æ˜¯ä¸€ä¸ªè™šæ‹Ÿæ¦‚å¿µï¼Œç±»ä¼¼äºæƒé™æ§åˆ¶ç»„ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤åˆ†é…ç»™ç”¨æˆ·Virtual Hostçš„æƒé™ï¼Œé»˜è®¤çš„guestç”¨æˆ·æ˜¯ç®¡ç†å‘˜æƒé™ï¼Œåˆå§‹ç©ºé—´æœ‰&#x2F;ï¼Œä¸€ä¸ªVirtual Hosté‡Œé¢å¯ä»¥æœ‰è‹¥å¹²ä¸ªExchangeå’ŒQueueï¼Œä½†æ˜¯æƒé™æ§åˆ¶çš„æœ€å°ç²’åº¦æ˜¯Virtual Host</li>
</ul>
</blockquote>
<h3 id="äº”ã€SpringBootæ•´åˆRabbitMQçš„ä½¿ç”¨ã€é‡ç‚¹ã€‘"><a href="#äº”ã€SpringBootæ•´åˆRabbitMQçš„ä½¿ç”¨ã€é‡ç‚¹ã€‘" class="headerlink" title="äº”ã€SpringBootæ•´åˆRabbitMQçš„ä½¿ç”¨ã€é‡ç‚¹ã€‘"></a>äº”ã€SpringBootæ•´åˆRabbitMQçš„ä½¿ç”¨ã€<code>é‡ç‚¹</code>ã€‘</h3><hr>
<h4 id="5-1-å¯¼å…¥ä¾èµ–"><a href="#5-1-å¯¼å…¥ä¾èµ–" class="headerlink" title="5.1 å¯¼å…¥ä¾èµ–"></a>5.1 å¯¼å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="5-2-åœ¨application-propertiesä¸­å¢åŠ é…ç½®"><a href="#5-2-åœ¨application-propertiesä¸­å¢åŠ é…ç½®" class="headerlink" title="5.2 åœ¨application.propertiesä¸­å¢åŠ é…ç½®"></a>5.2 åœ¨application.propertiesä¸­å¢åŠ é…ç½®</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å¯¹äºrabbitMQçš„æ”¯æŒ</span></span><br><span class="line">spring.rabbitmq.host=192.168.153.136</span><br><span class="line">spring.rabbitmq.port=5672</span><br><span class="line">spring.rabbitmq.username=guest</span><br><span class="line">spring.rabbitmq.password=guest</span><br></pre></td></tr></table></figure>



<h4 id="5-3-Hello-World-ç®€å•é˜Ÿåˆ—"><a href="#5-3-Hello-World-ç®€å•é˜Ÿåˆ—" class="headerlink" title="5.3 Hello-World ç®€å•é˜Ÿåˆ—"></a>5.3 Hello-World ç®€å•é˜Ÿåˆ—</h4><blockquote>
<p>ä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªé»˜è®¤çš„äº¤æ¢æœºï¼Œä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">ç»“æ„å›¾</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257229.png" alt="1587715551088"></td>
</tr>
</tbody></table>
<blockquote>
<p>1ï¼‰åˆ›å»ºé…ç½®ç±»ï¼Œç”¨äºåˆ›å»ºé˜Ÿåˆ—å¯¹è±¡</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.simple;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleQueueConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">simple</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;simpleQueue&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>2ï¼‰åˆ›å»ºç”Ÿäº§è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.simple;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleQueueProducer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;SimpleQueueProducer&quot;</span>);</span><br><span class="line">        <span class="comment">//å‘é€æ¶ˆæ¯ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºé˜Ÿåˆ—åç§°ï¼Œç¬¬äºŒå‚æ•°ä¸ºæ¶ˆæ¯å†…å®¹</span></span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;simpleQueue&quot;</span>,<span class="string">&quot;ç®€å•æ¨¡å¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>3ï¼‰åˆ›å»ºæ¶ˆè´¹è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.simple;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleQueueCustomer</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RabbitListener(queues=&quot;simpleQueue&quot;)</span><span class="comment">//ç›‘å¬æŒ‡å®šçš„æ¶ˆæ¯é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String content)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;SimpleQueueCustomer&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¥SimpleQueueProducerçš„ä¿¡æ¯ï¼š&quot;</span>+content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>4ï¼‰åœ¨src\test\java\com\qf\Rabbitmq01ApplicationTests.javaè¿›è¡Œæµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture;</span><br><span class="line"><span class="keyword">import</span> com.couture.simple.SimpleQueueProducer;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rabbitmq01ApplicationTests</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SimpleQueueProducer simpleQueueProducer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSimpleQueueProducer</span><span class="params">()</span>&#123;</span><br><span class="line">        simpleQueueProducer.send();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœä¼ é€’çš„æ˜¯ JavaBean å¯¹è±¡ï¼Œè¯¥å®ä½“ç±»éœ€è¦å®ç°åºåˆ—åŒ–æ¥å£ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<blockquote>
<ol>
<li>å¯¼å…¥lombokä¾èµ–ï¼Œåˆ›å»ºUserç±»</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="2">
<li>ä¿®æ”¹ç”Ÿäº§è€…ä¸­çš„ä»£ç </li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.simple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿäº§è€…</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimplePublisher</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;SimplePublisher...&quot;</span>);</span><br><span class="line">        <span class="comment">//rabbitTemplate.convertAndSend(&quot;&quot;,&quot;simpleQueue&quot;,&quot;ç®€å•æ¨¡å¼&quot;);</span></span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;&quot;</span>,<span class="string">&quot;simpleQueue&quot;</span>,<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>,<span class="string">&quot;123&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="3">
<li>ä¿®æ”¹æ¶ˆè´¹è€…ä¸­çš„ä»£ç </li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.simple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleConsumer</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @RabbitListener(queues = &quot;simpleQueue&quot;)</span></span><br><span class="line"><span class="comment">//    public void receive(String content)&#123;</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;SimpleConsumer...&quot;);</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;æ¥è‡ªSimplePublisherçš„æ¶ˆæ¯ï¼š&quot;+content);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;simpleQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(User user)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;SimpleConsumer...&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¥è‡ªSimplePublisherçš„æ¶ˆæ¯ï¼š&quot;</span>+user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="4">
<li>è¿è¡Œæµ‹è¯•ç±»å³å¯ï¼</li>
</ol>
</blockquote>
<h4 id="5-4-Work-å·¥ä½œé˜Ÿåˆ—"><a href="#5-4-Work-å·¥ä½œé˜Ÿåˆ—" class="headerlink" title="5.4 Work å·¥ä½œé˜Ÿåˆ—"></a>5.4 Work å·¥ä½œé˜Ÿåˆ—</h4><blockquote>
<p>ä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªé»˜è®¤çš„äº¤æ¢æœºï¼Œä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸¤ä¸ªæ¶ˆè´¹è€…</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">ç»“æ„å›¾</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257641.png" alt="1587718055260"></td>
</tr>
</tbody></table>
<blockquote>
<p> 1ï¼‰åˆ›å»ºé…ç½®ç±»ï¼Œç”¨äºåˆ›å»ºé˜Ÿåˆ—å¯¹è±¡</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.work;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WorkQueueConfig</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">work</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;workQueue&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>2ï¼‰åˆ›å»ºç”Ÿäº§è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.work;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WorkQueueProducer</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;WorkQueueProducer&quot;</span>);</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;workQueue&quot;</span>,<span class="string">&quot;å·¥ä½œé˜Ÿåˆ—æ¨¡å¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>3ï¼‰åˆ›å»ºæ¶ˆè´¹è€…ï¼Œæœ¬æ¡ˆä¾‹åˆ›å»ºä¸¤ä¸ªæ¶ˆè´¹è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.work;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WorkQueueCustomer_01</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RabbitListener(queues=&quot;workQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String content)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;WorkQueueCustomer_01ï¼š&quot;</span>+content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.work;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WorkQueueCustomer_02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues=&quot;workQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String content)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;WorkQueueCustomer_02ï¼š&quot;</span>+content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>4ï¼‰åœ¨æµ‹è¯•ç±»ä¸­æ·»åŠ å¯¹è±¡å’Œæ–¹æ³•è¿›è¡Œæµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> WorkQueueProducer workQueueProducer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testWorkQueueProducer</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</span><br><span class="line">        workQueueProducer.send();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="5-5-Publish-x2F-Subscribe-å‘å¸ƒè®¢é˜…æ¨¡å¼"><a href="#5-5-Publish-x2F-Subscribe-å‘å¸ƒè®¢é˜…æ¨¡å¼" class="headerlink" title="5.5 Publish&#x2F;Subscribe å‘å¸ƒè®¢é˜…æ¨¡å¼"></a>5.5 Publish&#x2F;Subscribe å‘å¸ƒè®¢é˜…æ¨¡å¼</h4><blockquote>
<p>ä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªäº¤æ¢æœºï¼Œä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸¤ä¸ªæ¶ˆè´¹è€…</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">ç»“æ„å›¾</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257569.png" alt="1587720941513"></td>
</tr>
</tbody></table>
<blockquote>
<p>ä½¿ç”¨è¯¥æ¨¡å¼éœ€è¦å€ŸåŠ©äº¤æ¢æœºï¼Œç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœºï¼Œå†é€šè¿‡äº¤æ¢æœºåˆ°è¾¾é˜Ÿåˆ—.</p>
<p>æœ‰å››ç§äº¤æ¢æœºï¼šdirect&#x2F;topic&#x2F;headers&#x2F;fanoutï¼Œé»˜è®¤äº¤æ¢æœºæ˜¯directï¼Œå‘å¸ƒä¸è®¢é˜…çš„å®ç°ä½¿ç”¨ç¬¬å››ä¸ªäº¤æ¢å™¨ç±»å‹fanout</p>
<p>ä½¿ç”¨äº¤æ¢æœºæ—¶ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…æœ‰è‡ªå·±çš„é˜Ÿåˆ—ï¼Œç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœº(X)ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½è¦ç»‘å®šåˆ°äº¤æ¢æœº</p>
</blockquote>
<blockquote>
<p>æœ¬ä¾‹ä¸­ï¼š</p>
<p>åˆ›å»º2ä¸ªæ¶ˆæ¯é˜Ÿåˆ—</p>
<p>åˆ›å»ºä¸€ä¸ªfanoutäº¤æ¢æœºå¯¹è±¡</p>
<p>Bindäº¤æ¢æœºå’Œé˜Ÿåˆ—</p>
</blockquote>
<blockquote>
<p> 1ï¼‰åˆ›å»ºé…ç½®ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.fanout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Binding;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.BindingBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.FanoutExchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FanoutConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸¤ä¸ªé˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">fanoutQueue1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;fanoutQueue1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">fanoutQueue2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;fanoutQueue2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ªäº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FanoutExchange <span class="title function_">fanoutExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FanoutExchange</span>(<span class="string">&quot;fanoutExchange&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å°†ä¸¤ä¸ªé˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºä¸Š</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingFanoutQueue1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(fanoutQueue1()).to(fanoutExchange());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingFanoutQueue2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(fanoutQueue2()).to(fanoutExchange());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>2ï¼‰åˆ›å»ºç”Ÿäº§è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.fanout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FanoutProducer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FanoutProducer&quot;</span>);</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº¤æ¢æœºçš„åç§° ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯routerKey è¿™é‡Œè®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²å³å¯ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¦å‘é€çš„æ¶ˆæ¯</span></span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;fanoutExchange&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;å‘å¸ƒ/è®¢é˜…&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>3ï¼‰åˆ›å»ºæ¶ˆè´¹è€…ï¼Œæœ¬æ¡ˆä¾‹åˆ›å»ºä¸¤ä¸ªæ¶ˆè´¹è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.fanout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FanoutCustomer_01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;fanoutQueue1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String content)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FanoutCustomer_01ï¼š&quot;</span>+content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.fanout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FanoutCustomer_02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;fanoutQueue2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String content)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;FanoutCustomer_02ï¼š&quot;</span>+content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>4ï¼‰åœ¨æµ‹è¯•ç±»ä¸­æ·»åŠ å¯¹è±¡å’Œæ–¹æ³•è¿›è¡Œæµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> FanoutProducer fanoutProducer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFanoutProducer</span><span class="params">()</span>&#123;</span><br><span class="line">    fanoutProducer.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="5-6-Routing-è·¯ç”±æ¨¡å¼"><a href="#5-6-Routing-è·¯ç”±æ¨¡å¼" class="headerlink" title="5.6 Routing è·¯ç”±æ¨¡å¼"></a>5.6 Routing è·¯ç”±æ¨¡å¼</h4><blockquote>
<p>ä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªäº¤æ¢æœºï¼Œä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸¤ä¸ªæ¶ˆè´¹è€…</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">ç»“æ„å›¾</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257024.png" alt="1587724886159"></td>
</tr>
</tbody></table>
<blockquote>
<p>ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°directäº¤æ¢æœºï¼ˆè·¯ç”±æ¨¡å¼éœ€è¦å€ŸåŠ©ç›´è¿äº¤æ¢æœºå®ç°ï¼‰ï¼Œåœ¨ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœºçš„æ—¶å€™æœ‰ä¸€ä¸ªè·¯ç”±keyï¼Œç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ä¼šæŒ‡å®šä¸€ä¸ªè·¯ç”±keyï¼Œé‚£ä¹ˆæ¶ˆæ¯åªä¼šå‘é€åˆ°ç›¸åº”keyç›¸åŒçš„é˜Ÿåˆ—ï¼Œæ¥ç€ç›‘å¬è¯¥é˜Ÿåˆ—çš„æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯ã€‚ä¹Ÿå°±æ˜¯è®©æ¶ˆè´¹è€…æœ‰é€‰æ‹©æ€§çš„æ¥æ”¶æ¶ˆæ¯ã€‚</p>
</blockquote>
<blockquote>
<p>æœ¬ä¾‹ä¸­ï¼š</p>
<p>åˆ›å»º2ä¸ªæ¶ˆæ¯é˜Ÿåˆ—</p>
<p>åˆ›å»ºä¸€ä¸ªdirectäº¤æ¢æœºå¯¹è±¡</p>
<p>Bindäº¤æ¢æœºå’Œé˜Ÿåˆ—</p>
</blockquote>
<blockquote>
<p>1ï¼‰åˆ›å»ºé…ç½®ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.direct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Binding;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.BindingBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.DirectExchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DirectConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">directQueue1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;directQueue1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">directQueue2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;directQueue2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">directExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(<span class="string">&quot;directExchange&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bingDirectQueue1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(directQueue1()).to(directExchange()).with(<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bingDirectQueue2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(directQueue2()).to(directExchange()).with(<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>2ï¼‰åˆ›å»ºç”Ÿäº§è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.direct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.DirectExchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DirectProducer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DirectExchange directExchange;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;DirectProducer&quot;</span>);</span><br><span class="line">        rabbitTemplate.convertAndSend(directExchange.getName(),<span class="string">&quot;zhangsan&quot;</span>,<span class="string">&quot;zhangsanContent&quot;</span>);</span><br><span class="line">        rabbitTemplate.convertAndSend(directExchange.getName(),<span class="string">&quot;lisi&quot;</span>,<span class="string">&quot;lisiContent&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>3ï¼‰åˆ›å»ºä¸¤ä¸ªæ¶ˆè´¹è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.direct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DirectCustomer_01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;directQueue1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String content)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;DirectCustomer_01ï¼š&quot;</span>+content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.direct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DirectCustomer_02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;directQueue2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String content)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;DirectCustomer_02ï¼š&quot;</span>+content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>4ï¼‰åœ¨æµ‹è¯•ç±»ä¸­æ·»åŠ å¯¹è±¡å’Œæ–¹æ³•è¿›è¡Œæµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> DirectProducer directProducer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDirectProducer</span><span class="params">()</span>&#123;</span><br><span class="line">    directProducer.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="5-7-Topic-ä¸»é¢˜æ¨¡å¼"><a href="#5-7-Topic-ä¸»é¢˜æ¨¡å¼" class="headerlink" title="5.7 Topic ä¸»é¢˜æ¨¡å¼"></a>5.7 Topic ä¸»é¢˜æ¨¡å¼</h4><blockquote>
<p>ä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªäº¤æ¢æœºï¼Œä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸¤ä¸ªæ¶ˆè´¹è€…</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">ç»“æ„å›¾</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257254.png" alt="1587727436898"></td>
</tr>
</tbody></table>
<blockquote>
<p>åˆç§°é€šé…ç¬¦æ¨¡å¼ï¼ˆå¯ä»¥ç†è§£ä¸ºæ¨¡ç³ŠåŒ¹é…ï¼Œè·¯ç”±æ¨¡å¼ç›¸å½“äºç²¾ç¡®åŒ¹é…ï¼‰</p>
<p>ä½¿ç”¨ç›´è¿äº¤æ¢æœºå¯ä»¥æ”¹å–„æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œä½†æ˜¯å®ƒä»æœ‰å±€é™æ€§ï¼Œå®ƒä¸èƒ½å®ç°å¤šé‡æ¡ä»¶çš„è·¯ç”±ã€‚</p>
<p>åœ¨æ¶ˆæ¯ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä¸ä»…æƒ³è¦è®¢é˜…åŸºäºè·¯ç”±é”®çš„é˜Ÿåˆ—ï¼Œè¿˜æƒ³è®¢é˜…åŸºäºç”Ÿäº§æ¶ˆæ¯çš„æºã€‚è¿™æ—¶å€™å¯ä»¥ä½¿ç”¨topicäº¤æ¢æœºã€‚</p>
<p>ä½¿ç”¨ä¸»é¢˜äº¤æ¢æœºæ—¶ä¸èƒ½é‡‡ç”¨ä»»æ„å†™æ³•çš„è·¯ç”±é”®ï¼Œè·¯ç”±é”®çš„å½¢å¼åº”è¯¥æ˜¯ç”±ç‚¹åˆ†å‰²çš„æœ‰æ„ä¹‰çš„å•è¯ã€‚ä¾‹å¦‚â€goods.stock.infoâ€ç­‰ã€‚è·¯ç”±keyæœ€å¤š255å­—èŠ‚ã€‚</p>
</blockquote>
<blockquote>
<p>*å·ä»£è¡¨ä¸€ä¸ªå•è¯</p>
<p>#å·ä»£è¡¨0ä¸ªæˆ–å¤šä¸ªå•è¯</p>
</blockquote>
<blockquote>
<p>1ï¼‰åˆ›å»ºé…ç½®ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.topic;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Binding;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.BindingBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.TopicExchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TopicConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">topicQueue1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;topicQueue1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">topicQueue2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;topicQueue2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> TopicExchange <span class="title function_">topicExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TopicExchange</span>(<span class="string">&quot;topicExchange&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bingTopicQueue1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(topicQueue1()).to(topicExchange()).with(<span class="string">&quot;wangwu.*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bingTopicQueue2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(topicQueue2()).to(topicExchange()).with(<span class="string">&quot;zhaoliu.#&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>2ï¼‰åˆ›å»ºç”Ÿäº§è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.topic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.DirectExchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.TopicExchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TopicProducer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TopicExchange topicExchange;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TopicProducer&quot;</span>);</span><br><span class="line"> rabbitTemplate.convertAndSend(topicExchange.getName(),<span class="string">&quot;wangwu.abc&quot;</span>,<span class="string">&quot;wangwuContent&quot;</span>);    rabbitTemplate.convertAndSend(topicExchange.getName(),<span class="string">&quot;zhaoliu.xyz.qwer&quot;</span>,<span class="string">&quot;zhaoliuContent&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>3ï¼‰åˆ›å»ºä¸¤ä¸ªæ¶ˆè´¹è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.topic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TopicCustomer_01</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;topicQueue1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String content)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TopicCustomer_01ï¼š&quot;</span>+content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.topic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TopicCustomer_02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;topicQueue2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String content)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TopicCustomer_02ï¼š&quot;</span>+content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>4ï¼‰åœ¨æµ‹è¯•ç±»ä¸­æ·»åŠ å¯¹è±¡å’Œæ–¹æ³•è¿›è¡Œæµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> TopicProducer topicProducer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testTopicProducer</span><span class="params">()</span>&#123;</span><br><span class="line">    topicProducer.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="5-8æ‰‹åŠ¨Ack"><a href="#5-8æ‰‹åŠ¨Ack" class="headerlink" title="5.8æ‰‹åŠ¨Ack"></a>5.8æ‰‹åŠ¨Ack</h4><blockquote>
<p>RabbitMQä¸­çš„Ackï¼š ä¸»è¦æ˜¯ç¡®è®¤æ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ¶ˆè´¹å®Œæˆåé€šçŸ¥æœåŠ¡å™¨å°†é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯æ¸…é™¤ï¼Œspring-boot-data-amqp æ˜¯è‡ªåŠ¨ACKæœºåˆ¶ï¼Œå°±æ„å‘³ç€ MQ ä¼šåœ¨æ¶ˆæ¯å‘é€å®Œæ¯•åï¼Œè‡ªåŠ¨å¸®æˆ‘ä»¬å»ACKï¼Œç„¶ååˆ é™¤é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œè¿™æ ·ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼šå¦‚æœæ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œæˆ–è€…åœ¨æ¶ˆè´¹æ¶ˆæ¯çš„æ—¶å€™å‡ºç°å¼‚å¸¸ï¼Œéƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰‹åŠ¨Ackå¯ä»¥é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ã€‚</p>
</blockquote>
<h5 id="5-8-1-åŸç”Ÿæ–¹å¼æµ‹è¯•"><a href="#5-8-1-åŸç”Ÿæ–¹å¼æµ‹è¯•" class="headerlink" title="5.8.1 åŸç”Ÿæ–¹å¼æµ‹è¯•"></a>5.8.1 åŸç”Ÿæ–¹å¼æµ‹è¯•</h5><blockquote>
<p>1.ä»¥ç®€å•æ¨¡å¼ä¸ºä¾‹ï¼Œåªéœ€è¦ä¿®æ”¹æ¶ˆè´¹è€…å³å¯ï¼Œå¯åŠ¨ç”Ÿäº§è€…è¿›è¡Œæµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.helloworld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Consumer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ¶ˆè´¹è€…å¯åŠ¨...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºè¿æ¥</span></span><br><span class="line">        <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">        <span class="comment">//è®¾ç½®å‚æ•°</span></span><br><span class="line">        factory.setUsername(<span class="string">&quot;guest&quot;</span>);</span><br><span class="line">        factory.setPassword(<span class="string">&quot;guest&quot;</span>);</span><br><span class="line">        factory.setHost(<span class="string">&quot;192.168.25.134&quot;</span>);</span><br><span class="line">        factory.setPort(<span class="number">5672</span>);<span class="comment">//æµè§ˆå™¨è®¿é—®çš„æ˜¯ï¼š15672</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–Channel</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å›è°ƒï¼Œåˆ›å»ºConsumer</span></span><br><span class="line">        <span class="type">DefaultConsumer</span> <span class="variable">defaultConsumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">//è·å–æ¶ˆæ¯</span></span><br><span class="line">                    System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(body, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                    <span class="comment">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span><br><span class="line">                    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">                    <span class="comment">//æ‰‹åŠ¨ack</span></span><br><span class="line">                    <span class="comment">//å‚æ•°1ï¼šdeliveryTag:æŠ•é€’è¿‡æ¥æ¶ˆæ¯çš„æ ‡ç­¾,ç”±MQæ‰“çš„ï¼Œä»1å¼€å§‹ï¼Œ1,2,3...</span></span><br><span class="line">        			<span class="comment">//å‚æ•°2ï¼šmultipleï¼šæ˜¯å¦æ‰¹é‡ç¡®è®¤ä¹‹å‰å·²ç»æ¶ˆè´¹è¿‡çš„æ¶ˆæ¯ï¼Œä¸€èˆ¬ä¸ºfalse</span></span><br><span class="line">                    channel.basicAck(envelope.getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="comment">//æ•è·æ‰€æœ‰å¼‚å¸¸</span></span><br><span class="line">                    <span class="comment">//ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šrequeue -&gt; trueè¡¨ç¤ºé‡æ–°æ”¾å…¥é˜Ÿåˆ—ï¼Œfalse -&gt; æ”¾å¼ƒè¯¥æ¶ˆæ¯</span></span><br><span class="line">                    <span class="comment">//channel.basicNack(envelope.getDeliveryTag(), false, true);</span></span><br><span class="line">                    <span class="comment">//æŠ›å¼ƒæ­¤æ¡æ¶ˆæ¯</span></span><br><span class="line">                    channel.basicNack(envelope.getDeliveryTag(), <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    <span class="comment">//å…³é—­ï¼Œå¦åˆ™ä¸€ç›´å¾ªç¯å½“å‰æ“ä½œ</span></span><br><span class="line">                    connection.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–æ¶ˆæ¯</span></span><br><span class="line">        <span class="comment">//1.é˜Ÿåˆ—åç§°ï¼ˆä»å“ªä¸ªé˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ï¼‰</span></span><br><span class="line">        <span class="comment">//2.trueè¡¨ç¤ºè‡ªåŠ¨ackï¼ˆæ¶ˆè´¹å®Œæ¶ˆæ¯ä¹‹åï¼Œè‡ªåŠ¨å‘Šè¯‰rabbitmqï¼‰</span></span><br><span class="line">        <span class="comment">//  falseè¡¨ç¤ºæ‰‹åŠ¨ackï¼Œéœ€è¦è‡ªå·±æ”¶åˆ°è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        <span class="comment">//3.å›è°ƒ</span></span><br><span class="line">        channel.basicConsume(<span class="string">&quot;helloworld&quot;</span>,<span class="literal">false</span>,defaultConsumer);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­ï¼Œæ¶ˆè´¹æ–¹ä¸€èˆ¬ä¸å…³é—­ï¼Œæœ‰æ¶ˆæ¯è¿‡æ¥å°±éœ€è¦åŠæ—¶å¤„ç†</span></span><br><span class="line">        <span class="comment">//channel.close();</span></span><br><span class="line">        <span class="comment">//connection.close();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-8-2-SpringBootä¸­æµ‹è¯•"><a href="#5-8-2-SpringBootä¸­æµ‹è¯•" class="headerlink" title="5.8.2 SpringBootä¸­æµ‹è¯•"></a>5.8.2 SpringBootä¸­æµ‹è¯•</h5><blockquote>
<p>1.åœ¨ application.properties ä¸­æ·»åŠ é…ç½®</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#é…ç½®æ‰‹åŠ¨Ack</span></span><br><span class="line">spring.rabbitmq.listener.simple.acknowledge-mode=manual</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.åœ¨ä¹‹å‰æµ‹è¯•çš„ä»»æ„æ¨¡å¼ä¸­æ·»åŠ  AckCustomer æ¼”ç¤º</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.simple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶ˆè´¹è€…ï¼šç›‘å¬é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œç„¶åè·å–æ¶ˆæ¯</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;simpleQueue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AckCustomer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¤„ç†æ¶ˆæ¯ï¼ˆè·å–æ¶ˆæ¯ï¼Œè¿›ä¸€æ­¥æ“ä½œï¼‰</span></span><br><span class="line">    <span class="meta">@RabbitHandler</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String message,Channel channel,Message msg)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;AckCustomer...&quot;</span>);</span><br><span class="line">        <span class="comment">//è·å–æ¶ˆæ¯å†…å®¹</span></span><br><span class="line">        <span class="keyword">if</span>(message!=<span class="literal">null</span> &amp;&amp; message.length()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;è·å–æ¶ˆæ¯ï¼š&quot;</span>+message);</span><br><span class="line">                <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">                <span class="comment">//æ‰‹åŠ¨ç¡®è®¤</span></span><br><span class="line">                <span class="type">long</span> <span class="variable">deliveryTag</span> <span class="operator">=</span> msg.getMessageProperties().getDeliveryTag();</span><br><span class="line">                System.out.println(<span class="string">&quot;deliveryTagï¼š&quot;</span>+deliveryTag);</span><br><span class="line">                channel.basicAck(deliveryTag,<span class="literal">false</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;<span class="comment">//æ•è·æ‰€æœ‰å¼‚å¸¸</span></span><br><span class="line">                System.out.println(<span class="string">&quot;æ¶ˆæ¯å¤„ç†...&quot;</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">//é‡æ–°æ”¾å…¥é˜Ÿåˆ—ä¸­</span></span><br><span class="line">                    <span class="comment">//channel.basicNack(msg.getMessageProperties().getDeliveryTag(),false,true);</span></span><br><span class="line">                    <span class="comment">//æ”¾å¼ƒæ¶ˆæ¯</span></span><br><span class="line">                    channel.basicNack(msg.getMessageProperties().getDeliveryTag(),<span class="literal">false</span>,<span class="literal">false</span>);</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    <span class="comment">//å…³é—­</span></span><br><span class="line">                    channel.getConnection().close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">                    ex.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ²¡æœ‰æ¶ˆæ¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨é‡Šæˆ–æ‰“å¼€å¼‚å¸¸è¿›è¡Œæµ‹è¯•å³å¯ï¼</p>
</blockquote>
<h3 id="å…­ã€äº‹åŠ¡ä¸confirmæœºåˆ¶"><a href="#å…­ã€äº‹åŠ¡ä¸confirmæœºåˆ¶" class="headerlink" title="å…­ã€äº‹åŠ¡ä¸confirmæœºåˆ¶"></a>å…­ã€äº‹åŠ¡ä¸confirmæœºåˆ¶</h3><hr>
<h4 id="6-1-æ¶ˆæ¯çš„å¯é æ€§"><a href="#6-1-æ¶ˆæ¯çš„å¯é æ€§" class="headerlink" title="6.1 æ¶ˆæ¯çš„å¯é æ€§"></a>6.1 æ¶ˆæ¯çš„å¯é æ€§</h4><blockquote>
<p>æ€è€ƒï¼Ÿ</p>
<p>1.å¦‚æœæ¶ˆæ¯å·²ç»åˆ°è¾¾RabbitMQï¼ŒRabbitMQå®•æœºäº†ï¼Œæ¶ˆæ¯æ˜¯ä¸æ˜¯å°±ä¸¢å¤±äº†ï¼Ÿ</p>
<p>å¯ä»¥ä½¿ç”¨Queueçš„æŒä¹…åŒ–æœºåˆ¶</p>
<p>2.æ¶ˆè´¹è€…åœ¨æ¶ˆè´¹æ¶ˆæ¯çš„æ—¶å€™ï¼Œç¨‹åºæ‰§è¡Œåˆ°ä¸€åŠï¼Œæ¶ˆè´¹è€…å®•æœºäº†æ€ä¹ˆåŠï¼Ÿ</p>
<p>å¯ä»¥æ‰‹åŠ¨Ack</p>
<p>3.ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶ï¼Œç”±äºç½‘ç»œé—®é¢˜ï¼Œå¯¼è‡´æ¶ˆæ¯æ²¡æœ‰å‘é€åˆ°RabbitMQæ€ä¹ˆåŠï¼Ÿ</p>
<p>RabbitMQæä¾›äº†äº‹åŠ¡æ“ä½œå’ŒConfirmä»¥åŠReturnæœºåˆ¶</p>
</blockquote>
<blockquote>
<p>ä¿è¯æ¶ˆæ¯çš„ä¼ é€’å¯ä»¥ä½¿ç”¨RabbitMQä¸­çš„äº‹åŠ¡ï¼Œäº‹åŠ¡å¯ä»¥ä¿è¯æ¶ˆæ¯100%ä¼ é€’ï¼Œå¯ä»¥é€šè¿‡äº‹åŠ¡çš„å›æ»šå»è®°å½•æ—¥å¿—ï¼Œåé¢å®šæ—¶å†æ¬¡å‘é€å½“å‰æ¶ˆæ¯ï¼Œä½†æ˜¯äº‹åŠ¡æ“ä½œæ•ˆç‡å¤ªä½ã€‚</p>
<p>RabbitMQä¸­é™¤äº†äº‹åŠ¡ï¼Œè¿˜æä¾›äº†Confirmçš„ç¡®è®¤æœºåˆ¶ï¼Œè¿™ä¸ªæ•ˆç‡æ¯”äº‹åŠ¡é«˜å¾ˆå¤šã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071257525.png" alt="1587727436898"></p>
<h4 id="6-2-RabbitMQäº‹åŠ¡"><a href="#6-2-RabbitMQäº‹åŠ¡" class="headerlink" title="6.2 RabbitMQäº‹åŠ¡"></a>6.2 RabbitMQäº‹åŠ¡</h4><blockquote>
<p>RabbitMQçš„äº‹åŠ¡æ˜¯å¯¹AMQPåè®®çš„å®ç°ï¼Œé€šè¿‡è®¾ç½®<code>Channel</code> çš„æ¨¡å¼æ¥å®Œæˆï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">channel.txSelect();  <span class="comment">//å¼€å¯äº‹åŠ¡</span></span><br><span class="line"><span class="comment">// ....æœ¬åœ°äº‹åŠ¡æ“ä½œ</span></span><br><span class="line">channel.txCommit();  <span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">channel.txRollback(); <span class="comment">//å›æ»šäº‹åŠ¡</span></span><br></pre></td></tr></table></figure>

<p><font color="red"><strong>ç‰¹åˆ«è¯´æ˜ï¼šRabbitMQçš„äº‹åŠ¡æœºåˆ¶æ˜¯åŒæ­¥æ“ä½œï¼Œä¼šæå¤§çš„é™ä½RabbitMQçš„æ€§èƒ½ã€‚</strong></font></p>
<h4 id="6-3-Confirmæœºåˆ¶"><a href="#6-3-Confirmæœºåˆ¶" class="headerlink" title="6.3 Confirmæœºåˆ¶"></a>6.3 Confirmæœºåˆ¶</h4><blockquote>
<p>ç”±äºRabbitMQçš„äº‹åŠ¡æ€§èƒ½çš„é—®é¢˜ï¼Œäºæ˜¯å°±åˆæ¨å‡ºäº†å‘é€æ–¹ç¡®è®¤æ¨¡å¼ã€‚</p>
</blockquote>
<h5 id="6-3-1-åˆ›å»ºå·¥å…·ç±»"><a href="#6-3-1-åˆ›å»ºå·¥å…·ç±»" class="headerlink" title="6.3.1 åˆ›å»ºå·¥å…·ç±»"></a>6.3.1 åˆ›å»ºå·¥å…·ç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeoutException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMQUtils</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1. åˆ›å»ºè¿æ¥å·¥å‚ï¼ˆConnectionFactoryï¼‰</span></span><br><span class="line"><span class="comment">     * 2. åˆ›å»ºè¿æ¥ (Connection)</span></span><br><span class="line"><span class="comment">     * 3. åˆ›å»ºé€šé“  (Channel)</span></span><br><span class="line"><span class="comment">     Connection conn = connectionFactory.newConnection();</span></span><br><span class="line"><span class="comment">     Channel channel = conn.createChannel();</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ConnectionFactory connectionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        connectionFactory = <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">        connectionFactory.setPort(<span class="number">5672</span>);</span><br><span class="line">        connectionFactory.setUsername(<span class="string">&quot;guest&quot;</span>);</span><br><span class="line">        connectionFactory.setPassword(<span class="string">&quot;guest&quot;</span>);</span><br><span class="line">        connectionFactory.setHost(<span class="string">&quot;192.168.25.134&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = connectionFactory.newConnection();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException ioException) &#123;</span><br><span class="line">            ioException.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (TimeoutException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> connection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Channel channel, Connection connection)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != channel) &#123;</span><br><span class="line">                channel.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6-3-2-å•æ¡æ¶ˆæ¯ç¡®è®¤"><a href="#6-3-2-å•æ¡æ¶ˆæ¯ç¡®è®¤" class="headerlink" title="6.3.2 å•æ¡æ¶ˆæ¯ç¡®è®¤"></a>6.3.2 å•æ¡æ¶ˆæ¯ç¡®è®¤</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">channel.confirmSelect(); <span class="comment">//å¼€å¯å‘é€æ–¹ç¡®è®¤æ¨¡å¼</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>1.åœ¨RabbitMqæ§åˆ¶å°é¡µé¢ï¼Œåˆ›å»ºä¸€ä¸ªdirectç±»å‹çš„äº¤æ¢æœºï¼Œå†åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—å¹¶ç»‘å®š</p>
</blockquote>
<blockquote>
<p>channel.waitForConfirms(); &#x2F;&#x2F;å¯¹äºå•æ¡æ¶ˆæ¯çš„ç¡®è®¤ï¼Œtrueè¡¨ç¤ºæˆåŠŸ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.confirm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.utils.RabbitMQUtils;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ComfirmTest1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> RabbitMQUtils.getConnection();</span><br><span class="line">        <span class="comment">//è·å–Channel</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">        <span class="comment">//å¼€å¯confirm</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line">        <span class="comment">//å‘é€æ¶ˆæ¯ï¼ˆå‰æï¼šé˜Ÿåˆ—å·²ç»é€šè¿‡routingKeyç»‘å®šåˆ°è¯¥äº¤æ¢æœºä¸Šï¼‰</span></span><br><span class="line">        channel.basicPublish(<span class="string">&quot;myExchange&quot;</span>,<span class="string">&quot;my&quot;</span>,<span class="literal">null</span>,<span class="string">&quot;æ¶ˆæ¯å†…å®¹&quot;</span>.getBytes());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ¶ˆæ¯åˆ°è¾¾äº¤æ¢æœºï¼Œtrueè¡¨ç¤ºåˆ°è¾¾ï¼Œè‹¥æ²¡æœ‰äº¤æ¢æœºåˆ™ç³»ç»Ÿä¼šç›´æ¥æŠ¥é”™</span></span><br><span class="line">        <span class="keyword">if</span>(channel.waitForConfirms())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¶ˆæ¯å·²åˆ°è¾¾äº¤æ¢æœº&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­</span></span><br><span class="line">        RabbitMQUtils.close(channel,connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="6-3-2-æ‰¹é‡æ¶ˆæ¯ç¡®è®¤"><a href="#6-3-2-æ‰¹é‡æ¶ˆæ¯ç¡®è®¤" class="headerlink" title="6.3.2 æ‰¹é‡æ¶ˆæ¯ç¡®è®¤"></a>6.3.2 æ‰¹é‡æ¶ˆæ¯ç¡®è®¤</h5><blockquote>
<p>channel.waitForConfirmsOrDie();  &#x2F;&#x2F;æ‰¹é‡æ¶ˆæ¯ç¡®è®¤ï¼Œå¦‚æœæœ‰ä¸€æ¡æ¶ˆæ¯æ²¡æœ‰å‘é€æˆåŠŸï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.confirm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.utils.RabbitMQUtils;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ComfirmTest2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> RabbitMQUtils.getConnection();</span><br><span class="line">        <span class="comment">//è·å–Channel</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">        <span class="comment">//å¼€å¯confirm</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line">        <span class="comment">//å‘é€æ¶ˆæ¯ï¼ˆå‰æï¼šé˜Ÿåˆ—å·²ç»é€šè¿‡routingKeyç»‘å®šåˆ°è¯¥äº¤æ¢æœºä¸Šï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="comment">//åˆ¤æ–­</span></span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">5</span>)&#123;</span><br><span class="line">                <span class="comment">//å‰ææ˜¯ç³»ç»Ÿä¸­æ²¡æœ‰åä¸ºmyExchange2çš„äº¤æ¢æœº</span></span><br><span class="line">                channel.basicPublish(<span class="string">&quot;myExchange2&quot;</span>, <span class="string">&quot;my&quot;</span>, <span class="literal">null</span>, (<span class="string">&quot;æ¶ˆæ¯å†…å®¹&quot;</span>+ i).getBytes());</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å‘é€æ¶ˆæ¯</span></span><br><span class="line">            channel.basicPublish(<span class="string">&quot;myExchange&quot;</span>, <span class="string">&quot;my&quot;</span>, <span class="literal">null</span>, (<span class="string">&quot;æ¶ˆæ¯å†…å®¹&quot;</span>+ i).getBytes());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¡®å®šæ‰¹é‡æ“ä½œæ˜¯å¦æˆåŠŸ</span></span><br><span class="line">        <span class="comment">//å½“å‘é€çš„å…¨éƒ¨æ¶ˆæ¯ï¼Œæœ‰ä¸€ä¸ªå¤±è´¥çš„æ—¶å€™ï¼Œå°±ç›´æ¥å…¨éƒ¨å¤±è´¥ æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        channel.waitForConfirmsOrDie();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­</span></span><br><span class="line">        RabbitMQUtils.close(channel,connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="6-3-3-å›è°ƒæ–¹å¼ç¡®è®¤"><a href="#6-3-3-å›è°ƒæ–¹å¼ç¡®è®¤" class="headerlink" title="6.3.3 å›è°ƒæ–¹å¼ç¡®è®¤"></a>6.3.3 å›è°ƒæ–¹å¼ç¡®è®¤</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.confirm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.utils.RabbitMQUtils;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.ConfirmListener;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ComfirmTest3</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> RabbitMQUtils.getConnection();</span><br><span class="line">        <span class="comment">//è·å–Channel</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">        <span class="comment">//å¼€å¯confirm</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€æ¶ˆæ¯ï¼ˆå‰æï¼šé˜Ÿåˆ—å·²ç»é€šè¿‡routingKeyç»‘å®šåˆ°è¯¥äº¤æ¢æœºä¸Šï¼‰</span></span><br><span class="line">        channel.basicPublish(<span class="string">&quot;myExchange&quot;</span>,<span class="string">&quot;my&quot;</span>,<span class="literal">null</span>,<span class="string">&quot;æ¶ˆæ¯å†…å®¹&quot;</span>.getBytes());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¼€å¯å¼‚æ­¥å›è°ƒ</span></span><br><span class="line">        channel.addConfirmListener(<span class="keyword">new</span> <span class="title class_">ConfirmListener</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleAck</span><span class="params">(<span class="type">long</span> deliveryTag, <span class="type">boolean</span> multiple)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æˆåŠŸè¾¾åˆ°äº¤æ¢æœº&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleNack</span><span class="params">(<span class="type">long</span> deliveryTag, <span class="type">boolean</span> multiple)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ²¡æœ‰åˆ°è¾¾äº¤æ¢æœº&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­</span></span><br><span class="line">        RabbitMQUtils.close(channel,connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="6-4-Returnæœºåˆ¶"><a href="#6-4-Returnæœºåˆ¶" class="headerlink" title="6.4 Returnæœºåˆ¶"></a>6.4 Returnæœºåˆ¶</h4><blockquote>
<p>Confirmåªèƒ½ä¿è¯æ¶ˆæ¯åˆ°è¾¾exchangeï¼Œæ— æ³•ä¿è¯æ¶ˆæ¯å¯ä»¥è¢«exchangeåˆ†å‘åˆ°æŒ‡å®šqueue</p>
<p>è€Œä¸”exchangeæ˜¯ä¸èƒ½æŒä¹…åŒ–æ¶ˆæ¯çš„ï¼Œqueueæ˜¯å¯ä»¥æŒä¹…åŒ–æ¶ˆæ¯</p>
<p>é‡‡ç”¨Returnæœºåˆ¶æ¥ç›‘å¬æ¶ˆæ¯æ˜¯å¦ä»exchangeé€åˆ°äº†æŒ‡å®šçš„queueä¸­</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071258092.png" alt="1587727436898"></p>
<blockquote>
<p>å¼€å¯Returnæœºåˆ¶ï¼Œåœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œéœ€è¦æŒ‡å®šmandatoryä¸ºtrue</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.confirm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.utils.RabbitMQUtils;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReturnTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> RabbitMQUtils.getConnection();</span><br><span class="line">        <span class="comment">//è·å–Channel</span></span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line">        <span class="comment">//å¼€å¯confirm</span></span><br><span class="line">        channel.confirmSelect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€æ¶ˆæ¯</span></span><br><span class="line">        <span class="comment">//æ³¨æ„ï¼šæŒ‡å®šmandatoryå‚æ•°ä¸ºtrueï¼Œè®¾ç½®æ²¡æœ‰ç»‘å®šçš„routingkey</span></span><br><span class="line">        channel.basicPublish(<span class="string">&quot;myExchange&quot;</span>,<span class="string">&quot;my2&quot;</span>,<span class="literal">true</span>,<span class="literal">null</span>,<span class="string">&quot;æ¶ˆæ¯å†…å®¹&quot;</span>.getBytes());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¼€å¯å¼‚æ­¥å›è°ƒ</span></span><br><span class="line">        channel.addConfirmListener(<span class="keyword">new</span> <span class="title class_">ConfirmListener</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleAck</span><span class="params">(<span class="type">long</span> deliveryTag, <span class="type">boolean</span> multiple)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æˆåŠŸè¾¾åˆ°äº¤æ¢æœº&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleNack</span><span class="params">(<span class="type">long</span> deliveryTag, <span class="type">boolean</span> multiple)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ²¡æœ‰åˆ°è¾¾äº¤æ¢æœº&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ²¡æœ‰åˆ°è¾¾é˜Ÿåˆ—çš„æ—¶å€™è§¦å‘</span></span><br><span class="line">        channel.addReturnListener(<span class="keyword">new</span> <span class="title class_">ReturnListener</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleReturn</span><span class="params">(<span class="type">int</span> replyCode, String replyText, String exchange,</span></span><br><span class="line"><span class="params">                                     String routingKey, AMQP.BasicProperties properties,</span></span><br><span class="line"><span class="params">                                     <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">                System.out.println(<span class="string">&quot;æ²¡æœ‰åˆ°è¾¾é˜Ÿåˆ—&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­</span></span><br><span class="line">        RabbitMQUtils.close(channel,connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="6-5-SpringBootå®ç°"><a href="#6-5-SpringBootå®ç°" class="headerlink" title="6.5  SpringBootå®ç°"></a>6.5  SpringBootå®ç°</h4><blockquote>
<p>1.åœ¨ application.properties ä¸­æ·»åŠ é…ç½®</p>
</blockquote>
<blockquote>
<p>spring.rabbitmq.publisher-confirm-type å¯¹åº”å€¼çš„è¯´æ˜</p>
<ul>
<li>NONE ï¼šç¦ç”¨å‘å¸ƒç¡®è®¤æ¨¡å¼ï¼Œæ˜¯é»˜è®¤å€¼</li>
<li>CORRELATEDï¼šå‘å¸ƒæ¶ˆæ¯æˆåŠŸåˆ°äº¤æ¢å™¨åä¼šè§¦å‘å›è°ƒæ–¹æ³•</li>
<li>SIMPLEï¼šä¸¤ç§æ•ˆæœ</li>
</ul>
<ol>
<li>å’ŒCORRELATEDå€¼ä¸€æ ·ä¼šè§¦å‘å›è°ƒæ–¹æ³•</li>
<li>åœ¨å‘å¸ƒæ¶ˆæ¯æˆåŠŸåä½¿ç”¨rabbitTemplateè°ƒç”¨waitForConfirmsæˆ–waitForConfirmsOrDieæ–¹æ³•ç­‰å¾…brokerèŠ‚ç‚¹è¿”å›å‘é€ç»“æœï¼Œæ ¹æ®è¿”å›ç»“æœæ¥åˆ¤å®šä¸‹ä¸€æ­¥çš„é€»è¾‘ï¼Œè¦æ³¨æ„çš„ç‚¹æ˜¯waitForConfirmsOrDieæ–¹æ³•å¦‚æœè¿”å›falseåˆ™ä¼šå…³é—­channelï¼Œåˆ™æ¥ä¸‹æ¥æ— æ³•å‘é€æ¶ˆæ¯åˆ°broker</li>
</ol>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½®å¼€å¯Confirmå’ŒReturn</span></span><br><span class="line">spring.rabbitmq.publisher-confirm-type: simple</span><br><span class="line">spring.rabbitmq.publisher-returns: <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.åˆ›å»ºé…ç½®ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.direct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.ReturnedMessage;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.connection.CorrelationData;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PublisherConfirmAndReturnConfig</span> <span class="keyword">implements</span> <span class="title class_">RabbitTemplate</span>.ConfirmCallback,RabbitTemplate.ReturnsCallback &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initMethod</span><span class="params">()</span>&#123;</span><br><span class="line">        rabbitTemplate.setConfirmCallback(<span class="built_in">this</span>);</span><br><span class="line">        rabbitTemplate.setReturnsCallback(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">confirm</span><span class="params">(CorrelationData correlationData, <span class="type">boolean</span> ack, String s)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(ack)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;åˆ°è¾¾äº¤æ¢æœº&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ²¡æœ‰åˆ°è¾¾äº¤æ¢æœº&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnedMessage</span><span class="params">(ReturnedMessage returnedMessage)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ²¡æœ‰åˆ°è¾¾é˜Ÿåˆ—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3.ä¿®æ”¹ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ–¹æ³•ä¸­çš„routingKeyï¼Œç„¶åå¯åŠ¨æµ‹è¯•ç±»æµ‹è¯•å³å¯ï¼</p>
</blockquote>
<h3 id="ä¸ƒ-æ­»ä¿¡é˜Ÿåˆ—"><a href="#ä¸ƒ-æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="ä¸ƒ. æ­»ä¿¡é˜Ÿåˆ—"></a>ä¸ƒ. æ­»ä¿¡é˜Ÿåˆ—</h3><hr>
<blockquote>
<p>æ­»ä¿¡é˜Ÿåˆ—å¹¶ä¸æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„é˜Ÿåˆ—ï¼Œåªæ˜¯ä¸€ä¸ªæ™®é€šçš„é˜Ÿåˆ—ï¼Œåªæ˜¯æˆ‘ä»¬æŠŠä»–ä»¬å–åå«åšæ­»ä¿¡é˜Ÿåˆ—ã€‚</p>
<p>æ­»ä¿¡é˜Ÿåˆ—çš„è®¾è®¡æ˜¯åœ¨æŸä¸ªé˜Ÿåˆ—çš„å¤´ä¿¡æ¯ä¸­è®¾å®š<code>x-dead-letter-exchange</code> (æ­»ä¿¡äº¤æ¢æœº)å’Œ<code>x-dead-letter-routing-key</code>(æ­»ä¿¡è·¯ç”±é”®)å³å¯ã€‚å…³è”åˆ°ä¸€ä¸ªç»‘å®šåˆ°æŸä¸ªæ­»ä¿¡äº¤æ¢æœºçš„é˜Ÿåˆ—ä¸Šã€‚ç„¶åç»™è¯¥é˜Ÿåˆ—æŒ‡å®šè¿‡æœŸæ—¶é—´æˆ–è€…æŒ‡å®šçš„æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ï¼Œé‚£ä¹ˆè¯¥æ¶ˆæ¯åˆ°æœŸåä¼šè‡ªåŠ¨åˆ°è¾¾æ­»ä¿¡é˜Ÿåˆ—ä¸­ã€‚</p>
</blockquote>
<h5 id="7-1-åœºæ™¯"><a href="#7-1-åœºæ™¯" class="headerlink" title="7.1 åœºæ™¯"></a>7.1 åœºæ™¯</h5><blockquote>
<p>åœºæ™¯ä¸€ï¼šæœªæ”¯ä»˜è®¢å•åœ¨è§„å®šçš„æ—¶é—´å–æ¶ˆã€‚å®ç°çš„æ–¹å¼ä¸ºï¼Œå°†è®¢å•æ¶ˆæ¯æ”¾å…¥åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå¹¶æŒ‡å®šå…¶è¿‡æœŸæ—¶é—´ã€‚å½“è¿‡æœŸæ—¶é—´åˆ°äº†ä¹‹åï¼Œå°±è¿›å…¥åˆ°äº†æ­»ä¿¡é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥åœ¨æ­»ä¿¡é˜Ÿåˆ—çš„æ¶ˆè´¹ç«¯å–å‡ºå¯¹åº”çš„æ¶ˆæ¯å³å¯ã€‚</p>
</blockquote>
<blockquote>
<p>åœºæ™¯äºŒï¼šæŸæ¡æ¶ˆæ¯åœ¨æ¶ˆè´¹ç«¯æ›¾å¤šæ¬¡å°è¯•æ¶ˆè´¹ï¼Œä½†æ˜¯å‡æœªæ¶ˆè´¹æˆåŠŸï¼Œé‚£ä¹ˆå°±è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼Œè®©äººå·¥å¹²é¢„ã€‚</p>
</blockquote>
<h5 id="7-2-æµ‹è¯•"><a href="#7-2-æµ‹è¯•" class="headerlink" title="7.2 æµ‹è¯•"></a>7.2 æµ‹è¯•</h5><blockquote>
<p>æå‰åˆ›å»ºRabbitMQUtilså·¥å…·ç±»å¹¶æµ‹è¯•å³å¯</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.dead;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.utils.RabbitMQUtils;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.AMQP;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeadQueueTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">dead_letter_exchange</span> <span class="operator">=</span> <span class="string">&quot;dead_letter_exchange&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡è·¯ç”±é”®</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">dead_letter_routing_key</span> <span class="operator">=</span> <span class="string">&quot;dead_letter_routing_key&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">dead_letter_queue</span> <span class="operator">=</span> <span class="string">&quot;dead_letter_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">people_exchange</span> <span class="operator">=</span> <span class="string">&quot;people_exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">people_routing_key</span> <span class="operator">=</span> <span class="string">&quot;people_routing_key&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">people_queue</span> <span class="operator">=</span> <span class="string">&quot;people_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> RabbitMQUtils.getConnection();</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªæ­»ä¿¡çš„äº¤æ¢æœº</span></span><br><span class="line">        channel.exchangeDeclare(dead_letter_exchange, <span class="string">&quot;direct&quot;</span>);</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">        channel.queueDeclare(dead_letter_queue, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// å°†æ­»ä¿¡é˜Ÿåˆ—ç»‘å®šåˆ°æ­»ä¿¡äº¤æ¢æœºï¼Œè·¯ç”±é”®ä¸º &quot;dead_letter_routing_key&quot;</span></span><br><span class="line">        channel.queueBind(dead_letter_queue, dead_letter_exchange, dead_letter_routing_key);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®é˜Ÿåˆ—å‚æ•°</span></span><br><span class="line">        Map&lt;String, Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, dead_letter_exchange);</span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, dead_letter_routing_key);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå½“å‰äº¤æ¢æœºï¼Œé˜Ÿåˆ—ä»¥åŠè·¯ç”±é”®</span></span><br><span class="line">        channel.exchangeDeclare(people_exchange, <span class="string">&quot;direct&quot;</span>);</span><br><span class="line">        <span class="comment">//æœ€åä¸€ä¸ªå‚æ•°æ˜¯å½“å‰é˜Ÿåˆ—çš„å±æ€§</span></span><br><span class="line">        channel.queueDeclare(people_queue, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, arguments);</span><br><span class="line">        channel.queueBind(people_queue, people_exchange, people_routing_key);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ï¼Œå•ä½ï¼šæ¯«ç§’</span></span><br><span class="line">        AMQP.<span class="type">BasicProperties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AMQP</span>.BasicProperties.Builder()</span><br><span class="line">                .expiration(<span class="string">&quot;15000&quot;</span>).build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€æ¶ˆæ¯</span></span><br><span class="line">        channel.basicPublish(people_exchange, people_routing_key, properties, <span class="string">&quot;dead_message&quot;</span>.getBytes());</span><br><span class="line"></span><br><span class="line">        RabbitMQUtils.close(channel, connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="å…«-é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹"><a href="#å…«-é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹" class="headerlink" title="å…«. é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹"></a>å…«. é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹</h3><hr>
<h4 id="8-1-å¹‚ç­‰æ€§"><a href="#8-1-å¹‚ç­‰æ€§" class="headerlink" title="8.1 å¹‚ç­‰æ€§"></a>8.1 å¹‚ç­‰æ€§</h4><blockquote>
<p>æ‰€æœ‰çš„æ¶ˆæ¯ä¸­é—´ä»¶éƒ½ä¼šå­˜åœ¨è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯æ¶ˆæ¯çš„é‡å¤æ¶ˆè´¹é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»åšå¹‚ç­‰æ€§è®¾è®¡ï¼Œæ‰€è°“å¹‚ç­‰æ€§è®¾è®¡å°±æ˜¯ï¼Œä¸€æ¡æ¶ˆæ¯æ— è®ºæ¶ˆè´¹å¤šå°‘æ¬¡æ‰€äº§ç”Ÿçš„ç»“æœéƒ½æ˜¯ç›¸åŒçš„ã€‚</p>
<p>é‡å¤æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ˜¯å¯¹éå¹‚ç­‰æ€§æ“ä½œé€ æˆé—®é¢˜ï¼Œé‡å¤æ¶ˆè´¹æ¶ˆæ¯çš„åŸå› æ˜¯å› ä¸ºæ¶ˆè´¹è€…æ²¡æœ‰ç»™RabbitMQä¸€ä¸ªAck</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071258024.png" alt="1587727436898"></p>
<blockquote>
<p>ä¸ºäº†è§£å†³æ¶ˆæ¯é‡å¤æ¶ˆè´¹çš„é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨Redisï¼Œåœ¨æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯ä¹‹å‰ï¼Œç°å°†æ¶ˆæ¯çš„idæ”¾åˆ°Redisä¸­ï¼Œ</p>
<p>id-0ï¼ˆæ­£åœ¨æ‰§è¡Œä¸šåŠ¡ï¼‰</p>
<p>id-1ï¼ˆæ‰§è¡Œä¸šåŠ¡æˆåŠŸï¼‰</p>
<p>å¦‚æœackå¤±è´¥ï¼Œåœ¨RabbitMQå°†æ¶ˆæ¯äº¤ç»™å…¶ä»–çš„æ¶ˆè´¹è€…æ—¶ï¼Œå…ˆæ‰§è¡Œsetnxï¼Œå¦‚æœkeyå·²ç»å­˜åœ¨ï¼Œè·å–ä»–çš„å€¼ï¼Œå¦‚æœæ˜¯0ï¼Œå½“å‰æ¶ˆè´¹è€…å°±ä»€ä¹ˆéƒ½ä¸åšï¼Œå¦‚æœæ˜¯1ï¼Œç›´æ¥ackã€‚</p>
<p>æç«¯æƒ…å†µï¼šç¬¬ä¸€ä¸ªæ¶ˆè´¹è€…åœ¨æ‰§è¡Œä¸šåŠ¡æ—¶ï¼Œå‡ºç°äº†æ­»é”ï¼Œåœ¨setnxçš„åŸºç¡€ä¸Šï¼Œå†ç»™keyè®¾ç½®ä¸€ä¸ªç”Ÿå­˜æ—¶é—´ã€‚</p>
</blockquote>
<h4 id="8-2-è§£å†³æ–¹æ¡ˆ"><a href="#8-2-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="8.2 è§£å†³æ–¹æ¡ˆ"></a>8.2 è§£å†³æ–¹æ¡ˆ</h4><blockquote>
<p>æ–¹æ¡ˆä¸€ï¼šä¸ºæ¯æ¡æ¶ˆæ¯ç”Ÿæˆå…¨å±€å”¯ä¸€IDï¼Œå°†IDå’Œä¸šåŠ¡æ•°æ®æ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ¯æ¬¡æ¶ˆè´¹æ¶ˆæ¯ä¹‹åéƒ½å°†IDåœ¨è¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œæ¯æ¬¡æ¶ˆè´¹ä¹‹å‰å…ˆæŸ¥è¯¢IDæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±æ‰§è¡Œå¯¹åº”çš„é€»è¾‘ï¼›å¦‚æœå­˜åœ¨åˆ™ç›´æ¥ç¡®è®¤ã€‚</p>
</blockquote>
<blockquote>
<p>æ–¹æ¡ˆäºŒï¼ˆæ¨èï¼‰ï¼šåˆ©ç”¨redis+æ•°æ®åº“çš„æ–¹æ¡ˆæ¥å®ç°å¹‚ç­‰æ€§çš„è®¾è®¡ï¼Œå®ç°çš„æ€è·¯ä¸redisçš„ç¼“å­˜å‡»ç©¿æ–¹æ¡ˆç±»ä¼¼ï¼›å½“æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œå°†å”¯ä¸€IDåŒæ—¶æ’å…¥æ•°æ®åº“ï¼Œç„¶åæ”¾å…¥åˆ°redisä¸­ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ¯æ¬¡ä»redisä¸­åˆ¤æ–­ã€‚</p>
</blockquote>
<h4 id="8-3-åœ¨springbootä¸­æµ‹è¯•"><a href="#8-3-åœ¨springbootä¸­æµ‹è¯•" class="headerlink" title="8.3 åœ¨springbootä¸­æµ‹è¯•"></a>8.3 åœ¨springbootä¸­æµ‹è¯•</h4><h5 id="8-3-1-å¯¼å…¥ä¾èµ–"><a href="#8-3-1-å¯¼å…¥ä¾èµ–" class="headerlink" title="8.3.1 å¯¼å…¥ä¾èµ–"></a>8.3.1 å¯¼å…¥ä¾èµ–</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="8-3-2-é…ç½®application-properties"><a href="#8-3-2-é…ç½®application-properties" class="headerlink" title="8.3.2 é…ç½®application.properties"></a>8.3.2 é…ç½®application.properties</h5><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å¯¹äºrabbitMQçš„æ”¯æŒ</span></span><br><span class="line"><span class="attr">spring.rabbitmq.host</span>=<span class="string">192.168.25.140</span></span><br><span class="line"><span class="attr">spring.rabbitmq.port</span>=<span class="string">5672</span></span><br><span class="line"><span class="attr">spring.rabbitmq.username</span>=<span class="string">guest</span></span><br><span class="line"><span class="attr">spring.rabbitmq.password</span>=<span class="string">guest</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring.rabbitmq.listener.simple.acknowledge-mode</span>=<span class="string">manual</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring.redis.host</span>=<span class="string">127.0.0.1</span></span><br><span class="line"><span class="attr">spring.redis.port</span>=<span class="string">6379</span></span><br></pre></td></tr></table></figure>

<h5 id="8-3-3-è¿™é‡Œä»¥ç®€å•æ¨¡å¼æ¼”ç¤º"><a href="#8-3-3-è¿™é‡Œä»¥ç®€å•æ¨¡å¼æ¼”ç¤º" class="headerlink" title="8.3.3 è¿™é‡Œä»¥ç®€å•æ¨¡å¼æ¼”ç¤º"></a>8.3.3 è¿™é‡Œä»¥ç®€å•æ¨¡å¼æ¼”ç¤º</h5><blockquote>
<p>1.ç¼–å†™é…ç½®ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.simple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.AmqpException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.connection.CorrelationData;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é…ç½®ç±»ï¼Œåˆ›å»ºé˜Ÿåˆ—</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleQueueConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">simpleQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;simpleQueue&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºMessagePostProcessorå¯¹è±¡ï¼Œç”¨äºåœ¨ç”Ÿäº§è€…ä¸­æŠŠidç­‰å‚æ•°ä¼ ç»™æ¶ˆè´¹è€…</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MessagePostProcessor <span class="title function_">correlationIdProcessor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MessagePostProcessor</span> <span class="variable">messagePostProcessor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MessagePostProcessor</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Message <span class="title function_">postProcessMessage</span><span class="params">(Message message, Correlation correlation)</span> &#123;</span><br><span class="line">                <span class="type">MessageProperties</span> <span class="variable">messageProperties</span> <span class="operator">=</span> message.getMessageProperties();</span><br><span class="line">                <span class="comment">//é€šè¿‡Correlationå¯¹è±¡å­˜å‚¨idå‚æ•°ï¼ŒMessageè·å–idå‚æ•°</span></span><br><span class="line">                <span class="keyword">if</span> (correlation <span class="keyword">instanceof</span> CorrelationData) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">correlationId</span> <span class="operator">=</span> ((CorrelationData) correlation).getId();</span><br><span class="line">                    messageProperties.setCorrelationId(correlationId);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//è¿”å›</span></span><br><span class="line">                <span class="keyword">return</span> message;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Message <span class="title function_">postProcessMessage</span><span class="params">(Message message)</span> <span class="keyword">throws</span> AmqpException &#123;</span><br><span class="line">                <span class="keyword">return</span> message;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> messagePostProcessor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.ç¼–å†™ç”Ÿäº§è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.simple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.MessagePostProcessor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.connection.CorrelationData;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿäº§è€…</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleProducer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MessagePostProcessor messagePostProcessor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">CorrelationData</span> <span class="variable">correlationData</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CorrelationData</span>();</span><br><span class="line">        System.out.println(correlationData.getId());</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;&quot;</span>,<span class="string">&quot;simpleQueue&quot;</span>,<span class="string">&quot;ç®€å•é˜Ÿåˆ—&quot;</span>,messagePostProcessor,correlationData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>3.ç¼–å†™æ¶ˆè´¹è€…</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.simple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.MessageProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.StringRedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">//ç›‘å¬æŒ‡å®šé˜Ÿåˆ—</span></span><br><span class="line"><span class="meta">@RabbitListener(queues = &quot;simpleQueue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AckCustomer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitHandler</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getMessage</span><span class="params">(String msg, Channel channel, Message message)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//1.è·å–MessageId</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">messageId</span> <span class="operator">=</span> message.getMessageProperties().getCorrelationId();</span><br><span class="line">        System.out.println(messageId);</span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">aBoolean</span> <span class="operator">=</span> redisTemplate.opsForValue().setIfAbsent(messageId, <span class="string">&quot;0&quot;</span>, <span class="number">600</span>, TimeUnit.SECONDS);</span><br><span class="line">        <span class="comment">//2.è®¾ç½®keyåˆ°Redis</span></span><br><span class="line">        <span class="keyword">if</span>(aBoolean) &#123;</span><br><span class="line">            <span class="comment">//3.æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line">            System.out.println(<span class="string">&quot;æ­£åœ¨å¤„ç†æ¶ˆæ¯....&quot;</span>);</span><br><span class="line">            <span class="comment">//System.out.println(&quot;æ¥æ”¶åˆ°æ¶ˆæ¯ï¼š&quot; + msg);</span></span><br><span class="line">            <span class="comment">//4.è®¾ç½®keyçš„valueä¸º1</span></span><br><span class="line">            <span class="comment">//redisTemplate.opsForValue().set(messageId,&quot;1&quot;,600, TimeUnit.SECONDS);</span></span><br><span class="line">            <span class="comment">//5.æ‰‹åŠ¨ack</span></span><br><span class="line">            <span class="comment">//channel.basicAck(message.getMessageProperties().getDeliveryTag(),false);</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦å·²ç»æ¶ˆè´¹ï¼š1 -&gt; å·²æ¶ˆè´¹ 0 -&gt; æœªæ¶ˆè´¹</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;0&quot;</span>.equalsIgnoreCase(redisTemplate.opsForValue().get(messageId)))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¥æ”¶åˆ°æ¶ˆæ¯ï¼š&quot;</span> + msg);</span><br><span class="line">            redisTemplate.opsForValue().set(messageId,<span class="string">&quot;1&quot;</span>,<span class="number">600</span>, TimeUnit.SECONDS);</span><br><span class="line">            channel.basicAck(message.getMessageProperties().getDeliveryTag(),<span class="literal">false</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//è·å–Redisä¸­çš„valueå³å¯ å¦‚æœæ˜¯1ï¼Œç›´æ¥æ‰‹åŠ¨ackï¼Œä¸éœ€è¦å†æ¬¡æ¶ˆè´¹äº†</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;1&quot;</span>.equalsIgnoreCase(redisTemplate.opsForValue().get(messageId)))&#123;</span><br><span class="line">                channel.basicAck(message.getMessageProperties().getDeliveryTag(),<span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>4.æµ‹è¯•ç±»æµ‹è¯•å³å¯</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.simple.SimpleProducer;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Springboot14RabbitmqApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SimpleProducer simpleProducer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        simpleProducer.send();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•æˆåŠŸåï¼Œåˆ°redisä¸­æŸ¥çœ‹å³å¯ï¼</p>
</blockquote>
]]></content>
      <categories>
        <category>RabbitMQ</category>
      </categories>
      <tags>
        <tag>åç«¯</tag>
        <tag>RabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title>Shiro</title>
    <url>/2022/05/30/Shiro/</url>
    <content><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071249775.png" alt="1587372890081"></p>
<p>[TOC]</p>
<h3 id="ä¸€ã€RBACä»‹ç»"><a href="#ä¸€ã€RBACä»‹ç»" class="headerlink" title="ä¸€ã€RBACä»‹ç»"></a>ä¸€ã€RBACä»‹ç»</h3><hr>
<h4 id="1-1-RBACç®€ä»‹"><a href="#1-1-RBACç®€ä»‹" class="headerlink" title="1.1 RBACç®€ä»‹"></a>1.1 RBACç®€ä»‹</h4><blockquote>
<p>RBACæ˜¯åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRole-Based Access Control ï¼‰åœ¨ RBAC ä¸­ï¼Œæƒé™ä¸è§’è‰²ç›¸å…³è”ï¼Œç”¨æˆ·é€šè¿‡æˆä¸ºé€‚å½“è§’è‰²çš„æˆå‘˜è€Œå¾—åˆ°è¿™äº›è§’è‰²çš„æƒé™ã€‚è¿™å°±æå¤§åœ°ç®€åŒ–äº†æƒé™çš„ç®¡ç†ã€‚è¿™æ ·ç®¡ç†éƒ½æ˜¯å±‚çº§ç›¸äº’ä¾èµ–çš„ï¼Œæƒé™èµ‹äºˆç»™è§’è‰²ï¼Œè€ŒæŠŠè§’è‰²åˆèµ‹äºˆç”¨æˆ·ï¼Œè¿™æ ·çš„æƒé™è®¾è®¡å¾ˆæ¸…æ¥šï¼Œç®¡ç†èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚</p>
</blockquote>
<blockquote>
<p>åœ¨RBACæ¨¡å‹é‡Œé¢ï¼Œæœ‰3ä¸ªåŸºç¡€ç»„æˆéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ï¼šç”¨æˆ·ã€è§’è‰²å’Œæƒé™ã€‚</p>
<p>RBACé€šè¿‡å®šä¹‰è§’è‰²çš„æƒé™ï¼Œå¹¶å¯¹ç”¨æˆ·æˆäºˆæŸä¸ªè§’è‰²ä»è€Œæ¥æ§åˆ¶ç”¨æˆ·çš„æƒé™ï¼Œå®ç°äº†ç”¨æˆ·å’Œæƒé™çš„é€»è¾‘åˆ†ç¦»ï¼Œæå¤§åœ°æ–¹ä¾¿äº†æƒé™çš„ç®¡ç†ï¼Œåœ¨è®²è§£ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€äº›åè¯ï¼š</p>
</blockquote>
<span id="more"></span>
<blockquote>
<p>Userï¼ˆç”¨æˆ·ï¼‰ï¼šæ¯ä¸ªç”¨æˆ·éƒ½æœ‰å”¯ä¸€çš„UIDè¯†åˆ«ï¼Œå¹¶è¢«æˆäºˆä¸åŒçš„è§’è‰²</p>
<p>Roleï¼ˆè§’è‰²ï¼‰ï¼šä¸åŒè§’è‰²å…·æœ‰ä¸åŒçš„æƒé™</p>
<p>Permissionï¼ˆæƒé™ï¼‰ï¼šè®¿é—®æƒé™</p>
<p>ç”¨æˆ·-è§’è‰²æ˜ å°„ï¼šç”¨æˆ·å’Œè§’è‰²ä¹‹é—´çš„æ˜ å°„å…³ç³»</p>
<p>è§’è‰²-æƒé™æ˜ å°„ï¼šè§’è‰²å’Œæƒé™ä¹‹é—´çš„æ˜ å°„</p>
</blockquote>
<h4 id="1-2-æƒé™ç®¡ç†"><a href="#1-2-æƒé™ç®¡ç†" class="headerlink" title="1.2 æƒé™ç®¡ç†"></a>1.2 æƒé™ç®¡ç†</h4><blockquote>
<p> åªè¦æœ‰ç”¨æˆ·å‚ä¸çš„ç³»ç»Ÿä¸€èˆ¬éƒ½è¦æœ‰æƒé™ç®¡ç†ï¼Œæƒé™ç®¡ç†å®ç°å¯¹ç”¨æˆ·è®¿é—®ç³»ç»Ÿçš„æ§åˆ¶ï¼ŒæŒ‰ç…§å®‰å…¨è§„åˆ™æˆ–è€…<a href="http://baike.baidu.com/view/160028.htm_blank">å®‰å…¨ç­–ç•¥</a>æ§åˆ¶ç”¨æˆ·å¯ä»¥è®¿é—®è€Œä¸”åªèƒ½è®¿é—®è‡ªå·±è¢«æˆæƒçš„èµ„æºã€‚</p>
<p> æƒé™ç®¡ç†åŒ…æ‹¬ç”¨æˆ·è®¤è¯å’Œæˆæƒä¸¤éƒ¨åˆ†ã€‚</p>
</blockquote>
<h3 id="äºŒã€-ç”¨æˆ·è®¤è¯"><a href="#äºŒã€-ç”¨æˆ·è®¤è¯" class="headerlink" title="äºŒã€ ç”¨æˆ·è®¤è¯"></a>äºŒã€ ç”¨æˆ·è®¤è¯</h3><blockquote>
<p>ç”¨æˆ·è®¤è¯ï¼Œç”¨æˆ·å»è®¿é—®ç³»ç»Ÿï¼Œç³»ç»Ÿè¦éªŒè¯ç”¨æˆ·èº«ä»½çš„åˆæ³•æ€§ã€‚æœ€å¸¸ç”¨çš„ç”¨æˆ·èº«ä»½éªŒè¯çš„æ–¹æ³•ï¼š</p>
<p>1ã€ç”¨æˆ·åå¯†ç æ–¹å¼ã€2ã€æŒ‡çº¹æ‰“å¡æœºã€3ã€åŸºäºè¯ä¹¦éªŒè¯æ–¹æ³•ã€‚ã€‚ç³»ç»ŸéªŒè¯ç”¨æˆ·èº«ä»½åˆæ³•ï¼Œç”¨æˆ·æ–¹å¯è®¿é—®ç³»ç»Ÿçš„èµ„æºã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071249502.png"></p>
<blockquote>
<p>å…³é”®å¯¹è±¡ï¼š</p>
<p>subjectï¼šä¸»ä½“ï¼Œç†è§£ä¸ºç”¨æˆ·,å¯èƒ½æ˜¯ç¨‹åºï¼Œéƒ½è¦å»è®¿é—®ç³»ç»Ÿçš„èµ„æºï¼Œç³»ç»Ÿéœ€è¦å¯¹subjectè¿›è¡Œèº«ä»½è®¤è¯ã€‚</p>
<p>principalï¼šèº«ä»½ä¿¡æ¯ï¼Œé€šå¸¸æ˜¯å”¯ä¸€çš„ï¼Œä¸€ä¸ªä¸»ä½“è¿˜æœ‰å¤šä¸ªèº«ä»½ä¿¡æ¯ï¼Œä½†æ˜¯éƒ½æœ‰ä¸€ä¸ªä¸»èº«ä»½ä¿¡æ¯ï¼ˆprimary principalï¼‰</p>
<p>credentialï¼šå‡­è¯ä¿¡æ¯ï¼Œå¯ä»¥æ˜¯å¯†ç  ã€è¯ä¹¦ã€æŒ‡çº¹ã€‚</p>
<p>æ€»ç»“ï¼šä¸»ä½“åœ¨è¿›è¡Œèº«ä»½è®¤è¯æ—¶éœ€è¦æä¾›èº«ä»½ä¿¡æ¯å’Œå‡­è¯ä¿¡æ¯ã€‚</p>
</blockquote>
<h3 id="ä¸‰ã€ç”¨æˆ·æˆæƒ"><a href="#ä¸‰ã€ç”¨æˆ·æˆæƒ" class="headerlink" title="ä¸‰ã€ç”¨æˆ·æˆæƒ"></a>ä¸‰ã€ç”¨æˆ·æˆæƒ</h3><hr>
<blockquote>
<p>ç”¨æˆ·æˆæƒï¼Œç®€å•ç†è§£ä¸ºè®¿é—®æ§åˆ¶ï¼Œåœ¨ç”¨æˆ·è®¤è¯é€šè¿‡åï¼Œç³»ç»Ÿå¯¹ç”¨æˆ·è®¿é—®èµ„æºè¿›è¡Œæ§åˆ¶ï¼Œç”¨æˆ·å…·æœ‰èµ„æºçš„è®¿é—®æƒé™æ–¹å¯è®¿é—®ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071249558.png"></p>
<blockquote>
<p>å…³é”®å¯¹è±¡</p>
<p>æˆæƒçš„è¿‡ç¨‹ç†è§£ä¸ºï¼šwhoå¯¹what(which)è¿›è¡Œhowæ“ä½œã€‚</p>
<p>whoï¼šä¸»ä½“å³subjectï¼Œsubjectåœ¨è®¤è¯é€šè¿‡åç³»ç»Ÿè¿›è¡Œè®¿é—®æ§åˆ¶ã€‚</p>
<p>what(which)ï¼šèµ„æº(Resource)ï¼Œsubjectå¿…é¡»å…·å¤‡èµ„æºçš„è®¿é—®æƒé™æ‰å¯è®¿é—®è¯¥ èµ„æºã€‚èµ„æºæ¯”å¦‚ï¼šç³»ç»Ÿç”¨æˆ·åˆ—è¡¨é¡µé¢ã€å•†å“ä¿®æ”¹èœå•ã€å•†å“idä¸º001çš„å•†å“ä¿¡æ¯ã€‚</p>
<p>èµ„æºåˆ†ä¸ºèµ„æºç±»å‹å’Œèµ„æºå®ä¾‹ï¼š</p>
<p>ç³»ç»Ÿçš„ç”¨æˆ·ä¿¡æ¯å°±æ˜¯èµ„æºç±»å‹ï¼Œç›¸å½“äºjavaç±»ã€‚</p>
<p>ç³»ç»Ÿä¸­idä¸º001çš„ç”¨æˆ·å°±æ˜¯èµ„æºå®ä¾‹ï¼Œç›¸å½“äºnewçš„javaå¯¹è±¡ã€‚</p>
<p>howï¼šæƒé™&#x2F;è®¸å¯(permission) ï¼Œé’ˆå¯¹èµ„æºçš„æƒé™æˆ–è®¸å¯ï¼Œsubjectå…·æœ‰permissionè®¿é—®èµ„æºï¼Œå¦‚ä½•è®¿é—®&#x2F;æ“ä½œéœ€è¦å®šä¹‰permissionï¼Œæƒé™æ¯”å¦‚ï¼šç”¨æˆ·æ·»åŠ ã€ç”¨æˆ·ä¿®æ”¹ã€å•†å“åˆ é™¤ã€‚</p>
</blockquote>
<h3 id="å››ã€æƒé™æ¨¡å‹"><a href="#å››ã€æƒé™æ¨¡å‹" class="headerlink" title="å››ã€æƒé™æ¨¡å‹"></a>å››ã€æƒé™æ¨¡å‹</h3><hr>
<blockquote>
<p>ä¸»ä½“ï¼ˆè´¦å·ã€å¯†ç ï¼‰</p>
<p>è§’è‰²ï¼ˆè§’è‰²åç§°ï¼‰</p>
<p>æƒé™ï¼ˆæƒé™åç§°ã€èµ„æºidï¼‰</p>
<p>ä¸»ä½“å’Œè§’è‰²å…³ç³»ï¼ˆä¸»ä½“idã€è§’è‰²idï¼‰</p>
<p>è§’è‰²å’Œæƒé™å…³ç³»ï¼ˆè§’è‰²idã€æƒé™idï¼‰</p>
<p>èµ„æºï¼ˆèµ„æºåç§°ã€è®¿é—®åœ°å€ï¼‰</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071249586.png"></p>
<blockquote>
<p>é€šå¸¸ä¼ä¸šå¼€å‘ä¸­å°†èµ„æºå’Œæƒé™è¡¨åˆå¹¶ä¸ºä¸€å¼ æƒé™è¡¨ï¼Œå¦‚ä¸‹ï¼š</p>
<p>èµ„æºï¼ˆèµ„æºåç§°ã€è®¿é—®åœ°å€ï¼‰</p>
<p>æƒé™ï¼ˆæƒé™åç§°ã€èµ„æºidï¼‰</p>
<p>åˆå¹¶ä¸ºï¼šæƒé™ï¼ˆæƒé™åç§°ã€èµ„æºåç§°ã€èµ„æºè®¿é—®åœ°å€ï¼‰</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071249079.png"></p>
<blockquote>
<p>ä¸Šå›¾å¸¸è¢«ç§°ä¸ºæƒé™ç®¡ç†çš„é€šç”¨æ¨¡å‹ï¼Œä¸è¿‡ä¼ä¸šåœ¨å¼€å‘ä¸­æ ¹æ®ç³»ç»Ÿè‡ªèº«çš„ç‰¹ç‚¹è¿˜ä¼šå¯¹ä¸Šå›¾è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯ç”¨æˆ·ã€è§’è‰²ã€æƒé™ã€ç”¨æˆ·è§’è‰²å…³ç³»ã€è§’è‰²æƒé™å…³ç³»æ˜¯éœ€è¦å»ç†è§£çš„ã€‚</p>
</blockquote>
<blockquote>
<p>åˆ†é…æƒé™ï¼šç”¨æˆ·éœ€è¦åˆ†é…ç›¸åº”çš„æƒé™æ‰å¯è®¿é—®ç›¸åº”çš„èµ„æºã€‚æƒé™æ˜¯å¯¹äºèµ„æºçš„æ“ä½œè®¸å¯ï¼Œé€šå¸¸ç»™ç”¨æˆ·åˆ†é…èµ„æºæƒé™éœ€è¦å°†æƒé™ä¿¡æ¯æŒä¹…åŒ–ï¼Œæ¯”å¦‚å­˜å‚¨åœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼ŒæŠŠç”¨æˆ·ä¿¡æ¯ã€æƒé™ç®¡ç†ã€ç”¨æˆ·åˆ†é…çš„æƒé™ä¿¡æ¯å†™åˆ°æ•°æ®åº“ï¼ˆæƒé™æ•°æ®æ¨¡å‹ï¼‰ã€‚</p>
</blockquote>
<h3 id="äº”ã€Shiroä»‹ç»"><a href="#äº”ã€Shiroä»‹ç»" class="headerlink" title="äº”ã€Shiroä»‹ç»"></a>äº”ã€Shiroä»‹ç»</h3><hr>
<blockquote>
<p>shiroæ˜¯apacheçš„ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªæƒé™ç®¡ç†çš„æ¡†æ¶ï¼Œå®ç° ç”¨æˆ·è®¤è¯ã€ç”¨æˆ·æˆæƒï¼ŒåŠŸèƒ½å¼ºå¤§ã€ä¸” ç®€å•ã€çµæ´»ï¼Œä¸”ä¸è·Ÿä»»ä½•çš„æ¡†æ¶æˆ–è€…å®¹å™¨ç»‘å®šï¼Œå¯ä»¥ç‹¬ç«‹è¿è¡Œã€‚</p>
<p>springä¸­æœ‰spring security (åŸåAcegi)ï¼Œæ˜¯ä¸€ä¸ªæƒé™æ¡†æ¶ï¼Œä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œå’Œspringä¾èµ–è¿‡äºç´§å¯†ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071249240.png"></p>
<blockquote>
<p>subjectï¼šä¸»ä½“ï¼Œå¯ä»¥æ˜¯ç”¨æˆ·ä¹Ÿå¯ä»¥æ˜¯ç¨‹åºï¼Œä¸»ä½“è¦è®¿é—®ç³»ç»Ÿï¼Œç³»ç»Ÿéœ€è¦å¯¹ä¸»ä½“è¿›è¡Œè®¤è¯ã€æˆæƒã€‚</p>
<p>securityManagerï¼šå®‰å…¨ç®¡ç†å™¨ï¼Œä¸»ä½“è¿›è¡Œè®¤è¯å’Œæˆæƒéƒ½æ˜¯é€šè¿‡securityManagerè¿›è¡Œã€‚</p>
<p>authenticatorï¼šè®¤è¯å™¨ï¼Œä¸»ä½“è¿›è¡Œè®¤è¯æœ€ç»ˆé€šè¿‡authenticatorè¿›è¡Œçš„ã€‚</p>
<p>authorizerï¼šæˆæƒå™¨ï¼Œä¸»ä½“è¿›è¡Œæˆæƒæœ€ç»ˆé€šè¿‡authorizerè¿›è¡Œçš„ã€‚</p>
<p>sessionManagerï¼šwebåº”ç”¨ä¸­ä¸€èˆ¬æ˜¯ç”¨webå®¹å™¨å¯¹sessionè¿›è¡Œç®¡ç†ï¼Œshiroä¹Ÿæä¾›ä¸€å¥—sessionç®¡ç†çš„æ–¹å¼ã€‚</p>
<p>SessionDaoï¼šé€šè¿‡SessionDaoç®¡ç†sessionæ•°æ®ï¼Œé’ˆå¯¹ä¸ªæ€§åŒ–çš„sessionæ•°æ®å­˜å‚¨éœ€è¦ä½¿ç”¨sessionDaoã€‚</p>
<p>cache Managerï¼šç¼“å­˜ç®¡ç†å™¨ï¼Œä¸»è¦å¯¹sessionå’Œæˆæƒæ•°æ®è¿›è¡Œç¼“å­˜ï¼Œæ¯”å¦‚å°†æˆæƒæ•°æ®é€šè¿‡cacheManagerè¿›è¡Œç¼“å­˜ç®¡ç†ï¼Œå’Œehcacheæ•´åˆå¯¹ç¼“å­˜æ•°æ®è¿›è¡Œç®¡ç†ã€‚</p>
<p>realmï¼šåŸŸï¼Œé¢†åŸŸï¼Œç›¸å½“äºæ•°æ®æºï¼Œé€šè¿‡realmå­˜å–è®¤è¯ã€æˆæƒç›¸å…³æ•°æ®ã€‚</p>
<p>æ³¨ï¼šåœ¨realmä¸­å­˜å‚¨æˆæƒå’Œè®¤è¯çš„é€»è¾‘ã€‚</p>
<p>cryptographyï¼šå¯†ç ç®¡ç†ï¼Œæä¾›äº†ä¸€å¥—åŠ å¯†&#x2F;è§£å¯†çš„ç»„ä»¶ï¼Œæ–¹ä¾¿å¼€å‘ã€‚æ¯”å¦‚æä¾›å¸¸ç”¨çš„æ•£åˆ—ã€åŠ &#x2F;è§£å¯†ç­‰åŠŸèƒ½ã€‚</p>
<p>æ¯”å¦‚ï¼šmd5ä¿¡æ¯æ‘˜è¦ç®—æ³•ã€‚</p>
</blockquote>
<h3 id="å…­ã€è®¤è¯æµç¨‹"><a href="#å…­ã€è®¤è¯æµç¨‹" class="headerlink" title="å…­ã€è®¤è¯æµç¨‹"></a>å…­ã€è®¤è¯æµç¨‹</h3><hr>
<h4 id=""><a href="#" class="headerlink" title=""></a><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071249741.png"></h4><h4 id="6-1-åˆ›å»ºMavenå·¥ç¨‹å¹¶å¯¼å…¥ä¾èµ–"><a href="#6-1-åˆ›å»ºMavenå·¥ç¨‹å¹¶å¯¼å…¥ä¾èµ–" class="headerlink" title="6.1 åˆ›å»ºMavenå·¥ç¨‹å¹¶å¯¼å…¥ä¾èµ–"></a>6.1 åˆ›å»ºMavenå·¥ç¨‹å¹¶å¯¼å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- åæœŸæ•´åˆspringbootå·¥ç¨‹æ—¶ä¼šäº§ç”Ÿæ¥å£å†²çªé—®é¢˜ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;dependency&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;artifactId&gt;shiro-spring-boot-starter&lt;/artifactId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;version&gt;1.8.0&lt;/version&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/dependency&gt;--&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="6-2-åœ¨resourcesç›®å½•ä¸‹åˆ›å»ºshiro-iniæ–‡ä»¶ï¼ŒIEDAéœ€è¦å®‰è£…-iniå¹¶é‡å¯æ–¹å¯ç”Ÿæ•ˆ"><a href="#6-2-åœ¨resourcesç›®å½•ä¸‹åˆ›å»ºshiro-iniæ–‡ä»¶ï¼ŒIEDAéœ€è¦å®‰è£…-iniå¹¶é‡å¯æ–¹å¯ç”Ÿæ•ˆ" class="headerlink" title="6.2 åœ¨resourcesç›®å½•ä¸‹åˆ›å»ºshiro.iniæ–‡ä»¶ï¼ŒIEDAéœ€è¦å®‰è£…*.iniå¹¶é‡å¯æ–¹å¯ç”Ÿæ•ˆ"></a>6.2 åœ¨resourcesç›®å½•ä¸‹åˆ›å»ºshiro.iniæ–‡ä»¶ï¼ŒIEDAéœ€è¦å®‰è£…*.iniå¹¶é‡å¯æ–¹å¯ç”Ÿæ•ˆ</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å¯¹ç”¨æˆ·çš„é…ç½®</span></span><br><span class="line">[<span class="built_in">users</span>]</span><br><span class="line"><span class="comment">#å¯¹ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç çš„é…ç½®</span></span><br><span class="line">jack=123</span><br><span class="line">tom=456</span><br></pre></td></tr></table></figure>



<h4 id="6-3-åˆ›å»ºè®¤è¯æµ‹è¯•ç±»"><a href="#6-3-åˆ›å»ºè®¤è¯æµ‹è¯•ç±»" class="headerlink" title="6.3 åˆ›å»ºè®¤è¯æµ‹è¯•ç±»"></a>6.3 åˆ›å»ºè®¤è¯æµ‹è¯•ç±»</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.authentication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UsernamePasswordToken;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.config.IniSecurityManagerFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.SecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.util.Factory;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthenticationDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨æˆ·ç™»é™†å’Œé€€å‡º</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLoginAndLogout</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºsecurityManagerå·¥å‚ï¼Œé€šè¿‡inié…ç½®æ–‡ä»¶åˆ›å»ºsecurityManagerå·¥å‚</span></span><br><span class="line">        Factory&lt;SecurityManager&gt; factory = <span class="keyword">new</span> <span class="title class_">IniSecurityManagerFactory</span>(</span><br><span class="line">                <span class="string">&quot;classpath:shiro.ini&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºSecurityManager</span></span><br><span class="line">        <span class="type">SecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> factory.getInstance();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†securityManagerè®¾ç½®å½“å‰çš„è¿è¡Œç¯å¢ƒä¸­</span></span><br><span class="line">        SecurityUtils.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»SecurityUtilsé‡Œè¾¹åˆ›å»ºä¸€ä¸ªsubject</span></span><br><span class="line">        <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨è®¤è¯æäº¤å‰å‡†å¤‡tokenï¼ˆä»¤ç‰Œï¼‰</span></span><br><span class="line">        <span class="comment">// è¿™é‡Œçš„è´¦å·å’Œå¯†ç  å°†æ¥æ˜¯ç”±ç”¨æˆ·è¾“å…¥è¿›å»</span></span><br><span class="line">        <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(<span class="string">&quot;jack&quot;</span>, <span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰§è¡Œè®¤è¯æäº¤</span></span><br><span class="line">        subject.login(token);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ˜¯å¦è®¤è¯é€šè¿‡</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isAuthenticated</span> <span class="operator">=</span> subject.isAuthenticated();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦è®¤è¯é€šè¿‡ï¼š&quot;</span> + isAuthenticated);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€€å‡ºæ“ä½œ</span></span><br><span class="line">        subject.logout();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ˜¯å¦è®¤è¯é€šè¿‡</span></span><br><span class="line">        isAuthenticated = subject.isAuthenticated();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦è®¤è¯é€šè¿‡ï¼š&quot;</span> + isAuthenticated);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-æ‰§è¡Œæµç¨‹"><a href="#6-4-æ‰§è¡Œæµç¨‹" class="headerlink" title="6.4 æ‰§è¡Œæµç¨‹"></a>6.4 æ‰§è¡Œæµç¨‹</h4><blockquote>
<p>1ã€é€šè¿‡inié…ç½®æ–‡ä»¶åˆ›å»ºsecurityManager</p>
<p>2ã€è°ƒç”¨subject.loginæ–¹æ³•ä¸»ä½“æäº¤è®¤è¯ï¼Œæäº¤çš„token</p>
<p>3ã€securityManagerè¿›è¡Œè®¤è¯ï¼ŒsecurityManageræœ€ç»ˆç”±ModularRealmAuthenticatorè¿›è¡Œè®¤è¯ã€‚</p>
<p>4ã€ModularRealmAuthenticatorè°ƒç”¨IniRealm(ç»™realmä¼ å…¥token) å»inié…ç½®æ–‡ä»¶ä¸­æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</p>
<p>5ã€IniRealmæ ¹æ®è¾“å…¥çš„tokenï¼ˆUsernamePasswordTokenï¼‰ä» shiro.iniæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œæ ¹æ®è´¦å·æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯	ï¼ˆè´¦å·å’Œå¯†ç ï¼‰</p>
<p>â€‹      å¦‚æœæŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œå°±ç»™ModularRealmAuthenticatorè¿”å›ç”¨æˆ·ä¿¡æ¯ï¼ˆè´¦å·å’Œå¯†ç ï¼‰</p>
<p>â€‹      å¦‚æœæŸ¥è¯¢ä¸åˆ°ï¼Œå°±ç»™ModularRealmAuthenticatorè¿”å›null</p>
<p>6ã€ModularRealmAuthenticatoræ¥æ”¶IniRealmè¿”å›Authenticationè®¤è¯ä¿¡æ¯</p>
<p>â€‹      å¦‚æœè¿”å›çš„è®¤è¯ä¿¡æ¯æ˜¯nullï¼ŒModularRealmAuthenticatoræŠ›å‡ºå¼‚å¸¸</p>
<p>ï¼ˆorg.apache.shiro.authc.UnknownAccountExceptionï¼‰</p>
<p>â€‹      å¦‚æœè¿”å›çš„è®¤è¯ä¿¡æ¯ä¸æ˜¯nullï¼ˆè¯´æ˜inirealmæ‰¾åˆ°äº†ç”¨æˆ·ï¼‰ï¼Œå¯¹IniRealmè¿”å›ç”¨æˆ·å¯†ç  ï¼ˆåœ¨iniæ–‡ä»¶ä¸­å­˜åœ¨ï¼‰</p>
<p>â€‹      å’Œ tokenä¸­çš„å¯†ç  è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœä¸ä¸€è‡´æŠ›å‡ºå¼‚å¸¸</p>
<p>ï¼ˆorg.apache.shiro.authc.IncorrectCredentialsExceptionï¼‰</p>
</blockquote>
<h4 id="6-5-æ€»ç»“"><a href="#6-5-æ€»ç»“" class="headerlink" title="6.5 æ€»ç»“"></a>6.5 æ€»ç»“</h4><blockquote>
<p>ModularRealmAuthenticatorä½œç”¨æ˜¯è¿›è¡Œè®¤è¯ï¼Œéœ€è¦è°ƒç”¨realmæ¥æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ˆåœ¨æ•°æ®åº“ä¸­å­˜åœ¨ç”¨æˆ·ä¿¡æ¯ï¼‰å¹¶ä¸”è¿›è¡Œå¯†ç å¯¹æ¯”ï¼ˆè®¤è¯è¿‡ç¨‹ï¼‰</p>
<p>realmï¼šéœ€è¦æ ¹æ®tokenä¸­çš„èº«ä»½ä¿¡æ¯å»æŸ¥è¯¢æ•°æ®åº“ï¼ˆå…¥é—¨ç¨‹åºä½¿ç”¨inié…ç½®æ–‡ä»¶ï¼‰ï¼Œå¦‚æœæŸ¥åˆ°ç”¨æˆ·è¿”å›è®¤è¯ä¿¡æ¯ï¼Œå¦‚æœæŸ¥è¯¢ä¸åˆ°è¿”å›null</p>
</blockquote>
<h3 id="ä¸ƒã€ä½¿ç”¨realmè®¤è¯"><a href="#ä¸ƒã€ä½¿ç”¨realmè®¤è¯" class="headerlink" title="ä¸ƒã€ä½¿ç”¨realmè®¤è¯"></a>ä¸ƒã€ä½¿ç”¨realmè®¤è¯</h3><hr>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071249769.png"></p>
<h4 id="7-1-åˆ›å»ºè‡ªå®šä¹‰realm"><a href="#7-1-åˆ›å»ºè‡ªå®šä¹‰realm" class="headerlink" title="7.1 åˆ›å»ºè‡ªå®šä¹‰realm"></a>7.1 åˆ›å»ºè‡ªå®šä¹‰realm</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.realm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.SimpleAuthenticationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.AuthorizationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.AuthorizingRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.PrincipalCollection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">realmDemo</span> <span class="keyword">extends</span> <span class="title class_">AuthorizingRealm</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">realmName</span>  <span class="operator">=</span> <span class="string">&quot;realmDemo&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¤è¯</span></span><br><span class="line">    <span class="keyword">protected</span> AuthenticationInfo <span class="title function_">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken </span></span><br><span class="line"><span class="params">authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException &#123;</span><br><span class="line">		<span class="comment">//ä»tokenä¸­å–å‡ºç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">        <span class="comment">//ç”¨æˆ·åï¼Œèº«ä»½ä¿¡æ¯</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">principal</span> <span class="operator">=</span> (String)authenticationToken.getPrincipal();</span><br><span class="line">        System.out.println(principal);</span><br><span class="line">        <span class="comment">//å¯†ç ï¼Œå‡­è¯</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">credentials</span> <span class="operator">=</span> authenticationToken.getCredentials();</span><br><span class="line">		<span class="comment">//ç±»å‹è½¬åŒ–</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>((<span class="type">char</span>[]) credentials);</span><br><span class="line">        System.out.println(password);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;jack&quot;</span>.equals(principal) &amp;&amp; <span class="string">&quot;123&quot;</span>.equals(password))&#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">SimpleAuthenticationInfo</span> <span class="variable">simpleAuthenticationInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleAuthenticationInfo</span>(principal,password,realmName);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> simpleAuthenticationInfo;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆæƒ</span></span><br><span class="line">    <span class="keyword">protected</span> AuthorizationInfo <span class="title function_">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="7-2-åœ¨resourceç›®å½•ä¸‹åˆ›å»ºshiro-realm-iniï¼ˆæ³¨æ„ï¼šrealmè·¯å¾„åˆ«é…ç½®é”™äº†ï¼‰"><a href="#7-2-åœ¨resourceç›®å½•ä¸‹åˆ›å»ºshiro-realm-iniï¼ˆæ³¨æ„ï¼šrealmè·¯å¾„åˆ«é…ç½®é”™äº†ï¼‰" class="headerlink" title="7.2 åœ¨resourceç›®å½•ä¸‹åˆ›å»ºshiro-realm.iniï¼ˆæ³¨æ„ï¼šrealmè·¯å¾„åˆ«é…ç½®é”™äº†ï¼‰"></a>7.2 åœ¨resourceç›®å½•ä¸‹åˆ›å»ºshiro-realm.iniï¼ˆæ³¨æ„ï¼šrealmè·¯å¾„åˆ«é…ç½®é”™äº†ï¼‰</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[main]</span><br><span class="line"><span class="comment">#è‡ªå®šä¹‰realm</span></span><br><span class="line">realmDemo=com.qf.realm.realmDemo</span><br><span class="line"><span class="comment">#å°†realmè®¾ç½®åˆ°securityManager</span></span><br><span class="line">securityManager.realms=<span class="variable">$realmDemo</span></span><br></pre></td></tr></table></figure>



<h4 id="7-3-åœ¨AuthenticationDemoç±»ä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•"><a href="#7-3-åœ¨AuthenticationDemoç±»ä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•" class="headerlink" title="7.3 åœ¨AuthenticationDemoç±»ä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•"></a>7.3 åœ¨AuthenticationDemoç±»ä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰realm</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRealmDemo</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºsecurityManagerå·¥å‚ï¼Œé€šè¿‡inié…ç½®æ–‡ä»¶åˆ›å»ºsecurityManagerå·¥å‚</span></span><br><span class="line">    Factory&lt;SecurityManager&gt; factory = <span class="keyword">new</span> <span class="title class_">IniSecurityManagerFactory</span>(</span><br><span class="line">            <span class="string">&quot;classpath:shiro-realm.ini&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºSecurityManager</span></span><br><span class="line">    <span class="type">SecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> factory.getInstance();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†securityManagerè®¾ç½®å½“å‰çš„è¿è¡Œç¯å¢ƒä¸­</span></span><br><span class="line">    SecurityUtils.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»SecurityUtilsé‡Œè¾¹åˆ›å»ºä¸€ä¸ªsubject</span></span><br><span class="line">    <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨è®¤è¯æäº¤å‰å‡†å¤‡tokenï¼ˆä»¤ç‰Œï¼‰</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„è´¦å·å’Œå¯†ç  å°†æ¥æ˜¯ç”±ç”¨æˆ·è¾“å…¥è¿›å»</span></span><br><span class="line">    <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(<span class="string">&quot;jack&quot;</span>, <span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œè®¤è¯æäº¤</span></span><br><span class="line">        subject.login(token);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (AuthenticationException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¯å¦è®¤è¯é€šè¿‡</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isAuthenticated</span> <span class="operator">=</span> subject.isAuthenticated();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;æ˜¯å¦è®¤è¯é€šè¿‡ï¼š&quot;</span> + isAuthenticated);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>è®¿é—®controlleræµ‹è¯•å³å¯</p>
</blockquote>
<h3 id="å…«ã€MD5åŠ å¯†"><a href="#å…«ã€MD5åŠ å¯†" class="headerlink" title="å…«ã€MD5åŠ å¯†"></a>å…«ã€MD5åŠ å¯†</h3><hr>
<blockquote>
<p>é€šå¸¸éœ€è¦å¯¹å¯†ç  è¿›è¡Œæ•£åˆ—ï¼Œå¸¸ç”¨çš„æœ‰MD5ã€SHAï¼Œ</p>
<p>å¯¹MD5å¯†ç ï¼Œå¦‚æœçŸ¥é“æ•£åˆ—åçš„å€¼å¯ä»¥é€šè¿‡ç©·ä¸¾ç®—æ³•ï¼Œå¾—åˆ°md5å¯†ç å¯¹åº”çš„æ˜æ–‡ï¼ˆæŒ‡åŠ å¯†å‰çš„å¯†ç ï¼‰ã€‚</p>
<p>å»ºè®®å¯¹MD5è¿›è¡Œæ•£åˆ—æ—¶åŠ saltï¼ˆç›ï¼‰ï¼Œè¿›è¡ŒåŠ å¯†ç›¸å½“äºå¯¹åŸå§‹å¯†ç +ç›è¿›è¡Œæ•£åˆ—ã€‚</p>
<p>æ­£å¸¸ä½¿ç”¨æ—¶æ•£åˆ—æ–¹æ³•ï¼š</p>
<p>åœ¨ç¨‹åºä¸­å¯¹åŸå§‹å¯†ç +ç›è¿›è¡Œæ•£åˆ—ï¼Œå°†æ•£åˆ—å€¼å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”è¿˜è¦å°†ç›ä¹Ÿè¦å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚</p>
<p>å¦‚æœè¿›è¡Œå¯†ç å¯¹æ¯”æ—¶ï¼Œä½¿ç”¨ç›¸åŒæ–¹æ³•ï¼Œå°†åŸå§‹å¯†ç +ç›è¿›è¡Œæ•£åˆ—ï¼Œè¿›è¡Œæ¯”å¯¹ã€‚</p>
</blockquote>
<h4 id="8-1-åˆ›å»ºMD5Demoæµ‹è¯•ç±»ï¼Œè¿›è¡Œæµ‹è¯•"><a href="#8-1-åˆ›å»ºMD5Demoæµ‹è¯•ç±»ï¼Œè¿›è¡Œæµ‹è¯•" class="headerlink" title="8.1.åˆ›å»ºMD5Demoæµ‹è¯•ç±»ï¼Œè¿›è¡Œæµ‹è¯•"></a>8.1.åˆ›å»ºMD5Demoæµ‹è¯•ç±»ï¼Œè¿›è¡Œæµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.shiro.crypto.hash.Md5Hash;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.crypto.hash.SimpleHash;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MD5Demo</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="comment">// åŸå§‹ å¯†ç </span></span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;123&quot;</span>;</span><br><span class="line">		<span class="comment">// ç›</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">salt</span> <span class="operator">=</span> <span class="string">&quot;abcde&quot;</span>;</span><br><span class="line">		<span class="comment">// æ•£åˆ—æ¬¡æ•°</span></span><br><span class="line">		<span class="type">int</span> <span class="variable">hashIterations</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">		<span class="comment">// ä¸Šè¾¹æ•£åˆ—1æ¬¡ï¼š7bc6c31880aeda581aa34e218af25753</span></span><br><span class="line">		<span class="comment">// ä¸Šè¾¹æ•£åˆ—2æ¬¡ï¼š6585096f3f6735025449cfb351c8cff9</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// ç¬¬ä¸€ç§æ–¹å¼</span></span><br><span class="line">		<span class="comment">// æ„é€ æ–¹æ³•ä¸­ï¼š</span></span><br><span class="line">		<span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜æ–‡ï¼ŒåŸå§‹å¯†ç </span></span><br><span class="line">		<span class="comment">// ç¬¬äºŒä¸ªå‚æ•°ï¼šç›ï¼Œé€šè¿‡ä½¿ç”¨éšæœºæ•°</span></span><br><span class="line">		<span class="comment">// ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šæ•£åˆ—çš„æ¬¡æ•°ï¼Œæ¯”å¦‚æ•£åˆ—ä¸¤æ¬¡ï¼Œç›¸å½“ äºmd5(md5(&#x27;&#x27;))</span></span><br><span class="line">		<span class="type">Md5Hash</span> <span class="variable">md5Hash</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Md5Hash</span>(password, salt, hashIterations);</span><br><span class="line"></span><br><span class="line">		<span class="type">String</span> <span class="variable">password_md5</span> <span class="operator">=</span> md5Hash.toString();</span><br><span class="line">		System.out.println(password_md5);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// ç¬¬äºŒç§æ–¹å¼</span></span><br><span class="line">		<span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ•£åˆ—ç®—æ³•</span></span><br><span class="line">		<span class="type">SimpleHash</span> <span class="variable">simpleHash</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleHash</span>(<span class="string">&quot;md5&quot;</span>, password, salt,</span><br><span class="line">				hashIterations);</span><br><span class="line">		System.out.println(simpleHash.toString());</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="8-2åœ¨AuthenticationDemoç±»ä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•"><a href="#8-2åœ¨AuthenticationDemoç±»ä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•" class="headerlink" title="8.2åœ¨AuthenticationDemoç±»ä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•"></a>8.2åœ¨AuthenticationDemoç±»ä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æµ‹è¯•MD5</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMD5</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºsecurityManagerå·¥å‚ï¼Œé€šè¿‡inié…ç½®æ–‡ä»¶åˆ›å»ºsecurityManagerå·¥å‚</span></span><br><span class="line">    Factory&lt;SecurityManager&gt; factory =</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">IniSecurityManagerFactory</span>(<span class="string">&quot;classpath:shiro-realm-md5.ini&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºSecurityManager</span></span><br><span class="line">    <span class="type">SecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> factory.getInstance();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†securityManagerè®¾ç½®å½“å‰çš„è¿è¡Œç¯å¢ƒä¸­</span></span><br><span class="line">    SecurityUtils.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»SecurityUtilsé‡Œè¾¹åˆ›å»ºä¸€ä¸ªsubject</span></span><br><span class="line">    <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨è®¤è¯æäº¤å‰å‡†å¤‡tokenï¼ˆä»¤ç‰Œï¼‰</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„è´¦å·å’Œå¯†ç  å°†æ¥æ˜¯ç”±ç”¨æˆ·è¾“å…¥è¿›å»</span></span><br><span class="line">    <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(<span class="string">&quot;jack&quot;</span>, <span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œè®¤è¯æäº¤</span></span><br><span class="line">        subject.login(token);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (AuthenticationException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¯å¦è®¤è¯é€šè¿‡</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isAuthenticated</span> <span class="operator">=</span> subject.isAuthenticated();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;æ˜¯å¦è®¤è¯é€šè¿‡ï¼š&quot;</span> + isAuthenticated);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="8-3åˆ›å»ºshiro-realm-md5-ini"><a href="#8-3åˆ›å»ºshiro-realm-md5-ini" class="headerlink" title="8.3åˆ›å»ºshiro-realm-md5.ini"></a>8.3åˆ›å»ºshiro-realm-md5.ini</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[main]</span><br><span class="line"><span class="comment">#è‡ªå®šä¹‰realm</span></span><br><span class="line">realmDemo=com.qf.realm.realmDemoMD5</span><br><span class="line"><span class="comment">#å°†realmè®¾ç½®åˆ°securityManager</span></span><br><span class="line">securityManager.realms=<span class="variable">$realmDemo</span></span><br></pre></td></tr></table></figure>



<h4 id="8-4åˆ›å»ºrealmMD5"><a href="#8-4åˆ›å»ºrealmMD5" class="headerlink" title="8.4åˆ›å»ºrealmMD5"></a>8.4åˆ›å»ºrealmMD5</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.realm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.SimpleAuthenticationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.AuthorizationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.crypto.hash.Md5Hash;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.AuthorizingRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.PrincipalCollection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">realmDemoMD5</span> <span class="keyword">extends</span> <span class="title class_">AuthorizingRealm</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">realmName</span>  <span class="operator">=</span> <span class="string">&quot;realmDemoMD5&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¤è¯</span></span><br><span class="line">    <span class="keyword">protected</span> AuthenticationInfo <span class="title function_">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException &#123;</span><br><span class="line">        <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">principal</span> <span class="operator">=</span> (String)authenticationToken.getPrincipal();</span><br><span class="line">        <span class="comment">//System.out.println(principal);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¯†ç </span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">credentials</span> <span class="operator">=</span> authenticationToken.getCredentials();</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>((<span class="type">char</span>[]) credentials);</span><br><span class="line">        System.out.println(password);</span><br><span class="line">        </span><br><span class="line">        <span class="type">Md5Hash</span> <span class="variable">md5Hash</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Md5Hash</span>(password, <span class="string">&quot;abcde&quot;</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password_md5</span> <span class="operator">=</span> md5Hash.toString();</span><br><span class="line">        System.out.println(password_md5);</span><br><span class="line">        <span class="comment">//ä»æ•°æ®åº“æŸ¥å‡ºæ¥çš„å¯†ç </span></span><br><span class="line">        <span class="type">String</span> <span class="variable">dbpassword</span> <span class="operator">=</span> <span class="string">&quot;6585096f3f6735025449cfb351c8cff9&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;jack&quot;</span>.equals(principal) &amp;&amp;password_md5.equals(dbpassword))&#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">SimpleAuthenticationInfo</span> </span><br><span class="line"><span class="variable">simpleAuthenticationInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleAuthenticationInfo</span>(principal,password,realmName);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> simpleAuthenticationInfo;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆæƒ</span></span><br><span class="line">    <span class="keyword">protected</span> AuthorizationInfo <span class="title function_">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="ä¹ã€æˆæƒæµç¨‹"><a href="#ä¹ã€æˆæƒæµç¨‹" class="headerlink" title="ä¹ã€æˆæƒæµç¨‹"></a>ä¹ã€æˆæƒæµç¨‹</h3><hr>
<p><img src="https://cdn.jsdelivr.net/gh/CoutureOne/blogimg@main/img/202211071250363.png"></p>
<h4 id="9-1åˆ›å»ºshiro-permission-iniï¼ˆshiro-permission-inié‡Œè¾¹çš„å†…å®¹ç›¸å½“äºåœ¨æ•°æ®åº“ï¼‰"><a href="#9-1åˆ›å»ºshiro-permission-iniï¼ˆshiro-permission-inié‡Œè¾¹çš„å†…å®¹ç›¸å½“äºåœ¨æ•°æ®åº“ï¼‰" class="headerlink" title="9.1åˆ›å»ºshiro-permission.iniï¼ˆshiro-permission.inié‡Œè¾¹çš„å†…å®¹ç›¸å½“äºåœ¨æ•°æ®åº“ï¼‰"></a>9.1åˆ›å»ºshiro-permission.iniï¼ˆshiro-permission.inié‡Œè¾¹çš„å†…å®¹ç›¸å½“äºåœ¨æ•°æ®åº“ï¼‰</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç”¨æˆ·</span></span><br><span class="line">[<span class="built_in">users</span>]</span><br><span class="line"><span class="comment">#ç”¨æˆ·jackçš„å¯†ç æ˜¯123ï¼Œæ­¤ç”¨æˆ·å…·æœ‰role1å’Œrole2ä¸¤ä¸ªè§’è‰²</span></span><br><span class="line">jack=123,role1,role2</span><br><span class="line">tom=456,role2</span><br><span class="line"></span><br><span class="line"><span class="comment">#æƒé™</span></span><br><span class="line">[roles]</span><br><span class="line"><span class="comment">#è§’è‰²role1å¯¹èµ„æºuseræ‹¥æœ‰createã€updateæƒé™</span></span><br><span class="line">role1=user:create,user:update</span><br><span class="line"><span class="comment">#è§’è‰²role2å¯¹èµ„æºuseræ‹¥æœ‰createã€deleteæƒé™</span></span><br><span class="line">role2=user:create,user:delete</span><br><span class="line"><span class="comment">#è§’è‰²role3å¯¹èµ„æºuseræ‹¥æœ‰queryæƒé™</span></span><br><span class="line">role3=user:query</span><br></pre></td></tr></table></figure>



<h4 id="9-2åˆ›å»ºAuthorizationDemo"><a href="#9-2åˆ›å»ºAuthorizationDemo" class="headerlink" title="9.2åˆ›å»ºAuthorizationDemo"></a>9.2åˆ›å»ºAuthorizationDemo</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.authorization;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UsernamePasswordToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.config.IniSecurityManagerFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.SecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.util.Factory;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthorizationDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è§’è‰²æˆæƒã€èµ„æºæˆæƒæµ‹è¯•</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAuthorization</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åˆ›å»ºSecurityManagerå·¥å‚</span></span><br><span class="line">		Factory&lt;SecurityManager&gt; factory = <span class="keyword">new</span> <span class="title class_">IniSecurityManagerFactory</span>(</span><br><span class="line">				<span class="string">&quot;classpath:shiro-permission.ini&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åˆ›å»ºSecurityManager</span></span><br><span class="line">		<span class="type">SecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> factory.getInstance();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// å°†SecurityManagerè®¾ç½®åˆ°ç³»ç»Ÿè¿è¡Œç¯å¢ƒï¼Œå°†SecurityManageré…ç½®springå®¹å™¨ä¸­ï¼Œä¸€èˆ¬å•ä¾‹ç®¡ç†</span></span><br><span class="line">		SecurityUtils.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åˆ›å»ºsubject</span></span><br><span class="line">		<span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åˆ›å»ºtokenä»¤ç‰Œ</span></span><br><span class="line">		<span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(<span class="string">&quot;jack&quot;</span>, <span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//è®¤è¯</span></span><br><span class="line">        subject.login(token);</span><br><span class="line">        <span class="comment">//æ˜¯å¦è®¤è¯æˆåŠŸ</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">authenticated</span> <span class="operator">=</span> subject.isAuthenticated();</span><br><span class="line">        System.out.println(<span class="string">&quot;æ˜¯å¦è®¤è¯æˆåŠŸï¼š&quot;</span>+authenticated);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//--------è®¤è¯é€šè¿‡ä¹‹åè¿›è¡Œæˆæƒ----------</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//åŸºäºè§’è‰²çš„æˆæƒ </span></span><br><span class="line">        <span class="comment">//å•ä¸ªè§’è‰²åˆ¤æ–­</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">role1</span> <span class="operator">=</span> subject.hasRole(<span class="string">&quot;role1&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;role1ï¼š&quot;</span>+role1);</span><br><span class="line">        <span class="comment">//å¤šä¸ªè§’è‰²åˆ¤æ–­</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">allRoles</span> <span class="operator">=</span> subject.hasAllRoles(Arrays.asList(<span class="string">&quot;role1&quot;</span>, <span class="string">&quot;role2&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;role1 + role2ï¼š&quot;</span>+allRoles);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//subject.checkRole(&quot;role3&quot;);//æ£€æŸ¥æ˜¯å¦æœ‰å½“å‰è§’è‰²</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//åŸºäºèµ„æºçš„æˆæƒ</span></span><br><span class="line">        <span class="comment">//å•ä¸ªæƒé™åˆ¤æ–­</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">permitted</span> <span class="operator">=</span> subject.isPermitted(<span class="string">&quot;user:create&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;user:createï¼š&quot;</span>+permitted);</span><br><span class="line">        <span class="comment">//å¤šä¸ªæƒé™åˆ¤æ–­</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">permittedAll</span> <span class="operator">=</span> subject.isPermittedAll(<span class="string">&quot;user:create&quot;</span>, <span class="string">&quot;user:update&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;user:create + user:updateï¼š&quot;</span>+permittedAll);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//subject.checkPermissions(&quot;user:query&quot;, &quot;user:add&quot;);</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="åã€ä½¿ç”¨realmæˆæƒ"><a href="#åã€ä½¿ç”¨realmæˆæƒ" class="headerlink" title="åã€ä½¿ç”¨realmæˆæƒ"></a>åã€ä½¿ç”¨realmæˆæƒ</h3><hr>
<blockquote>
<p>éœ€æ±‚</p>
<p>ä¸Šè¾¹çš„ç¨‹åºé€šè¿‡shiro-permission.iniå¯¹æƒé™ä¿¡æ¯è¿›è¡Œé™æ€é…ç½®ï¼Œå®é™…å¼€å‘ä¸­ä»æ•°æ®åº“ä¸­è·å–æƒé™æ•°æ®ã€‚å°±éœ€è¦è‡ªå®šä¹‰realmï¼Œç”±realmä»æ•°æ®åº“æŸ¥è¯¢æƒé™æ•°æ®ï¼Œrealmä¼šæ ¹æ®ç”¨æˆ·èº«ä»½æŸ¥è¯¢æƒé™æ•°æ®ï¼Œå°†æƒé™æ•°æ®è¿”å›ç»™authorizerï¼ˆæˆæƒå™¨ï¼‰ã€‚</p>
</blockquote>
<h4 id="10-1ä¿®æ”¹ä¹‹å‰realmDemo-javaä¸­çš„doGetAuthorizationInfoæ–¹æ³•"><a href="#10-1ä¿®æ”¹ä¹‹å‰realmDemo-javaä¸­çš„doGetAuthorizationInfoæ–¹æ³•" class="headerlink" title="10.1ä¿®æ”¹ä¹‹å‰realmDemo.javaä¸­çš„doGetAuthorizationInfoæ–¹æ³•"></a>10.1ä¿®æ”¹ä¹‹å‰realmDemo.javaä¸­çš„doGetAuthorizationInfoæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æˆæƒ</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> AuthorizationInfo <span class="title function_">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä» principalsè·å–ä¸»èº«ä»½ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">// å°†getPrimaryPrincipalæ–¹æ³•è¿”å›å€¼è½¬ä¸ºçœŸå®èº«ä»½ç±»å‹ï¼ˆåœ¨ä¸Šè¾¹çš„doGetAuthenticationInfoè®¤è¯é€šè¿‡å¡«å……åˆ°SimpleAuthenticationInfoä¸­èº«ä»½ç±»å‹ï¼‰</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">primaryPrincipal</span> <span class="operator">=</span> (String)principalCollection.getPrimaryPrincipal();</span><br><span class="line">    System.out.println(<span class="string">&quot;primaryPrincipalï¼š&quot;</span>+primaryPrincipal);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®èº«ä»½ä¿¡æ¯è·å–æƒé™ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">// è¿æ¥æ•°æ®åº“...</span></span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿä»æ•°æ®åº“è·å–åˆ°æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŠŠæ•°æ®åº“ä¸­æŸ¥åˆ°çš„è§’è‰²æ”¾è¿›é›†åˆä¸­</span></span><br><span class="line">    ArrayList&lt;String&gt; roles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    roles.add(<span class="string">&quot;role1&quot;</span>);</span><br><span class="line">    roles.add(<span class="string">&quot;role2&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŠŠæ•°æ®åº“ä¸­æŸ¥åˆ°çš„èµ„æºæ”¾è¿›é›†åˆä¸­</span></span><br><span class="line">    HashSet&lt;String&gt; permissions = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    permissions.add(<span class="string">&quot;user:add&quot;</span>);</span><br><span class="line">    permissions.add(<span class="string">&quot;user:update&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŸ¥åˆ°æƒé™æ•°æ®ï¼Œè¿”å›æˆæƒä¿¡æ¯ï¼ˆåŒ…æ‹¬ä»¥ä¸Šçš„è§’è‰²æˆ–è€…èµ„æºï¼‰</span></span><br><span class="line">    <span class="type">SimpleAuthorizationInfo</span> <span class="variable">simpleAuthorizationInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleAuthorizationInfo</span>();</span><br><span class="line">    <span class="comment">//é€šè¿‡è§’è‰²æˆæƒ</span></span><br><span class="line">    <span class="comment">//simpleAuthorizationInfo.addRoles(roles);</span></span><br><span class="line">    <span class="comment">//é€šè¿‡èµ„æºæˆæƒ</span></span><br><span class="line">    simpleAuthorizationInfo.addStringPermissions(permissions);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> simpleAuthorizationInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="10-2åˆ›å»ºshiro-realm-iniæ–‡ä»¶ï¼Œé…ç½®è‡ªå®šä¹‰çš„realmï¼Œå°†realmè®¾ç½®åˆ°securityManagerä¸­ï¼Œå› ä¸ºä¹‹å‰å·²ç»é…ç½®è¿‡ï¼Œè¯¥æ­¥éª¤å¯ä»¥çœç•¥"><a href="#10-2åˆ›å»ºshiro-realm-iniæ–‡ä»¶ï¼Œé…ç½®è‡ªå®šä¹‰çš„realmï¼Œå°†realmè®¾ç½®åˆ°securityManagerä¸­ï¼Œå› ä¸ºä¹‹å‰å·²ç»é…ç½®è¿‡ï¼Œè¯¥æ­¥éª¤å¯ä»¥çœç•¥" class="headerlink" title="10.2åˆ›å»ºshiro-realm.iniæ–‡ä»¶ï¼Œé…ç½®è‡ªå®šä¹‰çš„realmï¼Œå°†realmè®¾ç½®åˆ°securityManagerä¸­ï¼Œå› ä¸ºä¹‹å‰å·²ç»é…ç½®è¿‡ï¼Œè¯¥æ­¥éª¤å¯ä»¥çœç•¥"></a>10.2åˆ›å»ºshiro-realm.iniæ–‡ä»¶ï¼Œé…ç½®è‡ªå®šä¹‰çš„realmï¼Œå°†realmè®¾ç½®åˆ°securityManagerä¸­ï¼Œå› ä¸ºä¹‹å‰å·²ç»é…ç½®è¿‡ï¼Œè¯¥æ­¥éª¤å¯ä»¥çœç•¥</h4><h4 id="10-3åœ¨AuthorizationDemoä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•"><a href="#10-3åœ¨AuthorizationDemoä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•" class="headerlink" title="10.3åœ¨AuthorizationDemoä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•"></a>10.3åœ¨AuthorizationDemoä¸­æ·»åŠ æ–¹æ³•è¿›è¡Œæµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æˆæƒ</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAuthorization</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‡†å¤‡ç¯å¢ƒ</span></span><br><span class="line">    <span class="type">IniSecurityManagerFactory</span> <span class="variable">iniSecurityManagerFactory</span> <span class="operator">=</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">IniSecurityManagerFactory</span>(<span class="string">&quot;classpath:shiro-realm.ini&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">SecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> iniSecurityManagerFactory.getInstance();</span><br><span class="line"></span><br><span class="line">    SecurityUtils.setSecurityManager(securityManager);</span><br><span class="line">    <span class="comment">//è·å–ä¸»ä½“</span></span><br><span class="line">    <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">    <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(<span class="string">&quot;jack&quot;</span>,<span class="string">&quot;123&quot;</span>);</span><br><span class="line">    <span class="comment">//è®¤è¯</span></span><br><span class="line">    subject.login(token);</span><br><span class="line">    <span class="comment">//æ˜¯å¦è®¤è¯æˆåŠŸ</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">authenticated</span> <span class="operator">=</span> subject.isAuthenticated();</span><br><span class="line">    System.out.println(<span class="string">&quot;æ˜¯å¦è®¤è¯æˆåŠŸï¼š&quot;</span>+authenticated);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//--------è®¤è¯é€šè¿‡ä¹‹åè¿›è¡Œæˆæƒ----------</span></span><br><span class="line">    <span class="comment">//å•ä¸ªè§’è‰²åˆ¤æ–­</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">role1</span> <span class="operator">=</span> subject.hasRole(<span class="string">&quot;role1&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;role1ï¼š&quot;</span>+role1);</span><br><span class="line">    <span class="comment">//å¤šä¸ªè§’è‰²åˆ¤æ–­</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">allRoles</span> <span class="operator">=</span> subject.hasAllRoles(Arrays.asList(<span class="string">&quot;role1&quot;</span>, <span class="string">&quot;role2&quot;</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;role1 + role2ï¼š&quot;</span>+allRoles);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//subject.checkRole(&quot;role3&quot;);//æ£€æŸ¥æ˜¯å¦æœ‰å½“å‰è§’è‰²</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//-------åˆ¤æ–­æƒé™--------</span></span><br><span class="line">    <span class="comment">//å•ä¸ªæƒé™åˆ¤æ–­</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">permitted</span> <span class="operator">=</span> subject.isPermitted(<span class="string">&quot;user:create&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;user:createï¼š&quot;</span>+permitted);</span><br><span class="line">    <span class="comment">//å¤šä¸ªæƒé™åˆ¤æ–­</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">permittedAll</span> <span class="operator">=</span> subject.isPermittedAll(<span class="string">&quot;user:create&quot;</span>, <span class="string">&quot;user:update&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;user:create + user:updateï¼š&quot;</span>+permittedAll);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//subject.checkPermissions(&quot;user:query&quot;, &quot;user:add&quot;);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-4-æˆæƒæµç¨‹"><a href="#10-4-æˆæƒæµç¨‹" class="headerlink" title="10.4 æˆæƒæµç¨‹"></a>10.4 æˆæƒæµç¨‹</h4><blockquote>
<p>1ã€å¯¹subjectè¿›è¡Œæˆæƒï¼Œè°ƒç”¨æ–¹æ³•isPermittedï¼ˆâ€permissionä¸²â€ï¼‰<br>2ã€SecurityManageræ‰§è¡Œæˆæƒï¼Œé€šè¿‡ModularRealmAuthorizeræ‰§è¡Œæˆæƒ<br>3ã€ModularRealmAuthorizeræ‰§è¡Œrealmï¼ˆè‡ªå®šä¹‰çš„Realmï¼‰ä»æ•°æ®åº“æŸ¥è¯¢æƒé™æ•°æ®ï¼Œè°ƒç”¨realmçš„doGetAuthorizationInfoæˆæƒæ–¹æ³•<br>4ã€realmä»æ•°æ®åº“æŸ¥è¯¢æƒé™æ•°æ®ï¼Œè¿”å›ModularRealmAuthorizer<br>5ã€ModularRealmAuthorizerè°ƒç”¨PermissionResolverè¿›è¡Œæƒé™ä¸²æ¯”å¯¹<br>6ã€å¦‚æœæ¯”å¯¹åï¼ŒisPermittedä¸­â€permissionä¸²â€åœ¨realmæŸ¥è¯¢åˆ°æƒé™æ•°æ®ä¸­ï¼Œè¯´æ˜ç”¨æˆ·è®¿é—®permissionä¸²æœ‰æƒé™ï¼Œå¦åˆ™ æ²¡æœ‰æƒé™ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚</p>
</blockquote>
<h3 id="åä¸€ã€SpringBootæ•´åˆShiro"><a href="#åä¸€ã€SpringBootæ•´åˆShiro" class="headerlink" title="åä¸€ã€SpringBootæ•´åˆShiro"></a>åä¸€ã€SpringBootæ•´åˆShiro</h3><hr>
<h4 id="11-1å¯¼å…¥ä¾èµ–"><a href="#11-1å¯¼å…¥ä¾èµ–" class="headerlink" title="11.1å¯¼å…¥ä¾èµ–"></a>11.1å¯¼å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shiro<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shiro-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="11-2é…ç½®application-yml"><a href="#11-2é…ç½®application-yml" class="headerlink" title="11.2é…ç½®application.yml"></a>11.2é…ç½®application.yml</h4><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">session:</span></span><br><span class="line">      <span class="comment">#å»é™¤è®¿é—®è·¯å¾„åæºå¸¦sessionid</span></span><br><span class="line">      <span class="attr">tracking-modes:</span> <span class="string">cookie</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/shiro?serverTimezone=Asia/Shanghai&amp;characterEncoding=utf8</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">  <span class="attr">thymeleaf:</span></span><br><span class="line">    <span class="attr">cache:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">prefix:</span> <span class="string">classpath:/templates</span></span><br><span class="line">    <span class="attr">suffix:</span> <span class="string">.html</span></span><br><span class="line">    <span class="attr">encoding:</span> <span class="string">UTF-8</span></span><br><span class="line">    <span class="attr">mode:</span> <span class="string">HTML5</span></span><br><span class="line">    <span class="attr">servlet:</span></span><br><span class="line">      <span class="attr">content-type:</span> <span class="string">text/html</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mapper/*.xml</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class="line">    <span class="comment">#é©¼å³°å½¢å¼</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>



<h4 id="11-3ç¼–å†™ShiroRealm"><a href="#11-3ç¼–å†™ShiroRealm" class="headerlink" title="11.3ç¼–å†™ShiroRealm"></a>11.3ç¼–å†™ShiroRealm</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.realm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.AuthorizationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.AuthorizingRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.PrincipalCollection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShiroRealm</span> <span class="keyword">extends</span> <span class="title class_">AuthorizingRealm</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> AuthorizationInfo <span class="title function_">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> AuthenticationInfo <span class="title function_">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="11-4ç¼–å†™ShiroConfig"><a href="#11-4ç¼–å†™ShiroConfig" class="headerlink" title="11.4ç¼–å†™ShiroConfig"></a>11.4ç¼–å†™ShiroConfig</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> at.pollux.thymeleaf.shiro.dialect.ShiroDialect;</span><br><span class="line"><span class="keyword">import</span> com.qf.realm.ShiroRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.DefaultSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.SecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.spring.web.ShiroFilterFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.mgt.CookieRememberMeManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.mgt.DefaultWebSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.servlet.SimpleCookie;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShiroConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ShiroRealm <span class="title function_">getShiroRealm</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ShiroRealm</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®‰å…¨ç®¡ç†å¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SecurityManager <span class="title function_">getSecurityManager</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">DefaultWebSecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultWebSecurityManager</span>();</span><br><span class="line">        securityManager.setRealm(getShiroRealm());</span><br><span class="line">        <span class="keyword">return</span> securityManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//Shiroè¿‡æ»¤å™¨é…ç½®</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ShiroFilterFactoryBean <span class="title function_">getShiroFilterFactoryBean</span><span class="params">(SecurityManager securityManager)</span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºShiroå·¥å‚å¯¹è±¡</span></span><br><span class="line">        <span class="type">ShiroFilterFactoryBean</span> <span class="variable">shiroFilterFactoryBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShiroFilterFactoryBean</span>();</span><br><span class="line">        <span class="comment">//è®¾ç½®å®‰å…¨ç®¡ç†å™¨</span></span><br><span class="line">        shiroFilterFactoryBean.setSecurityManager(securityManager);</span><br><span class="line">        <span class="comment">//æœªè®¤è¯è®¿é—®é¡µé¢</span></span><br><span class="line">        shiroFilterFactoryBean.setLoginUrl(<span class="string">&quot;/toLogin&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¤è¯æˆåŠŸè·³è½¬é¡µé¢ï¼ˆä¸€èˆ¬ä¸è®¾ç½®ï¼Œé»˜è®¤ç™»å½•æˆåŠŸè·³è½¬å½“å‰é¡µé¢ï¼‰</span></span><br><span class="line">        <span class="comment">//shiroFilterFactoryBean.setSuccessUrl(&quot;/index&quot;);</span></span><br><span class="line">        <span class="comment">//æœªæˆæƒè®¿é—®é¡µé¢</span></span><br><span class="line">        shiroFilterFactoryBean.setUnauthorizedUrl(<span class="string">&quot;/refuse&quot;</span>);</span><br><span class="line">        <span class="comment">//é€šè¿‡mapé…ç½®è®¿é—®æµç¨‹ï¼ˆé¡ºåºå¾ˆé‡è¦ï¼‰</span></span><br><span class="line">        LinkedHashMap&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//é…ç½®é™æ€èµ„æº</span></span><br><span class="line">        map.put(<span class="string">&quot;/js/**&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;/css/**&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;/jquery/**&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;/layui/**&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        <span class="comment">//é…ç½®loginé¡µé¢</span></span><br><span class="line">        map.put(<span class="string">&quot;/login&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        <span class="comment">//é…ç½®logouté€€å‡º</span></span><br><span class="line">        <span class="comment">//map.put(&quot;/logout&quot;,&quot;logout&quot;);</span></span><br><span class="line">        <span class="comment">//é…ç½®æˆæƒ</span></span><br><span class="line">        <span class="comment">//map.put(&quot;/delete&quot;,&quot;perms[user:delete]&quot;);</span></span><br><span class="line">        <span class="comment">//map.put(&quot;/select&quot;,&quot;perms[user:select]&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//userè®¾ç½®è®°ä½æˆ‘ï¼ˆäºŒæ¬¡ç™»å½•ä¸åšè®¤è¯æ“ä½œï¼‰</span></span><br><span class="line">        <span class="comment">//map.put(&quot;/index&quot;,&quot;user&quot;);</span></span><br><span class="line"></span><br><span class="line">        map.put(<span class="string">&quot;/**&quot;</span>,<span class="string">&quot;authc&quot;</span>);<span class="comment">//è¯¥è·¯å¾„è®¤è¯åæ‰èƒ½è®¿é—®</span></span><br><span class="line">        <span class="comment">//map.put(&quot;/**&quot;,&quot;anon&quot;);//æ‰€æœ‰è·¯å¾„éƒ½å¯ä»¥åŒ¿åè®¿é—®</span></span><br><span class="line"></span><br><span class="line">        shiroFilterFactoryBean.setFilterChainDefinitionMap(map);</span><br><span class="line">        <span class="keyword">return</span> shiroFilterFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<table>
<thead>
<tr>
<th>è¿‡æ»¤å™¨ç®€ç§°</th>
<th>å¯¹åº”çš„javaç±»</th>
</tr>
</thead>
<tbody><tr>
<td>anon</td>
<td>org.apache.shiro.web.filter.authc.AnonymousFilter</td>
</tr>
<tr>
<td>authc</td>
<td>org.apache.shiro.web.filter.authc.FormAuthenticationFilter</td>
</tr>
<tr>
<td>authcBasic</td>
<td>org.apache.shiro.web.filter.authc.BasicHttpAuthenticationFilter</td>
</tr>
<tr>
<td>perms</td>
<td>org.apache.shiro.web.filter.authz.PermissionsAuthorizationFilter</td>
</tr>
<tr>
<td>port</td>
<td>org.apache.shiro.web.filter.authz.PortFilter</td>
</tr>
<tr>
<td>rest</td>
<td>org.apache.shiro.web.filter.authz.HttpMethodPermissionFilter</td>
</tr>
<tr>
<td>roles</td>
<td>org.apache.shiro.web.filter.authz.RolesAuthorizationFilter</td>
</tr>
<tr>
<td>ssl</td>
<td>org.apache.shiro.web.filter.authz.SslFilter</td>
</tr>
<tr>
<td>user</td>
<td>org.apache.shiro.web.filter.authc.UserFilter</td>
</tr>
<tr>
<td>logout</td>
<td>org.apache.shiro.web.filter.authc.LogoutFilter</td>
</tr>
</tbody></table>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">anonï¼šadmins<span class="comment">/**=anon æ²¡æœ‰å‚æ•°ï¼Œè¡¨ç¤ºå¯ä»¥åŒ¿åä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="comment">authcï¼š/admins/user/**=authcè¡¨ç¤ºéœ€è¦è®¤è¯(ç™»å½•)æ‰èƒ½ä½¿ç”¨ï¼ŒFormAuthenticationFilteræ˜¯è¡¨å•è®¤è¯ï¼Œæ²¡æœ‰å‚æ•° </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">rolesï¼š/admins/user/**=roles[admin],å‚æ•°å¯ä»¥å†™å¤šä¸ªï¼Œå¤šä¸ªæ—¶å¿…é¡»åŠ ä¸Šå¼•å·ï¼Œå¹¶ä¸”å‚æ•°ä¹‹é—´ç”¨é€—å·åˆ†å‰²ï¼Œå½“æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼Œä¾‹å¦‚admins/user/**=roles[&quot;admin,guest&quot;],æ¯ä¸ªå‚æ•°é€šè¿‡æ‰ç®—é€šè¿‡ï¼Œç›¸å½“äºhasAllRoles()æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">permsï¼š/admins/user/**=perms[user:add:*],å‚æ•°å¯ä»¥å†™å¤šä¸ªï¼Œå¤šä¸ªæ—¶å¿…é¡»åŠ ä¸Šå¼•å·ï¼Œå¹¶ä¸”å‚æ•°ä¹‹é—´ç”¨é€—å·åˆ†å‰²ï¼Œä¾‹å¦‚/admins/user/**=perms[&quot;user:add:*,user:modify:*&quot;]ï¼Œå½“æœ‰å¤šä¸ªå‚æ•°æ—¶å¿…é¡»æ¯ä¸ªå‚æ•°éƒ½é€šè¿‡æ‰é€šè¿‡ï¼Œæƒ³å½“äºisPermitedAll()æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">restï¼š/admins/user/**=rest[user],æ ¹æ®è¯·æ±‚çš„æ–¹æ³•ï¼Œç›¸å½“äº/admins/user/**=perms[user:method] ,å…¶ä¸­methodä¸ºpostï¼Œgetï¼Œdeleteç­‰ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">portï¼š/admins/user/**=port[8081],å½“è¯·æ±‚çš„urlçš„ç«¯å£ä¸æ˜¯8081æ˜¯è·³è½¬åˆ°schemalï¼š//serverName:8081?queryString,å…¶ä¸­schmalæ˜¯åè®®httpæˆ–httpsç­‰ï¼ŒserverNameæ˜¯ä½ è®¿é—®çš„host,8081æ˜¯urlé…ç½®é‡Œportçš„ç«¯å£ï¼ŒqueryStringæ˜¯ä½ è®¿é—®çš„urlé‡Œçš„ï¼Ÿåé¢çš„å‚æ•°ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">authcBasicï¼šä¾‹å¦‚/admins/user/**=authcBasicæ²¡æœ‰å‚æ•°è¡¨ç¤ºhttpBasicè®¤è¯</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">sslï¼š/admins/user/**=sslæ²¡æœ‰å‚æ•°ï¼Œè¡¨ç¤ºå®‰å…¨çš„urlè¯·æ±‚ï¼Œåè®®ä¸ºhttps</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">userï¼š/admins/user/**=useræ²¡æœ‰å‚æ•°è¡¨ç¤ºå¿…é¡»å­˜åœ¨ç”¨æˆ·, èº«ä»½è®¤è¯é€šè¿‡æˆ–é€šè¿‡è®°ä½æˆ‘è®¤è¯é€šè¿‡çš„å¯ä»¥è®¿é—®ï¼Œå½“ç™»å…¥æ“ä½œæ—¶ä¸åšæ£€æŸ¥</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>anonï¼ŒauthcBasicï¼Œauthcï¼Œuseræ˜¯è®¤è¯è¿‡æ»¤å™¨</p>
<p>permsï¼Œrolesï¼Œsslï¼Œrestï¼Œportæ˜¯æˆæƒè¿‡æ»¤å™¨</p>
</blockquote>
<h4 id="11-5åˆ›å»ºcontroller"><a href="#11-5åˆ›å»ºcontroller" class="headerlink" title="11.5åˆ›å»ºcontroller"></a>11.5åˆ›å»ºcontroller</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.IncorrectCredentialsException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UnknownAccountException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UsernamePasswordToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;toLogin&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toLgoin</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;toLogin&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;login&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/login&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;refuse&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">refuse</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;refuse&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/refuse&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;index&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;index&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/add&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;select&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">select</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;select&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/select&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;delete&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/delete&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @RequestMapping(&quot;logout&quot;)</span></span><br><span class="line"><span class="comment">//    public String logout()&#123;</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;logout&quot;);</span></span><br><span class="line"><span class="comment">//        Subject subject = SecurityUtils.getSubject();</span></span><br><span class="line"><span class="comment">//        subject.logout();</span></span><br><span class="line"><span class="comment">//        return &quot;/login&quot;;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯åŠ¨å·¥ç¨‹ï¼Œè¿›è¡Œæµ‹è¯•</p>
</blockquote>
<h4 id="11-6ç¼–å†™å¯¹åº”çš„login-htmlé¡µé¢ï¼ˆä»¥åŠå…¶ä»–é¡µé¢ï¼‰"><a href="#11-6ç¼–å†™å¯¹åº”çš„login-htmlé¡µé¢ï¼ˆä»¥åŠå…¶ä»–é¡µé¢ï¼‰" class="headerlink" title="11.6ç¼–å†™å¯¹åº”çš„login.htmlé¡µé¢ï¼ˆä»¥åŠå…¶ä»–é¡µé¢ï¼‰"></a>11.6ç¼–å†™å¯¹åº”çš„login.htmlé¡µé¢ï¼ˆä»¥åŠå…¶ä»–é¡µé¢ï¼‰</h4><blockquote>
<p>login.html</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;login&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>refuse.html</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span>&gt;</span>æ‹’ç»è®¿é—®ï¼ï¼ï¼<span class="tag">&lt;/<span class="name">font</span>&gt;</span> <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>index.html</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:shiro</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ä¸»é¡µé¢<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;add&quot;</span>&gt;</span>æ·»åŠ ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;select&quot;</span>&gt;</span>æŸ¥è¯¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;delete&quot;</span>&gt;</span>åˆ é™¤ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;update&quot;</span>&gt;</span>ä¿®æ”¹ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/logout&quot;</span>&gt;</span>é€€å‡º<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>add.html</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ·»åŠ ç”¨æˆ·<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>select.html</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æŸ¥è¯¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>delete.html</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>åˆ é™¤ç”¨æˆ·<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="11-7å®ç°ç”¨æˆ·è®¤è¯ï¼Œä¿®æ”¹UserControllerä¸­çš„loginæ–¹æ³•"><a href="#11-7å®ç°ç”¨æˆ·è®¤è¯ï¼Œä¿®æ”¹UserControllerä¸­çš„loginæ–¹æ³•" class="headerlink" title="11.7å®ç°ç”¨æˆ·è®¤è¯ï¼Œä¿®æ”¹UserControllerä¸­çš„loginæ–¹æ³•"></a>11.7å®ç°ç”¨æˆ·è®¤è¯ï¼Œä¿®æ”¹UserControllerä¸­çš„loginæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;login&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">    <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(username, password);</span><br><span class="line"></span><br><span class="line">    subject.login(token);</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">authenticated</span> <span class="operator">=</span> subject.isAuthenticated();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(authenticated)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/login&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="11-8ä¿®æ”¹ShiroRealmä¸­çš„AuthenticationInfoæ–¹æ³•"><a href="#11-8ä¿®æ”¹ShiroRealmä¸­çš„AuthenticationInfoæ–¹æ³•" class="headerlink" title="11.8ä¿®æ”¹ShiroRealmä¸­çš„AuthenticationInfoæ–¹æ³•"></a>11.8ä¿®æ”¹ShiroRealmä¸­çš„AuthenticationInfoæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> AuthenticationInfo <span class="title function_">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken token)</span> <span class="keyword">throws</span> AuthenticationException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//èº«ä»½ä¿¡æ¯ï¼Œç”¨æˆ·å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">principal</span> <span class="operator">=</span> (String)token.getPrincipal();</span><br><span class="line">        System.out.println(principal);</span><br><span class="line">        <span class="comment">//å‡­è¯ä¿¡æ¯ï¼Œå¯†ç </span></span><br><span class="line">        <span class="type">String</span> <span class="variable">credentials</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>((<span class="type">char</span>[])token.getCredentials());</span><br><span class="line">        System.out.println(credentials);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;jack&quot;</span>.equals(principal) &amp;&amp; <span class="string">&quot;123&quot;</span>.equals(credentials))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SimpleAuthenticationInfo</span>(principal,credentials,<span class="string">&quot;ShiroRealm&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è®¿é—®è·¯å¾„è¿›è¡Œæµ‹è¯•å³å¯ï¼</p>
</blockquote>
<h4 id="11-9å®ç°ç”¨æˆ·æˆæƒï¼Œåœ¨ShiroConfigä¸­çš„shiroFilteræ–¹æ³•ä¸­æ·»åŠ è¢«æˆæƒçš„ä¿¡æ¯"><a href="#11-9å®ç°ç”¨æˆ·æˆæƒï¼Œåœ¨ShiroConfigä¸­çš„shiroFilteræ–¹æ³•ä¸­æ·»åŠ è¢«æˆæƒçš„ä¿¡æ¯" class="headerlink" title="11.9å®ç°ç”¨æˆ·æˆæƒï¼Œåœ¨ShiroConfigä¸­çš„shiroFilteræ–¹æ³•ä¸­æ·»åŠ è¢«æˆæƒçš„ä¿¡æ¯"></a>11.9å®ç°ç”¨æˆ·æˆæƒï¼Œåœ¨ShiroConfigä¸­çš„shiroFilteræ–¹æ³•ä¸­æ·»åŠ è¢«æˆæƒçš„ä¿¡æ¯</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é…ç½®æˆæƒ</span></span><br><span class="line">map.put(<span class="string">&quot;/delete&quot;</span>,<span class="string">&quot;perms[user:delete]&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;/select&quot;</span>,<span class="string">&quot;perms[user:select]&quot;</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é…ç½®ä¹‹åé‡å¯é¡¹ç›®ï¼Œè®¿é—®è¯¥èµ„æºè·¯å¾„æ—¶åˆ™æ— æ³•è®¿é—®ï¼Œæ­¤æ—¶éœ€è¦é…ç½®æˆæƒä¿¡æ¯</p>
</blockquote>
<h4 id="11-10ä¿®æ”¹ShiroRealmä¸­çš„doGetAuthorizationInfoæ–¹æ³•"><a href="#11-10ä¿®æ”¹ShiroRealmä¸­çš„doGetAuthorizationInfoæ–¹æ³•" class="headerlink" title="11.10ä¿®æ”¹ShiroRealmä¸­çš„doGetAuthorizationInfoæ–¹æ³•"></a>11.10ä¿®æ”¹ShiroRealmä¸­çš„doGetAuthorizationInfoæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> AuthorizationInfo <span class="title function_">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principals)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">SimpleAuthorizationInfo</span> <span class="variable">simpleAuthorizationInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleAuthorizationInfo</span>();</span><br><span class="line"></span><br><span class="line">    HashSet&lt;String&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    set.add(<span class="string">&quot;user:select&quot;</span>);</span><br><span class="line">    set.add(<span class="string">&quot;user:update&quot;</span>);</span><br><span class="line"></span><br><span class="line">    simpleAuthorizationInfo.addStringPermissions(set);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> simpleAuthorizationInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç„¶åé‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®ç›¸åº”æˆæƒè·¯å¾„é¡µé¢</p>
</blockquote>
<h4 id="11-11Shiroæ•´åˆthymleafæ ‡ç­¾"><a href="#11-11Shiroæ•´åˆthymleafæ ‡ç­¾" class="headerlink" title="11.11Shiroæ•´åˆthymleafæ ‡ç­¾"></a>11.11Shiroæ•´åˆthymleafæ ‡ç­¾</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.theborakompanioni<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-extras-shiro<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="11-12åœ¨ShiroConfigä¸­æ·»åŠ è¯¥æ–¹æ³•"><a href="#11-12åœ¨ShiroConfigä¸­æ·»åŠ è¯¥æ–¹æ³•" class="headerlink" title="11.12åœ¨ShiroConfigä¸­æ·»åŠ è¯¥æ–¹æ³•"></a>11.12åœ¨ShiroConfigä¸­æ·»åŠ è¯¥æ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> ShiroDialect <span class="title function_">getShiroDialect</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ShiroDialect</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="11-13ä¿®æ”¹index-htmlé¡µé¢ä¸­æµ‹è¯•"><a href="#11-13ä¿®æ”¹index-htmlé¡µé¢ä¸­æµ‹è¯•" class="headerlink" title="11.13ä¿®æ”¹index.htmlé¡µé¢ä¸­æµ‹è¯•"></a>11.13ä¿®æ”¹index.htmlé¡µé¢ä¸­æµ‹è¯•</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:shiro</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ä¸»é¡µé¢<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;add&quot;</span>&gt;</span>æ·»åŠ ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;select&quot;</span>&gt;</span>æŸ¥è¯¢ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;delete&quot;</span> <span class="attr">shiro:hasPermission</span>=<span class="string">&quot;user:delete&quot;</span>&gt;</span>åˆ é™¤ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;update&quot;</span> <span class="attr">shiro:hasPermission</span>=<span class="string">&quot;user:update&quot;</span>&gt;</span>ä¿®æ”¹ç”¨æˆ·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/logout&quot;</span>&gt;</span>é€€å‡º<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯åŠ¨å·¥ç¨‹ï¼Œå†æ¬¡è¿›è¡Œæµ‹è¯•å³å¯</p>
</blockquote>
<h4 id="11-14å®ç°ç”¨æˆ·é€€å‡ºï¼ˆä¸¤ç§æ–¹å¼ï¼‰ï¼Œåœ¨ç›¸å…³index-htmlé¡µé¢ä¸­æ·»åŠ è¶…é“¾æ¥"><a href="#11-14å®ç°ç”¨æˆ·é€€å‡ºï¼ˆä¸¤ç§æ–¹å¼ï¼‰ï¼Œåœ¨ç›¸å…³index-htmlé¡µé¢ä¸­æ·»åŠ è¶…é“¾æ¥" class="headerlink" title="11.14å®ç°ç”¨æˆ·é€€å‡ºï¼ˆä¸¤ç§æ–¹å¼ï¼‰ï¼Œåœ¨ç›¸å…³index.htmlé¡µé¢ä¸­æ·»åŠ è¶…é“¾æ¥"></a>11.14å®ç°ç”¨æˆ·é€€å‡ºï¼ˆä¸¤ç§æ–¹å¼ï¼‰ï¼Œåœ¨ç›¸å…³index.htmlé¡µé¢ä¸­æ·»åŠ è¶…é“¾æ¥</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/logout&quot;</span>&gt;</span>é€€å‡º<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="11-15åœ¨ShiroConfigä¸­çš„shiroFilteræ–¹æ³•ä¸­æ·»åŠ é€€å‡ºé…ç½®ï¼ˆç¬¬ä¸€ç§ï¼‰"><a href="#11-15åœ¨ShiroConfigä¸­çš„shiroFilteræ–¹æ³•ä¸­æ·»åŠ é€€å‡ºé…ç½®ï¼ˆç¬¬ä¸€ç§ï¼‰" class="headerlink" title="11.15åœ¨ShiroConfigä¸­çš„shiroFilteræ–¹æ³•ä¸­æ·»åŠ é€€å‡ºé…ç½®ï¼ˆç¬¬ä¸€ç§ï¼‰"></a>11.15åœ¨ShiroConfigä¸­çš„shiroFilteræ–¹æ³•ä¸­æ·»åŠ é€€å‡ºé…ç½®ï¼ˆç¬¬ä¸€ç§ï¼‰</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é…ç½®é€€å‡º</span></span><br><span class="line">map.put(<span class="string">&quot;/logout&quot;</span>,<span class="string">&quot;logout&quot;</span>);</span><br></pre></td></tr></table></figure>



<h4 id="11-16åœ¨UserControllerä¸­æ·»åŠ logoutæ–¹æ³•ï¼ˆç¬¬äºŒç§ï¼‰"><a href="#11-16åœ¨UserControllerä¸­æ·»åŠ logoutæ–¹æ³•ï¼ˆç¬¬äºŒç§ï¼‰" class="headerlink" title="11.16åœ¨UserControllerä¸­æ·»åŠ logoutæ–¹æ³•ï¼ˆç¬¬äºŒç§ï¼‰"></a>11.16åœ¨UserControllerä¸­æ·»åŠ logoutæ–¹æ³•ï¼ˆç¬¬äºŒç§ï¼‰</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;logout&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">logout</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;logout&quot;</span>);</span><br><span class="line">    <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line">    subject.logout();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/login&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="11-17è®°ä½æˆ‘rememberMeï¼Œåœ¨login-htmlé¡µé¢ä¸­æ·»åŠ è®°ä½æˆ‘"><a href="#11-17è®°ä½æˆ‘rememberMeï¼Œåœ¨login-htmlé¡µé¢ä¸­æ·»åŠ è®°ä½æˆ‘" class="headerlink" title="11.17è®°ä½æˆ‘rememberMeï¼Œåœ¨login.htmlé¡µé¢ä¸­æ·»åŠ è®°ä½æˆ‘"></a>11.17è®°ä½æˆ‘rememberMeï¼Œåœ¨login.htmlé¡µé¢ä¸­æ·»åŠ è®°ä½æˆ‘</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;rememberMe&quot;</span>&gt;</span>è®°ä½æˆ‘<span class="tag">&lt;<span class="name">br</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="11-18åœ¨UserControllerä¸­çš„loginæ–¹æ³•é…ç½®rememberMeå‚æ•°"><a href="#11-18åœ¨UserControllerä¸­çš„loginæ–¹æ³•é…ç½®rememberMeå‚æ•°" class="headerlink" title="11.18åœ¨UserControllerä¸­çš„loginæ–¹æ³•é…ç½®rememberMeå‚æ•°"></a>11.18åœ¨UserControllerä¸­çš„loginæ–¹æ³•é…ç½®rememberMeå‚æ•°</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(String username, String password,<span class="type">boolean</span> rememberMe)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;login&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">    <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(username, password,rememberMe);</span><br><span class="line"></span><br><span class="line">    subject.login(token);</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">authenticated</span> <span class="operator">=</span> subject.isAuthenticated();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(authenticated)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;/login&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="11-19åœ¨ShiroConfigç±»ä¸­æ·»åŠ ç›¸å…³æ–¹æ³•ä»¥åŠä»£ç "><a href="#11-19åœ¨ShiroConfigç±»ä¸­æ·»åŠ ç›¸å…³æ–¹æ³•ä»¥åŠä»£ç " class="headerlink" title="11.19åœ¨ShiroConfigç±»ä¸­æ·»åŠ ç›¸å…³æ–¹æ³•ä»¥åŠä»£ç "></a>11.19åœ¨ShiroConfigç±»ä¸­æ·»åŠ ç›¸å…³æ–¹æ³•ä»¥åŠä»£ç </h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> at.pollux.thymeleaf.shiro.dialect.ShiroDialect;</span><br><span class="line"><span class="keyword">import</span> com.qf.realm.ShiroRealm;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.DefaultSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.SecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.spring.web.ShiroFilterFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.mgt.CookieRememberMeManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.mgt.DefaultWebSecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.servlet.SimpleCookie;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShiroConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CookieRememberMeManager <span class="title function_">getCookieRememberMeManager</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">SimpleCookie</span> <span class="variable">simpleCookie</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleCookie</span>(<span class="string">&quot;renemberMe&quot;</span>);</span><br><span class="line">        simpleCookie.setMaxAge(<span class="number">3600</span>*<span class="number">24</span>*<span class="number">31</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">CookieRememberMeManager</span> <span class="variable">cookieRememberMeManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CookieRememberMeManager</span>();</span><br><span class="line">        cookieRememberMeManager.setCookie(simpleCookie);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cookieRememberMeManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ShiroRealm <span class="title function_">getShiroRealm</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ShiroRealm</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SecurityManager <span class="title function_">getSecurityManager</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">DefaultWebSecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultWebSecurityManager</span>();</span><br><span class="line">        securityManager.setRealm(getShiroRealm());</span><br><span class="line">        securityManager.setRememberMeManager(getCookieRememberMeManager());</span><br><span class="line">        <span class="keyword">return</span> securityManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é…ç½®ShiroDialect</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ShiroDialect <span class="title function_">getShiroDialect</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ShiroDialect</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//shiroè¿‡æ»¤å™¨é…ç½®</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ShiroFilterFactoryBean <span class="title function_">getShiroFilterFactoryBean</span><span class="params">(SecurityManager securityManager)</span>&#123;</span><br><span class="line">        <span class="type">ShiroFilterFactoryBean</span> <span class="variable">shiroFilterFactoryBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShiroFilterFactoryBean</span>();</span><br><span class="line">        shiroFilterFactoryBean.setSecurityManager(securityManager);</span><br><span class="line">        <span class="comment">//æœªè®¤è¯è®¿é—®é¡µé¢</span></span><br><span class="line">        shiroFilterFactoryBean.setLoginUrl(<span class="string">&quot;/toLogin&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¤è¯æˆåŠŸè·³è½¬é¡µé¢ï¼ˆä¸€èˆ¬ä¸è®¾ç½®ï¼Œé»˜è®¤ç™»å½•æˆåŠŸè·³è½¬å½“å‰é¡µé¢ï¼‰</span></span><br><span class="line">        <span class="comment">//shiroFilterFactoryBean.setSuccessUrl(&quot;/index&quot;);</span></span><br><span class="line">        <span class="comment">//æœªæˆæƒè®¿é—®é¡µé¢</span></span><br><span class="line">        shiroFilterFactoryBean.setUnauthorizedUrl(<span class="string">&quot;/refuse&quot;</span>);</span><br><span class="line">        <span class="comment">//é€šè¿‡mapé…ç½®è®¿é—®æµç¨‹ï¼ˆé¡ºåºå¾ˆé‡è¦ï¼‰</span></span><br><span class="line">        LinkedHashMap&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//é…ç½®é™æ€èµ„æº</span></span><br><span class="line">        map.put(<span class="string">&quot;/js/**&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;/css/**&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;/jquery/**&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;/layui/**&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        <span class="comment">//é…ç½®loginé¡µé¢</span></span><br><span class="line">        map.put(<span class="string">&quot;/login&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        <span class="comment">//é…ç½®logouté€€å‡º</span></span><br><span class="line">        map.put(<span class="string">&quot;/logout&quot;</span>,<span class="string">&quot;logout&quot;</span>);</span><br><span class="line">        <span class="comment">//é…ç½®æˆæƒ</span></span><br><span class="line">        map.put(<span class="string">&quot;/delete&quot;</span>,<span class="string">&quot;perms[user:delete]&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;/select&quot;</span>,<span class="string">&quot;perms[user:select]&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//userè®¾ç½®è®°ä½æˆ‘ï¼ˆäºŒæ¬¡ç™»å½•ä¸åšè®¤è¯æ“ä½œï¼‰</span></span><br><span class="line">        map.put(<span class="string">&quot;/index&quot;</span>,<span class="string">&quot;user&quot;</span>);</span><br><span class="line"></span><br><span class="line">        map.put(<span class="string">&quot;/**&quot;</span>,<span class="string">&quot;authc&quot;</span>);<span class="comment">//è¯¥è·¯å¾„è®¤è¯åæ‰èƒ½è®¿é—®</span></span><br><span class="line">        <span class="comment">//map.put(&quot;/**&quot;,&quot;anon&quot;);//æ‰€æœ‰è·¯å¾„éƒ½å¯ä»¥åŒ¿åè®¿é—®</span></span><br><span class="line"></span><br><span class="line">        shiroFilterFactoryBean.setFilterChainDefinitionMap(map);</span><br><span class="line">        <span class="keyword">return</span> shiroFilterFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>ps:</code>ç™»å½•é¡µé¢å‹¾é€‰ è®°ä½æˆ‘ è¿›è¡Œæµ‹è¯•</p>
</blockquote>
]]></content>
      <categories>
        <category>åç«¯å­¦ä¹ </category>
        <category>java</category>
      </categories>
      <tags>
        <tag>åç«¯</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>DockeråŸºç¡€æ“ä½œï¼ˆäºŒï¼‰</title>
    <url>/2022/04/30/Docker%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<h2 id="DockeråŸºç¡€æ“ä½œå’Œé…ç½®"><a href="#DockeråŸºç¡€æ“ä½œå’Œé…ç½®" class="headerlink" title="DockeråŸºç¡€æ“ä½œå’Œé…ç½®"></a>DockeråŸºç¡€æ“ä½œå’Œé…ç½®</h2><p>é…ç½®é˜¿é‡Œäº‘Docker Yumæº</p>
<p>shell</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum install -y yum-utils device-mapper-persistent-data lvm2 git</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span><br></pre></td></tr></table></figure>

<p>å®‰è£…æŒ‡å®šç‰ˆæœ¬</p>
<p>shell</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">  æŸ¥çœ‹Dockerç‰ˆæœ¬ï¼š</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum list docker-ce --showduplicates</span></span><br></pre></td></tr></table></figure>
<span id="more"></span>
<p>å®‰è£…è¾ƒæ—§ç‰ˆæœ¬ï¼ˆæ¯”å¦‚Docker 17.03.2) ï¼š<br>FROMï¼šæŒ‡å®šåŸºç¡€é•œåƒ<br>MAINTAINERï¼šä½œè€…çš„ä¿¡æ¯<br>RUNï¼šæ‰§è¡Œä»€ä¹ˆå‘½ä»¤<br>EXPOSEï¼šå®¹å™¨å¯¹å¤–æš´éœ²çš„ç«¯å£<br>WORKDIRï¼šè¿›å…¥åˆ°å®¹å™¨åè¿›å…¥åˆ°å“ªä¸ªç›®å½•<br>ENVï¼šé…ç½®ç¯å¢ƒå˜é‡<br>ADDï¼šå°†æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­å¹¶è§£å‹<br>COPYï¼šå°†æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­<br>VOLUMEï¼šé…ç½®æ•°æ®å·<br>CMDï¼šå®¹å™¨å¯åŠ¨æ—¶å€™æ‰§è¡Œçš„å‘½ä»¤<br>ENTRYPOINTï¼šå®¹å™¨å¯åŠ¨æ—¶å€™æ‰§è¡Œçš„å‘½ä»¤</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€“Dockerfileå‚è€ƒé…ç½®â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>FROM <a href="http://daocloud.io/library/tomcat:8.5.15-jre8">daocloud.io&#x2F;library&#x2F;tomcat:8.5.15-jre8</a> #æŒ‡å®šè¦ç”Ÿæˆçš„é•œåƒçš„åŸºç¡€é•œåƒï¼Œå¼€å¤´ç¬¬ä¸€å¥è¯å¿…é¡»ä¹Ÿåªèƒ½æ˜¯FROM<br>COPY music.war &#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps #æ‹·è´å·¥ç¨‹åˆ°tomcatæŒ‡å®šç›®å½•<br>MAINTAINER <a href="mailto:scouture@163.com">scouture@163.com</a> #æŒ‡å®šä½œè€…æ˜¯è°<br>RUN mkdir -p &#x2F;datas&#x2F;<br>ADD jdk-8u60-linux-x64.tar.gz &#x2F;datas&#x2F; #å°†æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­å¹¶è§£å‹<br>ENV JAVA_HOME&#x3D;&#x2F;datas&#x2F;jdk1.8.0_60 #é…ç½®JAVA_HOME<br>ENV PATH&#x3D;JAVA_HOME&#x2F;bin:JAVAHâ€‹OME&#x2F;bin:PATH #é…ç½®PATH<br>WORKDIR &#x2F;dev&#x2F; #å¯åŠ¨å®¹å™¨åï¼Œå¦‚æœå¯åŠ¨äº¤äº’æ¨¡å¼ï¼Œç›´æ¥è¿›å…¥åˆ°å“ªä¸ªç›®å½•<br>CMD [â€œ&#x2F;bin&#x2F;bashâ€] #å¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼Œè¿›å…¥åˆ°&#x2F;bin&#x2F;bashè¿™ç§å‘½ä»¤è¡Œ</p>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>DockeråŸºç¡€æ“ä½œï¼ˆä¸€ï¼‰</title>
    <url>/2022/04/29/Docker%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<h2 id="DockeråŸºæœ¬å‘½ä»¤"><a href="#DockeråŸºæœ¬å‘½ä»¤" class="headerlink" title="DockeråŸºæœ¬å‘½ä»¤"></a>DockeråŸºæœ¬å‘½ä»¤</h2><h3 id="ä¸€ã€Dockerçš„å®‰è£…"><a href="#ä¸€ã€Dockerçš„å®‰è£…" class="headerlink" title="ä¸€ã€Dockerçš„å®‰è£…"></a>ä¸€ã€Dockerçš„å®‰è£…</h3><hr>
<h4 id="1-1-ä¸‹è½½Dockerä¾èµ–çš„ç¯å¢ƒ"><a href="#1-1-ä¸‹è½½Dockerä¾èµ–çš„ç¯å¢ƒ" class="headerlink" title="1.1 ä¸‹è½½Dockerä¾èµ–çš„ç¯å¢ƒ"></a>1.1 ä¸‹è½½Dockerä¾èµ–çš„ç¯å¢ƒ</h4><blockquote>
<p>æƒ³å®‰è£…Dockerï¼Œéœ€è¦å…ˆå°†ä¾èµ–çš„ç¯å¢ƒå…¨éƒ¨ä¸‹è½½ï¼Œå°±åƒMavenä¾èµ–JDKä¸€æ ·</p>
<p>å‚è€ƒï¼š<a href="https://developer.aliyun.com/article/110806">https://developer.aliyun.com/article/110806</a></p>
<p>å¦‚æœå·²å®‰è£…ï¼Œå¯ä»¥å…ˆåˆ é™¤</p>
<p>[root@localhost ~]# yum -y remove docker-ce</p>
</blockquote>
<span id="more"></span>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">01[root@localhost <span class="built_in">local</span>]<span class="comment"># yum -y install yum-utils device-mapper-persistent-data lvm2</span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-æŒ‡å®šDockeré•œåƒæº"><a href="#1-2-æŒ‡å®šDockeré•œåƒæº" class="headerlink" title="1.2 æŒ‡å®šDockeré•œåƒæº"></a>1.2 æŒ‡å®šDockeré•œåƒæº</h4><blockquote>
<p>é»˜è®¤ä¸‹è½½Dockerå›å»å›½å¤–æœåŠ¡å™¨ä¸‹è½½ï¼Œé€Ÿåº¦è¾ƒæ…¢ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸ºé˜¿é‡Œäº‘é•œåƒæºï¼Œé€Ÿåº¦æ›´å¿«</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">01[root@localhost ~]<span class="comment"># yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span><br></pre></td></tr></table></figure>

<h4 id="1-3-å®‰è£…Docker"><a href="#1-3-å®‰è£…Docker" class="headerlink" title="1.3 å®‰è£…Docker"></a>1.3 å®‰è£…Docker</h4><blockquote>
<p>ä¾ç„¶é‡‡ç”¨yumçš„æ–¹å¼å®‰è£…</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">0102[root@localhost ~]<span class="comment"># yum makecache fast</span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum -y install docker-ce</span></span><br></pre></td></tr></table></figure>

<h4 id="1-4-å¯åŠ¨Dockerå¹¶æµ‹è¯•"><a href="#1-4-å¯åŠ¨Dockerå¹¶æµ‹è¯•" class="headerlink" title="1.4 å¯åŠ¨Dockerå¹¶æµ‹è¯•"></a>1.4 å¯åŠ¨Dockerå¹¶æµ‹è¯•</h4><blockquote>
<p>å®‰è£…æˆåŠŸåï¼Œéœ€è¦æ‰‹åŠ¨å¯åŠ¨ï¼Œè®¾ç½®ä¸ºå¼€æœºè‡ªå¯ï¼Œå¹¶æµ‹è¯•ä¸€ä¸‹Docker</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">01020304<span class="comment"># å¯åŠ¨DockeræœåŠ¡</span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl start docker</span></span><br><span class="line"><span class="comment"># æµ‹è¯• hello-world</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker run hello-world</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨ï¼šå…³é—­é˜²ç«å¢™ä¹‹ådockeréœ€è¦é‡å¯</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">01[root@localhost ~]<span class="comment">#service docker restart</span></span><br></pre></td></tr></table></figure>

<h3 id="äºŒã€Dockerçš„ä¸­å¤®ä»“åº“"><a href="#äºŒã€Dockerçš„ä¸­å¤®ä»“åº“" class="headerlink" title="äºŒã€Dockerçš„ä¸­å¤®ä»“åº“"></a>äºŒã€Dockerçš„ä¸­å¤®ä»“åº“</h3><hr>
<blockquote>
<ul>
<li><p>Dockerå®˜æ–¹çš„ä¸­å¤®ä»“åº“ï¼šè¿™ä¸ªä»“åº“æ˜¯é•œåƒæœ€å…¨çš„ï¼Œä½†æ˜¯ä¸‹è½½é€Ÿåº¦è¾ƒæ…¢ã€‚</p>
<p><a href="https://hub.docker.com/">https://hub.docker.com/</a></p>
</li>
<li><p>å›½å†…çš„é•œåƒç½‘ç«™ï¼šç½‘æ˜“èœ‚å·¢ï¼ŒdaoCloudç­‰ï¼Œä¸‹è½½é€Ÿåº¦å¿«ï¼Œä½†æ˜¯é•œåƒç›¸å¯¹ä¸å…¨ã€‚</p>
<p><a href="https://c.163yun.com/hub#/home">https://c.163yun.com/hub#/home</a></p>
<p><a href="http://hub.daocloud.io/">http://hub.daocloud.io/</a> ï¼ˆæ¨èä½¿ç”¨ï¼‰</p>
</li>
<li><p>åœ¨å…¬å¸å†…éƒ¨ä¼šé‡‡ç”¨ç§æœçš„æ–¹å¼æ‹‰å–é•œåƒï¼Œéœ€è¦æ·»åŠ é…ç½®ï¼Œå¦‚ä¸‹â€¦â€¦</p>
<p><a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p>
</li>
</ul>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="number">0102030405060708</span># éœ€è¦åˆ›å»º/etc/docker/daemon.jsonï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;https://registry.docker-cn.com&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;insecure-registries&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ip:port&quot;</span><span class="punctuation">]</span>   </span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"># é‡å¯ä¸¤ä¸ªæœåŠ¡</span><br><span class="line">systemctl daemon-rd9oeload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>

<h3 id="ä¸‰ã€é•œåƒçš„æ“ä½œã€é‡ç‚¹ã€‘"><a href="#ä¸‰ã€é•œåƒçš„æ“ä½œã€é‡ç‚¹ã€‘" class="headerlink" title="ä¸‰ã€é•œåƒçš„æ“ä½œã€é‡ç‚¹ã€‘"></a>ä¸‰ã€é•œåƒçš„æ“ä½œã€<code>é‡ç‚¹</code>ã€‘</h3><hr>
<h4 id="3-1-æ‹‰å–é•œåƒ"><a href="#3-1-æ‹‰å–é•œåƒ" class="headerlink" title="3.1 æ‹‰å–é•œåƒ"></a>3.1 æ‹‰å–é•œåƒ</h4><blockquote>
<p>ä»ä¸­å¤®ä»“åº“æ‹‰å–é•œåƒåˆ°æœ¬åœ°</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">010203docker pull é•œåƒåç§°[:tag]</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># docker pull daocloud.io/library/tomcat:8.5.15-jre8</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2-æŸ¥çœ‹æœ¬åœ°å…¨éƒ¨é•œåƒ"><a href="#3-2-æŸ¥çœ‹æœ¬åœ°å…¨éƒ¨é•œåƒ" class="headerlink" title="3.2 æŸ¥çœ‹æœ¬åœ°å…¨éƒ¨é•œåƒ"></a>3.2 æŸ¥çœ‹æœ¬åœ°å…¨éƒ¨é•œåƒ</h4><blockquote>
<p>æŸ¥çœ‹æœ¬åœ°å·²ç»å®‰è£…è¿‡çš„é•œåƒä¿¡æ¯ï¼ŒåŒ…å«æ ‡è¯†ï¼Œåç§°ï¼Œç‰ˆæœ¬ï¼Œæ›´æ–°æ—¶é—´ï¼Œå¤§å°</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">01[root@localhost ~]<span class="comment"># docker images</span></span><br></pre></td></tr></table></figure>

<h4 id="3-3-åˆ é™¤æœ¬åœ°é•œåƒ"><a href="#3-3-åˆ é™¤æœ¬åœ°é•œåƒ" class="headerlink" title="3.3 åˆ é™¤æœ¬åœ°é•œåƒ"></a>3.3 åˆ é™¤æœ¬åœ°é•œåƒ</h4><blockquote>
<p>é•œåƒä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œå¯ä»¥ç›´æ¥æ‰‹åŠ¨åˆ é™¤ï¼Œè¡¨ç¤ºé€šè¿‡æŸ¥çœ‹è·å–</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">010203docker rmi é•œåƒçš„æ ‡è¯†ï¼ˆéœ€è¦å…ˆåˆ é™¤è¯¥é•œåƒåˆ›å»ºçš„å®¹å™¨ï¼Œåˆ é™¤å®¹å™¨éœ€è¦å…ˆåœæ­¢å®¹å™¨ï¼‰</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># docker rmi b8dfe9ade316</span></span><br></pre></td></tr></table></figure>

<h3 id="å››ã€å®¹å™¨æ“ä½œã€é‡ç‚¹ã€‘"><a href="#å››ã€å®¹å™¨æ“ä½œã€é‡ç‚¹ã€‘" class="headerlink" title="å››ã€å®¹å™¨æ“ä½œã€é‡ç‚¹ã€‘"></a>å››ã€å®¹å™¨æ“ä½œã€<code>é‡ç‚¹</code>ã€‘</h3><hr>
<h4 id="4-1-è¿è¡Œå®¹å™¨"><a href="#4-1-è¿è¡Œå®¹å™¨" class="headerlink" title="4.1 è¿è¡Œå®¹å™¨"></a>4.1 è¿è¡Œå®¹å™¨</h4><blockquote>
<p>è¿è¡Œå®¹å™¨éœ€è¦åˆ¶å®šå…·ä½“é•œåƒï¼Œå¦‚æœé•œåƒä¸å­˜åœ¨ï¼Œä¼šç›´æ¥ä¸‹è½½</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç®€å•æ“ä½œ</span></span><br><span class="line">docker run é•œåƒçš„æ ‡è¯†|é•œåƒåç§°[:tag]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¸ç”¨çš„å‚æ•°</span></span><br><span class="line">docker run -d -p å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ --name å®¹å™¨åç§° é•œåƒçš„æ ‡è¯†|é•œåƒåç§°[:tag]</span><br><span class="line"><span class="comment"># -dï¼šä»£è¡¨åå°è¿è¡Œå®¹å™¨</span></span><br><span class="line"><span class="comment"># -p å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ï¼šä¸ºäº†æ˜ å°„å½“å‰Linuxçš„ç«¯å£å’Œå®¹å™¨çš„ç«¯å£</span></span><br><span class="line"><span class="comment"># --name å®¹å™¨åç§°ï¼šæŒ‡å®šå®¹å™¨çš„åç§°(è‡ªå®šä¹‰)</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># docker run -d -p 8888:8080 --name mytomcat8.5 b8dfe9ade316</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•ï¼šæµè§ˆå™¨è®¿é—®ï¼šè™šæ‹Ÿæœºip:8888ï¼ˆè®¿é—®ä¹‹å‰éœ€è¦å…³é—­é˜²ç«å¢™ä»¥åŠå¼€æ”¾å®‰å…¨ç»„ä¸­çš„å¯¹åº”ç«¯å£å·ï¼‰</span></span><br></pre></td></tr></table></figure>

<h4 id="4-2-æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨"><a href="#4-2-æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨" class="headerlink" title="4.2 æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨"></a>4.2 æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨</h4><blockquote>
<p>æŸ¥çœ‹å…¨éƒ¨æ­£åœ¨è¿è¡Œçš„å®¹å™¨ä¿¡æ¯</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">docker ps [-qa]</span><br><span class="line"><span class="comment"># -aï¼šæŸ¥çœ‹å…¨éƒ¨çš„å®¹å™¨ï¼ŒåŒ…æ‹¬æ²¡æœ‰è¿è¡Œ</span></span><br><span class="line"><span class="comment"># -qï¼šåªæŸ¥çœ‹å®¹å™¨çš„æ ‡è¯†</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># docker ps</span></span><br></pre></td></tr></table></figure>

<h4 id="4-3-æŸ¥çœ‹å®¹å™¨æ—¥å¿—"><a href="#4-3-æŸ¥çœ‹å®¹å™¨æ—¥å¿—" class="headerlink" title="4.3 æŸ¥çœ‹å®¹å™¨æ—¥å¿—"></a>4.3 æŸ¥çœ‹å®¹å™¨æ—¥å¿—</h4><blockquote>
<p>æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼Œä»¥æŸ¥çœ‹å®¹å™¨è¿è¡Œçš„ä¿¡æ¯</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">01020304docker logs -f å®¹å™¨<span class="built_in">id</span></span><br><span class="line"><span class="comment"># -fï¼šå¯ä»¥æ»šåŠ¨æŸ¥çœ‹æ—¥å¿—çš„æœ€åå‡ è¡Œ</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># docker logs -f 4411f56f1fbb</span></span><br></pre></td></tr></table></figure>

<h4 id="4-4-è¿›å…¥å®¹å™¨å†…éƒ¨"><a href="#4-4-è¿›å…¥å®¹å™¨å†…éƒ¨" class="headerlink" title="4.4 è¿›å…¥å®¹å™¨å†…éƒ¨"></a>4.4 è¿›å…¥å®¹å™¨å†…éƒ¨</h4><blockquote>
<p>å¯ä»¥è¿›å…¥å®¹å™¨å†…éƒ¨è¿›è¡Œæ“ä½œ</p>
</blockquote>
<p>sh</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it å®¹å™¨<span class="built_in">id</span> bash</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># docker exec -it 4411f56f1fbb bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€€å‡ºå½“å‰å®¹å™¨ exit</span></span><br><span class="line">root@4411f56f1fbb:/usr/local/tomcat<span class="comment"># exit</span></span><br></pre></td></tr></table></figure>

<h4 id="4-5-å¤åˆ¶å†…å®¹åˆ°å®¹å™¨"><a href="#4-5-å¤åˆ¶å†…å®¹åˆ°å®¹å™¨" class="headerlink" title="4.5 å¤åˆ¶å†…å®¹åˆ°å®¹å™¨"></a>4.5 å¤åˆ¶å†…å®¹åˆ°å®¹å™¨</h4><blockquote>
<p>å°†å®¿ä¸»æœºçš„æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨å†…éƒ¨çš„æŒ‡å®šç›®å½•</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">01020304050607docker <span class="built_in">cp</span> æ–‡ä»¶åç§° å®¹å™¨<span class="built_in">id</span>:å®¹å™¨å†…éƒ¨è·¯å¾„</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠä¸»æœºrootç›®å½•ä¸‹çš„a.txtæ–‡ä»¶æ‹·è´åˆ°å®¹å™¨çš„tempç›®å½•ä¸‹ï¼ˆç”±äºtomcaté»˜è®¤è·¯å¾„åœ¨/usr/local/tomcatï¼‰</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker cp /root/a.txt 441:/usr/local/tomcat/temp</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠå®¹å™¨çš„tempç›®å½•ä¸‹çš„a.txtæ‹·è´åˆ°ä¸»æœºrootç›®å½•ä¸‹</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker cp 441:/usr/local/tomcat/temp/a.txt /root</span></span><br></pre></td></tr></table></figure>

<h4 id="4-6-é‡å¯-amp-å¯åŠ¨-amp-åœæ­¢-amp-åˆ é™¤å®¹å™¨"><a href="#4-6-é‡å¯-amp-å¯åŠ¨-amp-åœæ­¢-amp-åˆ é™¤å®¹å™¨" class="headerlink" title="4.6 é‡å¯&amp;å¯åŠ¨&amp;åœæ­¢&amp;åˆ é™¤å®¹å™¨"></a>4.6 é‡å¯&amp;å¯åŠ¨&amp;åœæ­¢&amp;åˆ é™¤å®¹å™¨</h4><blockquote>
<p>å®¹å™¨çš„å¯åŠ¨ï¼Œåœæ­¢ï¼Œåˆ é™¤ç­‰æ“ä½œï¼Œåç»­ç»å¸¸ä¼šä½¿ç”¨åˆ°</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">0102030405060708091011121314151617<span class="comment"># é‡æ–°å¯åŠ¨å®¹å™¨</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker restart å®¹å™¨id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨åœæ­¢è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker start å®¹å™¨id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœæ­¢æŒ‡å®šçš„å®¹å™¨ï¼ˆåˆ é™¤å®¹å™¨å‰ï¼Œéœ€è¦å…ˆåœæ­¢å®¹å™¨ï¼‰</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker stop å®¹å™¨id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœæ­¢å…¨éƒ¨å®¹å™¨</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker stop $(docker ps -qa)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æŒ‡å®šå®¹å™¨</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker rm å®¹å™¨id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å…¨éƒ¨å®¹å™¨</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker rm $(docker ps -qa)</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Springï¼ˆä¸€ï¼‰</title>
    <url>/2022/03/29/Spring%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<h3 id="1-ä»‹ç»"><a href="#1-ä»‹ç»" class="headerlink" title="1.ä»‹ç»"></a>1.ä»‹ç»</h3><blockquote>
<p>å®˜ç½‘ï¼š<a href="https://spring.io/">https://spring.io/</a></p>
</blockquote>
<blockquote>
<p>Spring è®©æ¯ä¸ªäººéƒ½å¯ä»¥æ›´å¿«ã€æ›´è½»æ¾ã€æ›´å®‰å…¨åœ°ç¼–å†™ Javaã€‚Spring å¯¹é€Ÿåº¦ã€ç®€å•æ€§å’Œç”Ÿäº§åŠ›çš„å…³æ³¨ä½¿å…¶æˆä¸º<a href="https://snyk.io/blog/jvm-ecosystem-report-2018-platform-application/">ä¸–ç•Œä¸Šæœ€å—æ¬¢è¿çš„</a>Java æ¡†æ¶ã€‚</p>
</blockquote>
<blockquote>
<p>æˆ‘ä»¬ä½¿ç”¨äº† Spring æ¡†æ¶é™„å¸¦çš„è®¸å¤šå·¥å…·ï¼Œå¹¶è·å¾—äº†è®¸å¤šå¼€ç®±å³ç”¨çš„è§£å†³æ–¹æ¡ˆæ‰€å¸¦æ¥çš„å¥½å¤„ï¼Œå¹¶ä¸”ä¸å¿…æ‹…å¿ƒç¼–å†™å¤§é‡é¢å¤–çš„ä»£ç â€”â€”è¿™ç¡®å®ä¸ºæˆ‘ä»¬èŠ‚çœäº†ä¸€äº›æ—¶é—´å’Œèƒ½é‡ã€‚</p>
</blockquote>
<span id="more"></span>
<h3 id="2-ç‰¹å¾"><a href="#2-ç‰¹å¾" class="headerlink" title="2.ç‰¹å¾"></a>2.ç‰¹å¾</h3><blockquote>
<ul>
<li><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html">æ ¸å¿ƒæŠ€æœ¯</a>ï¼šä¾èµ–æ³¨å…¥ã€äº‹ä»¶ã€èµ„æºã€i18nã€éªŒè¯ã€æ•°æ®ç»‘å®šã€ç±»å‹è½¬æ¢ã€SpELã€AOPã€‚</li>
<li><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/testing.html">æµ‹è¯•</a>ï¼šæ¨¡æ‹Ÿå¯¹è±¡ã€TestContext æ¡†æ¶ã€Spring MVC æµ‹è¯•ã€<code>WebTestClient</code>.</li>
<li><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/data-access.html">æ•°æ®è®¿é—®</a>ï¼šäº‹åŠ¡ã€DAO æ”¯æŒã€JDBCã€ORMã€ç¼–ç»„ XMLã€‚</li>
<li><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html">Spring MVC</a>å’Œ <a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/web-reactive.html">Spring WebFlux</a> Web æ¡†æ¶ã€‚</li>
<li><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/integration.html">é›†æˆ</a>ï¼šè¿œç¨‹å¤„ç†ã€JMSã€JCAã€JMXã€ç”µå­é‚®ä»¶ã€ä»»åŠ¡ã€è°ƒåº¦ã€ç¼“å­˜ã€‚</li>
<li><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/languages.html">è¯­è¨€</a>ï¼šKotlinã€Groovyã€åŠ¨æ€è¯­è¨€ã€‚</li>
</ul>
</blockquote>
<h3 id="3-æ ¸å¿ƒæŠ€æœ¯"><a href="#3-æ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="3.æ ¸å¿ƒæŠ€æœ¯"></a>3.æ ¸å¿ƒæŠ€æœ¯</h3><blockquote>
<p>IOCï¼šæ§åˆ¶åè½¬ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºæƒäº¤ç»™äº†Springå»ç®¡ç†</p>
<p>DIï¼šä¾èµ–æ³¨å…¥ï¼ŒæŠŠæ•°æ®ç»™åˆ›å»ºå¥½çš„å¯¹è±¡ä¸­çš„å±æ€§è¿›è¡Œèµ‹å€¼</p>
<p>AOPï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œåº•å±‚æ˜¯ä»£ç†æ¨¡å¼</p>
</blockquote>
<h3 id="4-Beançš„åˆ›å»º"><a href="#4-Beançš„åˆ›å»º" class="headerlink" title="4.Beançš„åˆ›å»º"></a>4.Beançš„åˆ›å»º</h3><blockquote>
<p><code>org.springframework.beans</code>å’Œ<code>org.springframework.context</code>åŒ…æ˜¯ Spring Framework çš„ IoC å®¹å™¨çš„åŸºç¡€ã€‚è¯¥ <a href="https://docs.spring.io/spring-framework/docs/5.3.20/javadoc-api/org/springframework/beans/factory/BeanFactory.html"><code>BeanFactory</code></a> æ¥å£æä¾›äº†ä¸€ç§é«˜çº§é…ç½®æœºåˆ¶ï¼Œèƒ½å¤Ÿç®¡ç†ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚ <a href="https://docs.spring.io/spring-framework/docs/5.3.20/javadoc-api/org/springframework/context/ApplicationContext.html"><code>ApplicationContext</code></a> æ˜¯ <code>BeanFactory</code>çš„å­æ¥å£ã€‚å®ƒè¡¥å……è¯´ï¼š</p>
<ul>
<li>æ›´å®¹æ˜“ä¸ Spring çš„ AOP åŠŸèƒ½é›†æˆ</li>
<li>æ¶ˆæ¯èµ„æºå¤„ç†ï¼ˆç”¨äºå›½é™…åŒ–ï¼‰</li>
<li>æ´»åŠ¨å‘å¸ƒ</li>
<li>åº”ç”¨å±‚ç‰¹å®šä¸Šä¸‹æ–‡ï¼Œä¾‹å¦‚<code>WebApplicationContext</code> ç”¨äº Web åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ã€‚</li>
</ul>
</blockquote>
<blockquote>
<p><code>org.springframework.context.ApplicationContext</code>æ¥å£ä»£è¡¨ Spring IoC å®¹å™¨ï¼Œè´Ÿè´£å®ä¾‹åŒ–ã€é…ç½®å’Œç»„è£… beanã€‚</p>
</blockquote>
<h4 id="4-1æ— å‚æ„é€ åˆ›å»º"><a href="#4-1æ— å‚æ„é€ åˆ›å»º" class="headerlink" title="4.1æ— å‚æ„é€ åˆ›å»º"></a>4.1æ— å‚æ„é€ åˆ›å»º</h4><blockquote>
<p>å¯¼å…¥ä¾èµ–</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- springæ ¸å¿ƒä¾èµ– --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ›å»ºUserå®ä½“ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coutrue.pojo;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Userå®ä½“ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ— å‚æ„é€ &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç¼–å†™applicationContext.xmlé…ç½®æ–‡ä»¶</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    è¯¥idå±æ€§æ˜¯æ ‡è¯†å•ä¸ª bean å®šä¹‰çš„å­—ç¬¦ä¸²ã€‚(ä¸èƒ½é‡å¤)</span></span><br><span class="line"><span class="comment">    è¯¥classå±æ€§å®šä¹‰ bean çš„ç±»å‹å¹¶ä½¿ç”¨å®Œå…¨é™å®šçš„ç±»åã€‚</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.coutrue.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç¼–å†™æµ‹è¯•ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//éœ€è¦åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ ¹æ®beanæ ‡ç­¾ä¸­çš„idå±æ€§å€¼ï¼Œè·å–beanå¯¹è±¡</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User)applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(user);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2å·¥å‚åˆ›å»º"><a href="#4-2å·¥å‚åˆ›å»º" class="headerlink" title="4.2å·¥å‚åˆ›å»º"></a>4.2å·¥å‚åˆ›å»º</h4><blockquote>
<p>åˆ›å»ºå·¥å‚ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡å®ä¾‹æ–¹æ³•è·å–Userå¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å– User å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//return new User();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//åå°„ + é…ç½®æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span>  (User)Class.forName(<span class="string">&quot;com.qf.pojo.User&quot;</span>).newInstance();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//return null;</span></span><br><span class="line">        <span class="comment">//æ‰‹åŠ¨æŠ›å¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;åˆ›å»ºUserå¯¹è±¡å¼‚å¸¸&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡é™æ€æ–¹æ³•è·å– User å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> User <span class="title function_">getUserStatic</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//return new User();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//åå°„ + é…ç½®æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span>  (User)Class.forName(<span class="string">&quot;com.qf.pojo.User&quot;</span>).newInstance();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//return null;</span></span><br><span class="line">        <span class="comment">//æ‰‹åŠ¨æŠ›å¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;åˆ›å»ºUserå¯¹è±¡å¼‚å¸¸&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é…ç½®applicationContext.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    è¯¥idå±æ€§æ˜¯æ ‡è¯†å•ä¸ª bean å®šä¹‰çš„å­—ç¬¦ä¸²ã€‚(ä¸èƒ½é‡å¤)</span></span><br><span class="line"><span class="comment">    è¯¥classå±æ€§å®šä¹‰ bean çš„ç±»å‹å¹¶ä½¿ç”¨å®Œå…¨é™å®šçš„ç±»åã€‚</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;bean id = &quot;user&quot; class = &quot;com.coutrue.pojo.User&quot;&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/bean&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å·¥å‚ä¸­çš„å®ä¾‹æ–¹æ³•åˆ›å»ºBean --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;bean id = &quot;userFactoryBean&quot; class = &quot;com.coutrue.factory.UserFactory&quot;&gt;&lt;/bean&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;bean id = &quot;user&quot; factory-bean=&quot;userFactoryBean&quot; factory-method=&quot;getUser&quot;&gt;&lt;/bean&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å·¥å‚ä¸­çš„é™æ€æ–¹æ³•åˆ›å»ºBean --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.coutrue.factory.UserFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getUserStatic&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="4-3ç®€å•å·¥å‚æ¨¡å¼"><a href="#4-3ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="4.3ç®€å•å·¥å‚æ¨¡å¼"></a>4.3ç®€å•å·¥å‚æ¨¡å¼</h4><blockquote>
<p>Car</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Car æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æä¾› run æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Car å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaoSJ</span>  <span class="keyword">implements</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¿æ—¶æ·åœ¨é£é©°...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Car çš„å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FaLL</span> <span class="keyword">implements</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ³•æ‹‰åˆ©åœ¨é£é©°...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç®€å•å·¥å‚æ¨¡å¼ï¼šä»£ç é›†ä¸­ï¼Œä¸ç¬¦åˆ OCP åŸåˆ™ï¼ˆ open - close ï¼‰ï¼šå¯¹ä»£ç çš„æ‰©å±•æ˜¯å¼€æ”¾çš„ï¼Œå¯¹ä»£ç çš„ä¿®æ”¹æ˜¯å…³é—­çš„</span></span><br><span class="line"><span class="comment"> * è½¦å·¥å‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CarFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æä¾›åˆ›å»ºä¿æ—¶æ·çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BaoSJ <span class="title function_">creatBaoSJ</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (BaoSJ)Class.forName(<span class="string">&quot;com.coutrue.factorymode.simplefactory.BaoSJ&quot;</span>).newInstance();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æä¾›åˆ›å»ºæ³•æ‹‰åˆ©çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> FaLL <span class="title function_">creatFaLL</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (FaLL)Class.forName(<span class="string">&quot;com.coutrue.factorymode.simplefactory.FaLL&quot;</span>).newInstance();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.simplefactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡ï¼Œè°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        <span class="comment">//BaoSJ baoSJ = new BaoSJ();</span></span><br><span class="line">        <span class="type">BaoSJ</span> <span class="variable">baoSJ</span> <span class="operator">=</span> CarFactory.creatBaoSJ();</span><br><span class="line">        baoSJ.run();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡ï¼Œè°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        <span class="comment">//FaLL faLL = new FaLL();</span></span><br><span class="line">        <span class="type">FaLL</span> <span class="variable">faLL</span> <span class="operator">=</span> CarFactory.creatFaLL();</span><br><span class="line">        faLL.run();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-4æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#4-4æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="4.4æŠ½è±¡å·¥å‚æ¨¡å¼"></a>4.4æŠ½è±¡å·¥å‚æ¨¡å¼</h4><blockquote>
<p>Car</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.abstractfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Car æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æä¾› run æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.abstractfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Car å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaoSJ</span>  <span class="keyword">implements</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¿æ—¶æ·åœ¨é£é©°...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.abstractfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Car çš„å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FaLL</span> <span class="keyword">implements</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ³•æ‹‰åˆ©åœ¨é£é©°...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>CarFactory</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.abstractfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠ½è±¡å·¥å‚æ¨¡å¼ï¼šç¬¦åˆå¼€é—­åŸåˆ™</span></span><br><span class="line"><span class="comment"> * è½¦å·¥å‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CarFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºè½¦çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Car <span class="title function_">createCar</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.abstractfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¿æ—¶æ·çš„è½¦å·¥å‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaoSJFactory</span> <span class="keyword">implements</span> <span class="title class_">CarFactory</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºä¿æ—¶æ·è½¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Car <span class="title function_">createCar</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (BaoSJ)Class.forName(<span class="string">&quot;com.qf.factorymode.abstractfactory.BaoSJ&quot;</span>).newInstance();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.abstractfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ³•æ‹‰åˆ©è½¦å·¥å‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FaLLFactory</span> <span class="keyword">implements</span> <span class="title class_">CarFactory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Car <span class="title function_">createCar</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (FaLL)Class.forName(<span class="string">&quot;com.qf.factorymode.abstractfactory.FaLL&quot;</span>).newInstance();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.factorymode.abstractfactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡ï¼Œè°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        <span class="type">BaoSJFactory</span> <span class="variable">baoSJFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BaoSJFactory</span>();</span><br><span class="line">        <span class="type">Car</span> <span class="variable">baoSJ</span> <span class="operator">=</span> baoSJFactory.createCar();</span><br><span class="line">        baoSJ.run();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡ï¼Œè°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        <span class="type">FaLLFactory</span> <span class="variable">faLLFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FaLLFactory</span>();</span><br><span class="line">        <span class="type">Car</span> <span class="variable">faLL</span> <span class="operator">=</span> faLLFactory.createCar();</span><br><span class="line">        faLL.run();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-Beançš„ä½œç”¨èŒƒå›´"><a href="#5-Beançš„ä½œç”¨èŒƒå›´" class="headerlink" title="5.Beançš„ä½œç”¨èŒƒå›´"></a>5.Beançš„ä½œç”¨èŒƒå›´</h3><h5 id="5-1scopeå±æ€§"><a href="#5-1scopeå±æ€§" class="headerlink" title="5.1scopeå±æ€§"></a>5.1scopeå±æ€§</h5><blockquote>
<p>beanæ ‡ç­¾çš„scopeå±æ€§ï¼šæŒ‡å®šå½“å‰beançš„ä½œç”¨èŒƒå›´</p>
<p>å–å€¼ï¼š</p>
<p>singletonï¼šå•ä¾‹ï¼ˆ é»˜è®¤å€¼ ï¼‰</p>
<p>prototypeï¼šå¤šä¾‹</p>
<p>requestï¼šä½œç”¨äºWebåº”ç”¨çš„è¯·æ±‚èŒƒå›´</p>
<p>sessionï¼šä½œç”¨äºWebåº”ç”¨çš„ä¼šè¯èŒƒå›´</p>
<p>global-sessionï¼šä½œç”¨äºé›†ç¾¤ç¯å¢ƒWebåº”ç”¨çš„ä¼šè¯èŒƒå›´ï¼ˆå…¨å±€ä¼šè¯ï¼‰</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    è¯¥idå±æ€§æ˜¯æ ‡è¯†å•ä¸ª bean å®šä¹‰çš„å­—ç¬¦ä¸²ã€‚(ä¸èƒ½é‡å¤)</span></span><br><span class="line"><span class="comment">    è¯¥classå±æ€§å®šä¹‰ bean çš„ç±»å‹å¹¶ä½¿ç”¨å®Œå…¨é™å®šçš„ç±»åã€‚</span></span><br><span class="line"><span class="comment">    scopeï¼šå¸¸ç”¨çš„æ˜¯å•ä¾‹ï¼ˆsingletonï¼‰å’Œå¤šä¾‹ï¼ˆprototypeï¼‰</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span> = <span class="string">&quot;user&quot;</span> <span class="attr">class</span> = <span class="string">&quot;com.couture.pojo.User&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="5-2å•ä¾‹æ¨¡å¼-æ‡’æ±‰å¼"><a href="#5-2å•ä¾‹æ¨¡å¼-æ‡’æ±‰å¼" class="headerlink" title="5.2å•ä¾‹æ¨¡å¼-æ‡’æ±‰å¼"></a>5.2å•ä¾‹æ¨¡å¼-æ‡’æ±‰å¼</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.singletonmode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•ä¾‹æ¨¡å¼ï¼šæ‡’æ±‰å¼ï¼ˆåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™å®ä¾‹åŒ–è‡ªå·±ï¼‰</span></span><br><span class="line"><span class="comment"> * ä¼˜åŠ¿ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨æ‰ä¼šåˆå§‹åŒ–ï¼Œé¿å…å†…å­˜æ¶ˆè€—</span></span><br><span class="line"><span class="comment"> * åŠ£åŠ¿ï¼šå¿…é¡»åŠ é”æ‰èƒ½ä¿è¯å•ä¾‹ï¼ŒåŠ é”ä¼šå½±å“æ•ˆç‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SingletonLazy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ„é€ å™¨ç§æœ‰åŒ–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">SingletonLazy</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å£°æ˜å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">SingletonLazy</span> <span class="variable">singletonLazy</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®ä¾‹åŒ–ï¼Œçº¿ç¨‹å®‰å…¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> SingletonLazy <span class="title function_">getSingletonLazy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> == singletonLazy) &#123;</span><br><span class="line">            singletonLazy = <span class="keyword">new</span> <span class="title class_">SingletonLazy</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> singletonLazy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-3å•ä¾‹æ¨¡å¼-é¥¿æ±‰å¼"><a href="#5-3å•ä¾‹æ¨¡å¼-é¥¿æ±‰å¼" class="headerlink" title="5.3å•ä¾‹æ¨¡å¼-é¥¿æ±‰å¼"></a>5.3å•ä¾‹æ¨¡å¼-é¥¿æ±‰å¼</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.singletonmode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¥¿æ±‰å¼ï¼šæ¯”è¾ƒå¸¸ç”¨ï¼Œå®¹æ˜“äº§ç”Ÿåƒåœ¾ï¼ˆ GCå›æ”¶ ï¼‰</span></span><br><span class="line"><span class="comment"> * ä¼˜åŠ¿ï¼šæ²¡æœ‰åŠ é”ï¼Œæ•ˆç‡ä¼šæé«˜</span></span><br><span class="line"><span class="comment"> * åŠ£åŠ¿ï¼šç±»åŠ è½½æ—¶å°±è¿›è¡Œåˆå§‹åŒ–ï¼Œæ¶ˆè€—å†…å­˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SingletonHungry</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰åŒ–æ„é€ å™¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">SingletonHungry</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®ä¾‹åŒ–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">SingletonHungry</span> <span class="variable">singletonHungry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SingletonHungry</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SingletonHungry <span class="title function_">getSingletonHungry</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> singletonHungry;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-4å•ä¾‹æ¨¡å¼-åŒé‡æ ¡éªŒé”"><a href="#5-4å•ä¾‹æ¨¡å¼-åŒé‡æ ¡éªŒé”" class="headerlink" title="5.4å•ä¾‹æ¨¡å¼-åŒé‡æ ¡éªŒé”"></a>5.4å•ä¾‹æ¨¡å¼-åŒé‡æ ¡éªŒé”</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.singletonmode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŒé‡æ ¡éªŒé”</span></span><br><span class="line"><span class="comment"> * ä¼˜åŠ¿ï¼šå®‰å…¨ï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ä¿è¯è¾ƒé«˜çš„æ€§èƒ½</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SingletonLock</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ„é€ å™¨ç§æœ‰åŒ–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">SingletonLock</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å£°æ˜</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">SingletonLock</span> <span class="variable">singletonLock</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®ä¾‹åŒ–æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SingletonLock <span class="title function_">getSingletonLock</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//å…ˆæ£€æŸ¥å½“å‰å®ä¾‹æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸å­˜åœ¨å†è¿›è¡ŒåŒæ­¥</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">null</span> == singletonLock)&#123;</span><br><span class="line">            <span class="comment">//åŒæ­¥</span></span><br><span class="line">            <span class="keyword">synchronized</span> (SingletonLock.class) &#123;</span><br><span class="line">                <span class="comment">//å†æ¬¡æ£€æŸ¥å½“å‰å®ä¾‹æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="literal">null</span> == singletonLock)&#123;</span><br><span class="line">                    <span class="comment">//è¿”å›</span></span><br><span class="line">                    singletonLock = <span class="keyword">new</span> <span class="title class_">SingletonLock</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> singletonLock;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-Beanç”Ÿå‘½å‘¨æœŸ"><a href="#6-Beanç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="6.Beanç”Ÿå‘½å‘¨æœŸ"></a>6.Beanç”Ÿå‘½å‘¨æœŸ</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    è¯¥idå±æ€§æ˜¯æ ‡è¯†å•ä¸ª bean å®šä¹‰çš„å­—ç¬¦ä¸²ã€‚(ä¸èƒ½é‡å¤)</span></span><br><span class="line"><span class="comment">    è¯¥classå±æ€§å®šä¹‰ bean çš„ç±»å‹å¹¶ä½¿ç”¨å®Œå…¨é™å®šçš„ç±»åã€‚</span></span><br><span class="line"><span class="comment">    scopeï¼šå¸¸ç”¨çš„æ˜¯å•ä¾‹ï¼ˆsingletonï¼‰å’Œå¤šä¾‹ï¼ˆprototypeï¼‰</span></span><br><span class="line"><span class="comment">    init-methodï¼šåˆ›å»ºå¯¹è±¡åæ‰§è¡Œçš„åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line"><span class="comment">    destroy-methodï¼šå¯¹è±¡é”€æ¯åæ‰§è¡Œï¼ˆå¦‚æœæ˜¯å¤šä¾‹æ¨¡å¼ä¸‹ä¸æ‰§è¡Œï¼‰</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span> = <span class="string">&quot;user&quot;</span> <span class="attr">class</span> = <span class="string">&quot;com.couture.pojo.User&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;initUser&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroyUser&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.pojo;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Userå®ä½“ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ— å‚æ„é€ &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆå§‹åŒ–æ–¹æ³•ï¼Œåˆ›å»ºå¯¹è±¡åæ‰§è¡Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;User åˆå§‹åŒ–æ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é”€æ¯æ–¹æ³•ï¼Œé”€æ¯springå®¹å™¨ä¸­å¯¹è±¡åæ‰§è¡Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroyUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;User é”€æ¯æ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•ç”Ÿå‘½å‘¨æœŸç›¸å…³æ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLife</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºClassPathXmlApplicationContextå¯¹è±¡</span></span><br><span class="line">    <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span></span><br><span class="line">        <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–å¯¹è±¡</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(user);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­</span></span><br><span class="line">    applicationContext.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-ä¾èµ–æ³¨å…¥"><a href="#7-ä¾èµ–æ³¨å…¥" class="headerlink" title="7.ä¾èµ–æ³¨å…¥"></a>7.ä¾èµ–æ³¨å…¥</h3><blockquote>
<p>DIï¼šDependency Injectionï¼šç»™åˆ›å»ºå¯¹è±¡ä¸­çš„å±æ€§èµ‹å€¼</p>
</blockquote>
<blockquote>
<p>IOCä½œç”¨ï¼šé™ä½ç¨‹åºé—´è€¦åˆï¼ˆä¾èµ–å…³ç³»ï¼‰</p>
<p>ä¾èµ–å…³ç³»ç»´æŠ¤ï¼šä»¥åéƒ½äº¤ç»™Springè¿›è¡Œç®¡ç†</p>
</blockquote>
<blockquote>
<p>å¯æ³¨å…¥ç±»å‹ï¼š</p>
<p>åŸºæœ¬æ•°æ®ç±»å‹ä»¥åŠåŒ…è£…ç±»</p>
<p>Stringç±»</p>
<p>ç±»ç±»å‹ï¼ˆ å…¶ä»–Beanç±»å‹ ï¼‰</p>
<p>å¤æ‚ç±»å‹ï¼šé›†åˆï¼Œæ•°ç»„â€¦</p>
</blockquote>
<h4 id="7-1setæ–¹æ³•æ³¨å…¥"><a href="#7-1setæ–¹æ³•æ³¨å…¥" class="headerlink" title="7.1setæ–¹æ³•æ³¨å…¥"></a>7.1setæ–¹æ³•æ³¨å…¥</h4><blockquote>
<p>applicationContext.xmlé…ç½®æ–‡ä»¶</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- åˆå§‹åŒ–ä¸€ä¸ªCarå¯¹è±¡ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;firstCar&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.couture.pojo.Car&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cid&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20001&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¿æ—¶æ·&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    è¯¥idå±æ€§æ˜¯æ ‡è¯†å•ä¸ª bean å®šä¹‰çš„å­—ç¬¦ä¸²ã€‚(ä¸èƒ½é‡å¤)</span></span><br><span class="line"><span class="comment">    è¯¥classå±æ€§å®šä¹‰ bean çš„ç±»å‹å¹¶ä½¿ç”¨å®Œå…¨é™å®šçš„ç±»åã€‚</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span> = <span class="string">&quot;user&quot;</span> <span class="attr">class</span> = <span class="string">&quot;com.coutrue.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- setæ–¹æ³•èµ‹å€¼</span></span><br><span class="line"><span class="comment">        propertyè¡¨ç¤ºå½“å‰å¯¹è±¡çš„å±æ€§</span></span><br><span class="line"><span class="comment">        nameï¼šå±æ€§å</span></span><br><span class="line"><span class="comment">        valueï¼šç»™å½“å‰å±æ€§èµ‹å€¼</span></span><br><span class="line"><span class="comment">        refï¼šç”¨äºæ³¨å…¥å…¶ä»–Beanå¯¹è±¡ï¼ˆåœ¨springå®¹å™¨ä¸­å·²ç»åˆ›å»ºäº†ï¼‰</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1001&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;car&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;firstCar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>å®ä½“ç±»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer cid;</span><br><span class="line">    <span class="keyword">private</span> String cname;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Car car;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.qf.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUser</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºBean</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span>(User)applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¾“å‡º</span></span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-2å¤æ‚ç±»å‹æ³¨å…¥"><a href="#7-2å¤æ‚ç±»å‹æ³¨å…¥" class="headerlink" title="7.2å¤æ‚ç±»å‹æ³¨å…¥"></a>7.2å¤æ‚ç±»å‹æ³¨å…¥</h4><blockquote>
<p>1.æ³¨å…¥æ•°ç»„å¯¹åº”çš„æ ‡ç­¾ï¼šarray</p>
<p>2.æ³¨å…¥LIstä»¥åŠSeté›†åˆçš„æ ‡ç­¾ï¼šlistï¼Œset</p>
<p>3.æ³¨å…¥Mapä»¥åŠPropertisçš„æ ‡ç­¾ï¼šmapï¼Œproperties</p>
</blockquote>
<blockquote>
<p>åˆ›å»ºå®ä½“ç±»CollectionVo</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.vo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•°ç»„ä»¥åŠé›†åˆç±»å‹çš„å±æ€§æ³¨å…¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CollectionVo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer [] arr;</span><br><span class="line">    <span class="keyword">private</span> List list;</span><br><span class="line">    <span class="keyword">private</span> Set set;</span><br><span class="line">    <span class="keyword">private</span> Map map;</span><br><span class="line">    <span class="keyword">private</span> Properties properties;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨applicationContext.xmlæ–‡ä»¶ä¸­æ·»åŠ å†…å®¹</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¤æ‚ç±»å‹æ³¨å…¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;collectionVo&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.coutrue.vo.CollectionVo&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ•°ç»„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;arr&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>123<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>456<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>789<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- List --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>jack<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>jack<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>rose<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;user&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Set --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;set&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>æå››<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;user&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Map --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;1001&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key-ref</span>=<span class="string">&quot;user&quot;</span> <span class="attr">value-ref</span>=<span class="string">&quot;firstCar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Properties --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;url&quot;</span>&gt;</span>jdbc:mysql:///db_name?serverTimezone=Asia/Shanghai<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;driverClassName&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•å¤æ‚ç±»å‹æ³¨å…¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCollectionVo</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºBean</span></span><br><span class="line">    <span class="type">CollectionVo</span> <span class="variable">collectionVo</span> <span class="operator">=</span> (CollectionVo) applicationContext.getBean(<span class="string">&quot;collectionVo&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¾“å‡º</span></span><br><span class="line">    System.out.println(collectionVo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-3æ„é€ å™¨æ³¨å…¥ï¼ˆ-ä¸å¸¸ç”¨-ï¼‰"><a href="#7-3æ„é€ å™¨æ³¨å…¥ï¼ˆ-ä¸å¸¸ç”¨-ï¼‰" class="headerlink" title="7.3æ„é€ å™¨æ³¨å…¥ï¼ˆ ä¸å¸¸ç”¨ ï¼‰"></a>7.3æ„é€ å™¨æ³¨å…¥ï¼ˆ ä¸å¸¸ç”¨ ï¼‰</h4><blockquote>
<p>åˆ›å»ºCar</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer cid;</span><br><span class="line">    <span class="keyword">private</span> String cname;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(Integer cid, String cname)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cid = cid;</span><br><span class="line">        <span class="built_in">this</span>.cname = cname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ›å»ºUser</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Car car;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(Integer id, String name, String password, Car car)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">        <span class="built_in">this</span>.car = car;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬ä¸€ä¸ªæ„é€ å™¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŠŠ id å’Œ name äº¤æ¢äº†ä¸€ä¸‹é¡ºåº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> password</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> car</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, Integer id,String password, Car car)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">        <span class="built_in">this</span>.car = car;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬äºŒä¸ªæ„é€ å™¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é…ç½®applicationContext.xmlæ–‡ä»¶</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- åˆå§‹åŒ–ä¸€ä¸ªCarå¯¹è±¡ï¼Œè¦å’Œç±»ä¸­çš„æ„é€ å™¨å™¨åŒ¹é… --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">     idå’Œnameç”¨æ³•ç›¸åŒ</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;firstCar&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.couture.pojo.Car&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ„é€ å™¨æ³¨å…¥</span></span><br><span class="line"><span class="comment">        nameï¼šè·å–æ„é€ å™¨ä¸­æŒ‡å®šå‚æ•°çš„åç§°</span></span><br><span class="line"><span class="comment">        valueï¼šç»™æ„é€ å™¨ä¸­çš„å‚æ•°èµ‹å€¼ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹ä»¥åŠStringç±»å‹ï¼‰</span></span><br><span class="line"><span class="comment">        refï¼šç»™å…¶ä»–beanç±»å‹èµ‹å€¼</span></span><br><span class="line"><span class="comment">        typeï¼šæŒ‡å®šæ³¨å…¥çš„ç±»å‹</span></span><br><span class="line"><span class="comment">        indexï¼šæŒ‡å®šå‚æ•°çš„ä½ç½®ï¼Œé»˜è®¤ä»0å¼€å§‹</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;cid&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20001&quot;</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.Integer&quot;</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;cname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¿æ—¶æ·&quot;</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- åˆå§‹åŒ–ä¸€ä¸ªUserå¯¹è±¡ï¼Œé€šè¿‡æ”¹å˜ index æ¥è®¾ç½®é€šè¿‡ä½¿ç”¨ç¬¬ä¸€ä¸ªæ„é€ å™¨åˆ›å»ºå¯¹è±¡ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span> = <span class="string">&quot;user1&quot;</span> <span class="attr">class</span> = <span class="string">&quot;com.couture.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1001&quot;</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¼ ä¸‰&quot;</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> <span class="attr">index</span>=<span class="string">&quot;2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;car&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;firstCar&quot;</span> <span class="attr">index</span>=<span class="string">&quot;3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- åˆå§‹åŒ–ä¸€ä¸ªUserå¯¹è±¡ï¼Œé€šè¿‡æ”¹å˜ index æ¥è®¾ç½®é€šè¿‡ä½¿ç”¨ç¬¬äºŒä¸ªæ„é€ å™¨åˆ›å»ºå¯¹è±¡ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span> = <span class="string">&quot;user2&quot;</span> <span class="attr">class</span> = <span class="string">&quot;com.couture.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1002&quot;</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æå››&quot;</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;456&quot;</span> <span class="attr">index</span>=<span class="string">&quot;2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;car&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;firstCar&quot;</span> <span class="attr">index</span>=<span class="string">&quot;3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.Car;</span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCar</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> (Car) applicationContext.getBean(<span class="string">&quot;firstCar&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(car);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUser</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> (User) applicationContext.getBean(<span class="string">&quot;user1&quot;</span>);</span><br><span class="line">        System.out.println(user1);</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> (User) applicationContext.getBean(<span class="string">&quot;user2&quot;</span>);</span><br><span class="line">        System.out.println(user2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-4æ³¨è§£æ³¨å…¥"><a href="#7-4æ³¨è§£æ³¨å…¥" class="headerlink" title="7.4æ³¨è§£æ³¨å…¥"></a>7.4æ³¨è§£æ³¨å…¥</h4><blockquote>
<p>æ³¨æ„ï¼šéœ€è¦åœ¨applicationContext.xmlæ–‡ä»¶ä¸­ï¼Œå¯¼å…¥contextçº¦æŸ</p>
</blockquote>
<blockquote>
<p>Car</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Component</span> å°†å¯¹è±¡æ”¾åˆ° spring å®¹å™¨ä¸­ï¼Œç›¸å½“äºï¼š&lt;bean id = &quot;&quot; class = &quot;&quot; /&gt;</span></span><br><span class="line"><span class="comment"> * å¦‚æœä¸€ä¸ªæ³¨è§£çš„å±æ€§é»˜è®¤å€¼æ˜¯ valueï¼Œåœ¨åªä½¿ç”¨ value å±æ€§çš„æ—¶å€™å¯ä»¥çœç•¥ä¸å†™</span></span><br><span class="line"><span class="comment"> * valueå±æ€§ï¼šç”¨äºæŒ‡å®š bean çš„ idï¼Œå¦‚æœä¸å†™ï¼Œé»˜è®¤å€¼å°±æ˜¯å½“å‰ç±»åï¼Œé¦–å­—æ¯å°å†™</span></span><br><span class="line"><span class="comment"> * ä»¥ä¸‹ä¸‰ä¸ªæ³¨è§£ç”¨æ³•å’Œ <span class="doctag">@Component</span> ä¸€æ ·ï¼Œä¸ºäº†åŒºåˆ«ä¸åŒå±‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Controller</span>ï¼šä¸€èˆ¬ç”¨äºè¡¨ç°å±‚ ï¼ˆ Webå±‚ ï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Service</span>ï¼šä¸€èˆ¬ç”¨äºä¸šåŠ¡é€»è¾‘å±‚ ï¼ˆ Serviceå±‚ ï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Repository</span>ï¼šä¸€èˆ¬ç”¨äºæŒä¹…å±‚ ï¼ˆ Daoå±‚ ï¼‰</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Value</span> ç»™å±æ€§èµ‹å€¼ï¼Œèµ‹å€¼ç±»å‹ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ä»¥åŠStringï¼Œå¯ä»¥åœ¨å±æ€§ä»¥åŠæ–¹æ³•ä¸Šä½¿ç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//@Component(&quot;myCar&quot;)</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;20001&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer cid;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//@Value(&quot;ä¿æ—¶æ·&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String cname;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;ä¿æ—¶æ·&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCname</span><span class="params">(String cname)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cname = cname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>User</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Scope;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.PreDestroy;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Scope</span> è¡¨ç¤ºå½“å‰å¯¹è±¡é»˜è®¤å•ä¾‹ï¼ˆ singleton ï¼‰ï¼Œå¯ä»¥è®¾ç½®ä¸ºå¤šä¾‹ï¼ˆ prototype ï¼‰</span></span><br><span class="line"><span class="comment"> * ç›¸å½“äº &lt;bean scope = &quot;&quot; /&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Scope(value = &quot;singleton&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;1001&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;å¼ ä¸‰&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;123&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Autowired</span> è¡¨ç¤ºè‡ªåŠ¨è£…é…ï¼Œå¦‚æœ springå®¹å™¨ä¸­æœ‰è¯¥ç±»å‹çš„å¯¹è±¡ï¼Œåˆ™è‡ªåŠ¨æ³¨å…¥åˆ°å½“å‰å±æ€§ä¸­</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Qualifier</span> å’Œ <span class="doctag">@Autowired</span> ä¸€èµ·ç”¨ï¼ŒæŒ‡å®šè¦æ³¨å…¥å…·ä½“å¯¹è±¡çš„åç§°ï¼Œvalue å±æ€§ï¼šæŒ‡å®šæ³¨å…¥ bean çš„ id</span></span><br><span class="line"><span class="comment">     * å¦‚æœåªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œåªä½¿ç”¨ <span class="doctag">@Autowired</span>ï¼Œå¦‚æœæœ‰å¤šä¸ªåŒç±»å‹çš„å¯¹è±¡ï¼Œåç§°ä¸èƒ½ç›¸åŒï¼Œä½¿ç”¨ <span class="doctag">@Qualifier</span> é€‰æ‹©å…·ä½“çš„ Bean</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  <span class="doctag">@Resource</span> æ˜¯javaEEä¸­çš„æ³¨è§£ï¼Œname å±æ€§ï¼šé€šè¿‡åç§°æŒ‡å®šæ³¨å…¥çš„ beanï¼Œç›¸å½“äº <span class="doctag">@Autowired</span> + <span class="doctag">@Qualifier</span></span></span><br><span class="line"><span class="comment">     *  <span class="doctag">@Resource</span> ä¸å¸¸ç”¨ï¼Œå¦‚æœä¸ç”Ÿæ•ˆï¼Œåˆ™éœ€è¦å¯¼å…¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;otherCar&quot;)</span></span><br><span class="line">    <span class="comment">//@Resource(name = &quot;otherCar&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Car car;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  <span class="doctag">@PostConstruct</span> ç›¸å½“äº &lt;bean init-method = &quot;&quot; /&gt; è¡¨ç¤ºåˆå§‹åŒ–çš„æ–¹æ³•ï¼ˆ æ„é€ å™¨ä¹‹åæ‰§è¡Œ ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;User åˆå§‹åŒ–&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  <span class="doctag">@PreDestroy</span> ç›¸å½“äº &lt;bean destroy-method = &quot;&quot; /&gt; è¡¨ç¤ºé”€æ¯çš„æ–¹æ³• ï¼ˆ å¯¹è±¡é”€æ¯ä¹‹å‰æ‰§è¡Œ ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PreDestroy</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;User é”€æ¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>applicationContext.xmlé…ç½®æ–‡ä»¶</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span> <span class="comment">&lt;!-- bean definitions here --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- æ‰«æå¯¹åº”åŒ…ä¸‹çš„æ³¨è§£ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.couture&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- åˆå§‹åŒ–ä¸€ä¸ª Car å¯¹è±¡ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;otherCar&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.couture.pojo.Car&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cid&quot;</span> <span class="attr">value</span>=<span class="string">&quot;30001&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ³•æ‹‰åˆ©&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>bean.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span> <span class="comment">&lt;!-- bean definitions here --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¼å…¥å…¶ä»–çš„xmlæ–‡ä»¶--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;applicationContext.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">import</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.Car;</span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•åˆå§‹åŒ– Car å¯¹è±¡ç›¸å…³æ³¨è§£çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCar</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> (Car) applicationContext.getBean(<span class="string">&quot;car&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(car);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•åˆå§‹åŒ– User å¯¹è±¡ç›¸å…³æ³¨è§£çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUser</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•ä½œç”¨èŒƒå›´å…³æ³¨è§£çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testScope</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> (User) applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> (User) applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(user1 == user2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•ç”Ÿå‘½å‘¨æœŸç›¸å…³æ³¨è§£çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLife</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡å…¶ä»–é…ç½®æ–‡ä»¶æµ‹è¯•</span></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­</span></span><br><span class="line">        applicationContext.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-æ•´åˆMyBatis-ã€é‡ç‚¹ã€‘"><a href="#8-æ•´åˆMyBatis-ã€é‡ç‚¹ã€‘" class="headerlink" title="8.æ•´åˆMyBatis ã€é‡ç‚¹ã€‘"></a>8.æ•´åˆMyBatis ã€é‡ç‚¹ã€‘</h3><h5 id="8-1å¯¼å…¥ä¾èµ–"><a href="#8-1å¯¼å…¥ä¾èµ–" class="headerlink" title="8.1å¯¼å…¥ä¾èµ–"></a>8.1å¯¼å…¥ä¾èµ–</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.couture<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-05<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.29<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- spring --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- è¿æ¥æ•°æ®åº“ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mybatis æ•´åˆ spring æ‰€éœ€ä¾èµ– --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- æµ‹è¯• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="8-2Userç±»"><a href="#8-2Userç±»" class="headerlink" title="8.2Userç±»"></a>8.2Userç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coutrue.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="8-3UserController"><a href="#8-3UserController" class="headerlink" title="8.3UserController"></a>8.3UserController</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.couture.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * webå±‚ -&gt; <span class="doctag">@Controller</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³¨å…¥ UserService</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="8-4UserService"><a href="#8-4UserService" class="headerlink" title="8.4UserService"></a>8.4UserService</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">01020304050607080910111213package com.couture.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="8-5UserServiceImpl"><a href="#8-5UserServiceImpl" class="headerlink" title="8.5UserServiceImpl"></a>8.5UserServiceImpl</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.qf.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.coutrue.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.coutrue.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.coutrue.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * serviceå±‚ -&gt; <span class="doctag">@Service</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³¨å…¥ UserMapper</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="8-6UserMapper"><a href="#8-6UserMapper" class="headerlink" title="8.6UserMapper"></a>8.6UserMapper</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coutrue.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.coutrue.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * daoå±‚ -&gt; <span class="doctag">@Repository</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="8-7UserMapper-xml"><a href="#8-7UserMapper-xml" class="headerlink" title="8.7UserMapper.xml"></a>8.7UserMapper.xml</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.coutrue.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment">&lt;!-- ormæ˜ å°„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.coutrue.pojo.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;password&quot;</span> <span class="attr">column</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- sqlç‰‡æ®µ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;baseSql&quot;</span>&gt;</span></span><br><span class="line">        select id, name, password from t_user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userMap&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;baseSql&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="8-8db-properties"><a href="#8-8db-properties" class="headerlink" title="8.8db.properties"></a>8.8db.properties</h5><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">db.username</span> = <span class="string">root</span></span><br><span class="line"><span class="attr">db.password</span> = <span class="string">root</span></span><br><span class="line"><span class="attr">db.url</span> = <span class="string">jdbc:mysql://localhost:3306/java?serverTimezone=Asia/Shanghai&amp;characterEncoding=UTF8</span></span><br><span class="line"><span class="attr">db.driver</span> = <span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>

<h5 id="8-9log4j-properties"><a href="#8-9log4j-properties" class="headerlink" title="8.9log4j.properties"></a>8.9log4j.properties</h5><p>properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">Global</span> <span class="string">logging configuration</span></span><br><span class="line"><span class="attr">log4j.rootLogger</span>=<span class="string">DEBUG, stdout</span></span><br><span class="line"><span class="comment"># Console output...</span></span><br><span class="line"><span class="attr">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%5p [%t] - %m%n</span></span><br></pre></td></tr></table></figure>

<h5 id="8-10mybatis-config-xml"><a href="#8-10mybatis-config-xml" class="headerlink" title="8.10mybatis-config.xml"></a>8.10mybatis-config.xml</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®æ—¥å¿— --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="8-11applicationContext-xml"><a href="#8-11applicationContext-xml" class="headerlink" title="8.11applicationContext.xml"></a>8.11applicationContext.xml</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span> <span class="comment">&lt;!-- bean definitions here --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- å¯¼å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶ db.properties --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:db.properties&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:property-placeholder</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®æ•°æ®æºå¯¹è±¡ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;datasource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- å¯¼å…¥ db.properties ä¸­çš„å€¼--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.username&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.password&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.url&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.driver&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- æ‰«æå¯¹åº”åŒ…ä¸‹çš„æ³¨è§£ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.coutrue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®sqlSessionFactory --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactoryBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- å¿…é€‰é…ç½® --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;datasource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- éå¿…é€‰å±æ€§ï¼Œæ ¹æ®è‡ªå·±éœ€æ±‚å»é…ç½® --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- å¯¼å…¥ mybatis-config.xml --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- å¯¼å…¥ Mapper.xml æ–‡ä»¶ï¼Œclasspathåé¢ä¸èƒ½æœ‰ç©ºæ ¼ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mapper/*.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- æ‰«æ Mapper æ¥å£ï¼Œç”Ÿæˆä»£ç†å¯¹è±¡ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mapperScannerConfigurer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æŒ‡å®šæ‰«æçš„å…·ä½“ä½ç½® --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.coutrue.mapper&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="8-12æµ‹è¯•"><a href="#8-12æµ‹è¯•" class="headerlink" title="8.12æµ‹è¯•"></a>8.12æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.controller.UserController;</span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test_findAll</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">UserController</span> <span class="variable">userController</span> <span class="operator">=</span> (UserController)applicationContext.getBean(<span class="string">&quot;userController&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; userList = userController.findAll();</span><br><span class="line"></span><br><span class="line">        System.out.println(userList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-æ•°æ®æºé…ç½®ç±»"><a href="#9-æ•°æ®æºé…ç½®ç±»" class="headerlink" title="9.æ•°æ®æºé…ç½®ç±»"></a>9.æ•°æ®æºé…ç½®ç±»</h3><blockquote>
<p>ç”¨äºæ›¿æ¢applicationContext.xmlä¸­æ•°æ®æºçš„ç›¸å…³é…ç½®</p>
<p>&lt;context:property-placeholder location&#x3D;â€œclasspath:db.propertiesâ€&gt;</context:property-placeholder></p>
</blockquote>
<p>java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.coture.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"><span class="keyword">import</span> com.couture.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.PropertySource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Configuration</span> è¡¨ç¤ºæœåŠ¡å™¨å¯åŠ¨æ—¶åŠ è½½å½“å‰ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@PropertySource</span> åŠ è½½å¯¹åº”çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@PropertySource(value = &quot;classpath:db.properties&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSourceConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;db.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;db.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;db.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;db.driver&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String driverClassName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆå§‹åŒ–ä¸€ä¸ª Bean å¯¹è±¡ -&gt; DataSource</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Bean</span> å°†æ–¹æ³•çš„è¿”å›å€¼ä½œä¸º bean å¯¹è±¡ï¼Œæ”¾åˆ° spring å®¹å™¨ä¸­</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean(&quot;datasource&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">getDataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//è®¾ç½®æ•°æ®æºå‚æ•°</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        properties.setProperty(<span class="string">&quot;username&quot;</span>, username);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;password&quot;</span>, password);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;url&quot;</span>, url);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;driverClassName&quot;</span>, driverClassName);</span><br><span class="line"></span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//åˆ›å»ºæ•°æ®æºå¯¹è±¡</span></span><br><span class="line">            dataSource = DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-åˆ†é¡µ"><a href="#10-åˆ†é¡µ" class="headerlink" title="10.åˆ†é¡µ"></a>10.åˆ†é¡µ</h3><h5 id="10-1å¯¼å…¥ä¾èµ–"><a href="#10-1å¯¼å…¥ä¾èµ–" class="headerlink" title="10.1å¯¼å…¥ä¾èµ–"></a>10.1å¯¼å…¥ä¾èµ–</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="10-2ç¬¬ä¸€ç§æ–¹å¼åœ¨mybatis-config-xmlä¸­é…ç½®"><a href="#10-2ç¬¬ä¸€ç§æ–¹å¼åœ¨mybatis-config-xmlä¸­é…ç½®" class="headerlink" title="10.2ç¬¬ä¸€ç§æ–¹å¼åœ¨mybatis-config.xmlä¸­é…ç½®"></a>10.2ç¬¬ä¸€ç§æ–¹å¼åœ¨mybatis-config.xmlä¸­é…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®æ—¥å¿— --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- åˆ†é¡µæ’ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- com.github.pagehelperä¸ºPageHelperç±»æ‰€åœ¨åŒ…å --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ•°æ®åº“æ–¹è¨€ï¼ŒæŒ‡å®šå¯¹åº”çš„æ•°æ®åº“è¿›è¡Œåˆ†é¡µ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;helperDialect&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- åˆ†é¡µåˆç†åŒ–å‚æ•°ï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚å½“è¯¥å‚æ•°è®¾ç½®ä¸º true æ—¶ï¼ŒpageNum&lt;=0 æ—¶ä¼šæŸ¥è¯¢ç¬¬ä¸€é¡µï¼Œ pageNum&gt;pagesï¼ˆè¶…è¿‡æ€»æ•°æ—¶ï¼‰ï¼Œä¼šæŸ¥è¯¢æœ€åä¸€é¡µ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;reasonable&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ”¯æŒé€šè¿‡ Mapper æ¥å£å‚æ•°æ¥ä¼ é€’åˆ†é¡µå‚æ•° --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;supportMethodsArguments&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="10-3ç¬¬äºŒç§æ–¹å¼åœ¨applicationContext-xmlä¸­é…ç½®"><a href="#10-3ç¬¬äºŒç§æ–¹å¼åœ¨applicationContext-xmlä¸­é…ç½®" class="headerlink" title="10.3ç¬¬äºŒç§æ–¹å¼åœ¨applicationContext.xmlä¸­é…ç½®"></a>10.3ç¬¬äºŒç§æ–¹å¼åœ¨applicationContext.xmlä¸­é…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®sqlSessionFactory --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactoryBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¿…é€‰é…ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;datasource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- éå¿…é€‰å±æ€§ï¼Œæ ¹æ®è‡ªå·±éœ€æ±‚å»é…ç½® --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¯¼å…¥ mybatis-config.xml --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¯¼å…¥ Mapper.xml æ–‡ä»¶ï¼Œclasspathåé¢ä¸èƒ½æœ‰ç©ºæ ¼ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mapper/*.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®åˆ†é¡µ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;plugins&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼é…ç½®å‚æ•°ï¼Œä¸€è¡Œé…ç½®ä¸€ä¸ª --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                        helperDialect = mysql</span><br><span class="line">                        reasonable = true</span><br><span class="line">                        supportMethodsArguments = true</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="10-4-æµ‹è¯•"><a href="#10-4-æµ‹è¯•" class="headerlink" title="10.4 æµ‹è¯•"></a>10.4 æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test_findByPage</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">UserController</span> <span class="variable">userController</span> <span class="operator">=</span> (UserController)applicationContext.getBean(<span class="string">&quot;userController&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">PageInfo</span> <span class="variable">pageInfo</span> <span class="operator">=</span> userController.findByPage(<span class="number">4</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(pageInfo.getList());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-AOP"><a href="#9-AOP" class="headerlink" title="9.AOP"></a>9.AOP</h3><blockquote>
<p>Aspect Oriented Programing é¢å‘åˆ‡é¢ç¼–ç¨‹</p>
<p>springAOPï¼šåœ¨ç¨‹åºè¿è¡ŒæœŸé€šè¿‡åŠ¨æ€ä»£ç†çš„æ–¹å¼å‘ç›®æ ‡ç±»ï¼ˆæ¥å£ï¼‰ï¼Œç»‡å…¥å¢å¼ºçš„ä»£ç ï¼Œä¸ºç›®æ ‡ç±»ï¼ˆæ¥å£ï¼‰ä¸­çš„æ–¹æ³•æ·»åŠ é¢å¤–çš„åŠŸèƒ½</p>
<p>é‡‡å–æ˜¯æ¨ªå‘æŠ½å–æœºåˆ¶ï¼Œå–ä»£äº†æˆ‘ä»¬ä¼ ç»Ÿçš„çºµå‘ç»§æ‰¿æ–¹å¼é‡å¤æ€§çš„ä»£ç </p>
<p>åº•å±‚åŸç†ï¼šä»£ç†æ¨¡å¼</p>
</blockquote>
<h4 id="9-1è£…é¥°å™¨æ¨¡å¼"><a href="#9-1è£…é¥°å™¨æ¨¡å¼" class="headerlink" title="9.1è£…é¥°å™¨æ¨¡å¼"></a>9.1è£…é¥°å™¨æ¨¡å¼</h4><blockquote>
<p>è£…é¥°å™¨æ¨¡å¼ï¼šå¯¹è±¡æœ¬èº«å¢å¼º</p>
<p>ä»£ç†æ¨¡å¼ï¼šä»£ç†å¯¹è±¡ï¼ˆä»£ç†è¿‡ç¨‹ï¼‰å¢å¼º</p>
</blockquote>
<h5 id="9-1-1Info"><a href="#9-1-1Info" class="headerlink" title="9.1.1Info"></a>9.1.1Info</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠ½è±¡æ„ä»¶</span></span><br><span class="line"><span class="comment"> * æŠ½è±¡ç±»ï¼šå¯ä»¥æœ‰æŠ½è±¡æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æœ‰æ™®é€šæ–¹æ³•ï¼Œä½†æ˜¯ä¸€æ—¦å†™äº†æŠ½è±¡æ–¹æ³•ï¼Œè¿™ä¸ªç±»ä¸€å®šä¸ºæŠ½è±¡ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Info</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‡ªæˆ‘ä»‹ç»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">info</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-1-2PersonInfo"><a href="#9-1-2PersonInfo" class="headerlink" title="9.1.2PersonInfo"></a>9.1.2PersonInfo</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…·ä½“æ„ä»¶</span></span><br><span class="line"><span class="comment"> * ç»§æ‰¿Infoï¼Œå®ç°æ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonInfo</span> <span class="keyword">extends</span> <span class="title class_">Info</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è‡ªæˆ‘ä»‹ç»&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-1-3Decorator"><a href="#9-1-3Decorator" class="headerlink" title="9.1.3Decorator"></a>9.1.3Decorator</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è£…é¥°å™¨</span></span><br><span class="line"><span class="comment"> * æŠ½è±¡è£…é¥°</span></span><br><span class="line"><span class="comment"> * ç»§æ‰¿Infoï¼Œå®ç°æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡å…¶å­ç±»æ‰©å±•å…·ä½“æ„ä»¶çš„åŠŸèƒ½</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Decorator</span> <span class="keyword">extends</span> <span class="title class_">Info</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Info info;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¼ å…¥è¢«è£…é¥°å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Decorator</span><span class="params">(Info info)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.info = info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//è°ƒç”¨è‡ªæˆ‘ä»‹ç»çš„æ–¹æ³•</span></span><br><span class="line">        info.info();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-1-4Singer"><a href="#9-1-4Singer" class="headerlink" title="9.1.4Singer"></a>9.1.4Singer</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…·ä½“è£…é¥°</span></span><br><span class="line"><span class="comment"> * ç»§æ‰¿æŠ½è±¡è£…é¥°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singer</span> <span class="keyword">extends</span> <span class="title class_">Decorator</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è°ƒç”¨çˆ¶ç±»æ„é€ å™¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Singer</span><span class="params">(Info info)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(info);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è‡ªå·±çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">singing</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å”±æ­Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é‡å†™æ–¹æ³•ï¼Œè¾¾åˆ°å¢å¼ºçš„ç›®çš„</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.info();</span><br><span class="line">        singing();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-1-5Dancer"><a href="#9-1-5Dancer" class="headerlink" title="9.1.5Dancer"></a>9.1.5Dancer</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…·ä½“è£…é¥°</span></span><br><span class="line"><span class="comment"> * ç»§æ‰¿æŠ½è±¡è£…é¥°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dancer</span> <span class="keyword">extends</span> <span class="title class_">Decorator</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Dancer</span><span class="params">(Info info)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(info);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dancing</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è·³èˆ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.info();</span><br><span class="line">        dancing();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-1-6Magic"><a href="#9-1-6Magic" class="headerlink" title="9.1.6Magic"></a>9.1.6Magic</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.decorator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…·ä½“è£…é¥°</span></span><br><span class="line"><span class="comment"> * ç»§æ‰¿æŠ½è±¡è£…é¥°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Magic</span> <span class="keyword">extends</span> <span class="title class_">Decorator</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Magic</span><span class="params">(Info info)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(info);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">magic</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å˜é­”æœ¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">info</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.info();</span><br><span class="line">        magic();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-1-7æµ‹è¯•"><a href="#9-1-7æµ‹è¯•" class="headerlink" title="9.1.7æµ‹è¯•"></a>9.1.7æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.decorator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å•ç‹¬æµ‹è¯•</span></span><br><span class="line"><span class="comment">//        Info personInfo = new PersonInfo();</span></span><br><span class="line"><span class="comment">//        personInfo.info();</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;----------------------&quot;);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        Decorator singer = new Singer(personInfo);</span></span><br><span class="line"><span class="comment">//        singer.info();</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;----------------------&quot;);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        Dancer dancer = new Dancer(personInfo);</span></span><br><span class="line"><span class="comment">//        dancer.info();</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;----------------------&quot;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¢å¼ºæµ‹è¯•</span></span><br><span class="line">        <span class="type">Info</span> <span class="variable">personInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PersonInfo</span>();</span><br><span class="line">        <span class="type">Decorator</span> <span class="variable">singer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singer</span>(personInfo);<span class="comment">//ç¬¬ä¸€æ¬¡å¢å¼º</span></span><br><span class="line">        <span class="type">Dancer</span> <span class="variable">dancer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dancer</span>(singer);<span class="comment">//ç¬¬äºŒæ¬¡å¢å¼º</span></span><br><span class="line">        <span class="type">Magic</span> <span class="variable">magic1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Magic</span>(dancer);<span class="comment">//ç¬¬ä¸‰æ¬¡å¢å¼º</span></span><br><span class="line">        <span class="type">Magic</span> <span class="variable">magic2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Magic</span>(magic1);<span class="comment">//ç¬¬å››æ¬¡å¢å¼º</span></span><br><span class="line"></span><br><span class="line">        magic2.info();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="9-2ä»£ç†æ¨¡å¼"><a href="#9-2ä»£ç†æ¨¡å¼" class="headerlink" title="9.2ä»£ç†æ¨¡å¼"></a>9.2ä»£ç†æ¨¡å¼</h4><blockquote>
<p>é€šè¿‡ä»£ç†ç±»å¯¹è±¡ï¼Œä¸ºç›®æ ‡ç±»å¯¹è±¡æ·»åŠ åŠŸèƒ½</p>
<p>åˆ†ç±»ï¼šé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†</p>
<p>é™æ€ä»£ç†ï¼šéœ€è¦å®ç°æ¥å£ä¸­çš„æ–¹æ³•ï¼Œè¿›è¡Œå¢å¼ºï¼Œä»£ç†çš„åŠŸèƒ½ä»£ç æœ‰å†—ä½™ï¼Œç»´æŠ¤æ€§è¾ƒå·®</p>
<p>åŠ¨æ€ä»£ç†ï¼šåœ¨ä¸å®ç°æ¥å£ä¸­æ‰€æœ‰æ–¹æ³•ï¼Œå¯¹æ¥å£ä¸­çš„æŒ‡å®šçš„æ–¹æ³•è¿›è¡Œå¢å¼º</p>
</blockquote>
<h5 id="9-2-1é™æ€ä»£ç†"><a href="#9-2-1é™æ€ä»£ç†" class="headerlink" title="9.2.1é™æ€ä»£ç†"></a>9.2.1é™æ€ä»£ç†</h5><blockquote>
<p>Rent</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.proxy.demo1;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¥å£</span></span><br><span class="line"><span class="comment"> * å‡ºç§Ÿæˆ¿å­</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Rent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‡ºç§Ÿæˆ¿å­</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…¶ä»–çš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//public void test();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Owner</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.proxy.demo1;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æˆ¿ä¸œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Owner</span> <span class="keyword">implements</span> <span class="title class_">Rent</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ¿ä¸œå‡ºç§Ÿæˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>OwnerProxy</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.proxy.demo1;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æˆ¿ä¸œçš„ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * é™æ€ä»£ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OwnerProxy</span> <span class="keyword">implements</span> <span class="title class_">Rent</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆ¿ä¸œå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> Owner owner;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OwnerProxy</span><span class="params">(Owner owner)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.owner = owner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">publish</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å‘å¸ƒç§Ÿæˆ¿ä¿¡æ¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">seeHouse</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¸¦ç§Ÿæˆ·çœ‹æˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span> &#123;</span><br><span class="line">        publish();</span><br><span class="line">        owner.rent();</span><br><span class="line">        seeHouse();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.proxy.demo1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Owner</span> <span class="variable">owner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Owner</span>();</span><br><span class="line">        owner.rent();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;----------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">OwnerProxy</span> <span class="variable">ownerProxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OwnerProxy</span>(owner);</span><br><span class="line">        ownerProxy.rent();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-2-2åŠ¨æ€ä»£ç†"><a href="#9-2-2åŠ¨æ€ä»£ç†" class="headerlink" title="9.2.2åŠ¨æ€ä»£ç†"></a>9.2.2åŠ¨æ€ä»£ç†</h5><blockquote>
<p>åˆ†ä¸ºï¼šJDKåŠ¨æ€ä»£ç† å’Œ CGLIBåŠ¨æ€ä»£ç†</p>
<p>JDKåŠ¨æ€ä»£ç†ï¼šåŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†ï¼Œè¢«ä»£ç†å¯¹è±¡å¿…é¡»å®ç°æ¥å£</p>
<p>CGLIBåŠ¨æ€ä»£ç† ï¼šåŸºäºå­ç±»çš„åŠ¨æ€ä»£ç†ï¼Œå¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œç»§æ‰¿ä»£ç†</p>
</blockquote>
<blockquote>
<p>JDKåŠ¨æ€ä»£ç†</p>
</blockquote>
<blockquote>
<p>Rent</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.proxy.demo2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¥å£</span></span><br><span class="line"><span class="comment"> * å‡ºç§Ÿæˆ¿å­</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Rent</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å‡ºç§Ÿæˆ¿å­</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…¶ä»–çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Owner</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.proxy.demo2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æˆ¿ä¸œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Owner</span> <span class="keyword">implements</span> <span class="title class_">Rent</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ¿ä¸œå‡ºç§Ÿæˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æµ‹è¯•æ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>RentJdkProxy</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.proxy.demo2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JDKåŠ¨æ€ä»£ç†</span></span><br><span class="line"><span class="comment"> * æ ¸å¿ƒå®ç° InvocationHandler æ¥å£ï¼Œè°ƒç”¨ invoke æ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RentJdkProxy</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Rent rent;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRent</span><span class="params">(Rent rent)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.rent = rent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”Ÿæˆä»£ç†å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> Rent <span class="title function_">getRent</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (Rent)Proxy.newProxyInstance(</span><br><span class="line">                rent.getClass().getClassLoader(), <span class="comment">//ç±»åŠ è½½å™¨</span></span><br><span class="line">                rent.getClass().getInterfaces(),<span class="comment">//æ¥å£åˆ—è¡¨</span></span><br><span class="line">                <span class="built_in">this</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹æ¥å£ä¸­çš„æ–¹æ³•è¿›è¡Œå¢å¼ºï¼ˆæ‰©å±•ï¼‰ï¼Œä¸éœ€è¦å®ç°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">//å£°æ˜å˜é‡åšä¸ºæ–¹æ³•çš„è¿”å›å€¼</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ–¹æ³•åï¼Œå¯¹å…¶è¿›è¡Œå¢å¼º</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;rent&quot;</span>.equals(method.getName()))&#123;</span><br><span class="line">            publish();</span><br><span class="line">            result = method.invoke(rent,args);</span><br><span class="line">            seeHouse();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result = method.invoke(rent,args);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">publish</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å‘å¸ƒç§Ÿæˆ¿ä¿¡æ¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">seeHouse</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¸¦ç§Ÿæˆ·çœ‹æˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ‹è¯•</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.proxy.demo2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Owner</span> <span class="variable">owner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Owner</span>();</span><br><span class="line">        owner.rent();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;-------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºRentJdkProxyå¯¹è±¡</span></span><br><span class="line">        <span class="type">RentJdkProxy</span> <span class="variable">rentJdkProxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RentJdkProxy</span>();</span><br><span class="line">        <span class="comment">//ç»™å±æ€§èµ‹å€¼</span></span><br><span class="line">        rentJdkProxy.setRent(owner);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        <span class="type">Rent</span> <span class="variable">proxyRent</span> <span class="operator">=</span> rentJdkProxy.getRent();</span><br><span class="line">        proxyRent.rent();</span><br><span class="line"></span><br><span class="line">        proxyRent.test();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="9-3Springä¸­çš„AOP"><a href="#9-3Springä¸­çš„AOP" class="headerlink" title="9.3Springä¸­çš„AOP"></a>9.3Springä¸­çš„AOP</h4><blockquote>
<p>é¢å‘åˆ‡é¢ç¼–ç¨‹ (AOP) é€šè¿‡æä¾›å¦ä¸€ç§æ€è€ƒç¨‹åºç»“æ„çš„æ–¹å¼æ¥è¡¥å……é¢å‘å¯¹è±¡ç¼–ç¨‹ (OOP)ï¼ŒOOPçš„å»¶ä¼¸</p>
<p>å¯¹ç›®æ ‡å¯¹è±¡ä¸­çš„å¤šä¸ªä¸åŒæ–¹æ³•è¿›è¡Œä¸åŒç¨‹åº¦çš„å¢å¼º</p>
</blockquote>
<blockquote>
<p>AOPçš„æœ¯è¯­:<br>Joinpoint(è¿æ¥ç‚¹)ï¼šæ‰€è°“è¿æ¥ç‚¹æ˜¯æŒ‡é‚£äº›è¢«æ‹¦æˆªåˆ°çš„ç‚¹ï¼Œåœ¨springä¸­ï¼Œè¿™äº›ç‚¹æŒ‡çš„æ˜¯æ–¹æ³•ï¼Œspringåªæ”¯æŒæ–¹æ³•ç±»å‹çš„è¿æ¥ç‚¹ã€‚<br>Pointcut(åˆ‡å…¥ç‚¹)ï¼šæ‰€è°“åˆ‡å…¥ç‚¹æ˜¯æŒ‡æˆ‘ä»¬è¦å¯¹å“ªäº›Joinpointè¿›è¡Œæ‹¦æˆªçš„å®šä¹‰ã€‚<br>Advice(é€šçŸ¥&#x2F;å¢å¼º)ï¼šæ‰€è°“é€šçŸ¥æ˜¯æŒ‡æ‹¦æˆªåˆ°Joinpointä¹‹åæ‰€è¦åšçš„äº‹æƒ…å°±æ˜¯é€šçŸ¥ï¼Œé€šçŸ¥åˆ†ä¸ºå‰ç½®é€šçŸ¥ï¼Œåç½®é€šçŸ¥ï¼Œå¼‚å¸¸é€šçŸ¥ï¼Œæœ€ç»ˆé€šçŸ¥ï¼Œç¯ç»•é€šçŸ¥ã€‚<br>Introduction(å¼•ä»‹)ï¼šå¯ä»¥åœ¨è¿è¡ŒæœŸä¸ºç±»åŠ¨æ€åœ°æ·»åŠ ä¸€äº›æ–¹æ³•æˆ–Fieldã€‚<br>Target(ç›®æ ‡å¯¹è±¡)ï¼šä»£ç†çš„ç›®æ ‡å¯¹è±¡ã€‚<br>Weaving(ç»‡å…¥)ï¼šæ˜¯æŒ‡æŠŠå¢å¼ºåº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡æ¥åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚<br>Proxy(ä»£ç†)ï¼šä¸€ä¸ªç±»è¢«AOPç»‡å…¥å¢å¼ºåï¼Œå°±äº§ç”Ÿä¸€ä¸ªä»£ç†ç±»ã€‚<br>Aspect(åˆ‡é¢)ï¼šæ˜¯åˆ‡å…¥ç‚¹å’Œé€šçŸ¥ï¼ˆå¼•ä»‹ï¼‰çš„ç»“åˆ</p>
</blockquote>
<h4 id="9-4XMLé…ç½®AOP"><a href="#9-4XMLé…ç½®AOP" class="headerlink" title="9.4XMLé…ç½®AOP"></a>9.4XMLé…ç½®AOP</h4><h5 id="9-4-1å¯¼å…¥ä¾èµ–"><a href="#9-4-1å¯¼å…¥ä¾èµ–" class="headerlink" title="9.4.1å¯¼å…¥ä¾èµ–"></a>9.4.1å¯¼å…¥ä¾èµ–</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- aop --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="9-4-2UserService"><a href="#9-4-2UserService" class="headerlink" title="9.4.2UserService"></a>9.4.2UserService</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç›®æ ‡å¯¹è±¡ target</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ²¡æœ‰å¢å¼ºçš„æ–¹æ³•ï¼Œå«åšè¿æ¥ç‚¹ JoinPoint</span></span><br><span class="line">    <span class="comment">//è¢«å¢å¼ºçš„æ–¹æ³•ï¼Œå«åšåˆ‡å…¥ç‚¹ PointCut</span></span><br><span class="line">    <span class="comment">//å¢å¼ºçš„ä»£ç ï¼Œå«åšé€šçŸ¥</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-4-3UserServiceImpl"><a href="#9-4-3UserServiceImpl" class="headerlink" title="9.4.3UserServiceImpl"></a>9.4.3UserServiceImpl</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>;<span class="comment">//ç®—æ•°å¼‚å¸¸</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;delete&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;update&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;query&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-4-4MyAdvice"><a href="#9-4-4MyAdvice" class="headerlink" title="9.4.4MyAdvice"></a>9.4.4MyAdvice</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.advice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šçŸ¥ç±»ï¼šå¢å¼ºçš„ä»£ç </span></span><br><span class="line"><span class="comment"> * æ–¹æ³•åä»¥åŠåŠŸèƒ½å¯ä»¥æ˜¯ä»»æ„çš„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å‰ç½®é€šçŸ¥ï¼Œç›®æ ‡å¯¹è±¡è°ƒç”¨æ–¹æ³•å‰æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åç½®é€šçŸ¥ï¼ˆæœ€ç»ˆé€šçŸ¥ï¼‰ï¼Œç›®æ ‡å¯¹è±¡è°ƒç”¨æ–¹æ³•åæ‰§è¡Œï¼Œæ— è®ºç›®æ ‡å¯¹è±¡æ–¹æ³•æ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after_returning</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åç½®é€šçŸ¥ï¼Œç›®æ ‡å¯¹è±¡è°ƒç”¨æ–¹æ³•åæ‰§è¡Œï¼Œç›®æ ‡å¯¹è±¡æ–¹æ³•å‘ç”Ÿå¼‚å¸¸åˆ™ä¸æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after_throwing</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¼‚å¸¸é€šçŸ¥ï¼Œç›®æ ‡å¯¹è±¡è°ƒç”¨æ–¹æ³•å‘ç”Ÿå¼‚å¸¸æ—¶æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">around</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¯ç»•é€šçŸ¥ï¼Œç›®æ ‡å¯¹è±¡è°ƒç”¨æ–¹æ³•ä¹‹å‰&quot;</span>);</span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¯ç»•é€šçŸ¥ï¼Œç›®æ ‡å¯¹è±¡è°ƒç”¨æ–¹æ³•ä¹‹å&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9-4-5applicationContext-xml"><a href="#9-4-5applicationContext-xml" class="headerlink" title="9.4.5applicationContext.xml"></a>9.4.5applicationContext.xml</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span> <span class="comment">&lt;!-- bean definitions here --&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®userServiceå¯¹è±¡ï¼Œå¯¹è¯¥å¯¹è±¡ä¸­çš„æ–¹æ³•è¿›è¡Œå¢å¼º --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.coutrue.service.impl.UserServiceImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®é€šçŸ¥ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myAdvice&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.coutrue.advice.MyAdvice&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®aop --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é»˜è®¤ä½¿ç”¨JDKåŠ¨æ€ä»£ç†ï¼Œé€šè¿‡ proxy-target-class=&quot;true&quot; å¯ä»¥è®¾ç½®ä½¿ç”¨CGLIBåŠ¨æ€ä»£ç† --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:config</span> <span class="attr">proxy-target-class</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®åˆ‡ç‚¹</span></span><br><span class="line"><span class="comment">             expressionï¼šè¡¨è¾¾å¼ï¼ŒæŒ‡å®šå“ªäº›æ–¹æ³•æ˜¯åˆ‡å…¥ç‚¹ï¼Œå¯¹é‚£äº›è¿›è¡Œå¢å¼º</span></span><br><span class="line"><span class="comment">             --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;aop:pointcut id=&quot;pc&quot; expression=&quot;execution(public void com.qf.service.impl.UserServiceImpl.add())&quot;/&gt;--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pc&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.coutrue.service.impl.*ServiceImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- é…ç½®åˆ‡é¢ï¼ŒæŠŠé€šçŸ¥é…ç½®åˆ°åˆ‡ç‚¹ä¸Š --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;myAdvice&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- aop:before å‰ç½®é€šçŸ¥ï¼Œmethod è¡¨ç¤ºå¢å¼ºçš„ä»£ç çš„æ–¹æ³•å --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;before&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:before</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- åç½®é€šçŸ¥ï¼ˆæœ€ç»ˆé€šçŸ¥ï¼‰ï¼Œç›®æ ‡å¯¹è±¡è°ƒç”¨æ–¹æ³•åæ‰§è¡Œï¼Œæ— è®ºç›®æ ‡å¯¹è±¡æ–¹æ³•æ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">&quot;after&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:after</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- åç½®é€šçŸ¥ï¼Œç›®æ ‡å¯¹è±¡è°ƒç”¨æ–¹æ³•åæ‰§è¡Œï¼Œç›®æ ‡å¯¹è±¡æ–¹æ³•å‘ç”Ÿå¼‚å¸¸åˆ™ä¸æ‰§è¡Œ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">&quot;after_returning&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:after-returning</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- å¼‚å¸¸é€šçŸ¥ï¼Œç›®æ ‡å¯¹è±¡è°ƒç”¨æ–¹æ³•å‘ç”Ÿå¼‚å¸¸æ—¶æ‰§è¡Œ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">&quot;after_throwing&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:after-throwing</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- ç¯ç»•é€šçŸ¥ï¼Œç›®æ ‡æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œä¹‹åéƒ½ä¼šæ‰§è¡Œ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;around&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:around</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="9-4-6æµ‹è¯•"><a href="#9-4-6æµ‹è¯•" class="headerlink" title="9.4.6æµ‹è¯•"></a>9.4.6æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.couture.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.couture.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAop</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">applicationContext</span></span><br><span class="line">                <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService)applicationContext.getBean(<span class="string">&quot;userService&quot;</span>);</span><br><span class="line"></span><br><span class="line">        userService.add();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//userService.delete();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>åç«¯å­¦ä¹ </category>
        <category>java</category>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>spring</tag>
        <tag>ssm</tag>
      </tags>
  </entry>
</search>
